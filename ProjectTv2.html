<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Table Merchant Onboarding — Site Data Manager • Product Loader • Recipe Laoder
  </title><style>
    :root { --bg:#0f0f10; --surface:#17171a; --muted:#9aa0a6; --text:#fff; --primary:#00A3FF; }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    .bar{position:sticky;top:0;z-index:50;background:linear-gradient(0deg,rgba(0,0,0,.25),rgba(0,0,0,.25)),var(--surface);border-bottom:1px solid #24262b;padding:10px;display:flex;gap:10px;align-items:center}
    .bar h1{font-size:15px;margin:0 8px 0 0;color:var(--muted);font-weight:600}
    .tab-btn{background:#23252a;color:#cfd3d7;border:1px solid #30333a;padding:8px 12px;border-radius:9px;cursor:pointer;font-weight:600}
    .tab-btn.active{background:var(--primary);color:#fff;border-color:transparent}
    .wrap{height:calc(100vh - 52px)}
    iframe{width:100%;height:100%;border:0;background:#fff;display:none}
    iframe.active{display:block}
  </style>
<script>
    const B64_IDS = {main: 'b64-main', app1: 'b64-product', app2: 'b64-recipe' };

    function decodeB64Utf8(b64) {
      if (window.TextDecoder) {
        const binStr = atob(b64);
        const len = binStr.length;
        const bytes = new Uint8Array(len);
        for (let i=0;i<len;i++) bytes[i] = binStr.charCodeAt(i);
        return new TextDecoder('utf-8').decode(bytes);
      } else {
        // Fallback for old engines
        return decodeURIComponent(escape(atob(b64)));
      }
    }

    function show(id){
      document.querySelectorAll('iframe').forEach(f=>f.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
      const btn = document.querySelector('[data-target="'+id+'"]');
      if (btn) btn.classList.add('active');
    }

    function ensureMounted(id){
      const frame = document.getElementById(id);
      if (frame.dataset.mounted) return;
      const holderId = B64_IDS[id];
      const dataEl = document.getElementById(holderId);
      if (dataEl) {
        frame.srcdoc = decodeB64Utf8(dataEl.textContent.trim());
        frame.dataset.mounted = '1';
      }
    }

    function patchMainUI(){
      const frame = document.getElementById('main');
      const doc = frame && frame.contentDocument;
      if (!doc) return;

      // Hide internal "Product Loader" / "Recipe Loader" buttons
      const kill = ['product loader','recipe loader'];
      const candidates = doc.querySelectorAll('button, .btn, a[role="button"], [role="button"], input[type="button"], input[type="submit"]');
      candidates.forEach(el => {
        const txt = (el.textContent || el.value || '').trim().toLowerCase();
        if (kill.includes(txt)) el.style.display = 'none';
      });

      // Update any "Step 6 of 8" text to reference tabs
      const nodes = doc.body.querySelectorAll('h1,h2,h3,h4,h5,h6,.step-title,.tutorial-step,p,li,div,span');
      for (const el of nodes) {
        const t = el.textContent || '';
        if (/(^|\b)step\s*6\s*of\s*8\b/i.test(t)) {
          let target = el.nextElementSibling || el;
          target.innerHTML = 'Use the <strong>tabs at the top</strong> to open the <strong>Product Loader</strong> inside this combined page.';
          break;
        }
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
// Fresh state: only mount main initially; others mount on first click
      ensureMounted('main');
      document.getElementById('main').addEventListener('load', patchMainUI);

      const b1 = document.querySelector('[data-target="app1"]');
      const b2 = document.querySelector('[data-target="app2"]');
if (b1) b1.addEventListener('click', (ev) => { ev.preventDefault(); ensureMounted('app1'); show('app1'); });
if (b2) b2.addEventListener('click', (ev) => { if (ev && ev.preventDefault) ev.preventDefault(); ensureMounted('app2'); show('app2'); });
show('main');
    
});
</script>
</head>
<body>
<div class="bar">
<h1>Table By Yoco </h1>
<button class="tab-btn active" data-target="main" onclick="show('main')">Site Data Manager</button>
<button class="tab-btn" data-target="app1" onclick="show('app1')">Product Loader</button>
<button class="tab-btn" data-target="app2">Recipe Loader</button>
</div>
<div class="wrap">
<iframe class="active" id="main" title="Site Data Manager"></iframe>
<iframe id="app1" title="Product Loader"></iframe>
<iframe id="app2" title="Recipe Loader"></iframe>
</div>
<!-- Base64 payloads (lint-safe, won't break parser). Decoded at runtime into srcdoc. -->
<script id="b64-main" type="application/json">PCFET0NUWVBFIGh0bWw+Cgo8aHRtbCBjbGFzcz0iaC1mdWxsIiBsYW5nPSJlbiI+CjxoZWFkPgo8bWV0YSBjaGFyc2V0PSJ1dGYtOCIvPgo8bWV0YSBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIiBuYW1lPSJ2aWV3cG9ydCIvPgo8dGl0bGU+VGFibGUgQnkgWW9jbyBTaXRlIERhdGEgTWFuYWdlcjwvdGl0bGU+CjwhLS0gVXNpbmcgYSBtb2Rlcm4gZmF2aWNvbiBmb3IgYSBwcm9mZXNzaW9uYWwgbG9vayAtLT4KPGxpbmsgaHJlZj0iZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMDAgMTAwJyUzRSUzQ2RlZnMlM0UlM0NsaW5lYXJHcmFkaWVudCBpZD0nZycgeDE9JzAlMjUnIHkxPScwJTI1JyB4Mj0nMTAwJTI1JyB5Mj0nMTAwJTI1JyUzRSUzQ3N0b3Agb2Zmc2V0PScwJTI1JyBzdHlsZT0nc3RvcC1jb2xvcjolMjMwMEEzRkY7c3RvcC1vcGFjaXR5OjEnIC8lM0UlM0NzdG9wIG9mZnNldD0nMTAwJTI1JyBzdHlsZT0nc3RvcC1jb2xvcjolMjMwMDc4RkY7c3RvcC1vcGFjaXR5OjEnIC8lM0UlM0MvbGluZWFyR3JhZGllbnQlM0UlM0MvZGVmcyUzRSUzQ3JlY3Qgd2lkdGg9JzEwMCcgaGVpZ2h0PScxMDAnIHJ4PScyMCcgZmlsbD0ndXJsKCUyM2cpJy8lM0UlM0N0ZXh0IHg9JzUwJyB5PSc2OCcgZm9udC1zaXplPSc1MCcgZm9udC1mYW1pbHk9J1BvcHBpbnMsIHNhbnMtc2VyaWYnIGZvbnQtd2VpZ2h0PSdib2xkJyBmaWxsPSd3aGl0ZScgdGV4dC1hbmNob3I9J21pZGRsZSclM0VUJTNDL3RleHQlM0UlM0Mvc3ZnJTNFIiByZWw9Imljb24iLz4KPCEtLSBTaGVldEpTIGxpYnJhcnkgZm9yIEV4Y2VsIGltcG9ydC9leHBvcnQgLS0+CjxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy94bHN4LzAuMTguNS94bHN4LmZ1bGwubWluLmpzIj48L3NjcmlwdD4KPCEtLSBUYWlsd2luZCBDU1MgZm9yIG1vZGVybiBzdHlsaW5nIC0tPgo8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG4udGFpbHdpbmRjc3MuY29tIj48L3NjcmlwdD4KPCEtLSBHb29nbGUgRm9udHMgZm9yIHR5cG9ncmFwaHkgLS0+CjxsaW5rIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20iIHJlbD0icHJlY29ubmVjdCIvPgo8bGluayBjcm9zc29yaWdpbj0iIiBocmVmPSJodHRwczovL2ZvbnRzLmdzdGF0aWMuY29tIiByZWw9InByZWNvbm5lY3QiLz4KPGxpbmsgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1Qb3BwaW5zOndnaHRANDAwOzUwMDs2MDA7NzAwJmFtcDtkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCIvPgo8c3R5bGU+CiAgICAvKiBSZXZlcnRlZCB0byBvcmlnaW5hbCBibHVlIGNvbG9yIHNjaGVtZSAqLwogICAgOnJvb3QgewogICAgICAtLXlvY28tYmc6ICMxMjEyMTI7CiAgICAgIC0teW9jby1zdXJmYWNlOiAjMWUxZTFlOwogICAgICAtLXlvY28tcHJpbWFyeTogIzAwQTNGRjsKICAgICAgLS15b2NvLXByaW1hcnktaG92ZXI6ICMwMDc4RkY7CiAgICAgIC0teW9jby10ZXh0OiAjZTBlMGUwOwogICAgICAtLXlvY28tdGV4dC1zZWNvbmRhcnk6ICNhMGEwYTA7CiAgICAgIC0teW9jby1ib3JkZXI6ICMzMzM7CiAgICAgIC0teW9jby1zdWNjZXNzOiAjMjhhNzQ1OwogICAgICAtLXlvY28tZXJyb3I6ICNkYzM1NDU7CiAgICAgIC0teW9jby13YXJuaW5nOiAjZmZjMTA3OwogICAgfQoKICAgIGJvZHkgewogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWJnKTsKICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dCk7CiAgICAgIGZvbnQtZmFtaWx5OiAnUG9wcGlucycsIHNhbnMtc2VyaWY7CiAgICAgIC13ZWJraXQtZm9udC1zbW9vdGhpbmc6IGFudGlhbGlhc2VkOwogICAgICAtbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlOwogICAgfQoKICAgIC5idG4gewogICAgICBwYWRkaW5nOiAwLjc1cmVtIDEuNXJlbTsKICAgICAgYm9yZGVyLXJhZGl1czogMC41cmVtOwogICAgICBmb250LXdlaWdodDogNjAwOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UtaW4tb3V0OwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGRpc3BsYXk6IGlubGluZS1mbGV4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBnYXA6IDAuNXJlbTsKICAgICAgYm94LXNoYWRvdzogMCA0cHggNnB4IHJnYmEoMCwgMCwgMCwgMC4yKTsKICAgIH0KICAgIAogICAgLmJ0bi1pY29uIHsKICAgICAgICBwYWRkaW5nOiAwLjc1cmVtOwogICAgfQoKICAgIC5idG46aG92ZXI6bm90KDpkaXNhYmxlZCkgewogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMnB4KTsKICAgICAgICBib3gtc2hhZG93OiAwIDZweCAxMHB4IHJnYmEoMCwgMCwgMCwgMC4zKTsKICAgIH0KICAgIAogICAgLmJ0bjpkaXNhYmxlZCB7CiAgICAgICAgb3BhY2l0eTogMC41OwogICAgICAgIGN1cnNvcjogbm90LWFsbG93ZWQ7CiAgICB9CgogICAgLmJ0bi1wcmltYXJ5IHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgY29sb3I6IHdoaXRlOwogICAgfQogICAgLmJ0bi1wcmltYXJ5OmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5LWhvdmVyKTsKICAgIH0KICAgIC5idG4tc2Vjb25kYXJ5IHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1zdXJmYWNlKTsKICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dCk7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgIH0KICAgICAuYnRuLXNlY29uZGFyeTpob3Zlcjpub3QoOmRpc2FibGVkKSB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tYm9yZGVyKTsKICAgIH0KICAgIC5idG4tZGFuZ2VyIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWVycm9yKTsKICAgICAgICBjb2xvcjogd2hpdGU7CiAgICB9CiAgICAuYnRuLWRhbmdlcjpob3Zlcjpub3QoOmRpc2FibGVkKSB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2M4MjMzMzsKICAgIH0KCiAgICAudGFiLWJ0biB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBib3JkZXItYm90dG9tOiAycHggc29saWQgdHJhbnNwYXJlbnQ7CiAgICAgICAgcGFkZGluZzogMXJlbSAxLjVyZW07CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7CiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZS1pbi1vdXQ7CiAgICB9CiAgICAudGFiLWJ0bi5hY3RpdmUgewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIGJvcmRlci1ib3R0b206IDJweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgLnRhYi1idG46aG92ZXIgewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgCiAgICAudGFibGUtY29udGFpbmVyIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UpOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBib3JkZXItcmFkaXVzOiAwLjc1cmVtOwogICAgICAgIG92ZXJmbG93LXg6IGF1dG87CiAgICAgICAgbWF4LWhlaWdodDogNTV2aDsKICAgICAgICBib3gtc2hhZG93OiAwIDhweCAyNHB4IHJnYmEoMCwgMCwgMCwgMC4yKTsKICAgIH0KCiAgICB0YWJsZSB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsKICAgIH0KCiAgICB0aCwgdGQgewogICAgICAgIHBhZGRpbmc6IDFyZW0gMS4yNXJlbTsKICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0OwogICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgIH0KCiAgICB0aGVhZCB0aCB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjIpOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgcG9zaXRpb246IHN0aWNreTsKICAgICAgICB0b3A6IDA7CiAgICAgICAgei1pbmRleDogMTA7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dCk7CiAgICB9CgogICAgdGJvZHkgdHI6aG92ZXIgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wNSk7CiAgICB9CiAgICAKICAgIHRkW2NvbnRlbnRlZGl0YWJsZT0idHJ1ZSJdIHsKICAgICAgICBjdXJzb3I6IGNlbGw7CiAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzIGVhc2U7CiAgICB9CiAgICB0ZFtjb250ZW50ZWRpdGFibGU9InRydWUiXTpmb2N1cyB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAxNjMsIDI1NSwgMC4xKTsKICAgICAgICBvdXRsaW5lOiAxcHggc29saWQgdmFyKC0teW9jby1wcmltYXJ5KTsKICAgIH0KICAgIAogICAgLyogVG9vbHRpcCBzdHlsZXMgKi8KICAgIC50b29sdGlwIHsKICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgY3Vyc29yOiBoZWxwOwogICAgfQogICAgLnRvb2x0aXA6OmFmdGVyIHsKICAgICAgICBjb250ZW50OiBhdHRyKGRhdGEtdG9vbHRpcCk7CiAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgIGJvdHRvbTogMTAwJTsKICAgICAgICBsZWZ0OiA1MCU7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpIHNjYWxlKDAuOSk7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsKICAgICAgICBjb2xvcjogI2ZmZjsKICAgICAgICBwYWRkaW5nOiAwLjVyZW0gMXJlbTsKICAgICAgICBib3JkZXItcmFkaXVzOiAwLjM3NXJlbTsKICAgICAgICBmb250LXNpemU6IDAuODc1cmVtOwogICAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7CiAgICAgICAgd2hpdGUtc3BhY2U6IG5vcm1hbDsKICAgICAgICB3aWR0aDogbWF4LWNvbnRlbnQ7CiAgICAgICAgbWF4LXdpZHRoOiAyNTBweDsKICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgb3BhY2l0eTogMDsKICAgICAgICB2aXNpYmlsaXR5OiBoaWRkZW47CiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZS1pbi1vdXQ7CiAgICAgICAgei1pbmRleDogMjA7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMC41cmVtOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwwLDAsMC40KTsKICAgIH0KICAgIC50b29sdGlwOmhvdmVyOjphZnRlciB7CiAgICAgICAgb3BhY2l0eTogMTsKICAgICAgICB2aXNpYmlsaXR5OiB2aXNpYmxlOwogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKSBzY2FsZSgxKTsKICAgIH0KCiAgICAuYWN0aW9uLWJ0biB7CiAgICAgICAgYmFja2dyb3VuZDogbm9uZTsKICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIHBhZGRpbmc6IDAuMjVyZW07CiAgICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMgZWFzZTsKICAgIH0KICAgIC5hY3Rpb24tYnRuOmhvdmVyIHsKICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICB9CgogICAgLyogTW9kYWwgc3R5bGVzICovCiAgICAubW9kYWwtYmFja2Ryb3AgewogICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICB0b3A6IDA7CiAgICAgICAgbGVmdDogMDsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjcpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICB6LWluZGV4OiAxMDAwOwogICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgdmlzaWJpbGl0eTogaGlkZGVuOwogICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4zcyBlYXNlLCB2aXNpYmlsaXR5IDAuM3MgZWFzZTsKICAgIH0KICAgIC5tb2RhbC1iYWNrZHJvcC5zaG93IHsKICAgICAgICBvcGFjaXR5OiAxOwogICAgICAgIHZpc2liaWxpdHk6IHZpc2libGU7CiAgICB9CiAgICAubW9kYWwtY29udGVudCB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1zdXJmYWNlKTsKICAgICAgICBwYWRkaW5nOiAycmVtOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDAuNzVyZW07CiAgICAgICAgd2lkdGg6IDkwJTsKICAgICAgICBtYXgtd2lkdGg6IDUwMHB4OwogICAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAzMHB4IHJnYmEoMCwwLDAsMC41KTsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgwLjk1KTsKICAgICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4zcyBlYXNlOwogICAgfQogICAgLm1vZGFsLWJhY2tkcm9wLnNob3cgLm1vZGFsLWNvbnRlbnQgewogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7CiAgICB9CiAgICAubW9kYWwtaWNvbiB7CiAgICAgICAgd2lkdGg6IDUwcHg7CiAgICAgICAgaGVpZ2h0OiA1MHB4OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgbWFyZ2luOiAwIGF1dG8gMS41cmVtIGF1dG87CiAgICB9CiAgICAubW9kYWwtaWNvbi5zdWNjZXNzIHsgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1zdWNjZXNzKTsgfQogICAgLm1vZGFsLWljb24uZXJyb3IgeyBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWVycm9yKTsgfQogICAgLm1vZGFsLWljb24ud2FybmluZyB7IGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28td2FybmluZyk7IH0KICAgIAogICAgI2xvZ28tYW5pbWF0aW9uLWNvbnRhaW5lciB7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgfQogICAgLmxvZ28tcGFydC0xIHsKICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICAgICAgb3BhY2l0eTogMDsKICAgICAgICBhbmltYXRpb246IGxvb3BBbmltYXRpb24xIDRzIGVhc2UtaW4tb3V0IGluZmluaXRlOwogICAgfQogICAgLmxvZ28tcGFydC0yIHsKICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICAgICAgb3BhY2l0eTogMDsKICAgICAgICBhbmltYXRpb246IGxvb3BBbmltYXRpb24yIDRzIGVhc2UtaW4tb3V0IGluZmluaXRlOwogICAgfQoKICAgIEBrZXlmcmFtZXMgbG9vcEFuaW1hdGlvbjEgewogICAgICAgIDAlLCAxMDAlIHsgb3BhY2l0eTogMDsgfQogICAgICAgIDEwJSwgODAlIHsgb3BhY2l0eTogMTsgfQogICAgfQoKICAgIEBrZXlmcmFtZXMgbG9vcEFuaW1hdGlvbjIgewogICAgICAgIDAlLCAyMCUgeyBvcGFjaXR5OiAwOyB9CiAgICAgICAgMzAlLCA4MCUgeyBvcGFjaXR5OiAxOyB9CiAgICB9CgogICAgLyogVHV0b3JpYWwgU3R5bGVzICovCiAgICAudHV0b3JpYWwtb3ZlcmxheSB7CiAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgIHRvcDogMDsKICAgICAgICBsZWZ0OiAwOwogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICB6LWluZGV4OiA5OTk4OwogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CiAgICAudHV0b3JpYWwtb3ZlcmxheS1wYXJ0IHsKICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjg1KTsKICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC40cyBlYXNlLWluLW91dDsKICAgIH0KICAgIC5oaWdobGlnaHQtZWxlbWVudCB7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgIHotaW5kZXg6IDk5OTk7CiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4zcyBlYXNlLWluLW91dDsKICAgICAgICBib3gtc2hhZG93OiAwIDAgMTVweCA1cHggcmdiYSgwLCAxNjMsIDI1NSwgMC43KTsKICAgICAgICBhbmltYXRpb246IHB1bHNlLWdsb3cgMnMgaW5maW5pdGUgZWFzZS1pbi1vdXQ7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3ZlciB7CiAgICAgICAgcG9zaXRpb246IGZpeGVkOyAKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UpOwogICAgICAgIGNvbG9yOiAjRkZGRkZGOyAvKiBCcmlnaHRlciB0ZXh0IGNvbG9yICovCiAgICAgICAgcGFkZGluZzogMDsKICAgICAgICBib3JkZXItcmFkaXVzOiAwLjhyZW07CiAgICAgICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICB6LWluZGV4OiAxMDAwMTsKICAgICAgICB3aWR0aDogOTAlOwogICAgICAgIG1heC13aWR0aDogMzgwcHg7CiAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDQwcHggcmdiYSgwLDAsMCwwLjcpLCAwIDAgMzBweCByZ2JhKDAsIDE2MywgMjU1LCAwLjUpOwogICAgICAgIGFuaW1hdGlvbjogZmFkZUluUG9wb3ZlciAwLjRzIGVhc2Utb3V0IGZvcndhcmRzOwogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci1oZWFkZXIgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMTYzLCAyNTUsIDAuMSk7CiAgICAgICAgcGFkZGluZzogMXJlbSAxLjVyZW07CiAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICBmb250LXNpemU6IDEuMXJlbTsKICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgZ2FwOiAwLjc1cmVtOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgLnR1dG9yaWFsLXBvcG92ZXItY29udGVudCB7CiAgICAgICAgcGFkZGluZzogMS41cmVtOwogICAgICAgIG1hcmdpbi1ib3R0b206IDA7CiAgICAgICAgZm9udC1zaXplOiAxLjA1cmVtOwogICAgICAgIGxpbmUtaGVpZ2h0OiAxLjY7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci1jb250ZW50IGIgewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci1uYXYgewogICAgICAgIHBhZGRpbmc6IDFyZW0gMS41cmVtOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwwLDAsMC4yKTsKICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICB9CgogICAgLnR1dG9yaWFsLXBvcG92ZXI6OmFmdGVyIHsKICAgICAgICBjb250ZW50OiAnJzsKICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgYm9yZGVyLXdpZHRoOiAxMHB4OwogICAgICAgIGJvcmRlci1zdHlsZTogc29saWQ7CiAgICAgICAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudDsKICAgIH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLmFycm93LXRvcDo6YWZ0ZXIgewogICAgICAgIGJvdHRvbTogMTAwJTsgbGVmdDogNTAlOwogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgICAgICBib3JkZXItYm90dG9tLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgLnR1dG9yaWFsLXBvcG92ZXIuYXJyb3ctYm90dG9tOjphZnRlciB7CiAgICAgICAgdG9wOiAxMDAlOyBsZWZ0OiA1MCU7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpOwogICAgICAgIGJvcmRlci10b3AtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy1sZWZ0OjphZnRlciB7CiAgICAgICAgcmlnaHQ6IDEwMCU7IHRvcDogNTAlOwogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsKICAgICAgICBib3JkZXItcmlnaHQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy1yaWdodDo6YWZ0ZXIgewogICAgICAgIGxlZnQ6IDEwMCU7IHRvcDogNTAlOwogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsKICAgICAgICBib3JkZXItbGVmdC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgIH0KICAgIAogICAgQGtleWZyYW1lcyBmYWRlSW5Qb3BvdmVyIHsKICAgICAgZnJvbSB7CiAgICAgICAgb3BhY2l0eTogMDsKICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOwogICAgICB9CiAgICAgIHRvIHsKICAgICAgICBvcGFjaXR5OiAxOwogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7CiAgICAgIH0KICAgIH0KCiAgICBAa2V5ZnJhbWVzIHB1bHNlLWdsb3cgewogICAgICAwJSB7IGJveC1zaGFkb3c6IDAgMCAxNXB4IDVweCByZ2JhKDAsIDE2MywgMjU1LCAwLjcpOyB9CiAgICAgIDUwJSB7IGJveC1zaGFkb3c6IDAgMCAyNXB4IDEwcHggcmdiYSgwLCAxNjMsIDI1NSwgMC43KTsgfQogICAgICAxMDAlIHsgYm94LXNoYWRvdzogMCAwIDE1cHggNXB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNyk7IH0KICAgIH0KCiAgICAvKiBNYWtlIHRhYnMgbW9yZSByZWFkYWJsZSBkdXJpbmcgdHV0b3JpYWwgKi8KICAgIGJvZHkudHV0b3JpYWwtYWN0aXZlIC50YWItYnRuIHsKICAgICAgICBjb2xvcjogI2ZmZmZmZjsKICAgICAgICBvcGFjaXR5OiAxOwogICAgfQogICAgYm9keS50dXRvcmlhbC1hY3RpdmUgLnRhYi1idG4uYWN0aXZlIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgIH0KICA8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5IGNsYXNzPSJoLWZ1bGwiPgo8IS0tIExPR0lOIFBBR0UgLS0+CjxkaXYgY2xhc3M9ImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIG1pbi1oLXNjcmVlbiBwLTQiIGlkPSJsb2dpbi1jb250YWluZXIiPgo8ZGl2IGNsYXNzPSJiZy1bdmFyKC0teW9jby1zdXJmYWNlKV0gcC04IHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSBzaGFkb3ctMnhsIHctZnVsbCBtYXgtdy1tZCB0ZXh0LWNlbnRlciI+CjxoMiBjbGFzcz0idGV4dC0yeGwgZm9udC1ib2xkIG1iLTIgdGV4dC13aGl0ZSI+V2VsY29tZTwvaDI+CjxwIGNsYXNzPSJ0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gbWItNiI+VGhlIHNpbXBsZSB3YXkgdG8gbWFuYWdlIHlvdXIgc2l0ZSBkYXRhLjwvcD4KPGRpdiBjbGFzcz0iZmxleCBqdXN0aWZ5LWNlbnRlciBpdGVtcy1jZW50ZXIgYmctYmxhY2sgcC00IHJvdW5kZWQtbGcgbWItNiBteC1hdXRvIHctZnVsbCBoLTMyIG1heC13LXNtIiBpZD0ibG9nby1hbmltYXRpb24tY29udGFpbmVyIj4KPGRpdiBjbGFzcz0idGV4dC13aGl0ZSB0ZXh0LTR4bCBmb250LWJvbGQgdHJhY2tpbmctd2lkZXN0IHdoaXRlc3BhY2Utbm93cmFwIiBzdHlsZT0iZm9udC1mYW1pbHk6ICdQb3BwaW5zJywgc2Fucy1zZXJpZjsiPgo8c3BhbiBjbGFzcz0ibG9nby1wYXJ0LTEiPlRBQkxFPC9zcGFuPjxzcGFuIGNsYXNzPSJsb2dvLXBhcnQtMiI+IEJZIFlPQ088L3NwYW4+CjwvZGl2Pgo8L2Rpdj4KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IHctZnVsbCBqdXN0aWZ5LWNlbnRlciIgaWQ9InNob3ctc3VtbWFyeS1idG4iPkNvbnRpbnVlPC9idXR0b24+CjwvZGl2Pgo8L2Rpdj4KPCEtLSBNQUlOIEFQUExJQ0FUSU9OIChJbml0aWFsbHkgaGlkZGVuKSAtLT4KPGRpdiBjbGFzcz0iaGlkZGVuIHAtNCBzbTpwLTgiIGlkPSJtYWluLWFwcC1jb250YWluZXIiPgo8ZGl2IGNsYXNzPSJtYXgtdy03eGwgbXgtYXV0byI+CjwhLS0gSGVhZGVyIFNlY3Rpb24gLS0+CjxoZWFkZXIgY2xhc3M9Im1iLTgiIGlkPSJ0dXRvcmlhbC1oZWFkZXIiPgo8ZGl2IGNsYXNzPSJmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1jZW50ZXIgbWItNiI+CjxhIGFyaWEtbGFiZWw9IlZpZXcgU2l0ZSBEYXRhIE1hbmFnZXIg4oCUIEhvdy1UbyBHdWlkZSIgY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IGJ0bi1pY29uIHRvb2x0aXAiIGRhdGEtdG9vbHRpcD0iVmlldyBIb3cgVG8gR3VpZGUiIGhyZWY9Imh0dHBzOi8vZHJpdmUuZ29vZ2xlLmNvbS9maWxlL2QvMWxRbzJUbUs1dVFEWVlPSVRpYzdlZnB1MDFWcHZVNUc0L3ZpZXciIGlkPSJ0dXRvcmlhbC1ob3ctdG8tZ3VpZGUiIHJlbD0ibm9vcGVuZXIgbm9yZWZlcnJlciIgcm9sZT0iYnV0dG9uIiB0YXJnZXQ9Il9ibGFuayI+CjxzdmcgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyMCIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiB2aWV3Ym94PSIwIDAgMjQgMjQiIHdpZHRoPSIyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTQgMkg2YTIgMiAwIDAgMC0yIDJ2MTZhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0yVjh6Ij48L3BhdGg+PHBvbHlsaW5lIHBvaW50cz0iMTQgMiAxNCA4IDIwIDgiPjwvcG9seWxpbmU+PGxpbmUgeDE9IjE2IiB4Mj0iOCIgeTE9IjEzIiB5Mj0iMTMiPjwvbGluZT48bGluZSB4MT0iMTYiIHgyPSI4IiB5MT0iMTciIHkyPSIxNyI+PC9saW5lPjxwb2x5bGluZSBwb2ludHM9IjEwIDkgOSA5IDggOSI+PC9wb2x5bGluZT48L3N2Zz4KPC9hPgo8ZGl2IGNsYXNzPSJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMyBmbGV4LXdyYXAganVzdGlmeS1jZW50ZXIgc206anVzdGlmeS1lbmQiIGlkPSJ0dXRvcmlhbC1hY3Rpb25zIj4KPGRpdiBjbGFzcz0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTMiIGlkPSJ0dXRvcmlhbC1sb2FkZXJzIj4KPGEgY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IiBocmVmPSJodHRwczovL3RhYmxlYWRtaW4tbGFiLmdpdGh1Yi5pby9wcm9kdWN0bG9hZGVyVjIvIiB0YXJnZXQ9Il9ibGFuayI+CjxzdmcgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyMCIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiB2aWV3Ym94PSIwIDAgMjQgMjQiIHdpZHRoPSIyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtMjEuMjEgMTUuODktMS40Mi0xLjQyYTIgMiAwIDAgMC0yLjgyIDBMMTIgMTkuNDFsLTIuOTMtMi45M2EyIDIgMCAwIDAtMi44MiAwTDQuODMgMTcuOWEyIDIgMCAwIDAgMCAyLjgybDEuNDIgMS40MmEyIDIgMCAwIDAgMi44MiAwTDEyIDE5LjQxbDIuOTMgMi45M2EyIDIgMCAwIDAgMi44MiAwbDEuNDItMS40MmEyIDIgMCAwIDAgMC0yLjgyeiI+PC9wYXRoPjxwYXRoIGQ9Ik03LjE3IDE0LjgzIDIuMDcgOS43M2EyIDIgMCAwIDEgMC0yLjgybDEuNDItMS40MmEyIDIgMCAwIDEgMi44MiAwTDkuMjQgOC40MiI+PC9wYXRoPjxwYXRoIGQ9Im0xMiAxMi4wMSA0Ljk1LTQuOTVhMiAyIDAgMCAxIDIuODIgMGwxLjQyIDEuNDJhMiAyIDAgMCAxIDAgMi44MmwtNS4wNSA1LjA1Ij48L3BhdGg+PHBhdGggZD0iTTE0LjgzIDcuMTcgMTkuODMgMi4xNyI+PC9wYXRoPjxwYXRoIGQ9Im0xMiAxOS40MSAyLjEyLTIuMTIiPjwvcGF0aD48cGF0aCBkPSJtOC40MiAxMi4wMSAyLjEyLTIuMTIiPjwvcGF0aD48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgUHJvZHVjdCBMb2FkZXIKICAgICAgICAgICAgICAgICAgICAgIDwvYT4KPGEgY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IiBocmVmPSJodHRwczovL3RhYmxlYWRtaW4tbGFiLmdpdGh1Yi5pby9SZWNpcGVMb2FkZXJ2Mi9SZWNpcGVMb2FkZXJ2Mi5odG1sIiB0YXJnZXQ9Il9ibGFuayI+CjxzdmcgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyMCIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiB2aWV3Ym94PSIwIDAgMjQgMjQiIHdpZHRoPSIyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTQgMkg2YTIgMiAwIDAgMC0yIDJ2MTZhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0yVjh6Ij48L3BhdGg+PHBvbHlsaW5lIHBvaW50cz0iMTQgMiAxNCA4IDIwIDgiPjwvcG9seWxpbmU+PGxpbmUgeDE9IjE2IiB4Mj0iOCIgeTE9IjEzIiB5Mj0iMTMiPjwvbGluZT48bGluZSB4MT0iMTYiIHgyPSI4IiB5MT0iMTciIHkyPSIxNyI+PC9saW5lPjxwb2x5bGluZSBwb2ludHM9IjEwIDkgOSA5IDggOSI+PC9wb2x5bGluZT48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgUmVjaXBlIExvYWRlcgogICAgICAgICAgICAgICAgICAgICAgPC9hPgo8L2Rpdj4KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IiBpZD0iZXhwb3J0QnRuIj4KPHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjIwIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIHZpZXdib3g9IjAgMCAyNCAyNCIgd2lkdGg9IjIwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0yMSAxNXY0YTIgMiAwIDAgMS0yIDJINWEyIDIgMCAwIDEtMi0ydi00Ij48L3BhdGg+PHBvbHlsaW5lIHBvaW50cz0iNyAxMCAxMiAxNSAxNyAxMCI+PC9wb2x5bGluZT48bGluZSB4MT0iMTIiIHgyPSIxMiIgeTE9IjE1IiB5Mj0iMyI+PC9saW5lPjwvc3ZnPgogICAgICAgICAgICAgICAgICAgIEV4cG9ydCBBbGwgdG8gRXhjZWwKICAgICAgICAgICAgICAgICAgPC9idXR0b24+CjxidXR0b24gY2xhc3M9ImJ0biBidG4tZGFuZ2VyIiBpZD0iY2xlYXJCdG4iPgo8c3ZnIGZpbGw9Im5vbmUiIGhlaWdodD0iMjAiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgdmlld2JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBvbHlsaW5lIHBvaW50cz0iMyA2IDUgNiAyMSA2Ij48L3BvbHlsaW5lPjxwYXRoIGQ9Ik0xOSA2djE0YTIgMiAwIDAgMS0yIDJIN2EyIDIgMCAwIDEtMi0yVjZtMyAwVjRhMiAyIDAgMCAxIDItMmg0YTIgMiAwIDAgMSAyIDJ2MiI+PC9wYXRoPjxsaW5lIHgxPSIxMCIgeDI9IjEwIiB5MT0iMTEiIHkyPSIxNyI+PC9saW5lPjxsaW5lIHgxPSIxNCIgeDI9IjE0IiB5MT0iMTEiIHkyPSIxNyI+PC9saW5lPjwvc3ZnPgogICAgICAgICAgICAgICAgICAgIENsZWFyIEFsbCBEYXRhCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9InRleHQtY2VudGVyIj4KPGgxIGNsYXNzPSJ0ZXh0LTR4bCBmb250LWJvbGQgdGV4dC13aGl0ZSB0cmFja2luZy10aWdodCBsZWFkaW5nLXRpZ2h0Ij4KPHNwYW4gY2xhc3M9ImJsb2NrIHRleHQteGwgZm9udC1saWdodCB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gdHJhY2tpbmctd2lkZXIgdXBwZXJjYXNlIj5UYWJsZSBCeSBZb2NvPC9zcGFuPgo8c3BhbiBjbGFzcz0idGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0iPlNpdGUgRGF0YSBNYW5hZ2VyPC9zcGFuPgo8L2gxPgo8L2Rpdj4KPC9oZWFkZXI+CjwhLS0gVGFiIE5hdmlnYXRpb24gLS0+CjxkaXYgY2xhc3M9ImJvcmRlci1iIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSBtYi02IiBpZD0idHV0b3JpYWwtdGFicyI+CjxuYXYgY2xhc3M9ImZsZXggZmxleC13cmFwIC1tYi1weCBqdXN0aWZ5LWNlbnRlciIgaWQ9InRhYi1uYXYiPgo8IS0tIFRhYiBidXR0b25zIHdpbGwgYmUgaW5zZXJ0ZWQgaGVyZSBieSBKUyAtLT4KPC9uYXY+CjwvZGl2Pgo8IS0tIFRhYiBDb250ZW50IC0tPgo8bWFpbiBpZD0idGFiLWNvbnRlbnQiPgo8IS0tIFRhYiBwYW5lbHMgd2lsbCBiZSBpbnNlcnRlZCBoZXJlIGJ5IEpTIC0tPgo8L21haW4+CjwhLS0gRm9vdGVyIFNlY3Rpb24gLS0+Cjxmb290ZXIgY2xhc3M9Im10LTEyIHB5LTYgZmxleCBqdXN0aWZ5LWNlbnRlciI+CjxkaXYgY2xhc3M9ImJnLVt2YXIoLS15b2NvLXN1cmZhY2UpXSBib3JkZXIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIHB4LTUgcHktMyByb3VuZGVkLWxnIGZsZXggaXRlbXMtY2VudGVyIHNwYWNlLXgtOCBzaGFkb3ctbGciPgo8YSBjbGFzcz0idGV4dC1iYXNlIGZvbnQtYm9sZCB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gaG92ZXI6dGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0gdHJhbnNpdGlvbi1jb2xvcnMiIGhyZWY9Imh0dHBzOi8vd3d3LnlvY28uY29tL3phL2xlZ2FsLyIgcmVsPSJub29wZW5lciBub3JlZmVycmVyIiB0YXJnZXQ9Il9ibGFuayI+CiAgICAgICAgICAgIFByaXZhY3kKICAgICAgICAgIDwvYT4KPGEgY2xhc3M9InRleHQtYmFzZSBmb250LWJvbGQgdGV4dC1bdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSldIGhvdmVyOnRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIHRyYW5zaXRpb24tY29sb3JzIiBocmVmPSJodHRwczovL3d3dy55b2NvLmNvbS96YS9sZWdhbC8iIHJlbD0ibm9vcGVuZXIgbm9yZWZlcnJlciIgdGFyZ2V0PSJfYmxhbmsiPgogICAgICAgICAgICBUZXJtcwogICAgICAgICAgPC9hPgo8L2Rpdj4KPC9mb290ZXI+CjwvZGl2Pgo8L2Rpdj4KPCEtLSBNb2RhbCBUZW1wbGF0ZSAtLT4KPGRpdiBjbGFzcz0ibW9kYWwtYmFja2Ryb3AiIGlkPSJtb2RhbCI+CjxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQgdGV4dC1jZW50ZXIiPgo8ZGl2IGNsYXNzPSJtb2RhbC1pY29uIiBpZD0ibW9kYWwtaWNvbiI+CjxzdmcgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyNCIgaWQ9Im1vZGFsLXN2ZyIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIHZpZXdib3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjwvc3ZnPgo8L2Rpdj4KPHAgY2xhc3M9InRleHQtbGcgbWItNiIgaWQ9Im1vZGFsLW1lc3NhZ2UiPjwvcD4KPGRpdiBjbGFzcz0iZmxleCBqdXN0aWZ5LWNlbnRlciBnYXAtNCIgaWQ9Im1vZGFsLWJ1dHRvbnMiPgo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIGlkPSJtb2RhbC1jb25maXJtIj5Db25maXJtPC9idXR0b24+CjxidXR0b24gY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IiBpZD0ibW9kYWwtY2FuY2VsIj5DYW5jZWw8L2J1dHRvbj4KPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPCEtLSBTdW1tYXJ5IE1vZGFsIC0tPgo8ZGl2IGNsYXNzPSJtb2RhbC1iYWNrZHJvcCIgaWQ9InN1bW1hcnktbW9kYWwiPgo8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50IHRleHQtbGVmdCI+CjxoMyBjbGFzcz0idGV4dC14bCBmb250LWJvbGQgbWItNCB0ZXh0LXdoaXRlIj5BcHBsaWNhdGlvbiBTdW1tYXJ5PC9oMz4KPHAgY2xhc3M9InRleHQtW3ZhcigtLXlvY28tdGV4dCldIG1iLTYiIGlkPSJzdW1tYXJ5LXRleHQiPjwvcD4KPGRpdiBjbGFzcz0iZmxleCBqdXN0aWZ5LWVuZCBnYXAtNCI+CjxhIGNsYXNzPSJidG4gYnRuLXNlY29uZGFyeSIgaHJlZj0iaHR0cHM6Ly93d3cueW9jby5jb20vemEvbGVnYWwvIiByZWw9Im5vb3BlbmVyIG5vcmVmZXJyZXIiIHRhcmdldD0iX2JsYW5rIj5Qcml2YWN5IFBvbGljeTwvYT4KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5IiBpZD0icHJvY2VlZC10by1hcHAtYnRuIj5PSywgUHJvY2VlZDwvYnV0dG9uPgo8L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8IS0tIFR1dG9yaWFsIFByb21wdCBNb2RhbCAtLT4KPGRpdiBjbGFzcz0ibW9kYWwtYmFja2Ryb3AiIGlkPSJ0dXRvcmlhbC1wcm9tcHQtbW9kYWwiPgo8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50IHRleHQtY2VudGVyIj4KPGgzIGNsYXNzPSJ0ZXh0LXhsIGZvbnQtYm9sZCBtYi00IHRleHQtd2hpdGUiPlF1aWNrIFR1dG9yaWFsPC9oMz4KPHAgY2xhc3M9InRleHQtW3ZhcigtLXlvY28tdGV4dCldIG1iLTYiPldvdWxkIHlvdSBsaWtlIGEgcXVpY2sgdG91ciBvZiB0aGUgbWFpbiBmZWF0dXJlcz88L3A+CjxkaXYgY2xhc3M9ImZsZXgganVzdGlmeS1jZW50ZXIgZ2FwLTQiPgo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIGlkPSJzdGFydC10dXRvcmlhbC1idG4iPlllcywgcGxlYXNlPC9idXR0b24+CjxidXR0b24gY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IiBpZD0ic2tpcC10dXRvcmlhbC1idG4iPk5vLCB0aGFua3M8L2J1dHRvbj4KPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPCEtLSBUdXRvcmlhbCBPdmVybGF5ICYgUG9wb3ZlciAtLT4KPGRpdiBjbGFzcz0idHV0b3JpYWwtb3ZlcmxheSIgaWQ9InR1dG9yaWFsLW92ZXJsYXkiPgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5LXBhcnQiIGlkPSJ0dXRvcmlhbC1vdmVybGF5LXRvcCI+PC9kaXY+CjxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktYm90dG9tIj48L2Rpdj4KPGRpdiBjbGFzcz0idHV0b3JpYWwtb3ZlcmxheS1wYXJ0IiBpZD0idHV0b3JpYWwtb3ZlcmxheS1sZWZ0Ij48L2Rpdj4KPGRpdiBjbGFzcz0idHV0b3JpYWwtb3ZlcmxheS1wYXJ0IiBpZD0idHV0b3JpYWwtb3ZlcmxheS1yaWdodCI+PC9kaXY+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyIiBpZD0idHV0b3JpYWwtcG9wb3ZlciI+CjxkaXYgY2xhc3M9InR1dG9yaWFsLXBvcG92ZXItaGVhZGVyIj4KPHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjI0IiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIHZpZXdib3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xMiAyMnM4LTQgOC0xMFY1bC04LTMtOCAzdjdjMCA2IDggMTAgOCAxMHoiPjwvcGF0aD48L3N2Zz4KPHNwYW4+UXVpY2sgR3VpZGU8L3NwYW4+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQiIGlkPSJ0dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQiPjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyLW5hdiI+CjxzcGFuIGNsYXNzPSJ0ZXh0LXNtIHRleHQtW3ZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpXSIgaWQ9InR1dG9yaWFsLXN0ZXAtY291bnRlciI+PC9zcGFuPgo8ZGl2Pgo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNlY29uZGFyeSIgaWQ9InR1dG9yaWFsLXByZXYtYnRuIj5QcmV2PC9idXR0b24+CjxidXR0b24gY2xhc3M9ImJ0biBidG4tcHJpbWFyeSIgaWQ9InR1dG9yaWFsLW5leHQtYnRuIj5OZXh0PC9idXR0b24+CjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjxzY3JpcHQ+Ci8vIC0tLSBEQVRBIElOSVRJQUxJWkFUSU9OIC0tLQpjb25zdCBpbml0aWFsRGF0YSA9IHsKICAgIHNpdGVEZXRhaWxzOiB7CiAgICAgICAgaWQ6ICdzaXRlRGV0YWlscycsCiAgICAgICAgbmFtZTogJ1NpdGUgRGV0YWlscycsCiAgICAgICAgaGVhZGVyczogWyJTaXRlIE5hbWUiLCJSZWdpc3RlcmVkIENvbXBhbnkgTmFtZSIsIlRyYWRpbmcgTmFtZSIsIkNvbXBhbnkgUmVnaXN0cmF0aW9uIE51bWJlciIsIkNvbXBhbnkgVkFUIE51bWJlciIsIlNpdGUgQWRkcmVzcyIsIk93bmVyIE5hbWUiLCJPd25lciBTdXJuYW1lIiwiT3duZXIgVGVsZXBob25lIE51bWJlciIsIk93bmVyIEVtYWlsIEFkZHJlc3MiXSwKICAgICAgICBmb3JtSGVhZGVyczogWyJTaXRlIE5hbWUiLCJSZWdpc3RlcmVkIENvbXBhbnkgTmFtZSIsIlRyYWRpbmcgTmFtZSIsIkNvbXBhbnkgUmVnaXN0cmF0aW9uIE51bWJlciIsIkNvbXBhbnkgVkFUIE51bWJlciIsIlNpdGUgQWRkcmVzcyIsIk93bmVyIEZ1bGwgTmFtZSIsIk93bmVyIFRlbGVwaG9uZSBOdW1iZXIiLCJPd25lciBFbWFpbCBBZGRyZXNzIl0sCiAgICAgICAgZGF0YTogW10KICAgIH0sCiAgICBlbXBsb3llZXM6IHsKICAgICAgICBpZDogJ2VtcGxveWVlcycsCiAgICAgICAgbmFtZTogJ0VtcGxveWVlcycsCiAgICAgICAgaGVhZGVyczogWyJFbXBsb3llZSBOYW1lIiwiU3VybmFtZSIsIkVtYWlsIEFkZHJlc3MgKElmIEFkbWluL01hbmFnZXIpIiwiQ29udGFjdCBOdW1iZXIgKElmIEFkbWluL01hbmFnZXIpIiwiUm9sZSIsIkxvZ2luIENvZGUiXSwKICAgICAgICBmb3JtSGVhZGVyczogWyJFbXBsb3llZSBGdWxsIE5hbWUiLCJFbWFpbCBBZGRyZXNzIChJZiBBZG1pbi9NYW5hZ2VyKSIsIkNvbnRhY3QgTnVtYmVyIChJZiBBZG1pbi9NYW5hZ2VyKSIsIlJvbGUiLCJMb2dpbiBDb2RlIl0sCiAgICAgICAgZGF0YTogW10gCiAgICB9LAogICAgc3VwcGxpZXJzOiB7CiAgICAgICAgaWQ6ICdzdXBwbGllcnMnLAogICAgICAgIG5hbWU6ICdTdXBwbGllcnMnLAogICAgICAgIGhlYWRlcnM6IFsiTmFtZSIsIkFkZHJlc3MgTGluZSAxIiwiVG93biIsIkNvbnRhY3QgRmlyc3QgTmFtZSIsIkNvbnRhY3QgRW1haWwiLCJDb250YWN0IFBob25lIE51bWJlciJdLAogICAgICAgIGZvcm1IZWFkZXJzOiBbIk5hbWUiLCJBZGRyZXNzIExpbmUgMSIsIlRvd24iLCJDb250YWN0IEZpcnN0IE5hbWUiLCJDb250YWN0IEVtYWlsIiwiQ29udGFjdCBQaG9uZSBOdW1iZXIiXSwKICAgICAgICBkYXRhOiBbXSAKICAgIH0sCiAgICBzaXRkb3duQXJlYXM6IHsKICAgICAgICBpZDogJ3NpdGRvd25BcmVhcycsCiAgICAgICAgbmFtZTogJ1NpdCBEb3duIEFyZWFzJywKICAgICAgICBoZWFkZXJzOiBbIkFyZWEgTG9jYXRpb24iLCAiVGFibGUgIyJdLAogICAgICAgIGZvcm1IZWFkZXJzOiBbIkFyZWEgTG9jYXRpb24iLCAiVGFibGUgIyJdLAogICAgICAgIGRhdGE6IFtdCiAgICB9LAogICAgaW50ZWdyYXRpb25zOiB7CiAgICAgICAgaWQ6ICdpbnRlZ3JhdGlvbnMnLAogICAgICAgIG5hbWU6ICczcmQgUGFydHkgSW50ZWdyYXRpb25zJywKICAgICAgICBoZWFkZXJzOiBbIkludGVncmF0aW9uIiwgIkRldGFpbCAxIiwgIlZhbHVlIDEiLCAiRGV0YWlsIDIiLCAiVmFsdWUgMiIsICJEZXRhaWwgMyIsICJWYWx1ZSAzIl0sCiAgICAgICAgZm9ybUhlYWRlcnM6IFtdLCAvLyBDdXN0b20gZm9ybSwgc28gdGhpcyBpcyBlbXB0eQogICAgICAgIGRhdGE6IFtdLAogICAgICAgIHR5cGU6ICdjdXN0b20nIC8vIEZsYWcgZm9yIHNwZWNpYWwgaGFuZGxpbmcKICAgIH0KfTsKCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7CiAgICAvLyAtLS0gTE9HSU4gUEFHRSBMT0dJQyAtLS0KICAgIGNvbnN0IGxvZ2luQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luLWNvbnRhaW5lcicpOwogICAgY29uc3QgbWFpbkFwcENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluLWFwcC1jb250YWluZXInKTsKICAgIGNvbnN0IHNob3dTdW1tYXJ5QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3ctc3VtbWFyeS1idG4nKTsKICAgIGNvbnN0IHN1bW1hcnlNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdW1tYXJ5LW1vZGFsJyk7CiAgICBjb25zdCBzdW1tYXJ5VGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdW1tYXJ5LXRleHQnKTsKICAgIGNvbnN0IHByb2NlZWRUb0FwcEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9jZWVkLXRvLWFwcC1idG4nKTsKICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5ib2R5OwogICAgY29uc3QgdHV0b3JpYWxQcm9tcHRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1wcm9tcHQtbW9kYWwnKTsKICAgIGNvbnN0IHN0YXJ0VHV0b3JpYWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnQtdHV0b3JpYWwtYnRuJyk7CiAgICBjb25zdCBza2lwVHV0b3JpYWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2tpcC10dXRvcmlhbC1idG4nKTsKCiAgICBjb25zdCBzdW1tYXJ5Q29udGVudCA9ICJUaGlzIHRvb2wgaXMgYSBTaXRlIERhdGEgTWFuYWdlciBmb3IgWW9jbyBUYWJsZSBNZXJjaGFudHMuIEl0IGFsbG93cyB5b3UgdG8gaW5wdXQgYW5kIG1hbmFnZSBlc3NlbnRpYWwgc2l0ZSBpbmZvcm1hdGlvbiwgaW5jbHVkaW5nIHNpdGUgZGV0YWlscywgZW1wbG95ZWVzLCBzdXBwbGllcnMsIGFuZCB0aGlyZC1wYXJ0eSBpbnRlZ3JhdGlvbnMsIGFsbCBpbiBvbmUgcGxhY2UgZm9yIHN0cmVhbWxpbmVkIHNldHVwIGFuZCBlYXN5IGRhdGEgZXhwb3J0LiI7CgogICAgLy8gIkNvbnRpbnVlIiBidXR0b24gc2hvd3MgdGhlIHN1bW1hcnkKICAgIHNob3dTdW1tYXJ5QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIHN1bW1hcnlUZXh0LnRleHRDb250ZW50ID0gc3VtbWFyeUNvbnRlbnQ7CiAgICAgICAgc3VtbWFyeU1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgIH0pOwogICAgCiAgICAvLyAiUHJvY2VlZCIgYnV0dG9uIG9uIHN1bW1hcnkgbW9kYWwgaGlkZXMgbG9naW4sIHNob3dzIGFwcCwgdGhlbiBhc2tzIGFib3V0IHR1dG9yaWFsCiAgICBwcm9jZWVkVG9BcHBCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgc3VtbWFyeU1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICBsb2dpbkNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKICAgICAgICBtYWluQXBwQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwogICAgICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnaC1mdWxsJyk7IC8vIEFsbG93IGJvZHkgdG8gZ3JvdwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd3ZWxjb21lU2NyZWVuU2hvd24nLCAndHJ1ZScpOwogICAgICAgIAogICAgICAgIC8vIE5vdyBhc2sgYWJvdXQgdGhlIHR1dG9yaWFsCiAgICAgICAgdHV0b3JpYWxQcm9tcHRNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICB9KTsKCiAgICBzdGFydFR1dG9yaWFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIHR1dG9yaWFsUHJvbXB0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIHN0YXJ0VHV0b3JpYWwoKTsKICAgIH0pOwoKICAgIHNraXBUdXRvcmlhbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICB0dXRvcmlhbFByb21wdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgIH0pOwogICAgCiAgICAvLyBDaGVjayBpZiB0aGUgd2VsY29tZSBzY3JlZW4gc2hvdWxkIGJlIHNraXBwZWQKICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnd2VsY29tZVNjcmVlblNob3duJykgPT09ICd0cnVlJykgewogICAgICAgIGxvZ2luQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgIG1haW5BcHBDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdoLWZ1bGwnKTsKICAgIH0KCgogICAgLy8gLS0tIE1BSU4gQVBQIExPR0lDIC0tLQogICAgY29uc3QgdGFiTmF2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhYi1uYXYnKTsKICAgIGNvbnN0IHRhYkNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFiLWNvbnRlbnQnKTsKCiAgICAvLyAtLS0gRFlOQU1JQyBVSSBHRU5FUkFUSU9OIC0tLQogICAgT2JqZWN0LnZhbHVlcyhpbml0aWFsRGF0YSkuZm9yRWFjaCgoc2hlZXQsIGluZGV4KSA9PiB7CiAgICAgICAgLy8gQ3JlYXRlIFRhYiBCdXR0b24KICAgICAgICBjb25zdCB0YWJCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICB0YWJCdXR0b24uY2xhc3NOYW1lID0gYHRhYi1idG4gJHtpbmRleCA9PT0gMCA/ICdhY3RpdmUnIDogJyd9YDsKICAgICAgICB0YWJCdXR0b24udGV4dENvbnRlbnQgPSBzaGVldC5uYW1lOwogICAgICAgIHRhYkJ1dHRvbi5kYXRhc2V0LnRhYiA9IHNoZWV0LmlkOwogICAgICAgIHRhYk5hdi5hcHBlbmRDaGlsZCh0YWJCdXR0b24pOwoKICAgICAgICAvLyBDcmVhdGUgVGFiIFBhbmVsCiAgICAgICAgY29uc3QgdGFiUGFuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICB0YWJQYW5lbC5pZCA9IHNoZWV0LmlkOwogICAgICAgIHRhYlBhbmVsLmNsYXNzTmFtZSA9IGB0YWItcGFuZWwgJHtpbmRleCAhPT0gMCA/ICdoaWRkZW4nIDogJyd9YDsKICAgICAgICAKICAgICAgICAvLyAtLS0gQ1VTVE9NIFRBQiBMT0dJQyAtLS0KICAgICAgICBpZiAoc2hlZXQudHlwZSA9PT0gJ2N1c3RvbScgJiYgc2hlZXQuaWQgPT09ICdpbnRlZ3JhdGlvbnMnKSB7CiAgICAgICAgICAgIHRhYlBhbmVsLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDxmb3JtIGlkPSJpbnRlZ3JhdGlvbnMtZm9ybSIgY2xhc3M9Im1iLTggYmctW3ZhcigtLXlvY28tc3VyZmFjZSldIHAtNiByb3VuZGVkLWxnIGJvcmRlciBib3JkZXItW3ZhcigtLXlvY28tYm9yZGVyKV0iIGF1dG9jb21wbGV0ZT0ib2ZmIiBub3ZhbGlkYXRlPgogICAgICAgICAgICAgICAgICAgIDxoMyBjbGFzcz0idGV4dC14bCBmb250LWJvbGQgbWItNCB0ZXh0LXdoaXRlIj5BZGQgM3JkIFBhcnR5IEludGVncmF0aW9uPC9oMz4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtYi02Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iaW50ZWdyYXRpb24tc2VsZWN0IiBjbGFzcz0iYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gbWItMSI+U2VsZWN0IEludGVncmF0aW9uPC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBpZD0iaW50ZWdyYXRpb24tc2VsZWN0IiBjbGFzcz0idy1mdWxsIGJnLVsjMmEyYTJhXSBib3JkZXIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIHJvdW5kZWQtbWQgcHgtMyBweS0yIHRleHQtd2hpdGUgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMiBmb2N1czpyaW5nLVt2YXIoLS15b2NvLXByaW1hcnkpXSBmb2N1czpib3JkZXItdHJhbnNwYXJlbnQgdHJhbnNpdGlvbiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPi0tIFNlbGVjdCBhbiBPcHRpb24gLS08L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InphcHBlciI+WmFwcGVyPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJzbmFwc2NhbiI+U25hcFNjYW48L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InlveW8iPllveW88L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICAgICAgICAgIDwhLS0gU25hcFNjYW4gRmllbGRzIC0tPgogICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9InNuYXBzY2FuLWZpZWxkcyIgY2xhc3M9ImhpZGRlbiBzcGFjZS15LTQiPgogICAgICAgICAgICAgICAgICAgICAgICA8aDQgY2xhc3M9InRleHQtbGcgZm9udC1zZW1pYm9sZCB0ZXh0LVt2YXIoLS15b2NvLXByaW1hcnkpXSBib3JkZXItYiBib3JkZXItW3ZhcigtLXlvY28tYm9yZGVyKV0gcGItMiI+U25hcFNjYW4gRGV0YWlsczwvaDQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJzbmFwc2Nhbi1jb2RlIiBjbGFzcz0iYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gbWItMSB0b29sdGlwIiBkYXRhLXRvb2x0aXA9IkVudGVyIHlvdXIgdW5pcXVlIFNuYXBTY2FuIFFSIGNvZGUgaWRlbnRpZmllci4iPllvdXIgU25hcFNjYW4gQ29kZSA8c3BhbiBjbGFzcz0idGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0iPio8L3NwYW4+PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0ic25hcHNjYW4tY29kZSIgbmFtZT0ic25hcHNjYW4tY29kZSIgcGxhY2Vob2xkZXI9IllvdXIgU25hcFNjYW4gQ29kZSIgY2xhc3M9InctZnVsbCBiZy1bIzJhMmEyYV0gYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSByb3VuZGVkLW1kIHB4LTMgcHktMiB0ZXh0LXdoaXRlIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1bdmFyKC0teW9jby1wcmltYXJ5KV0gZm9jdXM6Ym9yZGVyLXRyYW5zcGFyZW50IHRyYW5zaXRpb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9InNuYXBzY2FuLWVtYWlsIiBjbGFzcz0iYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gbWItMSB0b29sdGlwIiBkYXRhLXRvb2x0aXA9IlRoZSBlbWFpbCBhZGRyZXNzIGxpbmtlZCB0byB5b3VyIG1lcmNoYW50IGFjY291bnQuIj5SZWdpc3RlcmVkIEVtYWlsIEFkZHJlc3MgPHNwYW4gY2xhc3M9InRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIj4qPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iZW1haWwiIGlkPSJzbmFwc2Nhbi1lbWFpbCIgbmFtZT0ic25hcHNjYW4tZW1haWwiIHBsYWNlaG9sZGVyPSJZb3VyIHJlZ2lzdGVyZWQgZW1haWwiIGNsYXNzPSJ3LWZ1bGwgYmctWyMyYTJhMmFdIGJvcmRlciBib3JkZXItW3ZhcigtLXlvY28tYm9yZGVyKV0gcm91bmRlZC1tZCBweC0zIHB5LTIgdGV4dC13aGl0ZSBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctW3ZhcigtLXlvY28tcHJpbWFyeSldIGZvY3VzOmJvcmRlci10cmFuc3BhcmVudCB0cmFuc2l0aW9uIj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJzbmFwc2Nhbi1zaXRlLW5hbWUiIGNsYXNzPSJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtW3ZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpXSBtYi0xIHRvb2x0aXAiIGRhdGEtdG9vbHRpcD0iVGhlIHNpdGUgbmFtZSBhcyBpdCBhcHBlYXJzIGluIHlvdXIgU25hcFNjYW4gcG9ydGFsLiI+UmVnaXN0ZXJlZCBTaXRlIE5hbWUgPHNwYW4gY2xhc3M9InRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIj4qPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9InNuYXBzY2FuLXNpdGUtbmFtZSIgbmFtZT0ic25hcHNjYW4tc2l0ZS1uYW1lIiBwbGFjZWhvbGRlcj0iWW91ciByZWdpc3RlcmVkIHNpdGUgbmFtZSIgY2xhc3M9InctZnVsbCBiZy1bIzJhMmEyYV0gYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSByb3VuZGVkLW1kIHB4LTMgcHktMiB0ZXh0LXdoaXRlIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1bdmFyKC0teW9jby1wcmltYXJ5KV0gZm9jdXM6Ym9yZGVyLXRyYW5zcGFyZW50IHRyYW5zaXRpb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICAgICAgPCEtLSBaYXBwZXIgRmllbGRzIC0tPgogICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9InphcHBlci1maWVsZHMiIGNsYXNzPSJoaWRkZW4gc3BhY2UteS00Ij4KICAgICAgICAgICAgICAgICAgICAgICAgIDxoNCBjbGFzcz0idGV4dC1sZyBmb250LXNlbWlib2xkIHRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIGJvcmRlci1iIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSBwYi0yIj5aYXBwZXIgRGV0YWlsczwvaDQ+CiAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iemFwcGVyLW1lcmNoYW50LWlkIiBjbGFzcz0iYmxvY2sgdGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LVt2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KV0gbWItMSB0b29sdGlwIiBkYXRhLXRvb2x0aXA9IllvdXIgdW5pcXVlIFphcHBlciBNZXJjaGFudCBJRC4iPk1lcmNoYW50IElEIDxzcGFuIGNsYXNzPSJ0ZXh0LVt2YXIoLS15b2NvLXByaW1hcnkpXSI+Kjwvc3Bhbj48L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSJ6YXBwZXItbWVyY2hhbnQtaWQiIG5hbWU9InphcHBlci1tZXJjaGFudC1pZCIgcGxhY2Vob2xkZXI9IllvdXIgTWVyY2hhbnQgSUQiIGNsYXNzPSJ3LWZ1bGwgYmctWyMyYTJhMmFdIGJvcmRlciBib3JkZXItW3ZhcigtLXlvY28tYm9yZGVyKV0gcm91bmRlZC1tZCBweC0zIHB5LTIgdGV4dC13aGl0ZSBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctW3ZhcigtLXlvY28tcHJpbWFyeSldIGZvY3VzOmJvcmRlci10cmFuc3BhcmVudCB0cmFuc2l0aW9uIj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPSJ6YXBwZXItc2l0ZS1pZCIgY2xhc3M9ImJsb2NrIHRleHQtc20gZm9udC1tZWRpdW0gdGV4dC1bdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSldIG1iLTEgdG9vbHRpcCIgZGF0YS10b29sdGlwPSJUaGUgdW5pcXVlIElEIGZvciB0aGlzIHNwZWNpZmljIHNpdGUgcHJvdmlkZWQgYnkgWmFwcGVyLiI+U2l0ZSBJRCA8c3BhbiBjbGFzcz0idGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0iPio8L3NwYW4+PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iemFwcGVyLXNpdGUtaWQiIG5hbWU9InphcHBlci1zaXRlLWlkIiBwbGFjZWhvbGRlcj0iWW91ciBTaXRlIElEIiBjbGFzcz0idy1mdWxsIGJnLVsjMmEyYTJhXSBib3JkZXIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIHJvdW5kZWQtbWQgcHgtMyBweS0yIHRleHQtd2hpdGUgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMiBmb2N1czpyaW5nLVt2YXIoLS15b2NvLXByaW1hcnkpXSBmb2N1czpib3JkZXItdHJhbnNwYXJlbnQgdHJhbnNpdGlvbiI+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0iemFwcGVyLXBvcy1rZXkiIGNsYXNzPSJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtW3ZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpXSBtYi0xIHRvb2x0aXAiIGRhdGEtdG9vbHRpcD0iWW91ciBaYXBwZXIgUE9TIGludGVncmF0aW9uIGtleS4iPlBPUyBLZXkgPHNwYW4gY2xhc3M9InRleHQtW3ZhcigtLXlvY28tcHJpbWFyeSldIj4qPC9zcGFuPjwvbGFiZWw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9InphcHBlci1wb3Mta2V5IiBuYW1lPSJ6YXBwZXItcG9zLWtleSIgcGxhY2Vob2xkZXI9IllvdXIgUE9TIEtleSIgY2xhc3M9InctZnVsbCBiZy1bIzJhMmEyYV0gYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSByb3VuZGVkLW1kIHB4LTMgcHktMiB0ZXh0LXdoaXRlIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1bdmFyKC0teW9jby1wcmltYXJ5KV0gZm9jdXM6Ym9yZGVyLXRyYW5zcGFyZW50IHRyYW5zaXRpb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICAgICAgPCEtLSBZb3lvIEZpZWxkcyAtLT4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPSJ5b3lvLWZpZWxkcyIgY2xhc3M9ImhpZGRlbiBzcGFjZS15LTQiPgogICAgICAgICAgICAgICAgICAgICAgICAgPGg0IGNsYXNzPSJ0ZXh0LWxnIGZvbnQtc2VtaWJvbGQgdGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0gYm9yZGVyLWIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIHBiLTIiPllveW8gV2FsbGV0IERldGFpbHM8L2g0PgogICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9InRleHQtW3ZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpXSBtdC00IGJnLVsjMmEyYTJhXSBwLTQgcm91bmRlZC1tZCBib3JkZXIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIj5UbyBpbnRlZ3JhdGUgd2l0aCBZb3lvIFdhbGxldCwgcGxlYXNlIHJlZ2lzdGVyIHlvdXIgYnVzaW5lc3Mgd2l0aCBZb3lvIGRpcmVjdGx5LiBPbmNlIHlvdXIgcmVnaXN0cmF0aW9uIGlzIGNvbXBsZXRlLCBZb3lvIHdpbGwgcHJvdmlkZSB5b3Ugd2l0aCB0aGUgbmVjZXNzYXJ5IFNpdGUgSUQgdG8gY29tcGxldGUgdGhlIHNldHVwLjwvcD4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdC02IGZsZXgganVzdGlmeS1lbmQgZ2FwLTQiPgogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IGhpZGRlbiBjbGVhci1mb3JtLWJ0biI+Q2FuY2VsPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0ic3VibWl0IiBjbGFzcz0iYnRuIGJ0bi1wcmltYXJ5Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iYnRuLXRleHQiPkFkZCBFbnRyeTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Zvcm0+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWJsZS1jb250YWluZXIiPgogICAgICAgICAgICAgICAgICAgIDx0YWJsZSBpZD0iaW50ZWdyYXRpb25zLXRhYmxlIj4KICAgICAgICAgICAgICAgICAgICAgICAgPHRoZWFkPjwvdGhlYWQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT48L3Rib2R5PgogICAgICAgICAgICAgICAgICAgIDwvdGFibGU+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im10LTQgZmxleCBqdXN0aWZ5LWVuZCI+CiAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IHJlZnJlc2gtbGlzdC1idG4iIGRhdGEtdGFibGUtaWQ9ImludGVncmF0aW9ucy10YWJsZSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjEuNSAydjZoLTZNMi41IDIydi02aDZNMiAxMS41YTEwIDEwIDAgMCAxIDE4LjgtNC4zTTIyIDEyLjVhMTAgMTAgMCAwIDEtMTguOCA0LjMiLz48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgUmVmcmVzaCBMaXN0CiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgYDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyAtLS0gU1RBTkRBUkQgVEFCIExPR0lDIC0tLQogICAgICAgICAgICBjb25zdCBmb3JtRmllbGRzID0gc2hlZXQuZm9ybUhlYWRlcnMubWFwKGhlYWRlciA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dElkID0gYCR7c2hlZXQuaWR9LSR7aGVhZGVyLnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCAnLScpfWA7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGxldCByZXF1aXJlZCA9ICcnOwogICAgICAgICAgICAgICAgY29uc3QgcmVxdWlyZWRTaXRlRGV0YWlsc0ZpZWxkcyA9IFsiU2l0ZSBOYW1lIiwgIlJlZ2lzdGVyZWQgQ29tcGFueSBOYW1lIiwgIlRyYWRpbmcgTmFtZSIsICJTaXRlIEFkZHJlc3MiLCAiT3duZXIgRnVsbCBOYW1lIiwgIk93bmVyIFRlbGVwaG9uZSBOdW1iZXIiLCAiT3duZXIgRW1haWwgQWRkcmVzcyJdOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBVcGRhdGVkIGxvZ2ljIGZvciByZXF1aXJlZCBmaWVsZHMKICAgICAgICAgICAgICAgIGlmIChzaGVldC5pZCA9PT0gJ3NpdGVEZXRhaWxzJyAmJiByZXF1aXJlZFNpdGVEZXRhaWxzRmllbGRzLmluY2x1ZGVzKGhlYWRlcikpIHsKICAgICAgICAgICAgICAgICAgICByZXF1aXJlZCA9ICdyZXF1aXJlZCc7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNoZWV0LmlkID09PSAnc2l0ZG93bkFyZWFzJykgewogICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkID0gJ3JlcXVpcmVkJzsgLy8gQWxsIGZpZWxkcyBpbiBzaXRkb3duQXJlYXMgYXJlIHJlcXVpcmVkCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNoZWV0LmlkID09PSAnc3VwcGxpZXJzJyAmJiBoZWFkZXIgPT09ICdOYW1lJykgewogICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkID0gJ3JlcXVpcmVkJzsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hlZXQuaWQgPT09ICdlbXBsb3llZXMnICYmIFsnRW1wbG95ZWUgRnVsbCBOYW1lJywgJ1JvbGUnXS5pbmNsdWRlcyhoZWFkZXIpKSB7CiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQgPSAncmVxdWlyZWQnOwogICAgICAgICAgICAgICAgfQoKCiAgICAgICAgICAgICAgICBsZXQgaW5wdXRUeXBlID0gJ3RleHQnOwogICAgICAgICAgICAgICAgbGV0IGlucHV0RXh0cmEgPSAnJzsKICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlckxvd2VyID0gaGVhZGVyLnRvTG93ZXJDYXNlKCk7CgogICAgICAgICAgICAgICAgaWYgKGhlYWRlckxvd2VyLmluY2x1ZGVzKCdlbWFpbCcpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXRUeXBlID0gJ2VtYWlsJzsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaGVhZGVyTG93ZXIuaW5jbHVkZXMoJ3RlbGVwaG9uZScpIHx8IGhlYWRlckxvd2VyLmluY2x1ZGVzKCdwaG9uZSBudW1iZXInKSB8fCBoZWFkZXJMb3dlci5pbmNsdWRlcygnY29udGFjdCBudW1iZXInKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0RXh0cmEgPSBgb25pbnB1dD0idGhpcy52YWx1ZSA9IHRoaXMudmFsdWUucmVwbGFjZSgvW14wLTldL2csICcnKSIgbWlubGVuZ3RoPSIxMCIgbWF4bGVuZ3RoPSIxMCJgOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoZWFkZXJMb3dlci5pbmNsdWRlcygnbG9naW4gY29kZScpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXRFeHRyYSA9IGBvbmlucHV0PSJ0aGlzLnZhbHVlID0gdGhpcy52YWx1ZS5yZXBsYWNlKC9bXjAtOV0vZywgJycpIiBtaW5sZW5ndGg9IjQiIG1heGxlbmd0aD0iNCJgOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGxldCBpbnB1dEh0bWwgPSBgCiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9IiR7aW5wdXRUeXBlfSIgaWQ9IiR7aW5wdXRJZH0iIG5hbWU9IiR7aGVhZGVyfSIgcGxhY2Vob2xkZXI9IiR7aGVhZGVyfSIgJHtyZXF1aXJlZH0gJHtpbnB1dEV4dHJhfSBjbGFzcz0idy1mdWxsIGJnLVsjMmEyYTJhXSBib3JkZXIgYm9yZGVyLVt2YXIoLS15b2NvLWJvcmRlcildIHJvdW5kZWQtbWQgcHgtMyBweS0yIHRleHQtd2hpdGUgZm9jdXM6b3V0bGluZS1ub25lIGZvY3VzOnJpbmctMiBmb2N1czpyaW5nLVt2YXIoLS15b2NvLXByaW1hcnkpXSBmb2N1czpib3JkZXItdHJhbnNwYXJlbnQgdHJhbnNpdGlvbiI+CiAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICAgICAgaWYgKHNoZWV0LmlkID09PSAnZW1wbG95ZWVzJyAmJiBoZWFkZXIgPT09ICdSb2xlJykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpc3RJZCA9IGBSb2xlLWxpc3RgOwogICAgICAgICAgICAgICAgICAgIGlucHV0SHRtbCA9IGAKICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIGlkPSIke2lucHV0SWR9IiBuYW1lPSIke2hlYWRlcn0iIHBsYWNlaG9sZGVyPSIke2hlYWRlcn0iIGxpc3Q9IiR7bGlzdElkfSIgJHtyZXF1aXJlZH0gY2xhc3M9InctZnVsbCBiZy1bIzJhMmEyYV0gYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSByb3VuZGVkLW1kIHB4LTMgcHktMiB0ZXh0LXdoaXRlIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1bdmFyKC0teW9jby1wcmltYXJ5KV0gZm9jdXM6Ym9yZGVyLXRyYW5zcGFyZW50IHRyYW5zaXRpb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGF0YWxpc3QgaWQ9IiR7bGlzdElkfSI+PC9kYXRhbGlzdD4KICAgICAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IGxhYmVsVGV4dCA9IHJlcXVpcmVkID8gYCR7aGVhZGVyfSA8c3BhbiBjbGFzcz0idGV4dC1bdmFyKC0teW9jby1wcmltYXJ5KV0iPio8L3NwYW4+YCA6IGhlYWRlcjsKCiAgICAgICAgICAgICAgICByZXR1cm4gYAogICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9IiR7aW5wdXRJZH0iIGNsYXNzPSJibG9jayB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtW3ZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpXSBtYi0xIHRvb2x0aXAiIGRhdGEtdG9vbHRpcD0iJHtnZXRUb29sdGlwVGV4dChoZWFkZXIpfSI+JHtsYWJlbFRleHR9PC9sYWJlbD4KICAgICAgICAgICAgICAgICAgICAgICAgJHtpbnB1dEh0bWx9CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICB9KS5qb2luKCcnKTsKCiAgICAgICAgICAgIHRhYlBhbmVsLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDxmb3JtIGlkPSIke3NoZWV0LmlkfS1mb3JtIiBjbGFzcz0ibWItOCBiZy1bdmFyKC0teW9jby1zdXJmYWNlKV0gcC02IHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1bdmFyKC0teW9jby1ib3JkZXIpXSIgYXV0b2NvbXBsZXRlPSJvZmYiIG5vdmFsaWRhdGU+CiAgICAgICAgICAgICAgICAgICAgPGgzIGNsYXNzPSJ0ZXh0LXhsIGZvbnQtYm9sZCBtYi00IHRleHQtd2hpdGUiPkFkZC9VcGRhdGUgJHtzaGVldC5uYW1lLnNsaWNlKDAsIC0xKX08L2gzPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdyaWQgZ3JpZC1jb2xzLTEgc206Z3JpZC1jb2xzLTIgbGc6Z3JpZC1jb2xzLTMgZ2FwLTQiPgogICAgICAgICAgICAgICAgICAgICAgICAke2Zvcm1GaWVsZHN9CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibXQtNiBmbGV4IGp1c3RpZnktZW5kIGdhcC00Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJidG4gYnRuLXNlY29uZGFyeSBoaWRkZW4gY2xlYXItZm9ybS1idG4iPkNhbmNlbDwvYnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9InN1Ym1pdCIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iYnRuLXRleHQiPkFkZCBFbnRyeTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Zvcm0+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSJ0dXRvcmlhbC10YWJsZS0ke3NoZWV0LmlkfSIgY2xhc3M9InRhYmxlLWNvbnRhaW5lciI+CiAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGlkPSIke3NoZWV0LmlkfS10YWJsZSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0aGVhZD48L3RoZWFkPgogICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+PC90Ym9keT4KICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtdC00IGZsZXgganVzdGlmeS1lbmQiPgogICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXNlY29uZGFyeSByZWZyZXNoLWxpc3QtYnRuIiBkYXRhLXRhYmxlLWlkPSIke3NoZWV0LmlkfS10YWJsZSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjEuNSAydjZoLTZNMi41IDIydi02aDZNMiAxMS41YTEwIDEwIDAgMCAxIDE4LjgtNC4zTTIyIDEyLjVhMTAgMTAgMCAwIDEtMTguOCA0LjMiLz48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgUmVmcmVzaCBMaXN0CiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgYDsKICAgICAgICB9CiAgICAgICAgdGFiQ29udGVudC5hcHBlbmRDaGlsZCh0YWJQYW5lbCk7CiAgICB9KTsKICAgIAogICAgLy8gSW5pdGlhbCBsb2FkCiAgICBsb2FkQWxsVGFibGVzRnJvbVN0b3JhZ2UoKTsKICAgIGxvYWRBbGxTdWdnZXN0aW9ucygpOwoKICAgIC8vIC0tLSBFVkVOVCBMSVNURU5FUlMgLS0tCiAgICAKICAgIHRhYk5hdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CiAgICAgICAgaWYgKGUudGFyZ2V0Lm1hdGNoZXMoJy50YWItYnRuJykpIHsKICAgICAgICAgICAgY29uc3QgdGFiSWQgPSBlLnRhcmdldC5kYXRhc2V0LnRhYjsKICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhYi1idG4nKS5mb3JFYWNoKGJ0biA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFiLXBhbmVsJykuZm9yRWFjaChwYW5lbCA9PiBwYW5lbC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKSk7CiAgICAgICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJJZCkuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgfQogICAgfSk7CgogICAgdGFiQ29udGVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWl0KTsKICAgIHRhYkNvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcuY2xlYXItZm9ybS1idG4nKSkgewogICAgICAgICAgICBjb25zdCBmb3JtID0gZS50YXJnZXQuY2xvc2VzdCgnZm9ybScpOwogICAgICAgICAgICBpZiAoZm9ybS5pZCA9PT0gJ2ludGVncmF0aW9ucy1mb3JtJykgewogICAgICAgICAgICAgICAgcmVzZXRJbnRlZ3JhdGlvbkZvcm0oZm9ybSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXNldEZvcm0oZm9ybSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9KTsKCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmVmcmVzaC1saXN0LWJ0bicpLmZvckVhY2goYnV0dG9uID0+IHsKICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICAgICAgICBjb25zdCB0YWJsZUlkID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQudGFibGVJZDsKICAgICAgICAgICAgbG9hZFRhYmxlRnJvbVN0b3JhZ2UodGFibGVJZCk7CiAgICAgICAgICAgIHNob3dNb2RhbCgnTGlzdCBoYXMgYmVlbiByZWZyZXNoZWQgZnJvbSBzYXZlZCBkYXRhLicsICdzdWNjZXNzJyk7CiAgICAgICAgfSk7CiAgICB9KTsKCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0QnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBleHBvcnRBbGxUb0V4Y2VsKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGVhckJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICBzaG93TW9kYWwoCiAgICAgICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2xlYXIgYWxsIGRhdGEgZnJvbSBhbGwgdGFibGVzPyBUaGlzIGFjdGlvbiBjYW5ub3QgYmUgdW5kb25lLicsCiAgICAgICAgICAgICd3YXJuaW5nJywKICAgICAgICAgICAgKCkgPT4gY2xlYXJBbGxEYXRhKHRydWUpLAogICAgICAgICAgICB0cnVlCiAgICAgICAgKTsKICAgIH0pOwoKICAgIHRhYkNvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIChlKSA9PiB7CiAgICAgICAgaWYgKGUudGFyZ2V0Lm1hdGNoZXMoJ3RkW2NvbnRlbnRlZGl0YWJsZT0idHJ1ZSJdJykpIHsKICAgICAgICAgICAgY29uc3QgdGFibGUgPSBlLnRhcmdldC5jbG9zZXN0KCd0YWJsZScpOwogICAgICAgICAgICBpZiAodGFibGUpIHNhdmVUYWJsZVRvU3RvcmFnZSh0YWJsZS5pZCk7CiAgICAgICAgfQogICAgfSwgdHJ1ZSk7CiAgICAKICAgIC8vIEludGVncmF0aW9ucyBUYWIgTG9naWMKICAgIGNvbnN0IGludGVncmF0aW9uU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ludGVncmF0aW9uLXNlbGVjdCcpOwogICAgaWYgKGludGVncmF0aW9uU2VsZWN0KSB7CiAgICAgICAgaW50ZWdyYXRpb25TZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHsKICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgICAgWydzbmFwc2NhbicsICd6YXBwZXInLCAneW95byddLmZvckVhY2goaWQgPT4gewogICAgICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtpZH0tZmllbGRzYCk7CiAgICAgICAgICAgICAgICBpZiAoZWwpIGVsLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgICAgICAgICBjb25zdCBlbFRvU2hvdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3NlbGVjdGVkfS1maWVsZHNgKTsKICAgICAgICAgICAgICAgIGlmIChlbFRvU2hvdykgZWxUb1Nob3cuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KfSk7CgoKLy8gLS0tIE5BTUUgSEVMUEVSUyAtLS0KY29uc3Qgc3BsaXROYW1lID0gKGZ1bGxOYW1lKSA9PiB7CiAgICBjb25zdCBwYXJ0cyA9IChmdWxsTmFtZSB8fCAnJykudHJpbSgpLnNwbGl0KCcgJyk7CiAgICBjb25zdCBmaXJzdE5hbWUgPSBwYXJ0cy5zaGlmdCgpIHx8ICcnOwogICAgY29uc3QgbGFzdE5hbWUgPSBwYXJ0cy5qb2luKCcgJyk7CiAgICByZXR1cm4geyBmaXJzdE5hbWUsIGxhc3ROYW1lIH07Cn07CgovLyAtLS0gREFUQSBQRVJTSVNURU5DRSAtLS0KZnVuY3Rpb24gc2F2ZVRhYmxlVG9TdG9yYWdlKHRhYmxlSWQpIHsKICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFibGVJZCk7CiAgICBpZiAoIXRhYmxlKSByZXR1cm47CgogICAgY29uc3QgaGVhZGVycyA9IEFycmF5LmZyb20odGFibGUucXVlcnlTZWxlY3RvckFsbCgndGhlYWQgdGgnKSkubWFwKHRoID0+IHRoLnRleHRDb250ZW50KS5zbGljZSgwLCAtMSk7CiAgICBjb25zdCBkYXRhID0gQXJyYXkuZnJvbSh0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSB0cicpKS5tYXAocm93ID0+IHsKICAgICAgICBjb25zdCByb3dEYXRhID0ge307CiAgICAgICAgQXJyYXkuZnJvbShyb3cucXVlcnlTZWxlY3RvckFsbCgndGQnKSkuc2xpY2UoMCwgLTEpLmZvckVhY2goKHRkLCBpKSA9PiB7CiAgICAgICAgICAgIHJvd0RhdGFbaGVhZGVyc1tpXV0gPSB0ZC50ZXh0Q29udGVudDsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gcm93RGF0YTsKICAgIH0pOwogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYHRhYmxlX2RhdGFfJHt0YWJsZUlkfWAsIEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgIGlmICh0YWJsZUlkID09PSAnc2l0ZURldGFpbHMtdGFibGUnKSB7CiAgICAgICAgdXBkYXRlU2l0ZURldGFpbHNGb3JtU3RhdGUoKTsKICAgIH0KfQoKZnVuY3Rpb24gbG9hZEFsbFRhYmxlc0Zyb21TdG9yYWdlKCkgewogICAgT2JqZWN0LnZhbHVlcyhpbml0aWFsRGF0YSkuZm9yRWFjaChzaGVldCA9PiB7CiAgICAgICAgbG9hZFRhYmxlRnJvbVN0b3JhZ2UoYCR7c2hlZXQuaWR9LXRhYmxlYCk7CiAgICB9KTsKfQoKZnVuY3Rpb24gbG9hZFRhYmxlRnJvbVN0b3JhZ2UodGFibGVJZCkgewogICAgY29uc3Qgc2hlZXQgPSBPYmplY3QudmFsdWVzKGluaXRpYWxEYXRhKS5maW5kKHMgPT4gYCR7cy5pZH0tdGFibGVgID09PSB0YWJsZUlkKTsKICAgIGlmICghc2hlZXQpIHJldHVybjsKCiAgICBjb25zdCBzYXZlZERhdGFKU09OID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oYHRhYmxlX2RhdGFfJHt0YWJsZUlkfWApOwogICAgbGV0IGRhdGFUb1JlbmRlciA9IHNoZWV0LmRhdGE7CgogICAgaWYgKHNhdmVkRGF0YUpTT04pIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBKU09OLnBhcnNlKHNhdmVkRGF0YUpTT04pOwogICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShzYXZlZERhdGEpKSBkYXRhVG9SZW5kZXIgPSBzYXZlZERhdGE7CiAgICAgICAgfSBjYXRjaCAoZSkgeyBjb25zb2xlLmVycm9yKGBDb3VsZCBub3QgcGFyc2Ugc2F2ZWQgZGF0YSBmb3IgJHt0YWJsZUlkfTpgLCBlKTsgfQogICAgfQogICAgcmVuZGVyVGFibGUodGFibGVJZCwgc2hlZXQuaGVhZGVycywgZGF0YVRvUmVuZGVyKTsKfQoKZnVuY3Rpb24gc2F2ZVN1Z2dlc3Rpb25zKGxpc3RJZCwgdmFsdWUpIHsKICAgIGlmICghdmFsdWUpIHJldHVybjsKICAgIGNvbnN0IGtleSA9IGBzdWdnZXN0aW9uc18ke2xpc3RJZH1gOwogICAgbGV0IHN1Z2dlc3Rpb25zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKSB8fCBbXTsKICAgIGlmICghc3VnZ2VzdGlvbnMuaW5jbHVkZXModmFsdWUpKSB7CiAgICAgICAgc3VnZ2VzdGlvbnMucHVzaCh2YWx1ZSk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeShzdWdnZXN0aW9ucykpOwogICAgfQp9CgpmdW5jdGlvbiBsb2FkQWxsU3VnZ2VzdGlvbnMoKSB7CiAgICB1cGRhdGVEYXRhbGlzdCgnUm9sZS1saXN0Jyk7Cn0KCi8vIC0tLSBDT1JFIFVJIEZVTkNUSU9OUyAtLS0KZnVuY3Rpb24gcmVuZGVyVGFibGUodGFibGVJZCwgaGVhZGVycywgZGF0YSkgewogICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJsZUlkKTsKICAgIGlmICghdGFibGUpIHJldHVybjsKCiAgICBjb25zdCB0aGVhZCA9IHRhYmxlLnF1ZXJ5U2VsZWN0b3IoJ3RoZWFkJyk7CiAgICB0aGVhZC5pbm5lckhUTUwgPSBgPHRyPiR7aGVhZGVycy5tYXAoaCA9PiBgPHRoIGNsYXNzPSJ0b29sdGlwIiBkYXRhLXRvb2x0aXA9IiR7Z2V0VG9vbHRpcFRleHQoaCl9Ij4ke2h9PC90aD5gKS5qb2luKCcnKX08dGg+QWN0aW9uczwvdGg+PC90cj5gOwogICAgY29uc3QgdGJvZHkgPSB0YWJsZS5xdWVyeVNlbGVjdG9yKCd0Ym9keScpOwogICAgdGJvZHkuaW5uZXJIVE1MID0gJyc7CiAgICBkYXRhLmZvckVhY2gocm93RGF0YSA9PiBhcHBlbmRSb3dUb1RhYmxlKHRhYmxlSWQsIGhlYWRlcnMsIHJvd0RhdGEpKTsKCiAgICBpZiAodGFibGVJZCA9PT0gJ3NpdGVEZXRhaWxzLXRhYmxlJykgewogICAgICAgIHVwZGF0ZVNpdGVEZXRhaWxzRm9ybVN0YXRlKCk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFwcGVuZFJvd1RvVGFibGUodGFibGVJZCwgaGVhZGVycywgcm93RGF0YSkgewogICAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJsZUlkKT8ucXVlcnlTZWxlY3RvcigndGJvZHknKTsKICAgIGlmICghdGJvZHkpIHJldHVybjsKICAgIAogICAgY29uc3QgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpOwogICAgaGVhZGVycy5mb3JFYWNoKGhlYWRlciA9PiB7CiAgICAgICAgY29uc3QgdGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpOwogICAgICAgIHRkLnRleHRDb250ZW50ID0gcm93RGF0YVtoZWFkZXJdIHx8ICcnOwogICAgICAgIHRkLnNldEF0dHJpYnV0ZSgnY29udGVudGVkaXRhYmxlJywgJ3RydWUnKTsKICAgICAgICB0ci5hcHBlbmRDaGlsZCh0ZCk7CiAgICB9KTsKICAgIHRyLmFwcGVuZENoaWxkKGNyZWF0ZUFjdGlvbnNDZWxsKHRhYmxlSWQpKTsKICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKTsKICAgIHJldHVybiB0cjsKfQoKZnVuY3Rpb24gY3JlYXRlQWN0aW9uc0NlbGwodGFibGVJZCkgewogICAgY29uc3QgdGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpOwogICAgdGQuY2xhc3NOYW1lID0gJ2ZsZXggaXRlbXMtY2VudGVyIGdhcC0yJzsKICAgIAogICAgY29uc3QgZWRpdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgZWRpdEJ0bi5jbGFzc05hbWUgPSAnYWN0aW9uLWJ0bic7CiAgICBlZGl0QnRuLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0idmFyKC0teW9jby13YXJuaW5nKSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik0xMSA0SDRhMiAyIDAgMCAwLTIgMnYxNGEyIDIgMCAwIDAgMiAyaDE0YTIgMiAwIDAgMCAyLTJ2LTciPjwvcGF0aD48cGF0aCBkPSJNMTguNSAyLjVhMi4xMjEgMi4xMjEgMCAwIDEgMyAzTDEyIDE1bC00IDEgMS00IDkuNS05LjV6Ij48L3BhdGg+PC9zdmc+YDsKICAgIGlmICh0YWJsZUlkID09PSAnaW50ZWdyYXRpb25zLXRhYmxlJykgewogICAgICAgIGVkaXRCdG4ub25jbGljayA9IChlKSA9PiBoYW5kbGVJbnRlZ3JhdGlvbkVkaXRDbGljayhlLmN1cnJlbnRUYXJnZXQuY2xvc2VzdCgndHInKSk7CiAgICB9IGVsc2UgewogICAgICAgIGVkaXRCdG4ub25jbGljayA9IChlKSA9PiBoYW5kbGVFZGl0Q2xpY2soZS5jdXJyZW50VGFyZ2V0LmNsb3Nlc3QoJ3RyJykpOwogICAgfQogICAgdGQuYXBwZW5kQ2hpbGQoZWRpdEJ0bik7CgogICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICBkZWxldGVCdG4uY2xhc3NOYW1lID0gJ2FjdGlvbi1idG4nOwogICAgZGVsZXRlQnRuLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0idmFyKC0teW9jby1lcnJvcikiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cG9seWxpbmUgcG9pbnRzPSIzIDYgNSA2IDIxIDYiPjwvcG9seWxpbmU+PHBhdGggZD0iTTE5IDZ2MTRhMiAyIDAgMCAxLTIgMkg3YTIgMiAwIDAgMS0yLTJWNm0zIDBWNGEyIDIgMCAwIDEgMi0yaDRhMiAyIDAgMCAxIDIgMnYyIj48L3BhdGg+PC9zdmc+YDsKICAgIGRlbGV0ZUJ0bi5vbmNsaWNrID0gKGUpID0+IHsKICAgICAgICBjb25zdCByb3cgPSBlLmN1cnJlbnRUYXJnZXQuY2xvc2VzdCgndHInKTsKICAgICAgICBzaG93TW9kYWwoCiAgICAgICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgcm93PycsCiAgICAgICAgICAgICd3YXJuaW5nJywKICAgICAgICAgICAgKCkgPT4gewogICAgICAgICAgICAgICAgcm93LnJlbW92ZSgpOwogICAgICAgICAgICAgICAgc2F2ZVRhYmxlVG9TdG9yYWdlKHRhYmxlSWQpOwogICAgICAgICAgICB9LAogICAgICAgICAgICB0cnVlCiAgICAgICAgKTsKICAgIH07CiAgICAKICAgIHRkLmFwcGVuZENoaWxkKGRlbGV0ZUJ0bik7CiAgICByZXR1cm4gdGQ7Cn0KCmZ1bmN0aW9uIHVwZGF0ZURhdGFsaXN0KGxpc3RJZCkgewogICAgY29uc3QgZGF0YWxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsaXN0SWQpOwogICAgaWYgKCFkYXRhbGlzdCkgcmV0dXJuOwogICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBzdWdnZXN0aW9uc18ke2xpc3RJZH1gKSkgfHwgW107CiAgICBkYXRhbGlzdC5pbm5lckhUTUwgPSBzdWdnZXN0aW9ucy5tYXAocyA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtzfSI+PC9vcHRpb24+YCkuam9pbignJyk7Cn0KCi8vIC0tLSBFVkVOVCBIQU5ETEVSUyAmIEZPUk0gTE9HSUMgLS0tCmZ1bmN0aW9uIHVwZGF0ZVNpdGVEZXRhaWxzRm9ybVN0YXRlKCkgewogICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaXRlRGV0YWlscy1mb3JtJyk7CiAgICBjb25zdCB0YWJsZUJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2l0ZURldGFpbHMtdGFibGUnKT8ucXVlcnlTZWxlY3RvcigndGJvZHknKTsKICAgIGlmICghZm9ybSB8fCAhdGFibGVCb2R5KSByZXR1cm47CgogICAgY29uc3QgaGFzRW50cnkgPSB0YWJsZUJvZHkucm93cy5sZW5ndGggPiAwOwogICAgY29uc3QgaXNFZGl0aW5nID0gISFmb3JtLmRhdGFzZXQuZWRpdGluZ1Jvd0luZGV4OwogICAgY29uc3QgaW5wdXRzID0gZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpOwogICAgY29uc3Qgc3VibWl0QnRuID0gZm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT0ic3VibWl0Il0nKTsKCiAgICBpZiAoaGFzRW50cnkgJiYgIWlzRWRpdGluZykgewogICAgICAgIGlucHV0cy5mb3JFYWNoKGlucHV0ID0+IGlucHV0LmRpc2FibGVkID0gdHJ1ZSk7CiAgICAgICAgc3VibWl0QnRuLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICBzdWJtaXRCdG4ucXVlcnlTZWxlY3RvcignLmJ0bi10ZXh0JykudGV4dENvbnRlbnQgPSAnRW50cnkgTGltaXQgUmVhY2hlZCc7CiAgICB9IGVsc2UgewogICAgICAgIGlucHV0cy5mb3JFYWNoKGlucHV0ID0+IGlucHV0LmRpc2FibGVkID0gZmFsc2UpOwogICAgICAgIHN1Ym1pdEJ0bi5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgIHN1Ym1pdEJ0bi5xdWVyeVNlbGVjdG9yKCcuYnRuLXRleHQnKS50ZXh0Q29udGVudCA9IGlzRWRpdGluZyA/ICdVcGRhdGUgRW50cnknIDogJ0FkZCBFbnRyeSc7CiAgICB9Cn0KCmZ1bmN0aW9uIGhhbmRsZUVkaXRDbGljayhyb3cpIHsKICAgIGNvbnN0IHRhYmxlID0gcm93LmNsb3Nlc3QoJ3RhYmxlJyk7CiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFibGUuaWQucmVwbGFjZSgnLXRhYmxlJywgJy1mb3JtJykpOwogICAgY29uc3Qgc2hlZXQgPSBPYmplY3QudmFsdWVzKGluaXRpYWxEYXRhKS5maW5kKHMgPT4gYCR7cy5pZH0tdGFibGVgID09PSB0YWJsZS5pZCk7CiAgICBpZiAoIWZvcm0gfHwgIXNoZWV0KSByZXR1cm47CgogICAgY29uc3QgY2VsbHMgPSBBcnJheS5mcm9tKHJvdy5jZWxscykubWFwKGNlbGwgPT4gY2VsbC50ZXh0Q29udGVudCk7CiAgICBjb25zdCByb3dEYXRhID0gc2hlZXQuaGVhZGVycy5yZWR1Y2UoKG9iaiwgaGVhZGVyLCBpKSA9PiB7CiAgICAgICAgb2JqW2hlYWRlcl0gPSBjZWxsc1tpXTsKICAgICAgICByZXR1cm4gb2JqOwogICAgfSwge30pOwoKICAgIHNoZWV0LmZvcm1IZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IHsKICAgICAgICBjb25zdCBpbnB1dCA9IGZvcm0ucXVlcnlTZWxlY3RvcihgW25hbWU9IiR7aGVhZGVyfSJdYCk7CiAgICAgICAgaWYgKCFpbnB1dCkgcmV0dXJuOwoKICAgICAgICBsZXQgdmFsdWUgPSByb3dEYXRhW2hlYWRlcl07CiAgICAgICAgaWYgKGhlYWRlciA9PT0gJ093bmVyIEZ1bGwgTmFtZScpIHsKICAgICAgICAgICAgdmFsdWUgPSBgJHtyb3dEYXRhWydPd25lciBOYW1lJ10gfHwgJyd9ICR7cm93RGF0YVsnT3duZXIgU3VybmFtZSddIHx8ICcnfWAudHJpbSgpOwogICAgICAgIH0gZWxzZSBpZiAoaGVhZGVyID09PSAnRW1wbG95ZWUgRnVsbCBOYW1lJykgewogICAgICAgICAgICB2YWx1ZSA9IGAke3Jvd0RhdGFbJ0VtcGxveWVlIE5hbWUnXSB8fCAnJ30gJHtyb3dEYXRhWydTdXJuYW1lJ10gfHwgJyd9YC50cmltKCk7CiAgICAgICAgfQogICAgICAgIGlucHV0LnZhbHVlID0gdmFsdWUgfHwgJyc7CiAgICB9KTsKICAgIAogICAgZm9ybS5kYXRhc2V0LmVkaXRpbmdSb3dJbmRleCA9IHJvdy5yb3dJbmRleDsKICAgIGZvcm0ucXVlcnlTZWxlY3RvcignLmNsZWFyLWZvcm0tYnRuJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICBmb3JtLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnIH0pOwoKICAgIGlmKHNoZWV0LmlkID09PSAnc2l0ZURldGFpbHMnKSB7CiAgICAgICAgdXBkYXRlU2l0ZURldGFpbHNGb3JtU3RhdGUoKTsKICAgIH0KfQoKZnVuY3Rpb24gaGFuZGxlRm9ybVN1Ym1pdChlKSB7CiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICBjb25zdCBmb3JtID0gZS50YXJnZXQ7CiAgICBjb25zdCBzaGVldElkID0gZm9ybS5pZC5yZXBsYWNlKCctZm9ybScsICcnKTsKCiAgICBpZiAoc2hlZXRJZCA9PT0gJ2ludGVncmF0aW9ucycpIHsKICAgICAgICBoYW5kbGVBZGRJbnRlZ3JhdGlvbihmb3JtKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKCFmb3JtLmNoZWNrVmFsaWRpdHkoKSkgewogICAgICAgIGZvcm0ucmVwb3J0VmFsaWRpdHkoKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZm9ybSk7CiAgICBjb25zdCB2YWxpZGF0aW9ucyA9IHsKICAgICAgICBzaXRlRGV0YWlsczogW3sgZmllbGQ6ICdPd25lciBUZWxlcGhvbmUgTnVtYmVyJywgbGVuZ3RoOiAxMCB9XSwKICAgICAgICBlbXBsb3llZXM6IFsKICAgICAgICAgICAgeyBmaWVsZDogJ0NvbnRhY3QgTnVtYmVyIChJZiBBZG1pbi9NYW5hZ2VyKScsIGxlbmd0aDogMTAsIG9wdGlvbmFsOiB0cnVlIH0sCiAgICAgICAgICAgIHsgZmllbGQ6ICdMb2dpbiBDb2RlJywgbGVuZ3RoOiA0LCBvcHRpb25hbDogdHJ1ZSB9CiAgICAgICAgXSwKICAgICAgICBzdXBwbGllcnM6IFt7IGZpZWxkOiAnQ29udGFjdCBQaG9uZSBOdW1iZXInLCBsZW5ndGg6IDEwLCBvcHRpb25hbDogdHJ1ZSB9XQogICAgfTsKCiAgICBpZiAodmFsaWRhdGlvbnNbc2hlZXRJZF0pIHsKICAgICAgICBmb3IgKGNvbnN0IHJ1bGUgb2YgdmFsaWRhdGlvbnNbc2hlZXRJZF0pIHsKICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBmb3JtRGF0YS5nZXQocnVsZS5maWVsZCk7CiAgICAgICAgICAgIGlmIChydWxlLm9wdGlvbmFsICYmICF2YWx1ZSkgY29udGludWU7CiAgICAgICAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZS5sZW5ndGggIT09IHJ1bGUubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBzaG93TW9kYWwoYFRoZSBmaWVsZCAiJHtydWxlLmZpZWxkfSIgbXVzdCBiZSBleGFjdGx5ICR7cnVsZS5sZW5ndGh9IGRpZ2l0cyBsb25nLmAsICdlcnJvcicpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICBjb25zdCB0YWJsZUlkID0gZm9ybS5pZC5yZXBsYWNlKCctZm9ybScsICctdGFibGUnKTsKICAgIGNvbnN0IHNoZWV0ID0gT2JqZWN0LnZhbHVlcyhpbml0aWFsRGF0YSkuZmluZChzID0+IHMuaWQgPT09IHNoZWV0SWQpOwogICAgaWYgKCFzaGVldCkgcmV0dXJuOwoKICAgIGNvbnN0IG5ld1Jvd0RhdGEgPSB7fTsKICAgIHNoZWV0LmZvcm1IZWFkZXJzLmZvckVhY2goaGVhZGVyID0+IG5ld1Jvd0RhdGFbc2hlZXQuaGVhZGVycy5maW5kKGggPT4gaC5yZXBsYWNlKC8gL2csICcnKSA9PT0gaGVhZGVyLnJlcGxhY2UoLyAvZywnJykucmVwbGFjZSgnRnVsbE5hbWUnLCdOYW1lJykpIHx8IGhlYWRlcl0gPSBmb3JtRGF0YS5nZXQoaGVhZGVyKSB8fCAnJyk7CgogICAgaWYgKHNoZWV0LmlkID09PSAnc2l0ZURldGFpbHMnKSB7CiAgICAgICAgY29uc3QgeyBmaXJzdE5hbWUsIGxhc3ROYW1lIH0gPSBzcGxpdE5hbWUoZm9ybURhdGEuZ2V0KCdPd25lciBGdWxsIE5hbWUnKSk7CiAgICAgICAgbmV3Um93RGF0YVsnT3duZXIgTmFtZSddID0gZmlyc3ROYW1lOwogICAgICAgIG5ld1Jvd0RhdGFbJ093bmVyIFN1cm5hbWUnXSA9IGxhc3ROYW1lOwogICAgfQogICAgaWYgKHNoZWV0LmlkID09PSAnZW1wbG95ZWVzJykgewogICAgICAgIGNvbnN0IHsgZmlyc3ROYW1lLCBsYXN0TmFtZSB9ID0gc3BsaXROYW1lKGZvcm1EYXRhLmdldCgnRW1wbG95ZWUgRnVsbCBOYW1lJykpOwogICAgICAgIG5ld1Jvd0RhdGFbJ0VtcGxveWVlIE5hbWUnXSA9IGZpcnN0TmFtZTsKICAgICAgICBuZXdSb3dEYXRhWydTdXJuYW1lJ10gPSBsYXN0TmFtZTsKICAgICAgICBjb25zdCByb2xlID0gZm9ybURhdGEuZ2V0KCdSb2xlJyk7CiAgICAgICAgc2F2ZVN1Z2dlc3Rpb25zKCdSb2xlLWxpc3QnLCByb2xlKTsKICAgICAgICB1cGRhdGVEYXRhbGlzdCgnUm9sZS1saXN0Jyk7CiAgICB9CgogICAgaWYgKGZvcm0uZGF0YXNldC5lZGl0aW5nUm93SW5kZXgpIHsgLy8gVXBkYXRlIGV4aXN0aW5nIHJvdwogICAgICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFibGVJZCk7CiAgICAgICAgY29uc3Qgcm93SW5kZXggPSBwYXJzZUludChmb3JtLmRhdGFzZXQuZWRpdGluZ1Jvd0luZGV4LCAxMCk7CiAgICAgICAgY29uc3Qgcm93ID0gdGFibGUucm93c1tyb3dJbmRleF07CiAgICAgICAgaWYocm93KSB7CiAgICAgICAgICAgIHNoZWV0LmhlYWRlcnMuZm9yRWFjaCgoaGVhZGVyLCBpKSA9PiB7CiAgICAgICAgICAgICAgICByb3cuY2VsbHNbaV0udGV4dENvbnRlbnQgPSBuZXdSb3dEYXRhW2hlYWRlcl0gfHwgJyc7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0gZWxzZSB7IC8vIEFkZCBuZXcgcm93CiAgICAgICAgaWYgKHNoZWV0LmlkID09PSAnc2l0ZURldGFpbHMnICYmIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhYmxlSWQpLnF1ZXJ5U2VsZWN0b3IoJ3Rib2R5Jykucm93cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgnT25seSBvbmUgc2l0ZSBkZXRhaWxzIGVudHJ5IGlzIGFsbG93ZWQuJywgJ2Vycm9yJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgYXBwZW5kUm93VG9UYWJsZSh0YWJsZUlkLCBzaGVldC5oZWFkZXJzLCBuZXdSb3dEYXRhKTsKICAgIH0KICAgIAogICAgc2F2ZVRhYmxlVG9TdG9yYWdlKHRhYmxlSWQpOwogICAgcmVzZXRGb3JtKGZvcm0pOwp9CgpmdW5jdGlvbiBoYW5kbGVBZGRJbnRlZ3JhdGlvbihmb3JtKSB7CiAgICBjb25zdCBzZWxlY3RlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnRlZ3JhdGlvbi1zZWxlY3QnKS52YWx1ZTsKICAgIGlmICghc2VsZWN0ZWQpIHsKICAgICAgICBzaG93TW9kYWwoJ1BsZWFzZSBzZWxlY3QgYW4gaW50ZWdyYXRpb24gdHlwZS4nLCAnZXJyb3InKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgdGFibGVJZCA9ICdpbnRlZ3JhdGlvbnMtdGFibGUnOwogICAgY29uc3Qgc2hlZXQgPSBpbml0aWFsRGF0YS5pbnRlZ3JhdGlvbnM7CiAgICBjb25zdCBuZXdSb3dEYXRhID0geyAiSW50ZWdyYXRpb24iOiAiIiwgIkRldGFpbCAxIjogIiIsICJWYWx1ZSAxIjogIiIsICJEZXRhaWwgMiI6ICIiLCAiVmFsdWUgMiI6ICIiLCAiRGV0YWlsIDMiOiAiIiwgIlZhbHVlIDMiOiAiIiB9OwoKICAgIGlmIChzZWxlY3RlZCA9PT0gJ3NuYXBzY2FuJykgewogICAgICAgIG5ld1Jvd0RhdGFbIkludGVncmF0aW9uIl0gPSAnU25hcFNjYW4nOwogICAgICAgIG5ld1Jvd0RhdGFbIkRldGFpbCAxIl0gPSAnU25hcFNjYW4gQ29kZSc7CiAgICAgICAgbmV3Um93RGF0YVsiVmFsdWUgMSJdID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NuYXBzY2FuLWNvZGUnKS52YWx1ZTsKICAgICAgICBuZXdSb3dEYXRhWyJEZXRhaWwgMiJdID0gJ1JlZ2lzdGVyZWQgRW1haWwnOwogICAgICAgIG5ld1Jvd0RhdGFbIlZhbHVlIDIiXSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzbmFwc2Nhbi1lbWFpbCcpLnZhbHVlOwogICAgICAgIG5ld1Jvd0RhdGFbIkRldGFpbCAzIl0gPSAnU2l0ZSBOYW1lJzsKICAgICAgICBuZXdSb3dEYXRhWyJWYWx1ZSAzIl0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc25hcHNjYW4tc2l0ZS1uYW1lJykudmFsdWU7CiAgICAgICAgaWYgKCFuZXdSb3dEYXRhWyJWYWx1ZSAxIl0gfHwgIW5ld1Jvd0RhdGFbIlZhbHVlIDIiXSB8fCAhbmV3Um93RGF0YVsiVmFsdWUgMyJdKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgnUGxlYXNlIGZpbGwgaW4gYWxsIHJlcXVpcmVkIFNuYXBTY2FuIGZpZWxkcy4nLCAnZXJyb3InKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWQgPT09ICd6YXBwZXInKSB7CiAgICAgICAgbmV3Um93RGF0YVsiSW50ZWdyYXRpb24iXSA9ICdaYXBwZXInOwogICAgICAgIG5ld1Jvd0RhdGFbIkRldGFpbCAxIl0gPSAnTWVyY2hhbnQgSUQnOwogICAgICAgIG5ld1Jvd0RhdGFbIlZhbHVlIDEiXSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6YXBwZXItbWVyY2hhbnQtaWQnKS52YWx1ZTsKICAgICAgICBuZXdSb3dEYXRhWyJEZXRhaWwgMiJdID0gJ1NpdGUgSUQnOwogICAgICAgIG5ld1Jvd0RhdGFbIlZhbHVlIDIiXSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6YXBwZXItc2l0ZS1pZCcpLnZhbHVlOwogICAgICAgIG5ld1Jvd0RhdGFbIkRldGFpbCAzIl0gPSAnUE9TIEtleSc7CiAgICAgICAgbmV3Um93RGF0YVsiVmFsdWUgMyJdID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3phcHBlci1wb3Mta2V5JykudmFsdWU7CiAgICAgICAgaWYgKCFuZXdSb3dEYXRhWyJWYWx1ZSAxIl0gfHwgIW5ld1Jvd0RhdGFbIlZhbHVlIDIiXSB8fCAhbmV3Um93RGF0YVsiVmFsdWUgMyJdKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgnUGxlYXNlIGZpbGwgaW4gYWxsIHJlcXVpcmVkIFphcHBlciBmaWVsZHMuJywgJ2Vycm9yJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKHNlbGVjdGVkID09PSAneW95bycpIHsKICAgICAgICBuZXdSb3dEYXRhWyJJbnRlZ3JhdGlvbiJdID0gJ1lveW8gV2FsbGV0JzsKICAgICAgICBuZXdSb3dEYXRhWyJEZXRhaWwgMSJdID0gJ1N0YXR1cyc7CiAgICAgICAgbmV3Um93RGF0YVsiVmFsdWUgMSJdID0gJ1JlZ2lzdHJhdGlvbiBSZXF1aXJlZCc7CiAgICB9CiAgICAKICAgIGlmIChmb3JtLmRhdGFzZXQuZWRpdGluZ1Jvd0luZGV4KSB7CiAgICAgICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJsZUlkKTsKICAgICAgICBjb25zdCByb3dJbmRleCA9IHBhcnNlSW50KGZvcm0uZGF0YXNldC5lZGl0aW5nUm93SW5kZXgsIDEwKTsKICAgICAgICBjb25zdCByb3cgPSB0YWJsZS5yb3dzW3Jvd0luZGV4XTsKICAgICAgICBpZiAocm93KSB7CiAgICAgICAgICAgIHNoZWV0LmhlYWRlcnMuZm9yRWFjaCgoaGVhZGVyLCBpKSA9PiB7CiAgICAgICAgICAgICAgICByb3cuY2VsbHNbaV0udGV4dENvbnRlbnQgPSBuZXdSb3dEYXRhW2hlYWRlcl0gfHwgJyc7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgYXBwZW5kUm93VG9UYWJsZSh0YWJsZUlkLCBzaGVldC5oZWFkZXJzLCBuZXdSb3dEYXRhKTsKICAgIH0KICAgIAogICAgc2F2ZVRhYmxlVG9TdG9yYWdlKHRhYmxlSWQpOwogICAgcmVzZXRJbnRlZ3JhdGlvbkZvcm0oZm9ybSk7CiAgICBzaG93TW9kYWwoZm9ybS5kYXRhc2V0LmVkaXRpbmdSb3dJbmRleCA/ICdJbnRlZ3JhdGlvbiBlbnRyeSB1cGRhdGVkLicgOiAnSW50ZWdyYXRpb24gZW50cnkgYWRkZWQuJywgJ3N1Y2Nlc3MnKTsKfQoKZnVuY3Rpb24gcmVzZXRJbnRlZ3JhdGlvbkZvcm0oZm9ybSkgewogICAgZm9ybS5yZXNldCgpOwogICAgZGVsZXRlIGZvcm0uZGF0YXNldC5lZGl0aW5nUm93SW5kZXg7CgogICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ludGVncmF0aW9uLXNlbGVjdCcpOwogICAgaWYgKHNlbGVjdCkgewogICAgICAgIHNlbGVjdC52YWx1ZSA9ICcnOwogICAgICAgIHNlbGVjdC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnY2hhbmdlJykpOwogICAgfQoKICAgIGNvbnN0IGJ0blRleHQgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5idG4tdGV4dCcpOwogICAgaWYgKGJ0blRleHQpIGJ0blRleHQudGV4dENvbnRlbnQgPSAnQWRkIEVudHJ5JzsKICAgIAogICAgY29uc3QgY2xlYXJCdG4gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5jbGVhci1mb3JtLWJ0bicpOwogICAgaWYgKGNsZWFyQnRuKSBjbGVhckJ0bi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKfQoKCmZ1bmN0aW9uIGhhbmRsZUludGVncmF0aW9uRWRpdENsaWNrKHJvdykgewogICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnRlZ3JhdGlvbnMtZm9ybScpOwogICAgaWYgKCFmb3JtKSByZXR1cm47CgogICAgLy8gRXh0cmFjdCBkYXRhIGZyb20gdGhlIHJvdwogICAgY29uc3QgaW50ZWdyYXRpb25UeXBlID0gcm93LmNlbGxzWzBdLnRleHRDb250ZW50OwogICAgY29uc3QgdmFsdWUxID0gcm93LmNlbGxzWzJdLnRleHRDb250ZW50OwogICAgY29uc3QgdmFsdWUyID0gcm93LmNlbGxzWzRdLnRleHRDb250ZW50OwogICAgY29uc3QgdmFsdWUzID0gcm93LmNlbGxzWzZdLnRleHRDb250ZW50OwoKICAgIC8vIE1hcCBkaXNwbGF5IG5hbWUgdG8gc2VsZWN0IHZhbHVlCiAgICBjb25zdCBzZWxlY3RWYWx1ZSA9IGludGVncmF0aW9uVHlwZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoJyB3YWxsZXQnLCAnJyk7CiAgICAKICAgIC8vIFNldCB0aGUgZHJvcGRvd24gYW5kIHRyaWdnZXIgY2hhbmdlIHRvIHNob3cgZmllbGRzCiAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW50ZWdyYXRpb24tc2VsZWN0Jyk7CiAgICBzZWxlY3QudmFsdWUgPSBzZWxlY3RWYWx1ZTsKICAgIHNlbGVjdC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnY2hhbmdlJykpOwoKICAgIC8vIFBvcHVsYXRlIHRoZSBjb3JyZWN0IGZpZWxkcwogICAgaWYgKHNlbGVjdFZhbHVlID09PSAnc25hcHNjYW4nKSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NuYXBzY2FuLWNvZGUnKS52YWx1ZSA9IHZhbHVlMTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc25hcHNjYW4tZW1haWwnKS52YWx1ZSA9IHZhbHVlMjsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc25hcHNjYW4tc2l0ZS1uYW1lJykudmFsdWUgPSB2YWx1ZTM7CiAgICB9IGVsc2UgaWYgKHNlbGVjdFZhbHVlID09PSAnemFwcGVyJykgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd6YXBwZXItbWVyY2hhbnQtaWQnKS52YWx1ZSA9IHZhbHVlMTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnemFwcGVyLXNpdGUtaWQnKS52YWx1ZSA9IHZhbHVlMjsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnemFwcGVyLXBvcy1rZXknKS52YWx1ZSA9IHZhbHVlMzsKICAgIH0KCiAgICAvLyBTZXQgZm9ybSB0byBlZGl0IG1vZGUKICAgIGZvcm0uZGF0YXNldC5lZGl0aW5nUm93SW5kZXggPSByb3cucm93SW5kZXg7CiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5idG4tdGV4dCcpLnRleHRDb250ZW50ID0gJ1VwZGF0ZSBFbnRyeSc7CiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5jbGVhci1mb3JtLWJ0bicpLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwogICAgZm9ybS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJyB9KTsKfQoKCmZ1bmN0aW9uIHJlc2V0Rm9ybShmb3JtKSB7CiAgICBjb25zdCBmb3JtSWQgPSBmb3JtLmlkOwogICAgZm9ybS5yZXNldCgpOwogICAgZGVsZXRlIGZvcm0uZGF0YXNldC5lZGl0aW5nUm93SW5kZXg7CiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5idG4tdGV4dCcpLnRleHRDb250ZW50ID0gJ0FkZCBFbnRyeSc7CiAgICBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5jbGVhci1mb3JtLWJ0bicpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgaWYgKGZvcm1JZCA9PT0gJ3NpdGVEZXRhaWxzLWZvcm0nKSB7CiAgICAgICAgdXBkYXRlU2l0ZURldGFpbHNGb3JtU3RhdGUoKTsKICAgIH0KfQoKLy8gLS0tIFVUSUxJVFkgJiBFWFBPUlQgLS0tCmZ1bmN0aW9uIGNsZWFyQWxsRGF0YShzaG93U3VjY2Vzc01vZGFsID0gdHJ1ZSkgewogICAgT2JqZWN0LnZhbHVlcyhpbml0aWFsRGF0YSkuZm9yRWFjaChzaGVldCA9PiB7CiAgICAgICAgY29uc3QgdGFibGVJZCA9IGAke3NoZWV0LmlkfS10YWJsZWA7CiAgICAgICAgcmVuZGVyVGFibGUodGFibGVJZCwgc2hlZXQuaGVhZGVycywgW10pOwogICAgICAgIHNhdmVUYWJsZVRvU3RvcmFnZSh0YWJsZUlkKTsKICAgIH0pOwogICAgCiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnc3VnZ2VzdGlvbnNfUm9sZS1saXN0Jyk7CiAgICAKICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd3ZWxjb21lU2NyZWVuU2hvd24nKTsKICAgIAogICAgY29uc3QgaW50ZWdyYXRpb25TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW50ZWdyYXRpb24tc2VsZWN0Jyk7CiAgICBpZiAoaW50ZWdyYXRpb25TZWxlY3QpIHsKICAgICAgICBpbnRlZ3JhdGlvblNlbGVjdC52YWx1ZSA9ICcnOwogICAgICAgIGludGVncmF0aW9uU2VsZWN0LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdjaGFuZ2UnKSk7CiAgICB9CgogICAgbG9hZEFsbFN1Z2dlc3Rpb25zKCk7CiAgICBpZiAoc2hvd1N1Y2Nlc3NNb2RhbCkgewogICAgICAgIHNob3dNb2RhbCgnQWxsIGRhdGEgYW5kIHNldHRpbmdzIGhhdmUgYmVlbiBjbGVhcmVkLicsICdzdWNjZXNzJyk7CiAgICB9Cn0KCmZ1bmN0aW9uIGV4cG9ydEFsbFRvRXhjZWwoKSB7CiAgICBjb25zdCBkb1RoZUV4cG9ydEFuZENsZWFyID0gKCkgPT4gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHdiID0gWExTWC51dGlscy5ib29rX25ldygpOwogICAgICAgICAgICBPYmplY3QudmFsdWVzKGluaXRpYWxEYXRhKS5mb3JFYWNoKHNoZWV0ID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHRhYmxlSWQgPSBgJHtzaGVldC5pZH0tdGFibGVgOwogICAgICAgICAgICAgICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJsZUlkKTsKICAgICAgICAgICAgICAgIGlmICghdGFibGUpIHJldHVybjsKICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBzaGVldC5oZWFkZXJzOwogICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IEFycmF5LmZyb20odGFibGUucXVlcnlTZWxlY3RvckFsbCgndGJvZHkgdHInKSkubWFwKHJvdyA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93RGF0YSA9IHt9OwogICAgICAgICAgICAgICAgICAgIEFycmF5LmZyb20ocm93LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkJykpLnNsaWNlKDAsIC0xKS5mb3JFYWNoKCh0ZCwgaSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByb3dEYXRhW2hlYWRlcnNbaV1dID0gdGQudGV4dENvbnRlbnQ7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvd0RhdGE7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHdzID0gWExTWC51dGlscy5qc29uX3RvX3NoZWV0KGRhdGEsIHsgaGVhZGVyOiBoZWFkZXJzIH0pOwogICAgICAgICAgICAgICAgICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCB3cywgc2hlZXQubmFtZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IHNpdGVOYW1lID0gJ0RlZmF1bHRfU2l0ZSc7CiAgICAgICAgICAgIGNvbnN0IHNpdGVEZXRhaWxzVGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2l0ZURldGFpbHMtdGFibGUnKTsKICAgICAgICAgICAgaWYgKHNpdGVEZXRhaWxzVGFibGUpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0Um93ID0gc2l0ZURldGFpbHNUYWJsZS5xdWVyeVNlbGVjdG9yKCd0Ym9keSB0cicpOwogICAgICAgICAgICAgICAgaWYgKGZpcnN0Um93KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlyc3RDZWxsID0gZmlyc3RSb3cucXVlcnlTZWxlY3RvcigndGQnKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDZWxsICYmIGZpcnN0Q2VsbC50ZXh0Q29udGVudC50cmltKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2l0ZU5hbWUgPSBmaXJzdENlbGwudGV4dENvbnRlbnQudHJpbSgpLnJlcGxhY2UoL1teYS16QS1aMC05XyAtXS9nLCAnJykucmVwbGFjZSgvXHMrL2csICdfJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IGZpbGVOYW1lID0gYCR7c2l0ZU5hbWV9X3NpdGVfSW5mb3JtYXRpb24ueGxzeGA7CiAgICAgICAgICAgIAogICAgICAgICAgICBYTFNYLndyaXRlRmlsZSh3YiwgZmlsZU5hbWUpOwogICAgICAgICAgICAKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICBjbGVhckFsbERhdGEoZmFsc2UpOwogICAgICAgICAgICAgICAgc2hvd01vZGFsKCdEYXRhIHN1Y2Nlc3NmdWxseSBleHBvcnRlZCBhbmQgYWxsIGZpZWxkcyBoYXZlIGJlZW4gY2xlYXJlZCEnLCAnc3VjY2VzcycsICgpID0+IHt9LCBmYWxzZSwgeyBhdXRvQ2xvc2U6IGZhbHNlIH0pOwogICAgICAgICAgICB9LCAxMDApOwoKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCJFeHBvcnQgZmFpbGVkOiIsIGVycm9yKTsKICAgICAgICAgICAgc2hvd01vZGFsKCdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgZXhwb3J0LicsICdlcnJvcicpOwogICAgICAgIH0KICAgIH07CgogICAgY29uc3Qgc2hvd0ZpbmFsQ29uZmlybWF0aW9uID0gKCkgPT4gewogICAgICAgIHNob3dNb2RhbCgKICAgICAgICAgICAgJ1dhcm5pbmcuIFBsZWFzZSBlbnN1cmUgYWxsIGluZm9ybWF0aW9uIHByb3ZpZGVkIGlzIGNvcnJlY3QsIGFzIHRoaXMgYWN0aW9uIHdpbGwgY2xlYXIgYWxsIGRhdGEgZnJvbSB0aGUgdGFibGVzLiBEbyB5b3Ugd2FudCB0byBwcm9jZWVkPycsCiAgICAgICAgICAgICd3YXJuaW5nJywKICAgICAgICAgICAgZG9UaGVFeHBvcnRBbmRDbGVhciwKICAgICAgICAgICAgdHJ1ZQogICAgICAgICk7CiAgICB9OwoKICAgIGNvbnN0IHNpdGVEZXRhaWxzQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaXRlRGV0YWlscy10YWJsZScpPy5xdWVyeVNlbGVjdG9yKCd0Ym9keScpOwogICAgY29uc3QgZW1wbG95ZWVzQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlbXBsb3llZXMtdGFibGUnKT8ucXVlcnlTZWxlY3RvcigndGJvZHknKTsKICAgIAogICAgY29uc3QgaGFzU2l0ZURldGFpbHMgPSBzaXRlRGV0YWlsc0JvZHkgJiYgc2l0ZURldGFpbHNCb2R5LnJvd3MubGVuZ3RoID4gMDsKICAgIGNvbnN0IGhhc0VtcGxveWVlcyA9IGVtcGxveWVlc0JvZHkgJiYgZW1wbG95ZWVzQm9keS5yb3dzLmxlbmd0aCA+IDA7CiAgICAKICAgIGlmICghaGFzU2l0ZURldGFpbHMgfHwgIWhhc0VtcGxveWVlcykgewogICAgICAgIGxldCBtaXNzaW5nID0gW107CiAgICAgICAgaWYgKCFoYXNTaXRlRGV0YWlscykgbWlzc2luZy5wdXNoKCJTaXRlIERldGFpbHMiKTsKICAgICAgICBpZiAoIWhhc0VtcGxveWVlcykgbWlzc2luZy5wdXNoKCJFbXBsb3llZXMiKTsKICAgICAgICBzaG93TW9kYWwoYEV4cG9ydCBmYWlsZWQuIFRoZSBmb2xsb3dpbmcgcmVxdWlyZWQgc2VjdGlvbnMgYXJlIGVtcHR5OiAke21pc3Npbmcuam9pbignLCAnKX0uIFBsZWFzZSBhZGQgYXQgbGVhc3Qgb25lIGVudHJ5IHRvIGVhY2guYCwgJ2Vycm9yJyk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBlbXB0eU9wdGlvbmFsVGFicyA9IFtdOwogICAgWydzdXBwbGllcnMnLCAnc2l0ZG93bkFyZWFzJywgJ2ludGVncmF0aW9ucyddLmZvckVhY2goaWQgPT4gewogICAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtpZH0tdGFibGVgKT8ucXVlcnlTZWxlY3RvcigndGJvZHknKTsKICAgICAgICBjb25zdCBzaGVldCA9IGluaXRpYWxEYXRhW2lkXTsKICAgICAgICBpZiAoc2hlZXQgJiYgKCFib2R5IHx8IGJvZHkucm93cy5sZW5ndGggPT09IDApKSB7CiAgICAgICAgICAgIGVtcHR5T3B0aW9uYWxUYWJzLnB1c2goc2hlZXQubmFtZSk7CiAgICAgICAgfQogICAgfSk7CiAgICAKICAgIGlmIChlbXB0eU9wdGlvbmFsVGFicy5sZW5ndGggPiAwKSB7CiAgICAgICAgc2hvd01vZGFsKAogICAgICAgICAgICBgV2FybmluZzogVGhlIGZvbGxvd2luZyB0YWJzIGhhdmUgbm8gZGF0YTogJHtlbXB0eU9wdGlvbmFsVGFicy5qb2luKCcsICcpfS4gRG8geW91IHdhbnQgdG8gY29udGludWUgZXhwb3J0aW5nIHRoZSByZW1haW5pbmcgZGF0YT9gLAogICAgICAgICAgICAnd2FybmluZycsCiAgICAgICAgICAgIHNob3dGaW5hbENvbmZpcm1hdGlvbiwKICAgICAgICAgICAgdHJ1ZSwKICAgICAgICAgICAgeyBjaGFpbjogdHJ1ZSB9CiAgICAgICAgKTsKICAgIH0gZWxzZSB7CiAgICAgICAgc2hvd0ZpbmFsQ29uZmlybWF0aW9uKCk7CiAgICB9Cn0KCmZ1bmN0aW9uIHNob3dNb2RhbChtZXNzYWdlLCB0eXBlID0gJ3N1Y2Nlc3MnLCBvbkNvbmZpcm0gPSAoKSA9PiB7fSwgc2hvd0NhbmNlbCA9IGZhbHNlLCBvcHRpb25zID0ge30pIHsKICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsJyk7CiAgICBjb25zdCBtb2RhbE1lc3NhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWwtbWVzc2FnZScpOwogICAgY29uc3QgbW9kYWxJY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsLWljb24nKTsKICAgIGNvbnN0IG1vZGFsU3ZnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsLXN2ZycpOwogICAgY29uc3QgY29uZmlybUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbC1jb25maXJtJyk7CiAgICBjb25zdCBjYW5jZWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWwtY2FuY2VsJyk7CiAgICBjb25zdCBtb2RhbEJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWwtYnV0dG9ucycpOwoKICAgIG1vZGFsTWVzc2FnZS50ZXh0Q29udGVudCA9IG1lc3NhZ2U7CiAgICBtb2RhbEljb24uY2xhc3NOYW1lID0gYG1vZGFsLWljb24gJHt0eXBlfWA7CiAgICBsZXQgaWNvblBhdGggPSAnJzsKICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgIGNhc2UgJ3N1Y2Nlc3MnOiBpY29uUGF0aCA9ICc8cGF0aCBkPSJNMjIgMTEuMDhWMTJhMTAgMTAgMCAxIDEtNS45My05LjE0Ij48L3BhdGg+PHBvbHlsaW5lIHBvaW50cz0iMjIgNCAxMiAxNC4wMSA5IDExLjAxIj48L3BvbHlsaW5lPic7IGJyZWFrOwogICAgICAgIGNhc2UgJ2Vycm9yJzogaWNvblBhdGggPSAnPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiPjwvY2lyY2xlPjxsaW5lIHgxPSIxNSIgeTE9IjkiIHgyPSI5IiB5Mj0iMTUiPjwvbGluZT48bGluZSB4MT0iOSIgeTE9IjkiIHgyPSIxNSIgeTI9IjE1Ij48L2xpbmU+JzsgYnJlYWs7CiAgICAgICAgY2FzZSAnd2FybmluZyc6IGljb25QYXRoID0gJzxwYXRoIGQ9Ik0xMC4yOSAzLjg2TDEuODIgMThhMiAyIDAgMCAwIDEuNzEgM2gxNi45NGEyIDIgMCAwIDAgMS43MS0zTDEzLjcxIDMuODZhMiAyIDAgMCAwLTMuNDIgMHoiPjwvcGF0aD48bGluZSB4MT0iMTIiIHkxPSI5IiB4Mj0iMTIiIHkyPSIxMyI+PC9saW5lPjxsaW5lIHgxPSIxMiIgeTE9IjE3IiB4Mj0iMTIuMDEiIHkyPSIxNyI+PC9saW5lPic7IGJyZWFrOwogICAgfQogICAgbW9kYWxTdmcuaW5uZXJIVE1MID0gaWNvblBhdGg7CgogICAgbW9kYWxCdXR0b25zLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICBjb25maXJtQnRuLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgY2FuY2VsQnRuLnN0eWxlLmRpc3BsYXkgPSBzaG93Q2FuY2VsID8gJ2Jsb2NrJyA6ICdub25lJzsKICAgIAogICAgaWYgKCFzaG93Q2FuY2VsKSB7CiAgICAgICAgY29uZmlybUJ0bi50ZXh0Q29udGVudCA9ICdPSyc7CiAgICAgICAgY29uZmlybUJ0bi5vbmNsaWNrID0gaGlkZU1vZGFsOwogICAgICAgIGlmICh0eXBlID09PSAnc3VjY2VzcycgJiYgb3B0aW9ucy5hdXRvQ2xvc2UgIT09IGZhbHNlKSB7CiAgICAgICAgICAgICBzZXRUaW1lb3V0KGhpZGVNb2RhbCwgMjUwMCk7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBjb25maXJtQnRuLnRleHRDb250ZW50ID0gJ0NvbmZpcm0nOwogICAgICAgIGNvbmZpcm1CdG4ub25jbGljayA9ICgpID0+IHsgCiAgICAgICAgICAgIG9uQ29uZmlybSgpOwogICAgICAgICAgICBpZiAoIW9wdGlvbnMuY2hhaW4pIHsKICAgICAgICAgICAgICAgIGhpZGVNb2RhbCgpOyAKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICB9CiAgICAKICAgIGNhbmNlbEJ0bi5vbmNsaWNrID0gaGlkZU1vZGFsOwogICAgbW9kYWwub25jbGljayA9IChlKSA9PiB7IGlmIChlLnRhcmdldCA9PT0gbW9kYWwpIGhpZGVNb2RhbCgpOyB9OwogICAgCiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7Cn0KCmZ1bmN0aW9uIGhpZGVNb2RhbCgpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbCcpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKfQoKZnVuY3Rpb24gZ2V0VG9vbHRpcFRleHQoaGVhZGVyKSB7CiAgICBjb25zdCB0b29sdGlwcyA9IHsgIlNpdGUgTmFtZSI6ICJUaGUgY29tbW9uIG5hbWUgZm9yIHRoZSBidXNpbmVzcyBsb2NhdGlvbi4iLCAiUmVnaXN0ZXJlZCBDb21wYW55IE5hbWUiOiAiVGhlIG9mZmljaWFsLCBsZWdhbGx5IHJlZ2lzdGVyZWQgbmFtZSBvZiB0aGUgY29tcGFueS4iLCAiVHJhZGluZyBOYW1lIjogIlRoZSBuYW1lIHRoZSBidXNpbmVzcyB1c2VzIGZvciBtYXJrZXRpbmcgb3Igc2FsZXMuIiwgIkNvbXBhbnkgUmVnaXN0cmF0aW9uIE51bWJlciI6ICJUaGUgdW5pcXVlIG51bWJlciBhc3NpZ25lZCBieSB0aGUgY29tcGFueSByZWdpc3RyYXIuIiwgIkNvbXBhbnkgVkFUIE51bWJlciI6ICJUaGUgdW5pcXVlIG51bWJlciBhc3NpZ25lZCBmb3IgVmFsdWUtQWRkZWQgVGF4IHB1cnBvc2VzLiIsICJPd25lciBOYW1lIjogIkZpcnN0IG5hbWUgb2YgdGhlIHByaW1hcnkgYnVzaW5lc3Mgb3duZXIuIiwgIk93bmVyIFN1cm5hbWUiOiAiTGFzdCBuYW1lIG9mIHRoZSBwcmltYXJ5IGJ1c2luZXNzIG93bmVyLiIsICJPd25lciBGdWxsIE5hbWUiOiAiRnVsbCBuYW1lIG9mIHRoZSBwcmltYXJ5IGJ1c2luZXNzIG93bmVyLiIsICJPd25lciBUZWxlcGhvbmUgTnVtYmVyIjogIkNvbnRhY3QgbnVtYmVyIGZvciB0aGUgYnVzaW5lc3Mgb3duZXIuIE11c3QgYmUgMTAgZGlnaXRzLiIsICJPd25lciBFbWFpbCBBZGRyZXNzIjogIlRoZSBwcmltYXJ5IGVtYWlsIGZvciB0aGUgYnVzaW5lc3Mgb3duZXIuIE11c3QgYmUgYSB2YWxpZCBlbWFpbCBmb3JtYXQuIiwgIlNpdGUgQWRkcmVzcyI6ICJUaGUgcGh5c2ljYWwgYWRkcmVzcyBvZiB0aGUgYnVzaW5lc3MgbG9jYXRpb24uIiwgIkVtcGxveWVlIE5hbWUiOiAiRmlyc3QgbmFtZSBvZiB0aGUgZW1wbG95ZWUuIiwgIlN1cm5hbWUiOiAiTGFzdCBuYW1lIG9mIHRoZSBlbXBsb3llZS4iLCAiRW1wbG95ZWUgRnVsbCBOYW1lIjogIkZ1bGwgbmFtZSBvZiB0aGUgZW1wbG95ZWUuIiwgIkVtYWlsIEFkZHJlc3MgKElmIEFkbWluL01hbmFnZXIpIjogIlJlcXVpcmVkIGZvciBzdGFmZiB3aXRoIEFkbWluIG9yIE1hbmFnZXIgcGVybWlzc2lvbnMuIE11c3QgYmUgYSB2YWxpZCBlbWFpbCBmb3JtYXQuIiwgIkNvbnRhY3QgTnVtYmVyIChJZiBBZG1pbi9NYW5hZ2VyKSI6ICJPcHRpb25hbCBjb250YWN0IG51bWJlciBmb3Igc2VuaW9yIHN0YWZmLiBNdXN0IGJlIDEwIGRpZ2l0cyBpZiBwcm92aWRlZC4iLCAiUm9sZSI6ICJBIHNlY29uZGFyeSByb2xlIG9yIHRpdGxlIGZvciB0aGUgZW1wbG95ZWUgKGUuZy4sIE1hbmFnZXIsIFdhaXRlciwgU3RhZmYsIE93bmVyKS4iLCAiTG9naW4gQ29kZSI6ICJBIHVuaXF1ZSBudW1lcmljIGNvZGUgZm9yIHRoZSBlbXBsb3llZSB0byBsb2cgaW50byB0aGUgc3lzdGVtLiBNdXN0IGJlIDQgZGlnaXRzIGlmIHByb3ZpZGVkLiIsICJOYW1lIjogIlRoZSBuYW1lIG9mIHRoZSBzdXBwbGllciBjb21wYW55LiIsICJBZGRyZXNzIExpbmUgMSI6ICJUaGUgZmlyc3QgbGluZSBvZiB0aGUgc3VwcGxpZXIncyBhZGRyZXNzLiIsICJUb3duIjogIlRoZSB0b3duIG9yIGNpdHkgd2hlcmUgdGhlIHN1cHBsaWVyIGlzIGxvY2F0ZWQuIiwgIkNvbnRhY3QgRmlyc3QgTmFtZSI6ICJUaGUgZmlyc3QgbmFtZSBvZiB5b3VyIGNvbnRhY3QgcGVyc29uIGF0IHRoZSBzdXBwbGllci4iLCAiQ29udGFjdCBFbWFpbCI6ICJUaGUgZW1haWwgYWRkcmVzcyBmb3IgeW91ciBzdXBwbGllciBjb250YWN0LiBNdXN0IGJlIGEgdmFsaWQgZW1haWwgZm9ybWF0LiIsICJDb250YWN0IFBob25lIE51bWJlciI6ICJUaGUgcGhvbmUgbnVtYmVyIGZvciB5b3VyIHN1cHBsaWVyIGNvbnRhY3QuIE11c3QgYmUgMTAgZGlnaXRzLiIsICJBcmVhIExvY2F0aW9uIjogIkEgbmFtZSBmb3IgdGhlIHBoeXNpY2FsIGFyZWEgd2hlcmUgdGhlIHRhYmxlIGlzLCBlLmcuLCAnUGF0aW8nIG9yICdVcHN0YWlycycuIiwgIlRhYmxlICMiOiAiVGhlIG51bWJlciBvciBuYW1lIG9mIHRoZSB0YWJsZS4ifTsKICAgIHJldHVybiB0b29sdGlwc1toZWFkZXJdIHx8IGBFbnRlciB0aGUgJHtoZWFkZXJ9LmA7Cn0KCi8vIC0tLSBUVVRPUklBTCBMT0dJQyAtLS0KY29uc3QgdHV0b3JpYWxTdGVwcyA9IFsKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3R1dG9yaWFsLWhvdy10by1ndWlkZScsCiAgICAgICAgY29udGVudDogJzxiPldlbGNvbWUhPC9iPiBGb3IgYSBkZXRhaWxlZCBndWlkZSwgeW91IGNhbiBhbHdheXMgY2xpY2sgdGhpcyBkb2N1bWVudCBpY29uIHRvIG9wZW4gdGhlICJIb3cgVG8iIGd1aWRlIGluIGEgbmV3IHRhYi4nLAogICAgICAgIHBvc2l0aW9uOiAncmlnaHQnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjdHV0b3JpYWwtdGFicycsCiAgICAgICAgY29udGVudDogJ0ZpcnN0LCB1c2UgdGhlc2UgdGFicyB0byBzd2l0Y2ggYmV0d2VlbiB0aGUgZGlmZmVyZW50IHNlY3Rpb25zIHlvdSBuZWVkIHRvIGZpbGwgaW4sIGxpa2UgIlNpdGUgRGV0YWlscyIgYW5kICJFbXBsb3llZXMiLicsCiAgICAgICAgcG9zaXRpb246ICdib3R0b20nCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjc2l0ZURldGFpbHMtZm9ybScsCiAgICAgICAgY29udGVudDogJ0luIGVhY2ggc2VjdGlvbiwgZmlsbCBvdXQgdGhlIGZvcm0gd2l0aCB5b3VyIGluZm9ybWF0aW9uLiBGaWVsZHMgd2l0aCBhIGJsdWUgc3RhciAoKikgYXJlIHJlcXVpcmVkLicsCiAgICAgICAgcG9zaXRpb246ICdib3R0b20nCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjc2l0ZURldGFpbHMtZm9ybSBidXR0b25bdHlwZT0ic3VibWl0Il0nLAogICAgICAgIGNvbnRlbnQ6ICdPbmNlIHlvdVwndmUgZmlsbGVkIG91dCB0aGUgZm9ybSwgY2xpY2sgdGhpcyBidXR0b24gdG8gYWRkIHlvdXIgZW50cnkgdG8gdGhlIHRhYmxlIGJlbG93LicsCiAgICAgICAgcG9zaXRpb246ICd0b3AnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjdHV0b3JpYWwtdGFibGUtc2l0ZURldGFpbHMnLAogICAgICAgIGNvbnRlbnQ6ICdZb3VyIGVudHJpZXMgd2lsbCBhcHBlYXIgaGVyZS4gWW91IGNhbiBjbGljayBhbnkgY2VsbCB0byBtYWtlIHF1aWNrIGVkaXRzIGRpcmVjdGx5IGluIHRoZSB0YWJsZS4nLAogICAgICAgIHBvc2l0aW9uOiAndG9wJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3R1dG9yaWFsLWxvYWRlcnMnLAogICAgICAgIGNvbnRlbnQ6ICdUaGVzZSA8Yj5Mb2FkZXIgYnV0dG9uczwvYj4gb3BlbiBzZXBhcmF0ZSB0b29scyBpbiBhIG5ldyBicm93c2VyIHRhYi4gVXNlIHRoZW0gdG8gYnVsay11cGxvYWQgeW91ciBwcm9kdWN0IGFuZCByZWNpcGUgbGlzdHMuJywKICAgICAgICBwb3NpdGlvbjogJ2xlZnQnCiAgICB9LAogICAgIHsKICAgICAgICBlbGVtZW50OiAnI2V4cG9ydEJ0bicsCiAgICAgICAgY29udGVudDogJ1RoZSA8Yj5FeHBvcnQ8L2I+IGJ1dHRvbiBzYXZlcyBhbGwgdGhlIHNpdGUgZGF0YSB5b3VcJ3ZlIGVudGVyZWQgb24gdGhpcyBwYWdlIGludG8gYSBzaW5nbGUgRXhjZWwgZmlsZS4gTm90ZTogVGhpcyBkb2VzIG5vdCBpbmNsdWRlIGRhdGEgZnJvbSB0aGUgUHJvZHVjdC9SZWNpcGUgbG9hZGVycy4nLAogICAgICAgIHBvc2l0aW9uOiAnbGVmdCcKICAgIH0sCiAgICB7CiAgICAgICAgZWxlbWVudDogJyNjbGVhckJ0bicsCiAgICAgICAgY29udGVudDogJ1VzZSB0aGUgPGI+Q2xlYXIgQWxsIERhdGE8L2I+IGJ1dHRvbiB0byByZXNldCB0aGUgZW50aXJlIGFwcGxpY2F0aW9uIGFuZCBzdGFydCBmcmVzaC4nLAogICAgICAgIHBvc2l0aW9uOiAnbGVmdCcKICAgIH0KXTsKCmxldCBjdXJyZW50VHV0b3JpYWxTdGVwID0gMDsKY29uc3QgdHV0b3JpYWxPdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXknKTsKY29uc3QgdHV0b3JpYWxQb3BvdmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXBvcG92ZXInKTsKY29uc3QgcG9wb3ZlckNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcG9wb3Zlci1jb250ZW50Jyk7CmNvbnN0IHN0ZXBDb3VudGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXN0ZXAtY291bnRlcicpOwpjb25zdCBwcmV2QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXByZXYtYnRuJyk7CmNvbnN0IG5leHRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtbmV4dC1idG4nKTsKbGV0IGhpZ2hsaWdodGVkRWxlbWVudCA9IG51bGw7CgpmdW5jdGlvbiBzdGFydFR1dG9yaWFsKCkgewogICAgY3VycmVudFR1dG9yaWFsU3RlcCA9IDA7CiAgICB0dXRvcmlhbE92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ3R1dG9yaWFsLWFjdGl2ZScpOwogICAgc2hvd1R1dG9yaWFsU3RlcChjdXJyZW50VHV0b3JpYWxTdGVwKTsKfQoKZnVuY3Rpb24gZW5kVHV0b3JpYWwoKSB7CiAgICB0dXRvcmlhbE92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgIGNvbnN0IG92ZXJsYXlQYXJ0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50dXRvcmlhbC1vdmVybGF5LXBhcnQnKTsKICAgIG92ZXJsYXlQYXJ0cy5mb3JFYWNoKHBhcnQgPT4gewogICAgICAgIHBhcnQuc3R5bGUud2lkdGggPSAnMCc7CiAgICAgICAgcGFydC5zdHlsZS5oZWlnaHQgPSAnMCc7CiAgICB9KTsKCiAgICB0dXRvcmlhbFBvcG92ZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgndHV0b3JpYWwtYWN0aXZlJyk7CiAgICBpZiAoaGlnaGxpZ2h0ZWRFbGVtZW50KSB7CiAgICAgICAgaGlnaGxpZ2h0ZWRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodC1lbGVtZW50Jyk7CiAgICAgICAgaGlnaGxpZ2h0ZWRFbGVtZW50ID0gbnVsbDsKICAgIH0KfQoKZnVuY3Rpb24gc2hvd1R1dG9yaWFsU3RlcChpbmRleCkgewogICAgaWYgKGhpZ2hsaWdodGVkRWxlbWVudCkgewogICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQtZWxlbWVudCcpOwogICAgfQoKICAgIGNvbnN0IHN0ZXAgPSB0dXRvcmlhbFN0ZXBzW2luZGV4XTsKICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHN0ZXAuZWxlbWVudCk7CgogICAgaWYgKCF0YXJnZXRFbGVtZW50KSB7CiAgICAgICAgY29uc29sZS53YXJuKCdUdXRvcmlhbCBlbGVtZW50IG5vdCBmb3VuZDonLCBzdGVwLmVsZW1lbnQpOwogICAgICAgIGlmIChpbmRleCA8IHR1dG9yaWFsU3RlcHMubGVuZ3RoIC0gMSkgewogICAgICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGluZGV4ICsgMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZW5kVHV0b3JpYWwoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICAvLyBNYWtlIHBvcG92ZXIgdmlzaWJsZSBmb3IgcG9zaXRpb25pbmcgY2FsY3VsYXRpb25zCiAgICB0dXRvcmlhbFBvcG92ZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAKICAgIGhpZ2hsaWdodGVkRWxlbWVudCA9IHRhcmdldEVsZW1lbnQ7CiAgICBoaWdobGlnaHRlZEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0LWVsZW1lbnQnKTsKICAgIAogICAgdGFyZ2V0RWxlbWVudC5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdjZW50ZXInLCBpbmxpbmU6ICdjZW50ZXInIH0pOwoKICAgIHBvcG92ZXJDb250ZW50LmlubmVySFRNTCA9IHN0ZXAuY29udGVudDsKICAgIHN0ZXBDb3VudGVyLnRleHRDb250ZW50ID0gYFN0ZXAgJHtpbmRleCArIDF9IG9mICR7dHV0b3JpYWxTdGVwcy5sZW5ndGh9YDsKICAgIAogICAgLy8gUG9zaXRpb24gUG9wb3ZlciBhbmQgU3BvdGxpZ2h0CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBwb3NpdGlvblBvcG92ZXIodGFyZ2V0RWxlbWVudCwgc3RlcC5wb3NpdGlvbik7CiAgICAgICAgcG9zaXRpb25TcG90bGlnaHQodGFyZ2V0RWxlbWVudCk7CiAgICB9LCAzMDApOyAvLyBBIHNtYWxsIGRlbGF5IHRvIGFsbG93IGZvciBzY3JvbGxpbmcKCiAgICBwcmV2QnRuLmRpc2FibGVkID0gaW5kZXggPT09IDA7CiAgICBuZXh0QnRuLnRleHRDb250ZW50ID0gaW5kZXggPT09IHR1dG9yaWFsU3RlcHMubGVuZ3RoIC0gMSA/ICdGaW5pc2gnIDogJ05leHQnOwp9CgpmdW5jdGlvbiBwb3NpdGlvblNwb3RsaWdodCh0YXJnZXQpIHsKICAgIGNvbnN0IHRhcmdldFJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICBjb25zdCBvdmVybGF5VG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktdG9wJyk7CiAgICBjb25zdCBvdmVybGF5Qm90dG9tID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktYm90dG9tJyk7CiAgICBjb25zdCBvdmVybGF5TGVmdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWxlZnQnKTsKICAgIGNvbnN0IG92ZXJsYXlSaWdodCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jyk7CgogICAgb3ZlcmxheVRvcC5zdHlsZS5oZWlnaHQgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICBvdmVybGF5VG9wLnN0eWxlLndpZHRoID0gJzEwMHZ3JzsKICAgIAogICAgb3ZlcmxheUJvdHRvbS5zdHlsZS50b3AgPSBgJHt0YXJnZXRSZWN0LmJvdHRvbX1weGA7CiAgICBvdmVybGF5Qm90dG9tLnN0eWxlLmhlaWdodCA9IGBjYWxjKDEwMHZoIC0gJHt0YXJnZXRSZWN0LmJvdHRvbX1weClgOwogICAgb3ZlcmxheUJvdHRvbS5zdHlsZS53aWR0aCA9ICcxMDB2dyc7CgogICAgb3ZlcmxheUxlZnQuc3R5bGUudG9wID0gYCR7dGFyZ2V0UmVjdC50b3B9cHhgOwogICAgb3ZlcmxheUxlZnQuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC5oZWlnaHR9cHhgOwogICAgb3ZlcmxheUxlZnQuc3R5bGUud2lkdGggPSBgJHt0YXJnZXRSZWN0LmxlZnR9cHhgOwoKICAgIG92ZXJsYXlSaWdodC5zdHlsZS50b3AgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICBvdmVybGF5UmlnaHQuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC5oZWlnaHR9cHhgOwogICAgb3ZlcmxheVJpZ2h0LnN0eWxlLmxlZnQgPSBgJHt0YXJnZXRSZWN0LnJpZ2h0fXB4YDsKICAgIG92ZXJsYXlSaWdodC5zdHlsZS53aWR0aCA9IGBjYWxjKDEwMHZ3IC0gJHt0YXJnZXRSZWN0LnJpZ2h0fXB4KWA7Cn0KCmZ1bmN0aW9uIHBvc2l0aW9uUG9wb3Zlcih0YXJnZXQsIHBvc2l0aW9uKSB7CiAgICBjb25zdCB0YXJnZXRSZWN0ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgY29uc3QgcG9wb3Zlck5vZGUgPSB0dXRvcmlhbFBvcG92ZXI7CiAgICAKICAgIC8vIFRlbXBvcmFyaWx5IGRpc3BsYXkgdGhlIHBvcG92ZXIgdG8gZ2V0IGl0cyBkaW1lbnNpb25zCiAgICBwb3BvdmVyTm9kZS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7CiAgICBjb25zdCBwb3BvdmVyUmVjdCA9IHBvcG92ZXJOb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgcG9wb3Zlck5vZGUuc3R5bGUudmlzaWJpbGl0eSA9ICcnOwoKICAgIGNvbnN0IGFycm93Q2xhc3MgPSBgYXJyb3ctJHtwb3NpdGlvbn1gOwogICAgY29uc3Qgc3BhY2luZyA9IDE1OwoKICAgIC8vIFJlc2V0IGNsYXNzZXMKICAgIHBvcG92ZXJOb2RlLmNsYXNzTmFtZSA9ICd0dXRvcmlhbC1wb3BvdmVyJzsKCiAgICBsZXQgdG9wLCBsZWZ0OwoKICAgIHN3aXRjaCAocG9zaXRpb24pIHsKICAgICAgICBjYXNlICd0b3AnOgogICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCAtIHBvcG92ZXJSZWN0LmhlaWdodCAtIHNwYWNpbmc7CiAgICAgICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgKyAodGFyZ2V0UmVjdC53aWR0aCAvIDIpIC0gKHBvcG92ZXJSZWN0LndpZHRoIC8gMik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2JvdHRvbSc6CiAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QuYm90dG9tICsgc3BhY2luZzsKICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QubGVmdCArICh0YXJnZXRSZWN0LndpZHRoIC8gMikgLSAocG9wb3ZlclJlY3Qud2lkdGggLyAyKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnbGVmdCc6CiAgICAgICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgLSBwb3BvdmVyUmVjdC53aWR0aCAtIHNwYWNpbmc7CiAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wICsgKHRhcmdldFJlY3QuaGVpZ2h0IC8gMikgLSAocG9wb3ZlclJlY3QuaGVpZ2h0IC8gMik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ3JpZ2h0JzoKICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QucmlnaHQgKyBzcGFjaW5nOwogICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCArICh0YXJnZXRSZWN0LmhlaWdodCAvIDIpIC0gKHBvcG92ZXJSZWN0LmhlaWdodCAvIDIpOwogICAgICAgICAgICBicmVhazsKICAgIH0KICAgIAogICAgLy8gQm91bmRhcnkgY2hlY2tzCiAgICBpZiAobGVmdCA8IHNwYWNpbmcpIGxlZnQgPSBzcGFjaW5nOwogICAgaWYgKChsZWZ0ICsgcG9wb3ZlclJlY3Qud2lkdGgpID4gd2luZG93LmlubmVyV2lkdGggLSBzcGFjaW5nKSBsZWZ0ID0gd2luZG93LmlubmVyV2lkdGggLSBwb3BvdmVyUmVjdC53aWR0aCAtIHNwYWNpbmc7CiAgICBpZiAodG9wIDwgc3BhY2luZykgdG9wID0gc3BhY2luZzsKICAgIGlmICgodG9wICsgcG9wb3ZlclJlY3QuaGVpZ2h0KSA+IHdpbmRvdy5pbm5lckhlaWdodCAtIHNwYWNpbmcpIHRvcCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHBvcG92ZXJSZWN0LmhlaWdodCAtIHNwYWNpbmc7CgogICAgcG9wb3Zlck5vZGUuc3R5bGUudG9wID0gYCR7dG9wfXB4YDsKICAgIHBvcG92ZXJOb2RlLnN0eWxlLmxlZnQgPSBgJHtsZWZ0fXB4YDsKICAgIHBvcG92ZXJOb2RlLmNsYXNzTGlzdC5hZGQoYXJyb3dDbGFzcyk7Cn0KCgpwcmV2QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgaWYgKGN1cnJlbnRUdXRvcmlhbFN0ZXAgPiAwKSB7CiAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcC0tOwogICAgICAgIHNob3dUdXRvcmlhbFN0ZXAoY3VycmVudFR1dG9yaWFsU3RlcCk7CiAgICB9Cn0pOwoKbmV4dEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgIGlmIChjdXJyZW50VHV0b3JpYWxTdGVwIDwgdHV0b3JpYWxTdGVwcy5sZW5ndGggLSAxKSB7CiAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcCsrOwogICAgICAgIHNob3dUdXRvcmlhbFN0ZXAoY3VycmVudFR1dG9yaWFsU3RlcCk7CiAgICB9IGVsc2UgewogICAgICAgIGVuZFR1dG9yaWFsKCk7CiAgICB9Cn0pOwo8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg==</script>
<script id="b64-product" type="application/json">PCFET0NUWVBFIGh0bWw+Cgo8aHRtbCBsYW5nPSJlbiI+CjxoZWFkPgo8bWV0YSBjaGFyc2V0PSJ1dGYtOCIvPgo8bWV0YSBjb250ZW50PSIKICAgIGRlZmF1bHQtc3JjICdzZWxmJzsKICAgIHNjcmlwdC1zcmMgJ3NlbGYnICd1bnNhZmUtaW5saW5lJyBodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tOwogICAgc3R5bGUtc3JjICdzZWxmJyAndW5zYWZlLWlubGluZScgaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbTsKICAgIGZvbnQtc3JjICdzZWxmJyBodHRwczovL2ZvbnRzLmdzdGF0aWMuY29tOwogICAgaW1nLXNyYyAnc2VsZicgZGF0YTo7CiAgICBtZWRpYS1zcmMgJ3NlbGYnOwogICAgY29ubmVjdC1zcmMgJ3NlbGYnIHdzOjsKICAiIGh0dHAtZXF1aXY9IkNvbnRlbnQtU2VjdXJpdHktUG9saWN5Ii8+CjxtZXRhIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiIG5hbWU9InZpZXdwb3J0Ii8+Cjx0aXRsZT5UYWJsZSBCeSBZb2NvIFByb2R1Y3QgTG9hZGVyPC90aXRsZT4KPGxpbmsgaHJlZj0iZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMDAgMTAwJyUzRSUzQ2NpcmNsZSBjeD0nNTAnIGN5PSc1MCcgcj0nNTAnIGZpbGw9JyUyMzAwQTNGRicvJTNFJTNDdGV4dCB4PSc1MCcgeT0nNzAnIGZvbnQtc2l6ZT0nNTAnIGZvbnQtZmFtaWx5PSdQb3BwaW5zLCBzYW5zLXNlcmlmJyBmb250LXdlaWdodD0nYm9sZCcgZmlsbD0nd2hpdGUnIHRleHQtYW5jaG9yPSdtaWRkbGUnJTNFWSUzQy90ZXh0JTNFJTNDL3N2ZyUzRSIgcmVsPSJpY29uIi8+CjxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy94bHN4LzAuMTguNS94bHN4LmZ1bGwubWluLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3BkZi5qcy8yLjE2LjEwNS9wZGYubWluLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL1NvcnRhYmxlLzEuMTUuMC9Tb3J0YWJsZS5taW4uanMiPjwvc2NyaXB0Pgo8bGluayBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tIiByZWw9InByZWNvbm5lY3QiLz4KPGxpbmsgY3Jvc3NvcmlnaW49IiIgaHJlZj0iaHR0cHM6Ly9mb250cy5nc3RhdGljLmNvbSIgcmVsPSJwcmVjb25uZWN0Ii8+CjxsaW5rIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9UG9wcGluczp3Z2h0QDQwMDs1MDA7NjAwOzcwMCZhbXA7ZGlzcGxheT1zd2FwIiByZWw9InN0eWxlc2hlZXQiLz4KPHN0eWxlPgogICAgOnJvb3QgewogICAgICAtLXlvY28tYmc6ICMxMjEyMTI7IC0teW9jby1zdXJmYWNlOiAjMWUxZTFlOyAtLXlvY28tcHJpbWFyeTogIzAwQTNGRjsKICAgICAgLS15b2NvLXByaW1hcnktaG92ZXI6ICMwMDhiZGY7IC0teW9jby10ZXh0LXByaW1hcnk6ICNGRkZGRkY7IC0teW9jby10ZXh0LXNlY29uZGFyeTogI2IzYjNiMzsKICAgICAgLS15b2NvLWJvcmRlcjogIzMzMzMzMzsgLS15b2NvLXJlZDogI2ViNTc1NzsgLS15b2NvLXllbGxvdzogI2ZmYzEwNzsKICAgICAgLS15b2NvLWdyZWVuOiAjMjdhZTYwOyAtLXNoYWRvdzogMCA4cHggMjRweCByZ2JhKDAsIDAsIDAsIDAuMyk7CiAgICB9CiAgICAqIHsgYm94LXNpemluZzogYm9yZGVyLWJveDsgfQogICAgYm9keSB7CiAgICAgICAgZm9udC1mYW1pbHk6ICdQb3BwaW5zJywgc2Fucy1zZXJpZjsgbWFyZ2luOiAwOyBwYWRkaW5nOiAxNjBweCAyMHB4OwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tYmcpOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOyBwb3NpdGlvbjogcmVsYXRpdmU7Cn0KICAgIC5jb250YWluZXIgeyBtYXgtd2lkdGg6IDE2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmc6IDIwcHg7IH0KCiAgICBoZWFkZXIgewogICAgICAgIGRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW4tYm90dG9tOiA0MHB4OyBwb3NpdGlvbjogcmVsYXRpdmU7IGZsZXgtd3JhcDogd3JhcDsgZ2FwOiAyMHB4OwogICAgfQogICAgLnRpdGxlLWNvbnRhaW5lciB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIGdhcDogMTVweDsKICAgIH0KICAgIGhlYWRlciBoMiB7CiAgICAgICAgZm9udC1zaXplOiAyLjVyZW07IGZvbnQtd2VpZ2h0OiA3MDA7IG1hcmdpbjogMDsKICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoNDVkZWcsIHZhcigtLXlvY28tcHJpbWFyeSksICNmZmYpOwogICAgICAgIC13ZWJraXQtYmFja2dyb3VuZC1jbGlwOiB0ZXh0OyAtd2Via2l0LXRleHQtZmlsbC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICB9CiAgICAuaG93LXRvLWd1aWRlIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICB0cmFuc2l0aW9uOiBjb2xvciAwLjJzIGVhc2UtaW4tb3V0OwogICAgfQogICAgLmhvdy10by1ndWlkZTpob3ZlciB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAuaG93LXRvLWd1aWRlIC50b29sdGlwdGV4dCB7CiAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjsgd2lkdGg6IDEyMHB4OwogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOyB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgIHBhZGRpbmc6IDhweDsgYm9yZGVyLXJhZGl1czogNnB4OyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgei1pbmRleDogMTsgYm90dG9tOiAxNDAlOyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsgCiAgICAgIG9wYWNpdHk6IDA7IHRyYW5zaXRpb246IG9wYWNpdHkgMC4zczsKICAgIH0KICAgIC5ob3ctdG8tZ3VpZGU6aG92ZXIgLnRvb2x0aXB0ZXh0IHsKICAgICAgdmlzaWJpbGl0eTogdmlzaWJsZTsKICAgICAgb3BhY2l0eTogMTsKICAgIH0KICAgICNzZWNyZXRUcmlnZ2VyIHsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7CiAgICB9CiAgICAjc2F2ZVN0YXR1cyB7CiAgICAgICAgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDVweDsgbGVmdDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1ncmVlbik7IGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgICAgcGFkZGluZzogNXB4IDE1cHg7IGJvcmRlci1yYWRpdXM6IDIwcHg7IGZvbnQtc2l6ZTogMTRweDsKICAgICAgICBmb250LXdlaWdodDogNTAwOyBvcGFjaXR5OiAwOyB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuNXMgZWFzZS1pbi1vdXQ7CiAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICB9CiAgICAuc2Vzc2lvbi1zZXR0aW5ncywgLnByb2R1Y3QtZGVmYXVsdHMsIC5saWJyYXJ5LW1hbmFnZW1lbnQgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBib3JkZXItcmFkaXVzOiAxNnB4OyBwYWRkaW5nOiAzMHB4OyBtYXJnaW4tYm90dG9tOiA0MHB4OwogICAgICAgIGRpc3BsYXk6IGdyaWQ7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZml0LCBtaW5tYXgoMjUwcHgsIDFmcikpOwogICAgICAgIGdhcDogMjVweDsgYWxpZ24taXRlbXM6IGVuZDsKICAgIH0KICAgICAubGlicmFyeS1tYW5hZ2VtZW50IHsKICAgICAgICBwYWRkaW5nOiAyMHB4IDMwcHg7CiAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnI7IAogICAgfQogICAgLmxpYnJhcnktbWFuYWdlbWVudC1oZWFkZXIgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICAgICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgICAgZ2FwOiAxMHB4OwogICAgfQogICAgLmxpYnJhcnktbWFuYWdlbWVudC1oZWFkZXIgaDMgewogICAgICAgICBtYXJnaW46IDA7IGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgLmxpYnJhcnktY29udHJvbHMgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZ2FwOiAxNXB4OwogICAgICAgIGZsZXgtd3JhcDogd3JhcDsKICAgIH0KICAgIC5zZXNzaW9uLXNldHRpbmdzIGgzLCAucHJvZHVjdC1kZWZhdWx0cyBoMyB7IAogICAgICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7IG1hcmdpbjogMCAwIDEwcHggMDsgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IAogICAgfQogICAgLnByb2R1Y3QtZGVmYXVsdHMgewogICAgICAgIC8qIG1hcmdpbi10b3A6IC0yMHB4OyAqLyAvKiBSRU1PVkVEIC0gTm8gbG9uZ2VyIG5lZWRlZCBhZnRlciByZW1vdmluZyBzZXNzaW9uIGRlZmF1bHRzICovCiAgICB9CiAgICBmb3JtIHsKICAgICAgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maXQsIG1pbm1heCgyODBweCwgMWZyKSk7CiAgICAgIGdhcDogMjVweDsgcGFkZGluZzogMzBweDsgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1zdXJmYWNlKTsKICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOyBib3JkZXItcmFkaXVzOiAxNnB4OyBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOwogICAgICBtYXJnaW4tYm90dG9tOiA0MHB4OwogICAgfQogICAgLmZvcm0tZ3JvdXAgeyBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyB9CiAgICAuZHluYW1pYy1zZWN0aW9uIHsKICAgICAgICBncmlkLWNvbHVtbjogMSAvIC0xOyBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgIGdhcDogMTVweDsgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsgcGFkZGluZy10b3A6IDIwcHg7CiAgICB9CiAgICAudmFyaWFudHMtYW5kLXByaWNpbmctd3JhcHBlciB7CiAgICAgICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgICAgICBkaXNwbGF5OiBncmlkOwogICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDFmcjsKICAgICAgICBnYXA6IDI1cHg7CiAgICAgICAgYWxpZ24taXRlbXM6IHN0YXJ0OwogICAgICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgcGFkZGluZy10b3A6IDIwcHg7CiAgICB9CiAgICAjdmFyaWFudHMtY29sdW1uID4gZGl2IHsgbWFyZ2luLWJvdHRvbTogMjBweDsgfQogICAgLnZhcmlhbnQtZ3JvdXAtcm93LCAubW9kaWZpZXItZ3JvdXAtcm93IHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOyBwYWRkaW5nOiAxNXB4OyBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOyBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBnYXA6IDEwcHg7CiAgICAgICAgY3Vyc29yOiBncmFiOwogICAgfQogICAgLnZhcmlhbnQtZ3JvdXAtcm93OmdyYWJiaW5nIHsgY3Vyc29yOiBncmFiYmluZzsgfQogICAgLnZhcmlhbnQtb3B0aW9ucy1jb250YWluZXIgLnZhcmlhbnQtb3B0aW9uLXJvdyB7IGN1cnNvcjogZ3JhYjsgfQogICAgLnZhcmlhbnQtb3B0aW9ucy1jb250YWluZXIgLnZhcmlhbnQtb3B0aW9uLXJvdzpncmFiYmluZyB7IGN1cnNvcjogZ3JhYmJpbmc7IH0KCiAgICAudmFyaWFudC1ncm91cC1oZWFkZXIsIC5tb2RpZmllci1ncm91cC1oZWFkZXIgeyBkaXNwbGF5OiBmbGV4OyBnYXA6IDEwcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IH0KICAgIC52YXJpYW50LWdyb3VwLWhlYWRlciBpbnB1dCwgLm1vZGlmaWVyLWdyb3VwLWhlYWRlciBpbnB1dCB7IGZsZXgtZ3JvdzogMTsgfQogICAgLnZhcmlhbnQtb3B0aW9uLXJvdyB7IGRpc3BsYXk6IGdyaWQ7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIGF1dG87IGdhcDogMTBweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgcGFkZGluZy1sZWZ0OiAyMHB4O30KICAgIC5tb2RpZmllci1vcHRpb24tcm93IHsgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgMWZyIGF1dG87IGdhcDogMTBweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgcGFkZGluZy1sZWZ0OiAyMHB4O30KICAgIC52YXJpYW50LXByaWNpbmctcm93IHsgZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAyZnIgMWZyIDFmciBhdXRvOyBnYXA6IDEwcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IHBhZGRpbmctbGVmdDogMjBweDt9CiAgICAudmFyaWFudC1wcmljaW5nLXJvdyAuY29tYm8tbmFtZSB7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyB9CgogICAgLmJ0bi1hZGQtZHluYW1pYyB7IGFsaWduLXNlbGY6IGZsZXgtc3RhcnQ7IHBhZGRpbmc6IDhweCAxNnB4OyBmb250LXNpemU6IDE0cHg7IH0KICAgIC5keW5hbWljLWNvbnRyb2xzLXdyYXBwZXIgeyBkaXNwbGF5OiBmbGV4OyBnYXA6IDEwcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGZsZXgtd3JhcDogd3JhcDsgfQogICAgI3NpbmdsZS1wcm9kdWN0LW1vZGlmaWVyLWNvbnRyb2xzIHsgZGlzcGxheTogZmxleDsgZ2FwOiAxMHB4OyBhbGlnbi1pdGVtczogY2VudGVyOyB9CiAgICAuZm9ybS1hY3Rpb25zLWZvb3RlciB7CiAgICAgICAgZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW4tdG9wOiAxMHB4OyBncmlkLWNvbHVtbjogMSAvIC0xOyBnYXA6IDIwcHg7CiAgICB9CiAgICAucmVtZW1iZXItbWUtY29udGFpbmVyIHsKICAgICAgICBtYXJnaW4tcmlnaHQ6IGF1dG87IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogOHB4OwogICAgfQogICAgLnJlbWVtYmVyLW1lLWNvbnRhaW5lciBsYWJlbCB7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMDsgY3Vyc29yOiBwb2ludGVyOyB1c2VyLXNlbGVjdDogbm9uZTsKICAgIH0KICAgIC5pbnB1dC13cmFwcGVyIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgcGFkZGluZzogMCAxNHB4OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsKICAgICAgICB0cmFuc2l0aW9uOiBib3JkZXItY29sb3IgMC4ycywgYm94LXNoYWRvdyAwLjJzOwogICAgfQogICAgLmlucHV0LXdyYXBwZXI6Zm9jdXMtd2l0aGluIHsKICAgICAgICBvdXRsaW5lOiBub25lOwogICAgICAgIGJvcmRlci1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBib3gtc2hhZG93OiAwIDAgMCAzcHggcmdiYSgwLCAxNjMsIDI1NSwgMC4zKTsKICAgIH0KICAgIC5pbnB1dC13cmFwcGVyIGlucHV0IHsKICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICAgICAgb3V0bGluZTogbm9uZTsKICAgICAgICBwYWRkaW5nOiAxNHB4IDA7CiAgICAgICAgZmxleC1ncm93OiAxOwogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgICAgZm9udC1zaXplOiAxNnB4OwogICAgICAgIGZvbnQtZmFtaWx5OiAnUG9wcGlucycsIHNhbnMtc2VyaWY7CiAgICB9CiAgICAuZ2hvc3QtdGV4dCB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgICAgIG9wYWNpdHk6IDAuNzsKICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgICAgICB2aXNpYmlsaXR5OiBoaWRkZW47CiAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgICBwYWRkaW5nLWxlZnQ6IDAuNWNoOwogICAgfQogICAgbGFiZWwgeyBmb250LXdlaWdodDogNTAwOyBtYXJnaW4tYm90dG9tOiAxMHB4OyBmb250LXNpemU6IDE0cHg7IGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgfQogICAgbGFiZWwgLnJlcXVpcmVkLXN0YXIgeyBjb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgZm9udC13ZWlnaHQ6IGJvbGQ7IG1hcmdpbi1sZWZ0OiAycHg7IH0KICAgIGlucHV0LCBzZWxlY3QsIHRleHRhcmVhIHsKICAgICAgcGFkZGluZzogMTRweDsgYm9yZGVyLXJhZGl1czogOHB4OyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyYTJhMmE7IGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgIGZvbnQtc2l6ZTogMTZweDsgZm9udC1mYW1pbHk6ICdQb3BwaW5zJywgc2Fucy1zZXJpZjsKICAgICAgdHJhbnNpdGlvbjogYm9yZGVyLWNvbG9yIDAuMnMsIGJveC1zaGFkb3cgMC4ycywgYmFja2dyb3VuZC1jb2xvciAwLjJzOyByZXNpemU6IHZlcnRpY2FsOwogICAgfQogICAgc2VsZWN0IHsKICAgICAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAgICAgLW1vei1hcHBlYXJhbmNlOiBub25lOwogICAgICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJkYXRhOmltYWdlL3N2Zyt4bWwsJTNDc3ZnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zycgd2lkdGg9JzE2JyBoZWlnaHQ9JzE2JyBmaWxsPSclMjNiM2IzYjMnIHZpZXdCb3g9JzAgMCAxNiAxNiclM0UlM0NwYXRoIGZpbGwtcnVsZT0nZXZlbm9kZCcgZD0nTTEuNjQ2IDQuNjQ2YS41LjUgMCAwIDEgLjcwOCAwTDggMTAuMjkzbDUuNjQ2LTUuNjQ3YS41LjUgMCAwIDEgLjcwOCAuNzA4bC02IDZhLjUuNSAwIDAgMS0uNzA4IDBsLTYtNmEuNS41IDAgMCAxIDAtLjcwOHonLyUzRSUzQy9zdmclM0UiKTsKICAgICAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgICAgIGJhY2tncm91bmQtcG9zaXRpb246IHJpZ2h0IDE0cHggY2VudGVyOwogICAgICAgIGJhY2tncm91bmQtc2l6ZTogMTZweCAxNnB4OwogICAgfQogICAgaW5wdXQ6ZGlzYWJsZWQsIHNlbGVjdDpkaXNhYmxlZCwgdGV4dGFyZWE6ZGlzYWJsZWQgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjMzMzOyBjdXJzb3I6IG5vdC1hbGxvd2VkOyB9CiAgICBzZWxlY3Q6aW52YWxpZCB7IGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgfQogICAgaW5wdXQ6Zm9jdXMsIHNlbGVjdDpmb2N1cywgdGV4dGFyZWE6Zm9jdXMgewogICAgICAgIG91dGxpbmU6IG5vbmU7IGJvcmRlci1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBib3gtc2hhZG93OiAwIDAgMCAzcHggcmdiYSgwLCAxNjMsIDI1NSwgMC4zKTsKICAgIH0KICAgIGlucHV0LmlucHV0LWludmFsaWQsIHNlbGVjdC5pbnB1dC1pbnZhbGlkLCB0ZXh0YXJlYS5pbnB1dC1pbnZhbGlkIHsKICAgICAgICBib3JkZXItY29sb3I6IHZhcigtLXlvY28tcmVkKSAhaW1wb3J0YW50OwogICAgfQogICAgLmVycm9yLW1lc3NhZ2UgewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXJlZCk7CiAgICAgICAgZm9udC1zaXplOiAxM3B4OwogICAgICAgIG1hcmdpbi10b3A6IDZweDsKICAgIH0KICAgIGlucHV0OjpwbGFjZWhvbGRlciwgdGV4dGFyZWE6OnBsYWNlaG9sZGVyIHsgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyBvcGFjaXR5OiAwLjc7IH0KICAgIC5pbnB1dC13cmFwcGVyIGlucHV0W3R5cGU9Im51bWJlciJdIHsgLW1vei1hcHBlYXJhbmNlOiB0ZXh0ZmllbGQ7IH0KICAgIC5pbnB1dC13cmFwcGVyIGlucHV0W3R5cGU9Im51bWJlciJdOjotd2Via2l0LW91dGVyLXNwaW4tYnV0dG9uLAogICAgLmlucHV0LXdyYXBwZXIgaW5wdXRbdHlwZT0ibnVtYmVyIl06Oi13ZWJraXQtaW5uZXItc3Bpbi1idXR0b24gewogICAgICAgIC13ZWJraXQtYXBwZWFyYW5jZTogbm9uZTsKICAgICAgICBtYXJnaW46IDA7CiAgICB9CiAgICAudGFibGUtY29udGFpbmVyIHsKICAgICAgICBvdmVyZmxvdy14OiBhdXRvOyBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UpOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsgYm9yZGVyLXJhZGl1czogMTZweDsgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93KTsKICAgIH0KICAgIHRhYmxlIHsgd2lkdGg6IDEwMCU7IGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7IH0KICAgIHRoLCB0ZCB7IHBhZGRpbmc6IDE2cHggMjBweDsgdGV4dC1hbGlnbjogbGVmdDsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsgZm9udC1zaXplOiAxNHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyB9CiAgICB0cjpsYXN0LWNoaWxkIHRkIHsgYm9yZGVyLWJvdHRvbTogbm9uZTsgfQogICAgdGggewogICAgICBiYWNrZ3JvdW5kOiAjMmEyYTJhOyBmb250LXdlaWdodDogNjAwOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOyBmb250LXNpemU6IDEycHg7IGxldHRlci1zcGFjaW5nOiAwLjhweDsKICAgIH0KICAgIHRib2R5IHRyIHsgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzIGVhc2UtaW4tb3V0OyB9CiAgICB0Ym9keSB0cjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6ICMyYzJjMmMgIWltcG9ydGFudDsgfQogICAgdGJvZHkgdHIubmV3LXJvdyB7IGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMTYzLCAyNTUsIDAuMik7IHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC41cyBlYXNlLWluLW91dDsgfQogICAgdGJvZHkgdHIuZWRpdGluZy1yb3cgeyBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMTkzLCA3LCAwLjIpOyB9CiAgICB0Ym9keSB0ci5ncm91cC1hIHsgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAxNjMsIDI1NSwgMC4wNSk7IH0KICAgIHRib2R5IHRyLmdyb3VwLWIgeyBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgfQogICAgYnV0dG9uIHsKICAgICAgcGFkZGluZzogMTRweCAyOHB4OyBib3JkZXI6IG5vbmU7IGJvcmRlci1yYWRpdXM6IDhweDsgY3Vyc29yOiBwb2ludGVyOwogICAgICBmb250LXNpemU6IDE2cHg7IGZvbnQtd2VpZ2h0OiA2MDA7IGZvbnQtZmFtaWx5OiAnUG9wcGlucycsIHNhbnMtc2VyaWY7CiAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UtaW4tb3V0OwogICAgfQogICAgYnV0dG9uOmhvdmVyIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0zcHgpOyBib3gtc2hhZG93OiAwIDhweCAxNnB4IHJnYmEoMCwwLDAsMC4zKTsgfQogICAgYnV0dG9uOmRpc2FibGVkIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMzMzICFpbXBvcnRhbnQ7CiAgICAgICAgY29sb3I6ICM3NzcgIWltcG9ydGFudDsKICAgICAgICBjdXJzb3I6IG5vdC1hbGxvd2VkOwogICAgICAgIHRyYW5zZm9ybTogbm9uZTsKICAgICAgICBib3gtc2hhZG93OiBub25lOwogICAgICAgIGJvcmRlci1jb2xvcjogIzMzMyAhaW1wb3J0YW50OwogICAgfQogICAgLmJ0bi1hZGQsIC5idG4tdXBkYXRlIHsgYmFja2dyb3VuZDogdmFyKC0teW9jby1wcmltYXJ5KTsgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsgfQogICAgLmJ0bi1hZGQ6aG92ZXIsIC5idG4tdXBkYXRlOmhvdmVyIHsgYmFja2dyb3VuZDogdmFyKC0teW9jby1wcmltYXJ5LWhvdmVyKTsgfQogICAgLmJ0bi1leHBvcnQsIC5idG4taW1wb3J0IHsgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7IGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOyB9CiAgICAuYnRuLWV4cG9ydDpob3ZlciwgLmJ0bi1pbXBvcnQ6aG92ZXIgeyBiYWNrZ3JvdW5kOiB2YXIoLS15b2NvLXByaW1hcnkpOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOyB9CiAgICAuYnRuLWNsZWFyIHsKICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgY29sb3I6IHZhcigtLXlvY28tcmVkKTsgYm9yZGVyOiAycHggc29saWQgdmFyKC0teW9jby1yZWQpOyBwYWRkaW5nOiAxMnB4IDE0cHg7CiAgICB9CiAgICAuYnRuLWNsZWFyOmhvdmVyIHsgYmFja2dyb3VuZDogdmFyKC0teW9jby1yZWQpOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOyB9CiAgICAuYnRuLWNsZWFyIHN2ZywgLmJ0bi1lZGl0IHN2ZywgLmJ0bi1yZW1vdmUgc3ZnIHsgdHJhbnNpdGlvbjogZmlsbCAwLjJzOyB9CiAgICAuYnRuLWNsZWFyIHN2ZyB7IGZpbGw6IHZhcigtLXlvY28tcmVkKTsgfQogICAgLmJ0bi1jbGVhcjpob3ZlciBzdmcgeyBmaWxsOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7IH0KICAgIC5idG4tZWRpdCwgLmJ0bi1yZW1vdmUgewogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgcGFkZGluZzogNXB4OyBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgIHdpZHRoOiAzMnB4OyBoZWlnaHQ6IDMycHg7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgfQogICAgLmJ0bi1lZGl0IHN2ZywgLmJ0bi1yZW1vdmUgc3ZnIHsgZmlsbDogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7IH0KICAgIC5idG4tZWRpdDpob3ZlciBzdmcgeyBmaWxsOiB2YXIoLS15b2NvLXByaW1hcnkpOyB9CiAgICAuYnRuLXJlbW92ZTpob3ZlciBzdmcgeyBmaWxsOiB2YXIoLS15b2NvLXJlZCk7IH0KICAgIC5idG4tZWRpdDpob3ZlciB7IAogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDE2MywgMjU1LCAwLjEpOyAKICAgICAgdHJhbnNmb3JtOiBub25lOyAKICAgICAgYm94LXNoYWRvdzogbm9uZTsKICAgIH0KICAgIC52YXJpYW50LWdyb3VwLXJvdyAuYnRuLXJlbW92ZTpob3ZlciBzdmcsIC52YXJpYW50LW9wdGlvbi1yb3cgLmJ0bi1yZW1vdmU6aG92ZXIgc3ZnIHsKICAgICAgZmlsbDogdmFyKC0teW9jby1yZWQpOwogICAgfQogICAgLnZhcmlhbnQtZ3JvdXAtcm93IC5idG4tcmVtb3ZlOmhvdmVyLCAudmFyaWFudC1vcHRpb24tcm93IC5idG4tcmVtb3ZlOmhvdmVyIHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyMzUsIDg3LCA4NywgMC4xKTsKICAgIH0KICAgIC5idG4tcmVtb3ZlOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyMzUsIDg3LCA4NywgMC4xKTsgdHJhbnNmb3JtOiBub25lOyBib3gtc2hhZG93OiBub25lOyB9CiAgICAuYnRuLW1hbmFnZW1lbnQgewogICAgICAgIHBhZGRpbmc6IDEwcHggMjBweDsKICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICB9CiAgICAuYWN0aW9ucy1jZWxsIHsgZGlzcGxheTogZmxleDsgZ2FwOiA4cHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IH0KICAgIC5idXR0b24tY29udGFpbmVyIHsgbWFyZ2luLXRvcDogMjBweDsgZGlzcGxheTogZmxleDsgZ2FwOiAxNXB4OyBhbGlnbi1pdGVtczogY2VudGVyOyBmbGV4LXdyYXA6IHdyYXA7IH0KICAgIC50b29sdGlwIHsgcG9zaXRpb246IHJlbGF0aXZlOyBjdXJzb3I6IGhlbHA7IH0KICAgIC50b29sdGlwIC50b29sdGlwdGV4dCB7CiAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjsgd2lkdGg6IDI4MHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICB0ZXh0LWFsaWduOiBsZWZ0OyBwYWRkaW5nOiAxMnB4OyBib3JkZXItcmFkaXVzOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgcG9zaXRpb246IGFic29sdXRlOyB6LWluZGV4OiAxMDsgYm90dG9tOiAxMjUlOyBsZWZ0OiA1MCU7IG1hcmdpbi1sZWZ0OiAtMTQwcHg7IG9wYWNpdHk6IDA7CiAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4zczsgZm9udC13ZWlnaHQ6IDQwMDsgZm9udC1zaXplOiAxM3B4OyBsaW5lLWhlaWdodDogMS42OwogICAgICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwwLDAsMC40KTsKICAgIH0KICAgIC50b29sdGlwIC50b29sdGlwdGV4dDo6YWZ0ZXIgewogICAgICBjb250ZW50OiAiIjsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDEwMCU7IGxlZnQ6IDUwJTsgbWFyZ2luLWxlZnQ6IC01cHg7CiAgICAgIGJvcmRlci13aWR0aDogNXB4OyBib3JkZXItc3R5bGU6IHNvbGlkOyBib3JkZXItY29sb3I6ICMyYTJhMmEgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQ7CiAgICB9CiAgICAudG9vbHRpcDpob3ZlciAudG9vbHRpcHRleHQgeyB2aXNpYmlsaXR5OiB2aXNpYmxlOyBvcGFjaXR5OiAxOyB9CiAgICAudGFibGUtZm9vdGVyIHsgZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsgZ2FwOiAxNXB4OyBtYXJnaW4tdG9wOiAyMHB4OyB9CgogICAgLmxpc3QtY29udGFpbmVyIHsKICAgICAgICBtYXJnaW4tdG9wOiA0MHB4OwogICAgfQogICAgLnRhYnMgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBtYXJnaW4tYm90dG9tOiAtMXB4OyAvKiBPdmVybGFwIGJvcmRlciAqLwogICAgfQogICAgLnRhYi1saW5rIHsKICAgICAgICBwYWRkaW5nOiAxMnB4IDI0cHg7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogM3B4IHNvbGlkIHRyYW5zcGFyZW50OwogICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UtaW4tb3V0OwogICAgICAgIHRyYW5zZm9ybTogbm9uZTsgLyogT3ZlcnJpZGUgZ2VuZXJhbCBidXR0b24gaG92ZXIgKi8KICAgICAgICBib3gtc2hhZG93OiBub25lOyAvKiBPdmVycmlkZSBnZW5lcmFsIGJ1dHRvbiBob3ZlciAqLwogICAgfQogICAgLnRhYi1saW5rOmhvdmVyIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgfQogICAgLnRhYi1saW5rLmFjdGl2ZSB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICAgICAgYm9yZGVyLWJvdHRvbTogM3B4IHNvbGlkIHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAudGFiLWNvbnRlbnQgewogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CiAgICAudGFiLWNvbnRlbnQuYWN0aXZlIHsKICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgIH0KCiAgICAuc2VhcmNoLWNvbnRhaW5lciB7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMjBweDsKICAgIH0KCiAgICAuc2VhcmNoLWNvbnRhaW5lciBpbnB1dFt0eXBlPSJzZWFyY2giXSB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgbWF4LXdpZHRoOiA0MDBweDsKICAgICAgICBwYWRkaW5nOiAxMnB4IDE0cHg7IC8qIFNsaWdodGx5IHNtYWxsZXIgcGFkZGluZyAqLwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICB9CgogICAgLnNlYXJjaC1jb250YWluZXIgaW5wdXRbdHlwZT0ic2VhcmNoIl06Zm9jdXMgewogICAgICAgIG91dGxpbmU6IG5vbmU7CiAgICAgICAgYm9yZGVyLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDNweCByZ2JhKDAsIDE2MywgMjU1LCAwLjMpOwogICAgfQoKCiAgICAubW9kYWwtb3ZlcmxheSB7CiAgICAgICAgcG9zaXRpb246IGZpeGVkOyB0b3A6IDA7IGxlZnQ6IDA7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgxOCwgMTgsIDE4LCAwLjg1KTsKICAgICAgICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoOHB4KTsKICAgICAgICAtd2Via2l0LWJhY2tkcm9wLWZpbHRlcjogYmx1cig4cHgpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogY2VudGVyOyBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIHotaW5kZXg6IDEwMDA7IG9wYWNpdHk6IDA7IHBvaW50ZXItZXZlbnRzOiBub25lOyB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuM3MgZWFzZTsKICAgIH0KICAgIC5tb2RhbC1vdmVybGF5LnNob3cgeyBvcGFjaXR5OiAxOyBwb2ludGVyLWV2ZW50czogYXV0bzsgfQogICAgLm1vZGFsLWNvbnRlbnQgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICAgICAgcGFkZGluZzogMzBweDsgYm9yZGVyLXJhZGl1czogMTZweDsgbWluLXdpZHRoOiAzMjBweDsgbWF4LXdpZHRoOiA1MDBweDsgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC45KTsgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuM3MgZWFzZTsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICB9CiAgICAubW9kYWwtb3ZlcmxheS5zaG93IC5tb2RhbC1jb250ZW50IHsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgfQogICAgLm1vZGFsLWNvbnRlbnQgcCB7IG1hcmdpbjogMCAwIDIwcHggMDsgZm9udC1zaXplOiAxNnB4OyBsaW5lLWhlaWdodDogMS42OyB3aGl0ZS1zcGFjZTogcHJlLXdyYXA7IH0KICAgIC5tb2RhbC1hY3Rpb25zIHsgZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGdhcDogMTVweDsgfQogICAgLm1vZGFsLWNvbnRlbnQuZXJyb3IgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjNDQxYzI0OyBjb2xvcjogI2Y4ZDdkYTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1yZWQpOyB9CiAgICAubW9kYWwtY29udGVudC53YXJuaW5nIHsgYmFja2dyb3VuZC1jb2xvcjogIzRkNDIxYTsgY29sb3I6ICNmZmYzY2Q7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28teWVsbG93KTsgfQogICAgCiAgICAvKiAqLwogICAgLmxpYnJhcnktbW9kYWwtbWVudSB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgIGdhcDogMTVweDsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0OwogICAgfQogICAgLmxpYnJhcnktbW9kYWwtbWVudSBidXR0b24gewogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDsKICAgICAgICBwYWRkaW5nOiAxOHB4IDI0cHg7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICB9CiAgICAubGlicmFyeS1tb2RhbC1tZW51IGJ1dHRvbjpob3ZlciB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzMzMzsKICAgICAgICBib3JkZXItY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CgoKICAgICNtb2RpZmllck1vZGFsIC5tb2RhbC1jb250ZW50LCAjbGlua01vZGlmaWVyTW9kYWwgLm1vZGFsLWNvbnRlbnQsIAogICAgLnByZXNldC1tb2RhbCAubW9kYWwtY29udGVudCB7IAogICAgICAgIG1heC13aWR0aDogODAwcHg7IHRleHQtYWxpZ246IGxlZnQ7IAogICAgfQogICAgI2VkaXRNb2RpZmllckdyb3Vwc0NvbnRhaW5lciwgI2xpbmtNb2RpZmllckxpc3RDb250YWluZXIsIAogICAgLnByZXNldC1saXN0LWNvbnRhaW5lciwgLnByZXNldC1lZGl0LWNvbnRhaW5lciB7IAogICAgICAgIG1heC1oZWlnaHQ6IDQwdmg7IG92ZXJmbG93LXk6IGF1dG87IHBhZGRpbmctcmlnaHQ6IDEwcHg7CiAgICB9CiAgICAubW9kYWwtc2VjdGlvbi1kaXZpZGVyIHsKICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIHBhZGRpbmctYm90dG9tOiAxNXB4OwogICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICB9CiAgICAjbGlua01vZGlmaWVyTGlzdENvbnRhaW5lciAubW9kaWZpZXItbGluay1pdGVtIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDE1cHg7IHBhZGRpbmc6IDhweDsKICAgIH0KICAgICNsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyIC5tb2RpZmllci1saW5rLWl0ZW06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOyBib3JkZXItcmFkaXVzOiA0cHg7IH0KICAgICNsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyIC5tb2RpZmllci1saW5rLWl0ZW0gaW5wdXRbdHlwZT0iY2hlY2tib3giXSB7IHdpZHRoOiAxOHB4OyBoZWlnaHQ6IDE4cHg7IH0KCiAgICAubW9kaWZpZXItaW5kaWNhdG9yIHsKICAgICAgICBkaXNwbGF5OiBpbmxpbmUtZmxleDsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgd2lkdGg6IDIycHg7IGhlaWdodDogMjJweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWdyZWVuKTsgY29sb3I6IHdoaXRlOyBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgZm9udC1zaXplOiAxMnB4OyBmb250LXdlaWdodDogNjAwOwogICAgICAgIGZsZXgtc2hyaW5rOiAwOwogICAgfQogICAgLm1vZGlmaWVyLWluZGljYXRvci13cmFwcGVyLnRvb2x0aXAgeyBib3JkZXItYm90dG9tOiBub25lOyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IH0KICAgIC5tb2RpZmllci1pbmRpY2F0b3Itd3JhcHBlciAudG9vbHRpcHRleHQgeyBtaW4td2lkdGg6IDIwMHB4OyBtYXJnaW4tbGVmdDogLTEwMHB4OyB9CgogICAgLnByaWNpbmctY29udHJvbHMgewogICAgICAgIGRpc3BsYXk6IGZsZXg7IGdhcDogMTBweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4OyBwYWRkaW5nOiAxMHB4OwogICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyYTJhMmE7IGJvcmRlci1yYWRpdXM6IDhweDsKICAgIH0KICAgIC5wcmljaW5nLWNvbnRyb2xzIHNlbGVjdCB7CiAgICAgICAgZmxleC1ncm93OiAxOwogICAgfQogICAgLnByaWNpbmctY29udHJvbHMgaW5wdXQgeyAKICAgICAgICBmbGV4LWdyb3c6IDE7IAogICAgfQoKICAgICNidWxrTW9kaWZpZXJMaW5rZXIgewogICAgICAgIHBhZGRpbmc6IDE1cHg7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICB9CgogICAgI2J1bGtNb2RpZmllckNoZWNrYm94Q29udGFpbmVyIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgZ2FwOiAxMHB4OwogICAgICAgIG1heC1oZWlnaHQ6IDE1MHB4OwogICAgICAgIG92ZXJmbG93LXk6IGF1dG87CiAgICAgICAgcGFkZGluZzogMTBweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWJnKTsKICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICAgIH0KCiAgICAudG9vbHRpcCAudG9vbHRpcHRleHQud2l0aC1naWYgewogICAgICAgIHdpZHRoOiA4NTBweDsKICAgICAgICBtYXJnaW4tbGVmdDogLTIyNXB4OwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBnYXA6IDE1cHg7CiAgICB9CiAgICAudG9vbHRpcC10ZXh0LWNvbnRlbnQgewogICAgICAgIGZsZXg6IDE7CiAgICB9CiAgICAudG9vbHRpcC1naWYgewogICAgICAgIHdpZHRoOiAxMDAwcHg7CiAgICAgICAgaGVpZ2h0OiA1MDA7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgfQoKICAgIC5oaWRkZW4gewogICAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7CiAgICB9CgogICAgLmJ0bi1saW5rIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsKICAgICAgICBwYWRkaW5nOiA1cHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgIHdpZHRoOiAzMnB4OwogICAgICAgIGhlaWdodDogMzJweDsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICB9CiAgICAuYnRuLWxpbmsgc3ZnIHsKICAgICAgICBmaWxsOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsKICAgICAgICB0cmFuc2l0aW9uOiBmaWxsIDAuMnM7CiAgICB9CiAgICAuYnRuLWxpbms6aG92ZXIgc3ZnIHsKICAgICAgICBmaWxsOiB2YXIoLS15b2NvLWdyZWVuKTsKICAgIH0KICAgIC5idG4tbGluazpob3ZlciB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzOSwgMTc0LCA5NiwgMC4xKTsKICAgICAgICB0cmFuc2Zvcm06IG5vbmU7CiAgICAgICAgYm94LXNoYWRvdzogbm9uZTsKICAgIH0KICAgIC5oaWdobGlnaHQtcm93IHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDEwMCwgMjU1LCAwLjMpICFpbXBvcnRhbnQ7CiAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjVzIGVhc2UtaW4tb3V0OwogICAgfQoKICAgIC5yYXctaXRlbS1pbmRpY2F0b3IgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ncmVlbik7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tZ3JlZW4pOwogICAgICAgIHBhZGRpbmc6IDNweCA4cHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogMTJweDsKICAgICAgICBmb250LXNpemU6IDEycHg7CiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICAgIGN1cnNvcjogZGVmYXVsdDsKICAgIH0KCgogICAgLyogLS0tIEhPVkVSIEJPQVJEIFNUWUxFUyAtLS0gKi8KICAgICNob3Zlci1ib2FyZCB7CiAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgIGJvdHRvbTogMjBweDsKICAgICAgICByaWdodDogMjBweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UpOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBib3JkZXItcmFkaXVzOiAxMnB4OwogICAgICAgIHBhZGRpbmc6IDRweDsKICAgICAgICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3cpOwogICAgICAgIHotaW5kZXg6IDk1MDsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGdhcDogNHB4OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZS1pbi1vdXQ7CiAgICAgICAgb3BhY2l0eTogMC42OwogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgxMHB4KTsKICAgIH0KCiAgICAjaG92ZXItYm9hcmQ6aG92ZXIgewogICAgICAgIG9wYWNpdHk6IDE7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKDApOwogICAgfQoKICAgIC5ob3Zlci1ib2FyZC1saW5rIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOwogICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICBmb250LXdlaWdodDogNTAwOwogICAgICAgIHBhZGRpbmc6IDZweCAxMHB4OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMsIGNvbG9yIDAuMnM7CiAgICB9CgogICAgLmhvdmVyLWJvYXJkLWxpbms6aG92ZXIgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyYTJhMmE7IC8qIEZhbGxiYWNrIGZvciB3aGVuIHZhciBpcyBub3QgYXZhaWxhYmxlICovCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1iZy1hbHQsICMyYTJhMmEpOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICB9CgogICAgI3Njcm9sbFRvVG9wQnRuLmhvdmVyLWJvYXJkLWxpbmssICNzY3JvbGxUb0JvdHRvbUJ0bi5ob3Zlci1ib2FyZC1saW5rIHsKICAgICAgICBiYWNrZ3JvdW5kOiBub25lOwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgcGFkZGluZzogNnB4OwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIH0KCiAgICAjc2Nyb2xsVG9Ub3BCdG4uaG92ZXItYm9hcmQtbGluayBzdmcsICNzY3JvbGxUb0JvdHRvbUJ0bi5ob3Zlci1ib2FyZC1saW5rIHN2ZyB7CiAgICAgICAgdHJhbnNpdGlvbjogZmlsbCAwLjJzOwogICAgICAgIGZpbGw6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgfQoKICAgICNzY3JvbGxUb1RvcEJ0bi5ob3Zlci1ib2FyZC1saW5rOmhvdmVyIHN2ZywgI3Njcm9sbFRvQm90dG9tQnRuLmhvdmVyLWJvYXJkLWxpbms6aG92ZXIgc3ZnIHsKICAgICAgICBmaWxsOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICB9CgoKICAgIEBtZWRpYSAobWF4LXdpZHRoOiA5OTJweCkgewogICAgICAgIC52YXJpYW50cy1hbmQtcHJpY2luZy13cmFwcGVyIHsKICAgICAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnI7CiAgICAgICAgfQogICAgfQoKICAgIEBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkgewogICAgICAgIGJvZHkgeyBwYWRkaW5nOiAxMHB4OyB9CiAgICAgICAgLmNvbnRhaW5lciB7IHBhZGRpbmc6IDEwcHg7IH0KICAgICAgICBoZWFkZXIgeyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogZmxleC1zdGFydDsgZ2FwOiAyMHB4OyB9CiAgICAgICAgaGVhZGVyIGgyIHsgZm9udC1zaXplOiAycmVtOyB9CiAgICAgICAgLnNlc3Npb24tc2V0dGluZ3MsIC5wcm9kdWN0LWRlZmF1bHRzLCBmb3JtIHsgCiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHg7IAogICAgICAgICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmcjsgCiAgICAgICAgfQogICAgICAgIC5saWJyYXJ5LW1hbmFnZW1lbnQgeyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmcjsgfQogICAgICAgIC5saWJyYXJ5LW1hbmFnZW1lbnQtaGVhZGVyIHsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7IH0KICAgICAgICAubGlicmFyeS1jb250cm9scyB7IHdpZHRoOiAxMDAlOyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyB9CiAgICAgICAgLmxpYnJhcnktY29udHJvbHMgYnV0dG9uIHsgd2lkdGg6IDEwMCU7IH0KICAgICAgICAudmFyaWFudC1ncm91cC1oZWFkZXIsIC52YXJpYW50LW9wdGlvbi1yb3csIC52YXJpYW50LXByaWNpbmctcm93LCAubW9kaWZpZXItZ3JvdXAtaGVhZGVyLCAubW9kaWZpZXItb3B0aW9uLXJvdyB7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyOyBnYXA6IDE1cHg7IH0KICAgICAgICB0aCwgdGQgeyBwYWRkaW5nOiAxMnB4IDEwcHg7IGZvbnQtc2l6ZTogMTNweDsgfQogICAgICAgIC5idXR0b24tY29udGFpbmVyIHsgd2lkdGg6IDEwMCU7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IH0KICAgICAgICAuYnV0dG9uLWNvbnRhaW5lciBidXR0b24geyB3aWR0aDogMTAwJTsgfQogICAgICAgIC5mb3JtLWFjdGlvbnMtZm9vdGVyIHsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IH0KICAgICAgICAuZm9ybS1hY3Rpb25zLWZvb3RlciBidXR0b24geyB3aWR0aDogMTAwJTsgfQogICAgfQogICAvKiAtLS0gTkVXIFNUWUxFUyBCTE9DSyBUTyBBREQgLS0tICovCgovKiAtLS0gVHV0b3JpYWwgU3R5bGVzIC0tLSAqLwoubW9kYWwtYmFja2Ryb3AgewogICAgcG9zaXRpb246IGZpeGVkOwogICAgdG9wOiAwOwogICAgbGVmdDogMDsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiAxMDAlOwogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjcpOwogICAgZGlzcGxheTogbm9uZTsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHotaW5kZXg6IDEwMDAwOwp9Ci5tb2RhbC1iYWNrZHJvcC5zaG93IHsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KLm1vZGFsLWJhY2tkcm9wIC5tb2RhbC1jb250ZW50IHsKICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICBwYWRkaW5nOiAycmVtOwogICAgYm9yZGVyLXJhZGl1czogMC43NXJlbTsKICAgIHdpZHRoOiA5MCU7CiAgICBtYXgtd2lkdGg6IDUwMHB4OwogICAgYm94LXNoYWRvdzogMCAxMHB4IDMwcHggcmdiYSgwLDAsMCwwLjUpOwogICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwp9CiAubW9kYWwtYmFja2Ryb3AgLm1vZGFsLWNvbnRlbnQgaDMgewogICAgZm9udC1zaXplOiAxLjVyZW07CiAgICBtYXJnaW4tYm90dG9tOiAxcmVtOwogICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKIH0KIC5tb2RhbC1iYWNrZHJvcCAubW9kYWwtY29udGVudCBwIHsKICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsKICAgIG1hcmdpbi1ib3R0b206IDJyZW07CiB9CiAubW9kYWwtYnV0dG9ucyB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICBnYXA6IDFyZW07CiB9CgoudHV0b3JpYWwtb3ZlcmxheSB7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICB6LWluZGV4OiA5OTk4OwogICAgZGlzcGxheTogbm9uZTsKfQoudHV0b3JpYWwtb3ZlcmxheS1wYXJ0IHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC44NSk7CiAgICB0cmFuc2l0aW9uOiBhbGwgMC40cyBlYXNlLWluLW91dDsKfQouaGlnaGxpZ2h0LWVsZW1lbnQgewogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgei1pbmRleDogOTk5OTsKICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgIHBhZGRpbmc6IDVweDsgLyogVGhpcyBuZXcgbGluZSBhZGRzIHNwYWNlIGFyb3VuZCB0aGUgaWNvbiAqLwogICAgdHJhbnNpdGlvbjogYm94LXNoYWRvdyAwLjNzIGVhc2UtaW4tb3V0OwogICAgYm94LXNoYWRvdzogMCAwIDE1cHggNXB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNyk7CiAgICBhbmltYXRpb246IHB1bHNlLWdsb3cgMnMgaW5maW5pdGUgZWFzZS1pbi1vdXQ7Cn0KLnR1dG9yaWFsLXBvcG92ZXIgewogICAgcG9zaXRpb246IGZpeGVkOyAKICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICBjb2xvcjogI0ZGRkZGRjsKICAgIHBhZGRpbmc6IDA7CiAgICBib3JkZXItcmFkaXVzOiAwLjhyZW07CiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgei1pbmRleDogMTAwMDE7CiAgICB3aWR0aDogOTAlOwogICAgbWF4LXdpZHRoOiAzODBweDsKICAgIGJveC1zaGFkb3c6IDAgMTBweCA0MHB4IHJnYmEoMCwwLDAsMC43KSwgMCAwIDMwcHggcmdiYSgwLCAxNjMsIDI1NSwgMC41KTsKICAgIGFuaW1hdGlvbjogZmFkZUluUG9wb3ZlciAwLjRzIGVhc2Utb3V0IGZvcndhcmRzOwogICAgZGlzcGxheTogbm9uZTsKfQoudHV0b3JpYWwtcG9wb3Zlci1oZWFkZXIgewogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAxNjMsIDI1NSwgMC4xKTsKICAgIHBhZGRpbmc6IDFyZW0gMS41cmVtOwogICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgIGZvbnQtc2l6ZTogMS4xcmVtOwogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIGdhcDogMC43NXJlbTsKICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwp9Ci50dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQgewogICAgcGFkZGluZzogMS41cmVtOwogICAgZm9udC1zaXplOiAxLjA1cmVtOwogICAgbGluZS1oZWlnaHQ6IDEuNjsKfQoudHV0b3JpYWwtcG9wb3Zlci1jb250ZW50IGIgewogICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICBmb250LXdlaWdodDogNjAwOwp9Ci50dXRvcmlhbC1wb3BvdmVyLW5hdiB7CiAgICBwYWRkaW5nOiAxcmVtIDEuNXJlbTsKICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwwLDAsMC4yKTsKICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKfQoudHV0b3JpYWwtcG9wb3Zlcjo6YWZ0ZXIgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBib3JkZXItd2lkdGg6IDEwcHg7CiAgICBib3JkZXItc3R5bGU6IHNvbGlkOwogICAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudDsKfQoudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy10b3A6OmFmdGVyIHsgYm90dG9tOiAxMDAlOyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsgYm9yZGVyLWJvdHRvbS1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgfQoudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy1ib3R0b206OmFmdGVyIHsgdG9wOiAxMDAlOyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsgYm9yZGVyLXRvcC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgfQoudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy1sZWZ0OjphZnRlciB7IHJpZ2h0OiAxMDAlOyB0b3A6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOyBib3JkZXItcmlnaHQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IH0KLnR1dG9yaWFsLXBvcG92ZXIuYXJyb3ctcmlnaHQ6OmFmdGVyIHsgbGVmdDogMTAwJTsgdG9wOiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsgYm9yZGVyLWxlZnQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IH0KCkBrZXlmcmFtZXMgZmFkZUluUG9wb3ZlciB7IGZyb20geyBvcGFjaXR5OiAwOyB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOyB9IHRvIHsgb3BhY2l0eTogMTsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgfSB9CkBrZXlmcmFtZXMgcHVsc2UtZ2xvdyB7IDAlLCAxMDAlIHsgYm94LXNoYWRvdzogMCAwIDE1cHggNXB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNyk7IH0gNTAlIHsgYm94LXNoYWRvdzogMCAwIDI1cHggMTBweCByZ2JhKDAsIDE2MywgMjU1LCAwLjcpOyB9IH0KICAKLyogU21hcnQgdG9vbHRpcCBwaW5uZWQvb3BlbiBzdGF0ZXMgKi8KLnRvb2x0aXAuaXMtb3BlbiAudG9vbHRpcHRleHQsCi50b29sdGlwOmZvY3VzLXdpdGhpbiAudG9vbHRpcHRleHQgeyB2aXNpYmlsaXR5OiB2aXNpYmxlOyBvcGFjaXR5OiAxOyB9CgovKiBUb29sdGlwIGJ1YmJsZSBlbmhhbmNlbWVudHMgKi8KLnRvb2x0aXAgLnRvb2x0aXB0ZXh0IHsKICBtYXgtd2lkdGg6IG1pbig0NjBweCwgOTJ2dyk7CiAgbWF4LWhlaWdodDogbWluKDUwdmgsIDQyMHB4KTsKICBvdmVyZmxvdzogYXV0bzsKICBwYWRkaW5nOiAxMnB4IDE0cHg7CiAgbGluZS1oZWlnaHQ6IDEuMzU7CiAgd29yZC13cmFwOiBicmVhay13b3JkOwogIG92ZXJmbG93LXdyYXA6IGFueXdoZXJlOwogIHotaW5kZXg6IDEwMDEwOwp9Ci8qIFBvc2l0aW9uYWwgaGVscGVycyAqLwoudG9vbHRpcCAudG9vbHRpcHRleHQucG9zLXRvcCAgICB7IHRvcDogYXV0bzsgYm90dG9tOiAxMjUlOyBsZWZ0OiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsgcmlnaHQ6IGF1dG87IH0KLnRvb2x0aXAgLnRvb2x0aXB0ZXh0LnBvcy1ib3R0b20geyBib3R0b206IGF1dG87IHRvcDogMTI1JTsgbGVmdDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7IHJpZ2h0OiBhdXRvOyB9Ci50b29sdGlwIC50b29sdGlwdGV4dC5wb3MtbGVmdCAgIHsgdG9wOiA1MCU7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsgbGVmdDogYXV0bzsgcmlnaHQ6IGNhbGMoMTAwJSArIDEycHgpOyBib3R0b206IGF1dG87IH0KLnRvb2x0aXAgLnRvb2x0aXB0ZXh0LnBvcy1yaWdodCAgeyB0b3A6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOyBsZWZ0OiBjYWxjKDEwMCUgKyAxMnB4KTsgcmlnaHQ6IGF1dG87IGJvdHRvbTogYXV0bzsgfQoKPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KPGhlYWRlcj4KPGRpdiBjbGFzcz0idGl0bGUtY29udGFpbmVyIj4KPGEgYXJpYS1sYWJlbD0iVmlldyBQcm9kdWN0IExvYWRlciDigJQgSG93LVRvIEd1aWRlIiBjbGFzcz0iaG93LXRvLWd1aWRlIGJ0biBidG4tc2Vjb25kYXJ5IGJ0bi1pY29uIHRvb2x0aXAiIGhyZWY9Imh0dHBzOi8vZHJpdmUuZ29vZ2xlLmNvbS9maWxlL2QvMXdKdnk4V3VQSlRwN3N6M0ZhdW5zaGVjOTZkcTBQUUlxL3ZpZXc/dXNwPWRyaXZlX2xpbmsiIGlkPSJob3dUb0d1aWRlTGluayIgcmVsPSJub29wZW5lciBub3JlZmVycmVyIiByb2xlPSJidXR0b24iIHRhcmdldD0iX2JsYW5rIj4KPHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjI0IiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIHZpZXdib3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xNCAySDZhMiAyIDAgMCAwLTIgMnYxNmEyIDIgMCAwIDAgMiAyaDEyYTIgMiAwIDAgMCAyLTJWOHoiPjwvcGF0aD48cG9seWxpbmUgcG9pbnRzPSIxNCAyIDE0IDggMjAgOCI+PC9wb2x5bGluZT48bGluZSB4MT0iMTYiIHgyPSI4IiB5MT0iMTMiIHkyPSIxMyI+PC9saW5lPjxsaW5lIHgxPSIxNiIgeDI9IjgiIHkxPSIxNyIgeTI9IjE3Ij48L2xpbmU+PHBvbHlsaW5lIHBvaW50cz0iMTAgOSA5IDkgOCA5Ij48L3BvbHlsaW5lPjwvc3ZnPgo8c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPkhvdy10byBHdWlkZTwvc3Bhbj4KPC9hPgo8aDI+PHNwYW4gaWQ9InNlY3JldFRyaWdnZXIiIHRpdGxlPSJVbmxvY2sgYWR2YW5jZWQgZmVhdHVyZXMiPlQ8L3NwYW4+YWJsZSBCeSBZb2NvIFByb2R1Y3QgTG9hZGVyPC9oMj4KPC9kaXY+CjxzcGFuIGlkPSJzYXZlU3RhdHVzIj5TYXZlZCE8L3NwYW4+CjxkaXYgY2xhc3M9ImJ1dHRvbi1jb250YWluZXIiPgo8YnV0dG9uIGNsYXNzPSJidG4taW1wb3J0IiBpZD0iZWRpdFNlc3Npb25CdG4iIHN0eWxlPSJkaXNwbGF5OiBub25lOyIgdHlwZT0iYnV0dG9uIj5FZGl0IFNlc3Npb248L2J1dHRvbj4KPGRpdiBpZD0ic2VjcmV0QWN0aW9uc0NvbnRhaW5lciIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7IGdhcDogMTVweDsgZmxleC13cmFwOiB3cmFwOyI+CjwvZGl2Pgo8YnV0dG9uIGNsYXNzPSJidG4tZXhwb3J0IiBvbmNsaWNrPSJleHBvcnRUb0V4Y2VsKCkiIHR5cGU9ImJ1dHRvbiI+RXhwb3J0IHRvIEV4Y2VsPC9idXR0b24+CjxidXR0b24gY2xhc3M9ImJ0bi1jbGVhciIgb25jbGljaz0iY29uZmlybUNsZWFyQWxsKCkiIHRpdGxlPSJDbGVhciBBbGwgRGF0YSIgdHlwZT0iYnV0dG9uIj4KPHN2ZyBoZWlnaHQ9IjE2IiB2aWV3Ym94PSIwIDAgMjQgMjQiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMyA2djE4aDE4di0xOGgtMTh6bTUgMTRjMCAuNTUyLS40NDggMS0xIDFzLTEtLjQ0OC0xLTF2LTEwYzAtLjU1Mi40NDgtMSAxLTFzMSAuNDQ4IDEgMXYxMHptNSAwYzAgLjU1Mi0uNDQ4IDEtMSAxcy0xLS40NDgtMS0xdi0xMGMwLS41NTIuNDQ4LTEgMS0xczEgLjQ0OCAxIDF2MTB6bTUgMGMwIC41NTItLjQ0OCAxLTEgMXMtMS0uNDQ4LTEtMXYtMTBjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjEwem00LTE4aC0yMHYtMmg2di0xLjVjMC0uODI3LjY3My0xLjUgMS41LTEuNWg1Yy44MjUgMCAxLjUuNjcxIDEuNSAxLjV2MS41aDZ2MnoiPjwvcGF0aD48L3N2Zz4KPC9idXR0b24+CjwvZGl2Pgo8L2hlYWRlcj4KPGRpdiBjbGFzcz0icHJvZHVjdC1kZWZhdWx0cyI+CjxoMz5Qcm9kdWN0IERlZmF1bHRzPC9oMz4KPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CjxsYWJlbCBjbGFzcz0idG9vbHRpcCIgZm9yPSJ0YXhBcHBsaWNhYmxlIj48c3BhbiBjbGFzcz0ibGFiZWwtdGV4dCI+VGF4IEFwcGxpY2FibGU8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj48L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5TZWxlY3QgVFJVRSBpZiB0YXggc2hvdWxkIGJlIGFkZGVkIHRvIHRoZSBwcmljZSwgb3RoZXJ3aXNlIHNlbGVjdCBGQUxTRS48L3NwYW4+PC9sYWJlbD4KPHNlbGVjdCBpZD0idGF4QXBwbGljYWJsZSIgcmVxdWlyZWQ9IiI+CjxvcHRpb24gZGlzYWJsZWQ9IiIgc2VsZWN0ZWQ9IiIgdmFsdWU9IiI+LS0gQ2hvb3NlIC0tPC9vcHRpb24+CjxvcHRpb24gdmFsdWU9InRydWUiPlRSVUU8L29wdGlvbj4KPG9wdGlvbiB2YWx1ZT0iZmFsc2UiPkZBTFNFPC9vcHRpb24+Cjwvc2VsZWN0Pgo8L2Rpdj4KPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CjxsYWJlbCBjbGFzcz0idG9vbHRpcCIgZm9yPSJwcm9kdWN0VHlwZSI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPlByb2R1Y3QgVHlwZTxzcGFuIGNsYXNzPSJyZXF1aXJlZC1zdGFyIj4qPC9zcGFuPjwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPldoYXQga2luZCBvZiBpdGVtIGlzIHRoaXM/IFlvdXIgY2hvaWNlIGNoYW5nZXMgdGhlIGZvcm0hIPCfk6Y8YnIvPjxiPmZpbmlzaGVkR29vZDo8L2I+IFNvbWV0aGluZyB5b3Ugc2VsbCBkaXJlY3RseSAoZS5nLiwgYSBidXJnZXIpLjxici8+PGI+cmF3TWF0ZXJpYWw6PC9iPiBBbiBpbmdyZWRpZW50IHlvdSB1c2UgYnV0IGRvbid0IHNlbGwgKGUuZy4sIGEgYmFnIG9mIGZsb3VyKS48YnIvPjxiPmZpbmlzaGVkR29vZCAmYW1wOyByYXdNYXRlcmlhbDo8L2I+IEFuIGl0ZW0geW91IEJPVEggc2VsbCBhbmQgdXNlIGFzIGFuIGluZ3JlZGllbnQgKGUuZy4sIGEgYm90dGxlIG9mIHNhdWNlKS48YnIvPjxiPk1hbnVmYWN0dXJlZDo8L2I+IEFuIGl0ZW0geW91IGNyZWF0ZSBmcm9tIHJhdyBtYXRlcmlhbHMgKGUuZy4sIGEgYnVyZ2VyIHBhdHR5IHlvdSBtYWtlIHlvdXJzZWxmKS48L3NwYW4+PC9sYWJlbD4KPHNlbGVjdCBpZD0icHJvZHVjdFR5cGUiIHJlcXVpcmVkPSIiPgo8b3B0aW9uIGRpc2FibGVkPSIiIHNlbGVjdGVkPSIiIHZhbHVlPSIiPi0tIFNlbGVjdCAtLTwvb3B0aW9uPgo8b3B0aW9uIHZhbHVlPSJmaW5pc2hlZEdvb2QiPmZpbmlzaGVkR29vZDwvb3B0aW9uPgo8b3B0aW9uIHZhbHVlPSJyYXdNYXRlcmlhbCI+cmF3TWF0ZXJpYWw8L29wdGlvbj4KPG9wdGlvbiB2YWx1ZT0iZmluaXNoZWRHb29kICZhbXA7IHJhd01hdGVyaWFsIj5maW5pc2hlZEdvb2QgJmFtcDsgcmF3TWF0ZXJpYWw8L29wdGlvbj4KPG9wdGlvbiB2YWx1ZT0iTWFudWZhY3R1cmVkIj5NYW51ZmFjdHVyZWQ8L29wdGlvbj4KPC9zZWxlY3Q+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIiBpZD0icHVyY2hhc2VkRm9yUmVzYWxlR3JvdXAiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+CjxsYWJlbCBjbGFzcz0idG9vbHRpcCI+SXRlbSBUeXBlCiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPklzIHRoaXMgYSAiYnV5LWFuZC1zZWxsIiBpdGVtPyDwn6WrPGJyLz5UaGluayBvZiBhIGNhbiBvZiBDb2tlLiBZb3UgYnV5IGl0IGFuZCBzZWxsIGl0IGluIHRoZSBleGFjdCBzYW1lIGZvcm0uIFRpY2tpbmcgdGhpcyB1c2VzIG9uZSBpdGVtIHJlY29yZCBmb3IgYm90aCB5b3VyIHN0b2NrIGFuZCB5b3VyIHNhbGVzIHNjcmVlbi4gU3VwZXIgc2ltcGxlITwvc3Bhbj4KPC9sYWJlbD4KPGRpdiBjbGFzcz0icmVtZW1iZXItbWUtY29udGFpbmVyIiBzdHlsZT0ibWFyZ2luLXRvcDogMTBweDsgcGFkZGluZzogMTRweDsgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsgYm9yZGVyLXJhZGl1czogOHB4OyI+CjxpbnB1dCBpZD0iaXNQdXJjaGFzZWRGb3JSZXNhbGUiIHN0eWxlPSJ3aWR0aDogMThweDsgaGVpZ2h0OiAxOHB4OyIgdHlwZT0iY2hlY2tib3giLz4KPGxhYmVsIGZvcj0iaXNQdXJjaGFzZWRGb3JSZXNhbGUiPlB1cmNoYXNlZCBmb3IgUmVzYWxlPC9sYWJlbD4KPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPGRpdiBjbGFzcz0ibGlicmFyeS1tYW5hZ2VtZW50Ij4KPGRpdiBjbGFzcz0ibGlicmFyeS1tYW5hZ2VtZW50LWhlYWRlciI+CjxoMz5MaWJyYXJpZXMgJmFtcDsgUHJlc2V0czwvaDM+CjxkaXYgY2xhc3M9ImxpYnJhcnktY29udHJvbHMiPgo8YnV0dG9uIGNsYXNzPSJidG4tYWRkIGJ0bi1tYW5hZ2VtZW50IiBpZD0ib3BlbkxpYnJhcnlNb2RhbEJ0biIgdHlwZT0iYnV0dG9uIj5NYW5hZ2UgTGlicmFyaWVzICZhbXA7IFByZXNldHM8L2J1dHRvbj4KPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPGZvcm0gaWQ9InByb2R1Y3RGb3JtIiBub3ZhbGlkYXRlPSIiPgo8aW5wdXQgaWQ9ImVkaXRpbmdJbmRleCIgdHlwZT0iaGlkZGVuIiB2YWx1ZT0iLTEiLz4KPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CjxsYWJlbCBjbGFzcz0idG9vbHRpcCIgZm9yPSJwcm9kdWN0TmFtZSI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPlByb2R1Y3QgTmFtZTxzcGFuIGNsYXNzPSJyZXF1aXJlZC1zdGFyIj4qPC9zcGFuPjwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPldoYXQncyB0aGUgbWFpbiBuYW1lIG9mIHlvdXIgcHJvZHVjdD8g8J+NlDxici8+S2VlcCBpdCBzaW1wbGUsIGxpa2UgIkNsYXNzaWMgQmVlZiBCdXJnZXIiIG9yICJDaGlja2VuIFBpenphIi4gWW91J2xsIGFkZCB2YXJpYXRpb25zIGxpa2Ugc2l6ZSBvciBmbGF2b3IgaW4gdGhlIFZhcmlhbnRzIHNlY3Rpb24gYmVsb3chPC9zcGFuPjwvbGFiZWw+CjxpbnB1dCBpZD0icHJvZHVjdE5hbWUiIHBsYWNlaG9sZGVyPSJlLmcuLCBDaGlja2VuIFBpenphIiByZXF1aXJlZD0iIiB0eXBlPSJ0ZXh0Ii8+CjxkaXYgaWQ9InNpbmdsZS1wcm9kdWN0LW1vZGlmaWVyLWNvbnRyb2xzIiBzdHlsZT0iZGlzcGxheTogbm9uZTsgbWFyZ2luLXRvcDogMTBweDsiPgo8YnV0dG9uIGNsYXNzPSJidG4tYWRkIGJ0bi1hZGQtZHluYW1pYyIgaWQ9ImxpbmtTaW5nbGVNb2RpZmllckJ0biIgdHlwZT0iYnV0dG9uIj5MaW5rIE1vZGlmaWVyPC9idXR0b24+CjxzcGFuIGlkPSJzaW5nbGVNb2RpZmllckluZGljYXRvciI+PC9zcGFuPgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiIGlkPSJzZWxsaW5nUHJpY2VHcm91cCI+CjxsYWJlbCBjbGFzcz0idG9vbHRpcCIgZm9yPSJzZWxsaW5nUHJpY2UiIGlkPSJzZWxsaW5nUHJpY2VMYWJlbCI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPkRlZmF1bHQgU2VsbGluZyBQcmljZSAoaWYgbm8gdmFyaWFudCk8L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5XaGF0J3MgdGhlIHByaWNlIGlmIGl0J3MganVzdCBhIHNpbmdsZSwgc2ltcGxlIGl0ZW0/IPCfkrA8YnIvPlRoaXMgcHJpY2UgaXMgdXNlZCBPTkxZIHdoZW4geW91IGRvbid0IGFkZCBhbnkgdmFyaWFudHMgKGxpa2Ugc2l6ZSBvciBjb2xvcikuIE9uY2UgeW91IGFkZCB2YXJpYW50cywgeW91J2xsIHNldCB0aGUgcHJpY2UgZm9yIGVhY2ggY29tYmluYXRpb24gaW5zdGVhZC48L3NwYW4+PC9sYWJlbD4KPGlucHV0IGlkPSJzZWxsaW5nUHJpY2UiIHBsYWNlaG9sZGVyPSJlLmcuLCAzNS4wMCIgc3RlcD0iMC4wMSIgdHlwZT0ibnVtYmVyIi8+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIiBpZD0icGx1RW50cnlHcm91cCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KPGxhYmVsIGNsYXNzPSJ0b29sdGlwIiBmb3I9ImN1c3RvbVBsdSI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPkN1c3RvbSBCYXNlIFBMVS9TS1U8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj48L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5Hb3QgeW91ciBvd24gcHJvZHVjdCBjb2Rlcz8g8J+Pt++4jzxici8+QSBQTFUvU0tVIGlzIGp1c3QgYSB1bmlxdWUgSUQgZm9yIGEgcHJvZHVjdC4gSWYgeW91IGhhdmUgeW91ciBvd24gc3lzdGVtLCBlbnRlciB0aGUgbWFpbiBjb2RlIGhlcmUuIE90aGVyd2lzZSwgdGhlIHRvb2wgY2FuIGdlbmVyYXRlIG9uZSBmb3IgeW91IGF1dG9tYWdpY2FsbHkhIOKcqDwvc3Bhbj48L2xhYmVsPgo8aW5wdXQgaWQ9ImN1c3RvbVBsdSIgcGxhY2Vob2xkZXI9ImUuZy4sIFBJWlpBLUNIRSIgdHlwZT0idGV4dCIvPgo8L2Rpdj4KPGRpdiBjbGFzcz0idmFyaWFudHMtYW5kLXByaWNpbmctd3JhcHBlciI+CjxkaXYgaWQ9InZhcmlhbnRzLWNvbHVtbiI+CjxkaXY+CjxsYWJlbCBjbGFzcz0idG9vbHRpcCI+VmFyaWFudCBHcm91cHMKICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5UaW1lIHRvIGFkZCBzb21lIHZhcmlldHkhIPCfjqg8YnIvPlZhcmlhbnRzIGFyZSBkaWZmZXJlbnQgb3B0aW9ucyBmb3IgYSBwcm9kdWN0LCBsaWtlIDxiPlNpemU8L2I+IChTbWFsbCwgTWVkaXVtLCBMYXJnZSkgb3IgPGI+Rmxhdm9yPC9iPiAoVmFuaWxsYSwgQ2hvY29sYXRlKS4gWW91IGNhbiBldmVuIGNvbWJpbmUgdGhlbSEgRWFjaCB1bmlxdWUgY29tYm8gY2FuIGhhdmUgaXRzIG93biBzcGVjaWFsIHByaWNlLjwvc3Bhbj4KPC9sYWJlbD4KPGRpdiBpZD0idmFyaWFudEdyb3Vwc0NvbnRhaW5lciI+PC9kaXY+CjxkaXYgY2xhc3M9ImR5bmFtaWMtY29udHJvbHMtd3JhcHBlciI+CjxidXR0b24gY2xhc3M9ImJ0bi1hZGQgYnRuLWFkZC1keW5hbWljIiBpZD0iYWRkVmFyaWFudEdyb3VwQnRuIiBvbmNsaWNrPSJhZGRWYXJpYW50R3JvdXAoKSIgdHlwZT0iYnV0dG9uIj5BZGQgTWFudWFsbHk8L2J1dHRvbj4KPGJ1dHRvbiBjbGFzcz0iYnRuLWltcG9ydCBidG4tYWRkLWR5bmFtaWMiIGlkPSJhcHBseVByZXNldEJ0biIgdHlwZT0iYnV0dG9uIj5BcHBseSBQcmVzZXQ8L2J1dHRvbj4KPGJ1dHRvbiBjbGFzcz0iYnRuLWV4cG9ydCBidG4tYWRkLWR5bmFtaWMiIGlkPSJzYXZlQXNQcmVzZXRCdG4iIHR5cGU9ImJ1dHRvbiI+U2F2ZSBhcyBQcmVzZXQ8L2J1dHRvbj4KPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPGRpdiBpZD0icHJpY2luZy1jb2x1bW4iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+CjxkaXYgaWQ9InZhcmlhbnRQcmljaW5nQ29udGFpbmVyIj48L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KPGxhYmVsIGNsYXNzPSJ0b29sdGlwIiBmb3I9InVvbSI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPlVPTTxzcGFuIGNsYXNzPSJyZXF1aXJlZC1zdGFyIj4qPC9zcGFuPjwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPlVuaXQgb2YgTWVhc3VyZS4gSG93IHRoZSBwcm9kdWN0IGlzIHNvbGQgKGUuZy4sIEVhY2gsIEtpbG9ncmFtcywgTGl0cmVzKS48L3NwYW4+PC9sYWJlbD4KPHNlbGVjdCBpZD0idW9tIiByZXF1aXJlZD0iIj4KPG9wdGlvbiBkaXNhYmxlZD0iIiBzZWxlY3RlZD0iIiB2YWx1ZT0iIj4tLSBTZWxlY3QgVU9NIC0tPC9vcHRpb24+CjxvcHRpb24gdmFsdWU9ImVhIj5FYWNoPC9vcHRpb24+CjxvcHRpb24gdmFsdWU9ImtnIj5LaWxvZ3JhbXM8L29wdGlvbj48b3B0aW9uIHZhbHVlPSJnIj5HcmFtczwvb3B0aW9uPgo8b3B0aW9uIHZhbHVlPSJsIj5MaXRyZXM8L29wdGlvbj48b3B0aW9uIHZhbHVlPSJtbCI+TWlsbGlsaXRyZXM8L29wdGlvbj4KPG9wdGlvbiB2YWx1ZT0ibSI+TWV0ZXJzPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT0ibW0iPk1pbGxpbWV0ZXJzPC9vcHRpb24+CjxvcHRpb24gdmFsdWU9ImNtIj5DZW50aW1ldGVyczwvb3B0aW9uPgo8L3NlbGVjdD4KPC9kaXY+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiIGlkPSJwcmVwTG9jYXRpb25Hcm91cCI+CjxsYWJlbCBjbGFzcz0idG9vbHRpcCIgZm9yPSJwcmVwTG9jYXRpb24iPjxzcGFuIGNsYXNzPSJsYWJlbC10ZXh0Ij5QcmVwIExvY2F0aW9uPHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+VGhlIGFyZWEgd2hlcmUgdGhlIGl0ZW0gaXMgcHJlcGFyZWQgKGUuZy4sICJLaXRjaGVuIiwgIkJhciIpLjwvc3Bhbj48L2xhYmVsPgo8aW5wdXQgaWQ9InByZXBMb2NhdGlvbiIgbGlzdD0icHJlcExpc3QiIHBsYWNlaG9sZGVyPSJlLmcuLCBLaXRjaGVuIiByZXF1aXJlZD0iIi8+CjxkYXRhbGlzdCBpZD0icHJlcExpc3QiPjwvZGF0YWxpc3Q+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIiBpZD0ibWVudUNhdGVnb3J5R3JvdXAiPgo8bGFiZWwgY2xhc3M9InRvb2x0aXAiIGZvcj0ibWVudUNhdGVnb3J5Ij48c3BhbiBjbGFzcz0ibGFiZWwtdGV4dCI+TWVudSBDYXRlZ29yeTxzcGFuIGNsYXNzPSJyZXF1aXJlZC1zdGFyIj4qPC9zcGFuPjwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPlRoZSBjYXRlZ29yeSB0aGUgcHJvZHVjdCB3aWxsIGFwcGVhciB1bmRlciBvbiB5b3VyIHBvaW50IG9mIHNhbGUgKGUuZy4sICJCdXJnZXJzIiwgIkhvdCBEcmlua3MiKS48L3NwYW4+PC9sYWJlbD4KPGlucHV0IGlkPSJtZW51Q2F0ZWdvcnkiIGxpc3Q9Im1lbnVMaXN0IiBwbGFjZWhvbGRlcj0iZS5nLiwgQnVyZ2VycyIgcmVxdWlyZWQ9IiIgdHlwZT0idGV4dCIvPgo8ZGF0YWxpc3QgaWQ9Im1lbnVMaXN0Ij48L2RhdGFsaXN0Pgo8L2Rpdj4KPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CjxsYWJlbCBjbGFzcz0idG9vbHRpcCIgZm9yPSJpbnZlbnRvcnlDYXRlZ29yeSIgaWQ9ImludmVudG9yeUNhdGVnb3J5TGFiZWwiPjxzcGFuIGNsYXNzPSJsYWJlbC10ZXh0Ij5JbnZlbnRvcnkgQ2F0ZWdvcnk8L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5BIGJyb2FkIGNhdGVnb3J5IGZvciBzdG9jayBtYW5hZ2VtZW50IChlLmcuLCAiRm9vZCIsICJCZXZlcmFnZXMiKS48L3NwYW4+PC9sYWJlbD4KPGlucHV0IGlkPSJpbnZlbnRvcnlDYXRlZ29yeSIgbGlzdD0iaW52ZW50b3J5Q2F0ZWdvcnlMaXN0IiBwbGFjZWhvbGRlcj0iZS5nLiwgRm9vZCIgdHlwZT0idGV4dCIvPgo8ZGF0YWxpc3QgaWQ9ImludmVudG9yeUNhdGVnb3J5TGlzdCI+PC9kYXRhbGlzdD4KPC9kaXY+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgo8bGFiZWwgY2xhc3M9InRvb2x0aXAiIGZvcj0iaW52ZW50b3J5U3ViQ2F0ZWdvcnkiIGlkPSJpbnZlbnRvcnlTdWJDYXRlZ29yeUxhYmVsIj48c3BhbiBjbGFzcz0ibGFiZWwtdGV4dCI+SW52ZW50b3J5IFN1Yi1DYXRlZ29yeTwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPkEgbW9yZSBzcGVjaWZpYyBzdG9jayBjYXRlZ29yeSAoZS5nLiwgIk1lYXQiLCAiQ29mZmVlICZhbXA7IFRlYSIpLjwvc3Bhbj48L2xhYmVsPgo8aW5wdXQgaWQ9ImludmVudG9yeVN1YkNhdGVnb3J5IiBsaXN0PSJpbnZlbnRvcnlTdWJDYXRlZ29yeUxpc3QiIHBsYWNlaG9sZGVyPSJlLmcuLCBNZWF0IiB0eXBlPSJ0ZXh0Ii8+CjxkYXRhbGlzdCBpZD0iaW52ZW50b3J5U3ViQ2F0ZWdvcnlMaXN0Ij48L2RhdGFsaXN0Pgo8L2Rpdj4KPGRpdiBjbGFzcz0iZm9ybS1ncm91cCIgaWQ9InN1cHBsaWVkUXVhbnRpdHlHcm91cCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KPGxhYmVsIGNsYXNzPSJ0b29sdGlwIiBmb3I9InN1cHBsaWVkUXVhbnRpdHkiIGlkPSJzdXBwbGllZFF1YW50aXR5TGFiZWwiPjxzcGFuIGNsYXNzPSJsYWJlbC10ZXh0Ij5TdXBwbGllZCBRdWFudGl0eTwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPkZvciByYXcgbWF0ZXJpYWwgcHJvZHVjdCB0eXBlcywgdGhpcyBpcyB0aGUgcXVhbnRpdHkgeW91IHJlY2VpdmUgZnJvbSB5b3VyIHN1cHBsaWVyIChlLmcuLCA1IGZvciBhIDVrZyBiYWcpLjwvc3Bhbj48L2xhYmVsPgo8ZGl2IGNsYXNzPSJpbnB1dC13cmFwcGVyIj4KPGlucHV0IGlkPSJzdXBwbGllZFF1YW50aXR5IiBwbGFjZWhvbGRlcj0iZS5nLiwgMTAwIiB0eXBlPSJudW1iZXIiLz4KPHNwYW4gY2xhc3M9Imdob3N0LXRleHQiIGlkPSJxdWFudGl0eUdob3N0VGV4dCI+PC9zcGFuPgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiIGlkPSJjb3N0UHJpY2VHcm91cCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KPGxhYmVsIGNsYXNzPSJ0b29sdGlwIiBmb3I9ImNvc3RQcmljZSIgaWQ9ImNvc3RQcmljZUxhYmVsIj48c3BhbiBjbGFzcz0ibGFiZWwtdGV4dCI+VG90YWwgQ29zdCBQcmljZSAoZXguIFZhdCk8L3NwYW4+PHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5UaGUgY29zdCBvZiB0aGUgcHJvZHVjdC4gRm9yIHJhdyBtYXRlcmlhbHMsIHRoaXMgaXMgdGhlIGNvc3QgZm9yIHRoZSBlbnRpcmUgc3VwcGxpZWQgcXVhbnRpdHkuPC9zcGFuPjwvbGFiZWw+CjxpbnB1dCBpZD0iY29zdFByaWNlIiBwbGFjZWhvbGRlcj0iZS5nLiwgMTUuNTAiIHN0ZXA9IjAuMDEiIHR5cGU9Im51bWJlciIvPgo8L2Rpdj4KPGRpdiBjbGFzcz0iZm9ybS1ncm91cCIgaWQ9InlpZWxkUXVhbnRpdHlHcm91cCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KPGxhYmVsIGNsYXNzPSJ0b29sdGlwIiBmb3I9InlpZWxkUXVhbnRpdHkiIGlkPSJ5aWVsZFF1YW50aXR5TGFiZWwiPjxzcGFuIGNsYXNzPSJsYWJlbC10ZXh0Ij5ZaWVsZCBRdWFudGl0eTwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPkZvciBtYW51ZmFjdHVyZWQgcHJvZHVjdCB0eXBlcywgdGhpcyBpcyB0aGUgcXVhbnRpdHkgcHJvZHVjZWQgZnJvbSB0aGUgcmF3IG1hdGVyaWFscy48L3NwYW4+PC9sYWJlbD4KPGRpdiBjbGFzcz0iaW5wdXQtd3JhcHBlciI+CjxpbnB1dCBpZD0ieWllbGRRdWFudGl0eSIgcGxhY2Vob2xkZXI9ImUuZy4sIDUwIiB0eXBlPSJudW1iZXIiLz4KPHNwYW4gY2xhc3M9Imdob3N0LXRleHQiIGlkPSJ5aWVsZEdob3N0VGV4dCI+PC9zcGFuPgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgo8bGFiZWwgY2xhc3M9InRvb2x0aXAiIGZvcj0iaGFzQmFyY29kZSI+PHNwYW4gY2xhc3M9ImxhYmVsLXRleHQiPkhhcyBCYXJjb2RlPzwvc3Bhbj48c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPlNlbGVjdCAiWWVzIiBpZiB5b3VyIHByb2R1Y3QgaGFzIGEgc2Nhbm5hYmxlIGJhcmNvZGUgdG8gcmV2ZWFsIHRoZSBlbnRyeSBmaWVsZC48L3NwYW4+PC9sYWJlbD4KPHNlbGVjdCBpZD0iaGFzQmFyY29kZSI+IDxvcHRpb24gdmFsdWU9Im5vIj5Obzwvb3B0aW9uPiA8b3B0aW9uIHZhbHVlPSJ5ZXMiPlllczwvb3B0aW9uPiA8L3NlbGVjdD4KPC9kaXY+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiIGlkPSJiYXJjb2RlRW50cnlHcm91cCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KPGxhYmVsIGNsYXNzPSJ0b29sdGlwIiBmb3I9ImJhcmNvZGUiPjxzcGFuIGNsYXNzPSJsYWJlbC10ZXh0Ij5CYXJjb2RlPC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+RW50ZXIgdGhlIG51bWVyaWNhbCBiYXJjb2RlIGZvciB0aGlzIHByb2R1Y3QuPC9zcGFuPjwvbGFiZWw+CjxpbnB1dCBpZD0iYmFyY29kZSIgcGxhY2Vob2xkZXI9IkVudGVyIHByb2R1Y3QgYmFyY29kZSIgdHlwZT0idGV4dCIvPgo8L2Rpdj4KPGRpdiBjbGFzcz0iZm9ybS1hY3Rpb25zLWZvb3RlciI+CjxkaXYgY2xhc3M9InJlbWVtYmVyLW1lLWNvbnRhaW5lciI+CjxpbnB1dCBjaGVja2VkPSIiIGlkPSJyZW1lbWJlckNhdGVnb3JpZXMiIHR5cGU9ImNoZWNrYm94Ii8+CjxsYWJlbCBmb3I9InJlbWVtYmVyQ2F0ZWdvcmllcyI+UmVtZW1iZXIgY2F0ZWdvcmllcyBmb3IgbmV4dCBwcm9kdWN0PC9sYWJlbD4KPC9kaXY+CjxidXR0b24gY2xhc3M9ImJ0bi1hZGQiIGlkPSJtYWluQWN0aW9uQnV0dG9uIiB0eXBlPSJidXR0b24iPkFkZCBQcm9kdWN0PC9idXR0b24+CjwvZGl2Pgo8L2Zvcm0+CjxkaXYgY2xhc3M9Imxpc3QtY29udGFpbmVyIj4KPGRpdiBjbGFzcz0idGFicyI+CjxidXR0b24gY2xhc3M9InRhYi1saW5rIGFjdGl2ZSIgZGF0YS10YWI9InByb2R1Y3RzIj5Qcm9kdWN0czwvYnV0dG9uPgo8YnV0dG9uIGNsYXNzPSJ0YWItbGluayIgZGF0YS10YWI9InN0b2NrIj5TdG9jayBJdGVtczwvYnV0dG9uPgo8L2Rpdj4KPGRpdiBjbGFzcz0idGFiLWNvbnRlbnQgYWN0aXZlIiBpZD0icHJvZHVjdHMiPgo8ZGl2IGNsYXNzPSJzZWFyY2gtY29udGFpbmVyIiBzdHlsZT0iZGlzcGxheTogZmxleDsgZ2FwOiAxNXB4OyBmbGV4LXdyYXA6IHdyYXA7Ij4KPGlucHV0IGlkPSJwcm9kdWN0U2VhcmNoIiBwbGFjZWhvbGRlcj0iU2VhcmNoIGJ5IG5hbWUsIFBMVS4uLiIgc3R5bGU9ImZsZXgtZ3JvdzogMTsiIHR5cGU9InNlYXJjaCIvPgo8c2VsZWN0IGlkPSJwcm9kdWN0Q2F0ZWdvcnlGaWx0ZXIiIHN0eWxlPSJtYXgtd2lkdGg6IDI1MHB4OyI+CjxvcHRpb24gdmFsdWU9IiI+RmlsdGVyIGJ5IE1lbnUgQ2F0ZWdvcnkuLi48L29wdGlvbj4KPC9zZWxlY3Q+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0YWJsZS1jb250YWluZXIiPgo8dGFibGUgaWQ9InByb2R1Y3RUYWJsZSI+Cjx0aGVhZD4KPHRyPgo8dGg+UExVPC90aD4KPHRoPlByb2R1Y3QgTmFtZTwvdGg+Cjx0aD5WYXJpYW50PC90aD4KPHRoPk1lbnUgQ2F0ZWdvcnk8L3RoPgo8dGg+U2VsbGluZyBQcmljZTwvdGg+Cjx0aD5Nb2RpZmllcnM8L3RoPgo8dGg+QWN0aW9uczwvdGg+CjwvdHI+CjwvdGhlYWQ+Cjx0Ym9keT48L3Rib2R5Pgo8L3RhYmxlPgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9InRhYi1jb250ZW50IiBpZD0ic3RvY2siPgo8ZGl2IGNsYXNzPSJzZWFyY2gtY29udGFpbmVyIj4KPGlucHV0IGlkPSJzdG9ja1NlYXJjaCIgcGxhY2Vob2xkZXI9IlNlYXJjaCBzdG9jayBieSBuYW1lLCBjYXRlZ29yeS4uLiIgdHlwZT0ic2VhcmNoIi8+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0YWJsZS1jb250YWluZXIiPgo8dGFibGUgaWQ9InN0b2NrVGFibGUiPgo8dGhlYWQ+Cjx0cj4KPHRoPlBMVTwvdGg+Cjx0aD5Qcm9kdWN0IE5hbWU8L3RoPgo8dGg+SW52LiBDYXRlZ29yeTwvdGg+Cjx0aD5VT008L3RoPgo8dGg+Q29zdCBQcmljZSAoZXguIFZhdCk8L3RoPgo8dGg+QWN0aW9uczwvdGg+CjwvdHI+CjwvdGhlYWQ+Cjx0Ym9keT48L3Rib2R5Pgo8L3RhYmxlPgo8L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0YWItY29udGVudCIgaWQ9InN0b2NrIj4KPGRpdiBjbGFzcz0ic2VhcmNoLWNvbnRhaW5lciI+CjxpbnB1dCBpZD0ic3RvY2tTZWFyY2giIHBsYWNlaG9sZGVyPSJTZWFyY2ggc3RvY2sgYnkgbmFtZSwgY2F0ZWdvcnkuLi4iIHR5cGU9InNlYXJjaCIvPgo8L2Rpdj4KPGRpdiBjbGFzcz0idGFibGUtY29udGFpbmVyIj4KPHRhYmxlIGlkPSJzdG9ja1RhYmxlIj4KPHRoZWFkPgo8dHI+Cjx0aD5QTFU8L3RoPgo8dGg+UHJvZHVjdCBOYW1lPC90aD4KPHRoPkludi4gQ2F0ZWdvcnk8L3RoPgo8dGg+VU9NPC90aD4KPHRoPkNvc3QgUHJpY2UgKGV4LiBWYXQpPC90aD4KPHRoPkFjdGlvbnM8L3RoPgo8L3RyPgo8L3RoZWFkPgo8dGJvZHk+PC90Ym9keT4KPC90YWJsZT4KPC9kaXY+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0YWJsZS1mb290ZXIiPgo8YnV0dG9uIGNsYXNzPSJidG4taW1wb3J0IiBvbmNsaWNrPSJ1cGRhdGVUYWJsZSgpIiB0eXBlPSJidXR0b24iPlJlZnJlc2ggTGlzdHM8L2J1dHRvbj4KPGJ1dHRvbiBjbGFzcz0iYnRuLWV4cG9ydCIgb25jbGljaz0iZXhwb3J0VG9FeGNlbCgpIiB0eXBlPSJidXR0b24iPkV4cG9ydCB0byBFeGNlbDwvYnV0dG9uPgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9Im1vZGFsLW92ZXJsYXkiIGlkPSJzZXNzaW9uRGVmYXVsdHNNb2RhbCI+CjxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiIHN0eWxlPSJ0ZXh0LWFsaWduOiBsZWZ0OyI+CjxoMyBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IG1hcmdpbi10b3A6IDA7Ij5TZXNzaW9uIFNldHVwPC9oMz4KPHAgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgbWFyZ2luLWJvdHRvbTogMjVweDsiPkZpcnN0LCBsZXQncyBzZXQgdXAgc29tZSBkZWZhdWx0cyBmb3IgdGhpcyBzZXNzaW9uLiBZb3UgY2FuIGNoYW5nZSB0aGVzZSBsYXRlci48L3A+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgo8bGFiZWwgY2xhc3M9InRvb2x0aXAiIGZvcj0ic2Vzc2lvblNpdGUiPjxzcGFuIGNsYXNzPSJsYWJlbC10ZXh0Ij5TaXRlPHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+RW50ZXIgdGhlIG5hbWUgb2YgeW91ciBzdG9yZSBvciBidXNpbmVzcyBsb2NhdGlvbiAoZS5nLiwgIk1haW4gU3RyZWV0IENhZmUiKS4gVGhpcyBpcyBhIHJlcXVpcmVkIGZpZWxkLjwvc3Bhbj48L2xhYmVsPgo8aW5wdXQgaWQ9InNlc3Npb25TaXRlIiBsaXN0PSJzaXRlTGlzdCIgcGxhY2Vob2xkZXI9ImUuZy4sIE1haW4gU3RyZWV0IENhZmUiIHJlcXVpcmVkPSIiLz4KPGRhdGFsaXN0IGlkPSJzaXRlTGlzdCI+PC9kYXRhbGlzdD4KPC9kaXY+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiIHN0eWxlPSJtYXJnaW4tdG9wOiAyMHB4OyI+CjxsYWJlbCBjbGFzcz0idG9vbHRpcCIgZm9yPSJzZXNzaW9uRGVmaW5lUGx1Ij48c3BhbiBjbGFzcz0ibGFiZWwtdGV4dCI+RGVmaW5lIFBMVS9TS1U/PHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+PC9zcGFuPjxzcGFuIGNsYXNzPSJ0b29sdGlwdGV4dCI+Q2hvb3NlICdZZXMnIGZvciBtYW51YWwgZW50cnkgaWYgeW91IGhhdmUgYSBwcmUtZXhpc3RpbmcgU0tVIHN5c3RlbSwgb3IgJ05vJyB0byBoYXZlIG9uZSBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZC48L3NwYW4+PC9sYWJlbD4KPHNlbGVjdCBpZD0ic2Vzc2lvbkRlZmluZVBsdSI+CjxvcHRpb24gdmFsdWU9Im5vIj5ObyAoQXV0by1nZW5lcmF0ZSk8L29wdGlvbj4KPG9wdGlvbiB2YWx1ZT0ieWVzIj5ZZXMgKE1hbnVhbCBFbnRyeSk8L29wdGlvbj4KPC9zZWxlY3Q+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJtb2RhbC1hY3Rpb25zIiBzdHlsZT0ibWFyZ2luLXRvcDogMzBweDsiPgo8YnV0dG9uIGNsYXNzPSJidG4tYWRkIiBpZD0ic2V0RGVmYXVsdHNCdG4iIHN0eWxlPSJ3aWR0aDogMTAwJTsiIHR5cGU9ImJ1dHRvbiI+U2V0IERlZmF1bHRzPC9idXR0b24+CjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9Im1vZGFsLW92ZXJsYXkiIGlkPSJsaWJyYXJ5TWFuYWdlbWVudE1vZGFsIj4KPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCI+CjxoMyBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IG1hcmdpbi10b3A6IDA7IG1hcmdpbi1ib3R0b206IDI1cHg7Ij5MaWJyYXJ5IE1hbmFnZW1lbnQ8L2gzPgo8ZGl2IGNsYXNzPSJsaWJyYXJ5LW1vZGFsLW1lbnUiPgo8YnV0dG9uIGlkPSJvcGVuTW9kaWZpZXJNb2RhbEJ0biIgdHlwZT0iYnV0dG9uIj5FZGl0IE1vZGlmaWVyIExpYnJhcnk8L2J1dHRvbj4KPGJ1dHRvbiBpZD0ibWFuYWdlVmFyaWFudFByZXNldHNCdG4iIHR5cGU9ImJ1dHRvbiI+TWFuYWdlIFZhcmlhbnQgUHJlc2V0czwvYnV0dG9uPgo8YnV0dG9uIGlkPSJtYW5hZ2VNb2RpZmllclByZXNldHNCdG4iIHR5cGU9ImJ1dHRvbiI+TWFuYWdlIE1vZGlmaWVyIFByZXNldHM8L2J1dHRvbj4KPC9kaXY+CjxkaXYgY2xhc3M9Im1vZGFsLWFjdGlvbnMiIHN0eWxlPSJtYXJnaW4tdG9wOiAzMHB4OyI+CjxidXR0b24gY2xhc3M9ImJ0bi1leHBvcnQiIG9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaWJyYXJ5TWFuYWdlbWVudE1vZGFsJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpIiB0eXBlPSJidXR0b24iPkNsb3NlPC9idXR0b24+CjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9Im1vZGFsLW92ZXJsYXkiIGlkPSJjdXN0b21Nb2RhbCI+CjxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiPgo8cCBpZD0ibW9kYWxNZXNzYWdlIj48L3A+CjxkaXYgY2xhc3M9Im1vZGFsLWFjdGlvbnMiIGlkPSJtb2RhbEFjdGlvbnMiPjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9Im1vZGFsLW92ZXJsYXkiIGlkPSJtb2RpZmllck1vZGFsIj4KPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCI+CjxkaXYgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsgbWFyZ2luLWJvdHRvbTogMjBweDsgZmxleC13cmFwOiB3cmFwOyBnYXA6IDE1cHg7Ij4KPGgzIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgbWFyZ2luOiAwOyI+TW9kaWZpZXIgTGlicmFyeTwvaDM+CjxkaXYgY2xhc3M9ImR5bmFtaWMtY29udHJvbHMtd3JhcHBlciI+CjxidXR0b24gY2xhc3M9ImJ0bi1pbXBvcnQgYnRuLWFkZC1keW5hbWljIiBpZD0iYXBwbHlNb2RpZmllclByZXNldEJ0biIgdHlwZT0iYnV0dG9uIj5BcHBseSBQcmVzZXQ8L2J1dHRvbj4KPGJ1dHRvbiBjbGFzcz0iYnRuLWV4cG9ydCBidG4tYWRkLWR5bmFtaWMiIGlkPSJzYXZlTW9kaWZpZXJzQXNQcmVzZXRCdG4iIHR5cGU9ImJ1dHRvbiI+U2F2ZSBMaWJyYXJ5IGFzIFByZXNldDwvYnV0dG9uPgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9Im1vZGFsLXNlY3Rpb24tZGl2aWRlciI+CjxoND5BZGQgTmV3IE1vZGlmaWVyIEdyb3VwPC9oND4KPGRpdiBjbGFzcz0ibW9kaWZpZXItZ3JvdXAtcm93IiBpZD0ibmV3TW9kaWZpZXJHcm91cEZvcm0iPgo8L2Rpdj4KPC9kaXY+CjxoND5FZGl0IEV4aXN0aW5nIEdyb3VwczwvaDQ+CjxkaXYgaWQ9ImVkaXRNb2RpZmllckdyb3Vwc0NvbnRhaW5lciI+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJtb2RhbC1hY3Rpb25zIiBzdHlsZT0ibWFyZ2luLXRvcDogMjBweDsiPgo8YnV0dG9uIGNsYXNzPSJidG4tYWRkIiBpZD0ic2F2ZU1vZGlmaWVyc0J0biIgdHlwZT0iYnV0dG9uIj5TYXZlIGFuZCBDbG9zZTwvYnV0dG9uPgo8YnV0dG9uIGNsYXNzPSJidG4tZXhwb3J0IiBpZD0iY2xvc2VNb2RpZmllck1vZGFsQnRuIiB0eXBlPSJidXR0b24iPkNhbmNlbDwvYnV0dG9uPgo8L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJtb2RhbC1vdmVybGF5IiBpZD0ibGlua01vZGlmaWVyTW9kYWwiPgo8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50Ij4KPGg0IGlkPSJsaW5rTW9kaWZpZXJNb2RhbFRpdGxlIiBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IG1hcmdpbi10b3A6IDA7IG1hcmdpbi1ib3R0b206IDIwcHg7Ij5MaW5rIE1vZGlmaWVyczwvaDQ+CjxkaXYgaWQ9ImxpbmtNb2RpZmllckxpc3RDb250YWluZXIiPgo8L2Rpdj4KPGRpdiBjbGFzcz0ibW9kYWwtYWN0aW9ucyIgc3R5bGU9Im1hcmdpbi10b3A6IDIwcHg7Ij4KPGRpdiBpZD0iZHluYW1pY01vZGFsQWN0aW9ucyI+PC9kaXY+CjxidXR0b24gY2xhc3M9ImJ0bi1hZGQiIGlkPSJjbG9zZUxpbmtNb2RpZmllck1vZGFsQnRuIiB0eXBlPSJidXR0b24iPkRvbmU8L2J1dHRvbj4KPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPGRpdiBjbGFzcz0ibW9kYWwtb3ZlcmxheSBwcmVzZXQtbW9kYWwiIGlkPSJhcHBseVZhcmlhbnRQcmVzZXRNb2RhbCI+CjxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiPgo8aDQgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyBtYXJnaW4tdG9wOiAwOyI+QXBwbHkgYSBWYXJpYW50IFByZXNldDwvaDQ+CjxwIGlkPSJhcHBseVZhcmlhbnRQcmVzZXRXYXJuaW5nIiBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyBtYXJnaW4tYm90dG9tOiAyMHB4OyI+PC9wPgo8ZGl2IGNsYXNzPSJwcmVzZXQtbGlzdC1jb250YWluZXIiIGlkPSJhcHBseVZhcmlhbnRQcmVzZXRMaXN0Q29udGFpbmVyIiBzdHlsZT0idGV4dC1hbGlnbjogbGVmdDsiPjwvZGl2Pgo8ZGl2IGNsYXNzPSJtb2RhbC1hY3Rpb25zIiBzdHlsZT0ibWFyZ2luLXRvcDogMjBweDsiPgo8YnV0dG9uIGNsYXNzPSJidG4tZXhwb3J0IiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlWYXJpYW50UHJlc2V0TW9kYWwnKS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JykiIHR5cGU9ImJ1dHRvbiI+Q2FuY2VsPC9idXR0b24+CjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9Im1vZGFsLW92ZXJsYXkgcHJlc2V0LW1vZGFsIiBpZD0ibWFuYWdlVmFyaWFudFByZXNldHNNb2RhbCI+CjxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiPgo8aDMgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyBtYXJnaW4tdG9wOiAwOyI+TWFuYWdlIFZhcmlhbnQgUHJlc2V0czwvaDM+CjxwIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7IG1hcmdpbi1ib3R0b206IDIwcHg7Ij5IZXJlIHlvdSBjYW4gcmVuYW1lIG9yIGRlbGV0ZSBzYXZlZCB2YXJpYW50IHByZXNldHMuPC9wPgo8ZGl2IGNsYXNzPSJwcmVzZXQtZWRpdC1jb250YWluZXIiIGlkPSJlZGl0VmFyaWFudFByZXNldHNDb250YWluZXIiPjwvZGl2Pgo8ZGl2IGNsYXNzPSJtb2RhbC1hY3Rpb25zIiBzdHlsZT0ibWFyZ2luLXRvcDogMjBweDsiPgo8YnV0dG9uIGNsYXNzPSJidG4tYWRkIiBpZD0ic2F2ZVZhcmlhbnRQcmVzZXRzQnRuIiB0eXBlPSJidXR0b24iPlNhdmUgYW5kIENsb3NlPC9idXR0b24+CjxidXR0b24gY2xhc3M9ImJ0bi1leHBvcnQiIG9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYW5hZ2VWYXJpYW50UHJlc2V0c01vZGFsJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpIiB0eXBlPSJidXR0b24iPkNhbmNlbDwvYnV0dG9uPgo8L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJtb2RhbC1vdmVybGF5IHByZXNldC1tb2RhbCIgaWQ9ImFwcGx5TW9kaWZpZXJQcmVzZXRNb2RhbCI+CjxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiPgo8aDQgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyBtYXJnaW4tdG9wOiAwOyI+QXBwbHkgYSBNb2RpZmllciBQcmVzZXQgTGlicmFyeTwvaDQ+CjxwIGlkPSJhcHBseU1vZGlmaWVyUHJlc2V0V2FybmluZyIgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgbWFyZ2luLWJvdHRvbTogMjBweDsiPjwvcD4KPGRpdiBjbGFzcz0icHJlc2V0LWxpc3QtY29udGFpbmVyIiBpZD0iYXBwbHlNb2RpZmllclByZXNldExpc3RDb250YWluZXIiIHN0eWxlPSJ0ZXh0LWFsaWduOiBsZWZ0OyI+PC9kaXY+CjxkaXYgY2xhc3M9Im1vZGFsLWFjdGlvbnMiIHN0eWxlPSJtYXJnaW4tdG9wOiAyMHB4OyI+CjxidXR0b24gY2xhc3M9ImJ0bi1leHBvcnQiIG9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseU1vZGlmaWVyUHJlc2V0TW9kYWwnKS5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JykiIHR5cGU9ImJ1dHRvbiI+Q2FuY2VsPC9idXR0b24+CjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9Im1vZGFsLW92ZXJsYXkgcHJlc2V0LW1vZGFsIiBpZD0ibWFuYWdlTW9kaWZpZXJQcmVzZXRzTW9kYWwiPgo8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50Ij4KPGgzIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsgbWFyZ2luLXRvcDogMDsiPk1hbmFnZSBNb2RpZmllciBQcmVzZXRzPC9oMz4KPHAgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgbWFyZ2luLWJvdHRvbTogMjBweDsiPkhlcmUgeW91IGNhbiByZW5hbWUgb3IgZGVsZXRlIHNhdmVkIG1vZGlmaWVyIHByZXNldCBsaWJyYXJpZXMuPC9wPgo8ZGl2IGNsYXNzPSJwcmVzZXQtZWRpdC1jb250YWluZXIiIGlkPSJlZGl0TW9kaWZpZXJQcmVzZXRzQ29udGFpbmVyIj48L2Rpdj4KPGRpdiBjbGFzcz0ibW9kYWwtYWN0aW9ucyIgc3R5bGU9Im1hcmdpbi10b3A6IDIwcHg7Ij4KPGJ1dHRvbiBjbGFzcz0iYnRuLWFkZCIgaWQ9InNhdmVNb2RpZmllclByZXNldHNCdG4iIHR5cGU9ImJ1dHRvbiI+U2F2ZSBhbmQgQ2xvc2U8L2J1dHRvbj4KPGJ1dHRvbiBjbGFzcz0iYnRuLWV4cG9ydCIgb25jbGljaz0iZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hbmFnZU1vZGlmaWVyUHJlc2V0c01vZGFsJykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpIiB0eXBlPSJidXR0b24iPkNhbmNlbDwvYnV0dG9uPgo8L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8YXVkaW8gaWQ9ImV4cG9ydFNvdW5kIiBwcmVsb2FkPSJhdXRvIiBzcmM9InRhYmxlYXVkaW8ubXAzIj48L2F1ZGlvPgo8ZGl2IGlkPSJ2aWRlb092ZXJsYXkiIHN0eWxlPSJkaXNwbGF5OiBub25lOyBwb3NpdGlvbjogZml4ZWQ7IHRvcDogMDsgbGVmdDogMDsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7IHotaW5kZXg6IDIwMDA7IGp1c3RpZnktY29udGVudDogY2VudGVyOyBhbGlnbi1pdGVtczogY2VudGVyOyI+Cjx2aWRlbyBpZD0iZXhwb3J0VmlkZW8iIHBsYXlzaW5saW5lPSIiIHN0eWxlPSJtYXgtd2lkdGg6IDkwJTsgbWF4LWhlaWdodDogOTAlOyIgd2lkdGg9IjYwMCI+Cjxzb3VyY2Ugc3JjPSJhbmltYXRlZC1sb2dvLm1wNCIgdHlwZT0idmlkZW8vbXA0Ii8+CiAgICBZb3VyIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgdmlkZW8gdGFnLgogIDwvdmlkZW8+CjwvZGl2Pgo8ZGl2IGlkPSJob3Zlci1ib2FyZCI+CjxidXR0b24gY2xhc3M9ImhvdmVyLWJvYXJkLWxpbmsiIGlkPSJzY3JvbGxUb1RvcEJ0biIgdGl0bGU9IlNjcm9sbCB0byBUb3AiPgo8c3ZnIGZpbGw9ImN1cnJlbnRDb2xvciIgaGVpZ2h0PSIxNiIgdmlld2JveD0iMCAwIDE2IDE2IiB3aWR0aD0iMTYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik04IDE1YS41LjUgMCAwIDAgLjUtLjVWMi43MDdsMy4xNDYgMy4xNDdhLjUuNSAwIDAgMCAuNzA4LS43MDhsLTQtNGEuNS41IDAgMCAwLS43MDggMGwtNCA0YS41LjUgMCAxIDAgLjcwOC43MDhMNy41IDIuNzA3VjE0LjVhLjUuNSAwIDAgMCAuNS41eiIgZmlsbC1ydWxlPSJldmVub2RkIj48L3BhdGg+Cjwvc3ZnPgo8L2J1dHRvbj4KPGJ1dHRvbiBjbGFzcz0iaG92ZXItYm9hcmQtbGluayIgaWQ9InNjcm9sbFRvQm90dG9tQnRuIiB0aXRsZT0iU2Nyb2xsIHRvIEJvdHRvbSI+CjxzdmcgZmlsbD0iY3VycmVudENvbG9yIiBoZWlnaHQ9IjE2IiB2aWV3Ym94PSIwIDAgMTYgMTYiIHdpZHRoPSIxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMWEuNS41IDAgMCAxIC41LjV2MTEuNzkzbDMuMTQ2LTMuMTQ3YS41LjUgMCAwIDEgLjcwOCAuNzA4bC00IDRhLjUuNSAwIDAgMS0uNzA4IDBsLTQgNGEuNS41IDAgMCAxIC43MDgtLjcwOEw3LjUgMTMuMjkzVjEuNUEuNS41IDAgMCAxIDggMXoiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PC9wYXRoPgo8L3N2Zz4KPC9idXR0b24+CjxhIGNsYXNzPSJob3Zlci1ib2FyZC1saW5rIiBocmVmPSJodHRwczovL3d3dy55b2NvLmNvbS96YS9sZWdhbC9wcml2YWN5LXBvbGljeS8iIHRhcmdldD0iX2JsYW5rIj5Qcml2YWN5PC9hPgo8YSBjbGFzcz0iaG92ZXItYm9hcmQtbGluayIgaHJlZj0iaHR0cHM6Ly93d3cueW9jby5jb20vemEvbGVnYWwvdGVybXMtYW5kLWNvbmRpdGlvbnMvIiB0YXJnZXQ9Il9ibGFuayI+VGVybXM8L2E+CjwvZGl2Pgo8c2NyaXB0PgogICAgLy8gLS0tIENPTkZJRyAmIEdMT0JBTCBTVEFURSAtLS0KICAgIGNvbnN0IEhPV19UT19HVUlERV9VUkwgPSAnaHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xd0p2eThXdVBKVHA3c3ozRmF1bnNoZWM5NmRxMFBRSXEvdmlldz91c3A9ZHJpdmVfbGluayc7CgogICAgbGV0IHByb2R1Y3RzID0gW107CiAgICBsZXQgcGx1Q291bnRlciA9IDEwMDA7CiAgICBsZXQgY3VycmVudE1vZGlmaWVyR3JvdXBzID0gW107CiAgICBsZXQgY3VycmVudE1vZGlmaWVyTGlua3MgPSB7fTsKICAgIGxldCBjdXJyZW50VmFyaWFudEdyb3VwcyA9IFtdOwogICAgbGV0IGN1cnJlbnRWYXJpYW50UHJpY2luZyA9IFtdOwogICAgbGV0IHZhcmlhbnRQcmVzZXRzID0gW107CiAgICBsZXQgbW9kaWZpZXJQcmVzZXRzID0gW107CiAgICBsZXQgc2Vzc2lvblNpdGUgPSAnJzsKICAgIGxldCBzZXNzaW9uRGVmaW5lUGx1ID0gJ25vJzsKICAgIGxldCBkZWZhdWx0c1NldCA9IGZhbHNlOwogICAgbGV0IGxvYWRlckludGVydmFsID0gbnVsbDsKICAgIGxldCByZW1lbWJlckNhdGVnb3JpZXNDaGVja2VkID0gdHJ1ZTsKICAgIGxldCBsYXN0VXNlZENhdGVnb3JpZXMgPSB7IHByZXA6ICcnLCBtZW51OiAnJywgaW52OiAnJywgc3ViSW52OiAnJywgdW9tOiAnJyB9OwoKICAgIGNvbnN0IGNhdGVnb3J5TWFwID0gewogICAgICAgICJGb29kIjogWyJNZWF0IiwgIkRhaXJ5IiwgIlByb2R1Y2UiLCAiQmFrZXJ5IiwgIkRyeSBHb29kcyIsICJGcm96ZW4iXSwKICAgICAgICAiQmV2ZXJhZ2VzIjogWyJTb2RhcyIsICJKdWljZXMiLCAiQWxjb2hvbCIsICJDb2ZmZWUgJiBUZWEiLCAiV2F0ZXIiXSwKICAgICAgICAiUGFja2FnaW5nIjogWyJDb250YWluZXJzIiwgIkJhZ3MiLCAiQ3V0bGVyeSIsICJOYXBraW5zIl0sICJTdXBwbGllcyI6IFsiQ2xlYW5pbmciLCAiT2ZmaWNlIiwgIlVuaWZvcm1zIl0KICAgIH07CiAgICBjb25zdCB1b21NYXAgPSB7CiAgICAgICAgJ2VhJzogJ0VhY2gnLCAna2cnOiAnS2lsb2dyYW1zJywgJ2cnOiAnR3JhbXMnLCAnbCc6ICdMaXRyZXMnLAogICAgICAgICdtbCc6ICdNaWxsaWxpdHJlcycsICdtJzogJ01ldGVycycsICdtbSc6ICdNaWxsaW1ldGVycycsICdjbSc6ICdDZW50aW1ldGVycycKICAgIH07CgogICAgLy8gLS0tIERPTSBFbGVtZW50IHZhcmlhYmxlcyB3aWxsIGJlIGRlZmluZWQgaW5zaWRlIERPTUNvbnRlbnRMb2FkZWQgLS0tCiAgICBsZXQgZXhwb3J0U291bmRFbGVtZW50LCBzZXNzaW9uRGVmYXVsdHNNb2RhbCwgc2Vzc2lvblNpdGVJbnB1dCwgc2Vzc2lvbkRlZmluZVBsdVNlbGVjdCwKICAgICAgICBlZGl0U2Vzc2lvbkJ0biwgbGlicmFyeU1hbmFnZW1lbnRNb2RhbCwgcGx1RW50cnlHcm91cCwgcHJvZHVjdFR5cGVTZWxlY3QsCiAgICAgICAgY29zdFByaWNlR3JvdXAsIHNlbGxpbmdQcmljZUdyb3VwLCBpbnZlbnRvcnlDYXRlZ29yeUlucHV0LCBoYXNCYXJjb2RlU2VsZWN0LAogICAgICAgIGJhcmNvZGVFbnRyeUdyb3VwLCBzYXZlU3RhdHVzLCB2YXJpYW50R3JvdXBzQ29udGFpbmVyLCBwcmljaW5nQ29sdW1uLAogICAgICAgIHZhcmlhbnRQcmljaW5nQ29udGFpbmVyLCBhZGRWYXJpYW50R3JvdXBCdG4sIGN1c3RvbU1vZGFsLCBtb2RhbE1lc3NhZ2UsCiAgICAgICAgbW9kYWxBY3Rpb25zLCBtYWluQWN0aW9uQnV0dG9uLCBlZGl0aW5nSW5kZXhJbnB1dCwgbW9kaWZpZXJNb2RhbCwKICAgICAgICBuZXdNb2RpZmllckdyb3VwRm9ybSwgZWRpdE1vZGlmaWVyR3JvdXBzQ29udGFpbmVyLCBsaW5rTW9kaWZpZXJNb2RhbCwKICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbFRpdGxlLCBsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyLCBzaW5nbGVQcm9kdWN0TW9kaWZpZXJDb250cm9scywKICAgICAgICB1b21TZWxlY3QsIHN1cHBsaWVkUXVhbnRpdHlJbnB1dCwgeWllbGRRdWFudGl0eUlucHV0LCByZW1lbWJlckNhdGVnb3JpZXNDaGVja2JveCwKICAgICAgICBhcHBseVZhcmlhbnRQcmVzZXRNb2RhbCwgbWFuYWdlVmFyaWFudFByZXNldHNNb2RhbCwgYXBwbHlNb2RpZmllclByZXNldE1vZGFsLAogICAgICAgIG1hbmFnZU1vZGlmaWVyUHJlc2V0c01vZGFsOwoKCiAgICAvLyAtLS0gRVZFTlQgTElTVEVORVJTICYgSU5JVElBTElaQVRJT04gLS0tCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4gewogICAgICAgIC8vIC0tLSBEZWZpbmUgYWxsIERPTSBlbGVtZW50IHZhcmlhYmxlcyBoZXJlIC0tLQogICAgICAgIGV4cG9ydFNvdW5kRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnRTb3VuZCcpOwogICAgICAgIHNlc3Npb25EZWZhdWx0c01vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nlc3Npb25EZWZhdWx0c01vZGFsJyk7CiAgICAgICAgc2Vzc2lvblNpdGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXNzaW9uU2l0ZScpOwogICAgICAgIHNlc3Npb25EZWZpbmVQbHVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Vzc2lvbkRlZmluZVBsdScpOwogICAgICAgIGVkaXRTZXNzaW9uQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXRTZXNzaW9uQnRuJyk7CiAgICAgICAgbGlicmFyeU1hbmFnZW1lbnRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaWJyYXJ5TWFuYWdlbWVudE1vZGFsJyk7CiAgICAgICAgcGx1RW50cnlHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbHVFbnRyeUdyb3VwJyk7CiAgICAgICAgcHJvZHVjdFR5cGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZHVjdFR5cGUnKTsKICAgICAgICBjb3N0UHJpY2VHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb3N0UHJpY2VHcm91cCcpOwogICAgICAgIHNlbGxpbmdQcmljZUdyb3VwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGxpbmdQcmljZUdyb3VwJyk7CiAgICAgICAgaW52ZW50b3J5Q2F0ZWdvcnlJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnZlbnRvcnlDYXRlZ29yeScpOwogICAgICAgIGhhc0JhcmNvZGVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGFzQmFyY29kZScpOwogICAgICAgIGJhcmNvZGVFbnRyeUdyb3VwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JhcmNvZGVFbnRyeUdyb3VwJyk7CiAgICAgICAgc2F2ZVN0YXR1cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlU3RhdHVzJyk7CiAgICAgICAgdmFyaWFudEdyb3Vwc0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2YXJpYW50R3JvdXBzQ29udGFpbmVyJyk7CiAgICAgICAgcHJpY2luZ0NvbHVtbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmljaW5nLWNvbHVtbicpOwogICAgICAgIHZhcmlhbnRQcmljaW5nQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZhcmlhbnRQcmljaW5nQ29udGFpbmVyJyk7CiAgICAgICAgYWRkVmFyaWFudEdyb3VwQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZFZhcmlhbnRHcm91cEJ0bicpOwogICAgICAgIGN1c3RvbU1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbU1vZGFsJyk7CiAgICAgICAgbW9kYWxNZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsTWVzc2FnZScpOwogICAgICAgIG1vZGFsQWN0aW9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbEFjdGlvbnMnKTsKICAgICAgICBtYWluQWN0aW9uQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5BY3Rpb25CdXR0b24nKTsKICAgICAgICBlZGl0aW5nSW5kZXhJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0aW5nSW5kZXgnKTsKICAgICAgICBtb2RpZmllck1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGlmaWVyTW9kYWwnKTsKICAgICAgICBuZXdNb2RpZmllckdyb3VwRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXdNb2RpZmllckdyb3VwRm9ybScpOwogICAgICAgIGVkaXRNb2RpZmllckdyb3Vwc0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0TW9kaWZpZXJHcm91cHNDb250YWluZXInKTsKICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5rTW9kaWZpZXJNb2RhbCcpOwogICAgICAgIGxpbmtNb2RpZmllck1vZGFsVGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlua01vZGlmaWVyTW9kYWxUaXRsZScpOwogICAgICAgIGxpbmtNb2RpZmllckxpc3RDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlua01vZGlmaWVyTGlzdENvbnRhaW5lcicpOwogICAgICAgIHNpbmdsZVByb2R1Y3RNb2RpZmllckNvbnRyb2xzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NpbmdsZS1wcm9kdWN0LW1vZGlmaWVyLWNvbnRyb2xzJyk7CiAgICAgICAgdW9tU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VvbScpOwogICAgICAgIHN1cHBsaWVkUXVhbnRpdHlJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdXBwbGllZFF1YW50aXR5Jyk7CiAgICAgICAgeWllbGRRdWFudGl0eUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3lpZWxkUXVhbnRpdHknKTsKICAgICAgICByZW1lbWJlckNhdGVnb3JpZXNDaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1lbWJlckNhdGVnb3JpZXMnKTsKICAgICAgICBhcHBseVZhcmlhbnRQcmVzZXRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseVZhcmlhbnRQcmVzZXRNb2RhbCcpOwogICAgICAgIG1hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFuYWdlVmFyaWFudFByZXNldHNNb2RhbCcpOwogICAgICAgIGFwcGx5TW9kaWZpZXJQcmVzZXRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseU1vZGlmaWVyUHJlc2V0TW9kYWwnKTsKICAgICAgICBtYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbCcpOwoKICAgICAgICAvLyAtLS0gVFVUT1JJQUwgTE9HSUMgKG5vdyBzYWZlbHkgaW5zaWRlIERPTUNvbnRlbnRMb2FkZWQpIC0tLQogICAgICAgIGNvbnN0IHR1dG9yaWFsUHJvbXB0TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcHJvbXB0LW1vZGFsJyk7CiAgICAgICAgY29uc3Qgc3RhcnRUdXRvcmlhbEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydC10dXRvcmlhbC1idG4nKTsKICAgICAgICBjb25zdCBza2lwVHV0b3JpYWxCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2tpcC10dXRvcmlhbC1idG4nKTsKICAgICAgICBjb25zdCB0dXRvcmlhbE92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheScpOwogICAgICAgIGNvbnN0IHR1dG9yaWFsUG9wb3ZlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1wb3BvdmVyJyk7CiAgICAgICAgY29uc3QgcG9wb3ZlckNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcG9wb3Zlci1jb250ZW50Jyk7CiAgICAgICAgY29uc3Qgc3RlcENvdW50ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtc3RlcC1jb3VudGVyJyk7CiAgICAgICAgY29uc3QgcHJldkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1wcmV2LWJ0bicpOwogICAgICAgIGNvbnN0IG5leHRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtbmV4dC1idG4nKTsKICAgICAgICAKICAgICAgICBsZXQgY3VycmVudFR1dG9yaWFsU3RlcCA9IDA7CiAgICAgICAgbGV0IGhpZ2hsaWdodGVkRWxlbWVudCA9IG51bGw7CgogICAgICAgIGNvbnN0IHR1dG9yaWFsU3RlcHMgPSBbCiAgICB7CiAgICAgICAgZWxlbWVudDogJyNob3dUb0d1aWRlTGluaycsIC8vIFRoaXMgbGluZSB0YXJnZXRzIE9OTFkgdGhlIGljb24KICAgICAgICBjb250ZW50OiAnPGI+V2VsY29tZSEg8J+RizwvYj4gTGV0XCdzIHRha2UgYSBxdWljaywgaW50ZXJhY3RpdmUgdG91ciBvZiB0aGUgUHJvZHVjdCBMb2FkZXIuIFdlXCdsbCBoaWdobGlnaHQgZWFjaCBzZWN0aW9uIGFzIHdlIGdvLicsCiAgICAgICAgcG9zaXRpb246ICdyaWdodCcKICAgIH0sCiAgICB7CiAgICAgICAgZWxlbWVudDogJy5wcm9kdWN0LWRlZmF1bHRzJywKICAgICAgICBjb250ZW50OiAnPGI+U3RlcCAxOiBQcm9kdWN0IERlZmF1bHRzIOKame+4jzwvYj4gU3RhcnQgaGVyZSBiZWZvcmUgYWRkaW5nIGEgcHJvZHVjdC4gU2V0IHRoZSBcJ1RheFwnIGFuZCBcJ1Byb2R1Y3QgVHlwZVwnLiBZb3VyIGNob2ljZSBoZXJlIGNoYW5nZXMgd2hpY2ggZmllbGRzIGFyZSByZXF1aXJlZCBpbiB0aGUgZm9ybSBiZWxvdy4nLAogICAgICAgIHBvc2l0aW9uOiAnYm90dG9tJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnLmxpYnJhcnktbWFuYWdlbWVudCcsCiAgICAgICAgY29udGVudDogJzxiPlN0ZXAgMjogTGlicmFyaWVzICYgUHJlc2V0cyDwn5OaPC9iPiBUaGlzIGlzIGEgaHVnZSB0aW1lLXNhdmVyISBNYW5hZ2UgeW91ciByZXVzYWJsZSBNb2RpZmllciBsaXN0cyAobGlrZSBwaXp6YSB0b3BwaW5ncykgYW5kIFZhcmlhbnQgUHJlc2V0cyAobGlrZSBULXNoaXJ0IHNpemVzKSBoZXJlLicsCiAgICAgICAgcG9zaXRpb246ICdib3R0b20nCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjcHJvZHVjdEZvcm0nLAogICAgICAgIGNvbnRlbnQ6ICc8Yj5TdGVwIDM6IFRoZSBNYWluIEZvcm0g8J+TnTwvYj4gVGhpcyBpcyB3aGVyZSB0aGUgbWFnaWMgaGFwcGVucy4gRmlsbCBpbiBhbGwgeW91ciBwcm9kdWN0IGRldGFpbHMuIE5vdGljZSBob3cgaXQgY2hhbmdlcyBiYXNlZCBvbiB0aGUgIlByb2R1Y3QgVHlwZSIgeW91IHNlbGVjdGVkLicsCiAgICAgICAgcG9zaXRpb246ICd0b3AnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcudGFicycsCiAgICAgICAgY29udGVudDogJzxiPlN0ZXAgNDogWW91ciBQcm9kdWN0IExpc3RzIOKchTwvYj4gQXMgeW91IGFkZCBwcm9kdWN0cywgdGhleSB3aWxsIGFwcGVhciBoZXJlLiBUaGUgIlByb2R1Y3RzIiB0YWIgaXMgZm9yIHNlbGxhYmxlIGl0ZW1zIGFuZCAiU3RvY2sgSXRlbXMiIGlzIGZvciBpbnZlbnRvcnkuIFlvdSBjYW4gZWRpdCBvciByZW1vdmUgdGhlbSBhbnl0aW1lLicsCiAgICAgICAgcG9zaXRpb246ICd0b3AnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICdoZWFkZXIgLmJ1dHRvbi1jb250YWluZXInLAogICAgICAgIGNvbnRlbnQ6ICI8Yj5Zb3UncmUgYWxsIHNldCEg8J+agDwvYj4gV2hlbiB5b3UncmUgZmluaXNoZWQgYWRkaW5nIGFsbCB5b3VyIHByb2R1Y3RzLCBjbGljayB0aGUgXCJFeHBvcnQgdG8gRXhjZWxcIiBidXR0b24gdXAgaGVyZSB0byBnZXQgeW91ciBmaW5hbCBmaWxlLiBHb29kIGx1Y2shIiwKICAgICAgICBwb3NpdGlvbjogJ2xlZnQnCiAgICB9Cl07CgogICAgICAgIGZ1bmN0aW9uIHN0YXJ0VHV0b3JpYWwoKSB7CiAgICAgICAgICAgIGN1cnJlbnRUdXRvcmlhbFN0ZXAgPSAwOwogICAgICAgICAgICB0dXRvcmlhbE92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgIHNob3dUdXRvcmlhbFN0ZXAoY3VycmVudFR1dG9yaWFsU3RlcCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBlbmRUdXRvcmlhbCgpIHsKICAgICAgICAgICAgdHV0b3JpYWxPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50dXRvcmlhbC1vdmVybGF5LXBhcnQnKS5mb3JFYWNoKHBhcnQgPT4gewogICAgICAgICAgICAgICAgcGFydC5zdHlsZS53aWR0aCA9ICcwJzsKICAgICAgICAgICAgICAgIHBhcnQuc3R5bGUuaGVpZ2h0ID0gJzAnOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdHV0b3JpYWxQb3BvdmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIGlmIChoaWdobGlnaHRlZEVsZW1lbnQpIHsKICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQtZWxlbWVudCcpOwogICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRFbGVtZW50ID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gc2hvd1R1dG9yaWFsU3RlcChpbmRleCkgewogICAgICAgICAgICBpZiAoaGlnaGxpZ2h0ZWRFbGVtZW50KSB7CiAgICAgICAgICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaGlnaGxpZ2h0LWVsZW1lbnQnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBzdGVwID0gdHV0b3JpYWxTdGVwc1tpbmRleF07CiAgICAgICAgICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHN0ZXAuZWxlbWVudCk7CgogICAgICAgICAgICBpZiAoIXRhcmdldEVsZW1lbnQpIHsKICAgICAgICAgICAgICAgIGlmIChpbmRleCA8IHR1dG9yaWFsU3RlcHMubGVuZ3RoIC0gMSkgeyBzaG93VHV0b3JpYWxTdGVwKGluZGV4ICsgMSk7IH0gCiAgICAgICAgICAgICAgICBlbHNlIHsgZW5kVHV0b3JpYWwoKTsgfQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICB0dXRvcmlhbFBvcG92ZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudCA9IHRhcmdldEVsZW1lbnQ7CiAgICAgICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQtZWxlbWVudCcpOwogICAgICAgICAgICB0YXJnZXRFbGVtZW50LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ2NlbnRlcicsIGlubGluZTogJ2NlbnRlcicgfSk7CiAgICAgICAgICAgIHBvcG92ZXJDb250ZW50LmlubmVySFRNTCA9IHN0ZXAuY29udGVudDsKICAgICAgICAgICAgc3RlcENvdW50ZXIudGV4dENvbnRlbnQgPSBgU3RlcCAke2luZGV4ICsgMX0gb2YgJHt0dXRvcmlhbFN0ZXBzLmxlbmd0aH1gOwogICAgICAgICAgICAKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICBwb3NpdGlvblBvcG92ZXIodGFyZ2V0RWxlbWVudCwgc3RlcC5wb3NpdGlvbik7CiAgICAgICAgICAgICAgICBwb3NpdGlvblNwb3RsaWdodCh0YXJnZXRFbGVtZW50KTsKICAgICAgICAgICAgfSwgMzAwKTsKCiAgICAgICAgICAgIHByZXZCdG4uZGlzYWJsZWQgPSBpbmRleCA9PT0gMDsKICAgICAgICAgICAgbmV4dEJ0bi50ZXh0Q29udGVudCA9IGluZGV4ID09PSB0dXRvcmlhbFN0ZXBzLmxlbmd0aCAtIDEgPyAnRmluaXNoJyA6ICdOZXh0JzsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHBvc2l0aW9uU3BvdGxpZ2h0KHRhcmdldCkgewogICAgICAgICAgICBjb25zdCB0YXJnZXRSZWN0ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS10b3AnKS5zdHlsZS5oZWlnaHQgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXRvcCcpLnN0eWxlLndpZHRoID0gJzEwMHZ3JzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktYm90dG9tJykuc3R5bGUudG9wID0gYCR7dGFyZ2V0UmVjdC5ib3R0b219cHhgOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1ib3R0b20nKS5zdHlsZS5oZWlnaHQgPSBgY2FsYygxMDB2aCAtICR7dGFyZ2V0UmVjdC5ib3R0b219cHgpYDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktYm90dG9tJykuc3R5bGUud2lkdGggPSAnMTAwdncnOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1sZWZ0Jykuc3R5bGUudG9wID0gYCR7dGFyZ2V0UmVjdC50b3B9cHhgOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1sZWZ0Jykuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC5oZWlnaHR9cHhgOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1sZWZ0Jykuc3R5bGUud2lkdGggPSBgJHt0YXJnZXRSZWN0LmxlZnR9cHhgOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1yaWdodCcpLnN0eWxlLnRvcCA9IGAke3RhcmdldFJlY3QudG9wfXB4YDsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktcmlnaHQnKS5zdHlsZS5oZWlnaHQgPSBgJHt0YXJnZXRSZWN0LmhlaWdodH1weGA7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Jykuc3R5bGUubGVmdCA9IGAke3RhcmdldFJlY3QucmlnaHR9cHhgOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1yaWdodCcpLnN0eWxlLndpZHRoID0gYGNhbGMoMTAwdncgLSAke3RhcmdldFJlY3QucmlnaHR9cHgpYDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHBvc2l0aW9uUG9wb3Zlcih0YXJnZXQsIHBvc2l0aW9uKSB7CiAgICAgICAgICAgIGNvbnN0IHRhcmdldFJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICAgIGNvbnN0IHBvcG92ZXJOb2RlID0gdHV0b3JpYWxQb3BvdmVyOwogICAgICAgICAgICBwb3BvdmVyTm9kZS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7CiAgICAgICAgICAgIGNvbnN0IHBvcG92ZXJSZWN0ID0gcG9wb3Zlck5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICAgIHBvcG92ZXJOb2RlLnN0eWxlLnZpc2liaWxpdHkgPSAnJzsKICAgICAgICAgICAgY29uc3Qgc3BhY2luZyA9IDE1OwogICAgICAgICAgICBwb3BvdmVyTm9kZS5jbGFzc05hbWUgPSAndHV0b3JpYWwtcG9wb3Zlcic7CiAgICAgICAgICAgIGxldCB0b3AsIGxlZnQ7CgogICAgICAgICAgICBzd2l0Y2ggKHBvc2l0aW9uKSB7CiAgICAgICAgICAgICAgICBjYXNlICd0b3AnOgogICAgICAgICAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wIC0gcG9wb3ZlclJlY3QuaGVpZ2h0IC0gc3BhY2luZzsKICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5sZWZ0ICsgKHRhcmdldFJlY3Qud2lkdGggLyAyKSAtIChwb3BvdmVyUmVjdC53aWR0aCAvIDIpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnYm90dG9tJzoKICAgICAgICAgICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LmJvdHRvbSArIHNwYWNpbmc7CiAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QubGVmdCArICh0YXJnZXRSZWN0LndpZHRoIC8gMikgLSAocG9wb3ZlclJlY3Qud2lkdGggLyAyKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2xlZnQnOgogICAgICAgICAgICAgICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgLSBwb3BvdmVyUmVjdC53aWR0aCAtIHNwYWNpbmc7CiAgICAgICAgICAgICAgICAgICAgdG9wID0gdGFyZ2V0UmVjdC50b3AgKyAodGFyZ2V0UmVjdC5oZWlnaHQgLyAyKSAtIChwb3BvdmVyUmVjdC5oZWlnaHQgLyAyKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzoKICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5yaWdodCArIHNwYWNpbmc7CiAgICAgICAgICAgICAgICAgICAgdG9wID0gdGFyZ2V0UmVjdC50b3AgKyAodGFyZ2V0UmVjdC5oZWlnaHQgLyAyKSAtIChwb3BvdmVyUmVjdC5oZWlnaHQgLyAyKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGxlZnQgPCBzcGFjaW5nKSBsZWZ0ID0gc3BhY2luZzsKICAgICAgICAgICAgaWYgKChsZWZ0ICsgcG9wb3ZlclJlY3Qud2lkdGgpID4gd2luZG93LmlubmVyV2lkdGggLSBzcGFjaW5nKSBsZWZ0ID0gd2luZG93LmlubmVyV2lkdGggLSBwb3BvdmVyUmVjdC53aWR0aCAtIHNwYWNpbmc7CiAgICAgICAgICAgIGlmICh0b3AgPCBzcGFjaW5nKSB0b3AgPSBzcGFjaW5nOwogICAgICAgICAgICBpZiAoKHRvcCArIHBvcG92ZXJSZWN0LmhlaWdodCkgPiB3aW5kb3cuaW5uZXJIZWlnaHQgLSBzcGFjaW5nKSB0b3AgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBwb3BvdmVyUmVjdC5oZWlnaHQgLSBzcGFjaW5nOwoKICAgICAgICAgICAgcG9wb3Zlck5vZGUuc3R5bGUudG9wID0gYCR7dG9wfXB4YDsKICAgICAgICAgICAgcG9wb3Zlck5vZGUuc3R5bGUubGVmdCA9IGAke2xlZnR9cHhgOwogICAgICAgICAgICBwb3BvdmVyTm9kZS5jbGFzc0xpc3QuYWRkKGBhcnJvdy0ke3Bvc2l0aW9ufWApOwogICAgICAgIH0KCiAgICAgICAgc3RhcnRUdXRvcmlhbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgdHV0b3JpYWxQcm9tcHRNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9kdWN0TG9hZGVyVHV0b3JpYWxTaG93bicsICd0cnVlJyk7CiAgICAgICAgICAgIHN0YXJ0VHV0b3JpYWwoKTsKICAgICAgICB9KTsKCiAgICAgICAgc2tpcFR1dG9yaWFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICB0dXRvcmlhbFByb21wdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2R1Y3RMb2FkZXJUdXRvcmlhbFNob3duJywgJ3RydWUnKTsKICAgICAgICB9KTsKCiAgICAgICAgcHJldkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgaWYgKGN1cnJlbnRUdXRvcmlhbFN0ZXAgPiAwKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50VHV0b3JpYWxTdGVwLS07CiAgICAgICAgICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGN1cnJlbnRUdXRvcmlhbFN0ZXApOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIG5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgIGlmIChjdXJyZW50VHV0b3JpYWxTdGVwIDwgdHV0b3JpYWxTdGVwcy5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50VHV0b3JpYWxTdGVwKys7CiAgICAgICAgICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGN1cnJlbnRUdXRvcmlhbFN0ZXApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZW5kVHV0b3JpYWwoKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIAogICAgICAgIC8vIC0tLSBSRUdVTEFSIEFQUCBJTklUSUFMSVpBVElPTiAtLS0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaG93VG9HdWlkZUxpbmsnKS5ocmVmID0gSE9XX1RPX0dVSURFX1VSTDsKICAgICAgICBsb2FkU3RhdGUoKTsKICAgICAgICB1cGRhdGVSZXF1aXJlZEZpZWxkcygpOwogICAgICAgIHNldHVwSW5saW5lVmFsaWRhdGlvbigpOwoKICAgICAgICBpZiAoIWRlZmF1bHRzU2V0KSB7CiAgICAgICAgICAgIHNlc3Npb25EZWZhdWx0c01vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlZGl0U2Vzc2lvbkJ0bi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzZWNyZXRUcmlnZ2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlY3JldFRyaWdnZXInKTsKICAgICAgICBpZiAoc2VjcmV0VHJpZ2dlcikgewogICAgICAgICAgICBzZWNyZXRUcmlnZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3Qgc2VjcmV0Q29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlY3JldEFjdGlvbnNDb250YWluZXInKTsKICAgICAgICAgICAgICAgIGlmIChzZWNyZXRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnKSB7CiAgICAgICAgICAgICAgICAgICAgc2VjcmV0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHNlY3JldENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWItbGluaycpLmZvckVhY2goYnV0dG9uID0+IHsKICAgICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgdGFiSWQgPSBidXR0b24uZGF0YXNldC50YWI7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFiLWxpbmsnKS5mb3JFYWNoKHRhYiA9PiB0YWIuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhYi1jb250ZW50JykuZm9yRWFjaChjb250ZW50ID0+IGNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFiSWQpLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Njcm9sbFRvVG9wQnRuJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gd2luZG93LnNjcm9sbFRvKHsgdG9wOiAwLCBiZWhhdmlvcjogJ3Ntb290aCcgfSkpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JvbGxUb0JvdHRvbUJ0bicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHdpbmRvdy5zY3JvbGxUbyh7IHRvcDogZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQsIGJlaGF2aW9yOiAnc21vb3RoJyB9KSk7CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0U2VhcmNoJykuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiBmaWx0ZXJUYWJsZSgncHJvZHVjdFNlYXJjaCcsICdwcm9kdWN0VGFibGUnLCAncHJvZHVjdENhdGVnb3J5RmlsdGVyJykpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0Q2F0ZWdvcnlGaWx0ZXInKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiBmaWx0ZXJUYWJsZSgncHJvZHVjdFNlYXJjaCcsICdwcm9kdWN0VGFibGUnLCAncHJvZHVjdENhdGVnb3J5RmlsdGVyJykpOwoKICAgICAgICBwcm9kdWN0VHlwZVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB1cGRhdGVSZXF1aXJlZEZpZWxkcyk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RheEFwcGxpY2FibGUnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBzYXZlU3RhdGUpOwoKICAgICAgICBjb25zdCBmaWVsZHNUb0NhcGl0YWxpemUgPSBbJ3Nlc3Npb25TaXRlJywgJ3Byb2R1Y3ROYW1lJywgJ3ByZXBMb2NhdGlvbicsICdtZW51Q2F0ZWdvcnknLCAnaW52ZW50b3J5Q2F0ZWdvcnknLCAnaW52ZW50b3J5U3ViQ2F0ZWdvcnknXTsKICAgICAgICBmaWVsZHNUb0NhcGl0YWxpemUuZm9yRWFjaChpZCA9PiB7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKT8uYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnRhcmdldC52YWx1ZSA9IGNhcGl0YWxpemVXb3JkcyhlLnRhcmdldC52YWx1ZS50cmltKCkpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICAKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xvc2VMaW5rTW9kaWZpZXJNb2RhbEJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgICAgIGdlbmVyYXRlQW5kUmVuZGVyUHJpY2luZygpOyAKICAgICAgICB9KTsKCiAgICB9KTsKCiAgICBmdW5jdGlvbiBmaWx0ZXJUYWJsZShzZWFyY2hJbnB1dElkLCB0YWJsZUlkLCBjYXRlZ29yeUZpbHRlcklkKSB7CiAgICAgICAgY29uc3QgcXVlcnkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZWFyY2hJbnB1dElkKS52YWx1ZS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGNvbnN0IGNhdGVnb3J5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2F0ZWdvcnlGaWx0ZXJJZCkgPyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYXRlZ29yeUZpbHRlcklkKS52YWx1ZSA6ICcnOwogICAgICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFibGVJZCk7CiAgICAgICAgaWYgKCF0YWJsZSkgcmV0dXJuOwogICAgICAgIGNvbnN0IHJvd3MgPSB0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSB0cicpOwoKICAgICAgICByb3dzLmZvckVhY2gocm93ID0+IHsKICAgICAgICAgICAgY29uc3QgdGV4dENvbnRlbnQgPSByb3cudGV4dENvbnRlbnQudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgY29uc3QgY2F0ZWdvcnlDZWxsID0gcm93LmNlbGxzWzNdID8gcm93LmNlbGxzWzNdLnRleHRDb250ZW50IDogJyc7IC8vIEFzc3VtZXMgTWVudSBDYXRlZ29yeSBpcyB0aGUgNHRoIGNlbGwKCiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXNRdWVyeSA9IHRleHRDb250ZW50LmluY2x1ZGVzKHF1ZXJ5KTsKICAgICAgICAgICAgY29uc3QgbWF0Y2hlc0NhdGVnb3J5ID0gY2F0ZWdvcnkgPyBjYXRlZ29yeUNlbGwgPT09IGNhdGVnb3J5IDogdHJ1ZTsKCiAgICAgICAgICAgIHJvdy5zdHlsZS5kaXNwbGF5ID0gKG1hdGNoZXNRdWVyeSAmJiBtYXRjaGVzQ2F0ZWdvcnkpID8gJycgOiAnbm9uZSc7CiAgICAgICAgfSk7CiAgICB9CgogICAgLy8gLS0tIEV2ZW50IExpc3RlbmVycyAtLS0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7CiAgICAvLyAtLS0gRGVmaW5lIGFsbCBET00gZWxlbWVudCB2YXJpYWJsZXMgaGVyZSAtLS0KICAgIGV4cG9ydFNvdW5kRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnRTb3VuZCcpOwogICAgc2Vzc2lvbkRlZmF1bHRzTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Vzc2lvbkRlZmF1bHRzTW9kYWwnKTsKICAgIHNlc3Npb25TaXRlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Vzc2lvblNpdGUnKTsKICAgIHNlc3Npb25EZWZpbmVQbHVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Vzc2lvbkRlZmluZVBsdScpOwogICAgZWRpdFNlc3Npb25CdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdFNlc3Npb25CdG4nKTsKICAgIGxpYnJhcnlNYW5hZ2VtZW50TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlicmFyeU1hbmFnZW1lbnRNb2RhbCcpOwogICAgcGx1RW50cnlHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbHVFbnRyeUdyb3VwJyk7CiAgICBwcm9kdWN0VHlwZVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0VHlwZScpOwogICAgY29zdFByaWNlR3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29zdFByaWNlR3JvdXAnKTsKICAgIHNlbGxpbmdQcmljZUdyb3VwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGxpbmdQcmljZUdyb3VwJyk7CiAgICBpbnZlbnRvcnlDYXRlZ29yeUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ludmVudG9yeUNhdGVnb3J5Jyk7CiAgICBoYXNCYXJjb2RlU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hhc0JhcmNvZGUnKTsKICAgIGJhcmNvZGVFbnRyeUdyb3VwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JhcmNvZGVFbnRyeUdyb3VwJyk7CiAgICBzYXZlU3RhdHVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVTdGF0dXMnKTsKICAgIHZhcmlhbnRHcm91cHNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmFyaWFudEdyb3Vwc0NvbnRhaW5lcicpOwogICAgcHJpY2luZ0NvbHVtbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmljaW5nLWNvbHVtbicpOwogICAgdmFyaWFudFByaWNpbmdDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmFyaWFudFByaWNpbmdDb250YWluZXInKTsKICAgIGFkZFZhcmlhbnRHcm91cEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRWYXJpYW50R3JvdXBCdG4nKTsKICAgIGN1c3RvbU1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbU1vZGFsJyk7CiAgICBtb2RhbE1lc3NhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxNZXNzYWdlJyk7CiAgICBtb2RhbEFjdGlvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxBY3Rpb25zJyk7CiAgICBtYWluQWN0aW9uQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5BY3Rpb25CdXR0b24nKTsKICAgIGVkaXRpbmdJbmRleElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXRpbmdJbmRleCcpOwogICAgbW9kaWZpZXJNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RpZmllck1vZGFsJyk7CiAgICBuZXdNb2RpZmllckdyb3VwRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXdNb2RpZmllckdyb3VwRm9ybScpOwogICAgZWRpdE1vZGlmaWVyR3JvdXBzQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXRNb2RpZmllckdyb3Vwc0NvbnRhaW5lcicpOwogICAgbGlua01vZGlmaWVyTW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlua01vZGlmaWVyTW9kYWwnKTsKICAgIGxpbmtNb2RpZmllck1vZGFsVGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlua01vZGlmaWVyTW9kYWxUaXRsZScpOwogICAgbGlua01vZGlmaWVyTGlzdENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyJyk7CiAgICBzaW5nbGVQcm9kdWN0TW9kaWZpZXJDb250cm9scyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaW5nbGUtcHJvZHVjdC1tb2RpZmllci1jb250cm9scycpOwogICAgdW9tU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VvbScpOwogICAgc3VwcGxpZWRRdWFudGl0eUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N1cHBsaWVkUXVhbnRpdHknKTsKICAgIHlpZWxkUXVhbnRpdHlJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd5aWVsZFF1YW50aXR5Jyk7CiAgICByZW1lbWJlckNhdGVnb3JpZXNDaGVja2JveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1lbWJlckNhdGVnb3JpZXMnKTsKICAgIGFwcGx5VmFyaWFudFByZXNldE1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5VmFyaWFudFByZXNldE1vZGFsJyk7CiAgICBtYW5hZ2VWYXJpYW50UHJlc2V0c01vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwnKTsKICAgIGFwcGx5TW9kaWZpZXJQcmVzZXRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseU1vZGlmaWVyUHJlc2V0TW9kYWwnKTsKICAgIG1hbmFnZU1vZGlmaWVyUHJlc2V0c01vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hbmFnZU1vZGlmaWVyUHJlc2V0c01vZGFsJyk7CgogICAgLy8gLS0tIFRVVE9SSUFMIExPR0lDIChub3cgc2FmZWx5IGluc2lkZSBET01Db250ZW50TG9hZGVkKSAtLS0KICAgIGNvbnN0IHR1dG9yaWFsUHJvbXB0TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcHJvbXB0LW1vZGFsJyk7CiAgICBjb25zdCBzdGFydFR1dG9yaWFsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0LXR1dG9yaWFsLWJ0bicpOwogICAgY29uc3Qgc2tpcFR1dG9yaWFsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NraXAtdHV0b3JpYWwtYnRuJyk7CiAgICBjb25zdCB0dXRvcmlhbE92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheScpOwogICAgY29uc3QgdHV0b3JpYWxQb3BvdmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXBvcG92ZXInKTsKICAgIGNvbnN0IHBvcG92ZXJDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXBvcG92ZXItY29udGVudCcpOwogICAgY29uc3Qgc3RlcENvdW50ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtc3RlcC1jb3VudGVyJyk7CiAgICBjb25zdCBwcmV2QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXByZXYtYnRuJyk7CiAgICBjb25zdCBuZXh0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW5leHQtYnRuJyk7CiAgICAKICAgIGxldCBjdXJyZW50VHV0b3JpYWxTdGVwID0gMDsKICAgIGxldCBoaWdobGlnaHRlZEVsZW1lbnQgPSBudWxsOwoKICAgIGNvbnN0IHR1dG9yaWFsU3RlcHMgPSBbCiAgICB7CiAgICAgICAgZWxlbWVudDogJyNob3dUb0d1aWRlTGluaycsIC8vIFRoaXMgbGluZSB0YXJnZXRzIE9OTFkgdGhlIGljb24KICAgICAgICBjb250ZW50OiAnPGI+V2VsY29tZSEg8J+RizwvYj4gTGV0XCdzIHRha2UgYSBxdWljaywgaW50ZXJhY3RpdmUgdG91ciBvZiB0aGUgUHJvZHVjdCBMb2FkZXIuIFdlXCdsbCBoaWdobGlnaHQgZWFjaCBzZWN0aW9uIGFzIHdlIGdvLiBUaGUgUGFnZSBpY29uIG9uIHRoZSB0b3AgbGVmdCBpcyBhIGJ1dHRvbiB0aGF0IHdpbGwgdGFrZSB5b3UgdG8gdGhlIDxiPkhvdyBUbyBHdWlkZTwvYj4nLAogICAgICAgIHBvc2l0aW9uOiAncmlnaHQnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcucHJvZHVjdC1kZWZhdWx0cycsCiAgICAgICAgY29udGVudDogJzxiPlN0ZXAgMTogUHJvZHVjdCBEZWZhdWx0cyDimpnvuI88L2I+IFN0YXJ0IGhlcmUgYmVmb3JlIGFkZGluZyBhIHByb2R1Y3QuIFNldCB0aGUgXCdUYXhcJyBhbmQgXCdQcm9kdWN0IFR5cGVcJy4gWW91ciBjaG9pY2UgaGVyZSBjaGFuZ2VzIHdoaWNoIGZpZWxkcyBhcmUgcmVxdWlyZWQgaW4gdGhlIGZvcm0gYmVsb3cuJywKICAgICAgICBwb3NpdGlvbjogJ2JvdHRvbScKICAgIH0sCiAgICB7CiAgICAgICAgZWxlbWVudDogJy5saWJyYXJ5LW1hbmFnZW1lbnQnLAogICAgICAgIGNvbnRlbnQ6ICc8Yj5TdGVwIDI6IExpYnJhcmllcyAmIFByZXNldHMg8J+TmjwvYj4gVGhpcyBpcyBhIGh1Z2UgdGltZS1zYXZlciEgTWFuYWdlIHlvdXIgcmV1c2FibGUgTW9kaWZpZXIgbGlzdHMgKGxpa2UgcGl6emEgdG9wcGluZ3MpIGFuZCBWYXJpYW50IFByZXNldHMgKGxpa2UgVC1zaGlydCBzaXplcykgaGVyZS4nLAogICAgICAgIHBvc2l0aW9uOiAnYm90dG9tJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3Byb2R1Y3RGb3JtJywKICAgICAgICBjb250ZW50OiAnPGI+U3RlcCAzOiBUaGUgTWFpbiBGb3JtIPCfk508L2I+IFRoaXMgaXMgd2hlcmUgdGhlIG1hZ2ljIGhhcHBlbnMuIEZpbGwgaW4gYWxsIHlvdXIgcHJvZHVjdCBkZXRhaWxzLiBOb3RpY2UgaG93IGl0IGNoYW5nZXMgYmFzZWQgb24gdGhlICJQcm9kdWN0IFR5cGUiIHlvdSBzZWxlY3RlZC4nLAogICAgICAgIHBvc2l0aW9uOiAndG9wJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnLnRhYnMnLAogICAgICAgIGNvbnRlbnQ6ICc8Yj5TdGVwIDQ6IFlvdXIgUHJvZHVjdCBMaXN0cyDinIU8L2I+IEFzIHlvdSBhZGQgcHJvZHVjdHMsIHRoZXkgd2lsbCBhcHBlYXIgaGVyZS4gVGhlICJQcm9kdWN0cyIgdGFiIGlzIGZvciBzZWxsYWJsZSBpdGVtcyBhbmQgIlN0b2NrIEl0ZW1zIiBpcyBmb3IgaW52ZW50b3J5LiBZb3UgY2FuIGVkaXQgb3IgcmVtb3ZlIHRoZW0gYW55dGltZS4nLAogICAgICAgIHBvc2l0aW9uOiAndG9wJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnaGVhZGVyIC5idXR0b24tY29udGFpbmVyJywKICAgICAgICBjb250ZW50OiAiPGI+WW91J3JlIGFsbCBzZXQhIPCfmoA8L2I+IFdoZW4geW91J3JlIGZpbmlzaGVkIGFkZGluZyBhbGwgeW91ciBwcm9kdWN0cywgY2xpY2sgdGhlIFwiRXhwb3J0IHRvIEV4Y2VsXCIgYnV0dG9uIHVwIGhlcmUgdG8gZ2V0IHlvdXIgZmluYWwgZmlsZS4gR29vZCBsdWNrISIsCiAgICAgICAgcG9zaXRpb246ICdsZWZ0JwogICAgfQpdOwoKICAgIGZ1bmN0aW9uIHN0YXJ0VHV0b3JpYWwoKSB7CiAgICAgICAgY3VycmVudFR1dG9yaWFsU3RlcCA9IDA7CiAgICAgICAgdHV0b3JpYWxPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIHNob3dUdXRvcmlhbFN0ZXAoY3VycmVudFR1dG9yaWFsU3RlcCk7CiAgICB9CgogICAgZnVuY3Rpb24gZW5kVHV0b3JpYWwoKSB7CiAgICAgICAgdHV0b3JpYWxPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnR1dG9yaWFsLW92ZXJsYXktcGFydCcpLmZvckVhY2gocGFydCA9PiB7CiAgICAgICAgICAgIHBhcnQuc3R5bGUud2lkdGggPSAnMCc7CiAgICAgICAgICAgIHBhcnQuc3R5bGUuaGVpZ2h0ID0gJzAnOwogICAgICAgIH0pOwogICAgICAgIHR1dG9yaWFsUG9wb3Zlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIGlmIChoaWdobGlnaHRlZEVsZW1lbnQpIHsKICAgICAgICAgICAgaGlnaGxpZ2h0ZWRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodC1lbGVtZW50Jyk7CiAgICAgICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudCA9IG51bGw7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNob3dUdXRvcmlhbFN0ZXAoaW5kZXgpIHsKICAgICAgICBpZiAoaGlnaGxpZ2h0ZWRFbGVtZW50KSB7CiAgICAgICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQtZWxlbWVudCcpOwogICAgICAgIH0KICAgICAgICBjb25zdCBzdGVwID0gdHV0b3JpYWxTdGVwc1tpbmRleF07CiAgICAgICAgY29uc3QgdGFyZ2V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc3RlcC5lbGVtZW50KTsKCiAgICAgICAgaWYgKCF0YXJnZXRFbGVtZW50KSB7CiAgICAgICAgICAgIGlmIChpbmRleCA8IHR1dG9yaWFsU3RlcHMubGVuZ3RoIC0gMSkgeyBzaG93VHV0b3JpYWxTdGVwKGluZGV4ICsgMSk7IH0gCiAgICAgICAgICAgIGVsc2UgeyBlbmRUdXRvcmlhbCgpOyB9CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdHV0b3JpYWxQb3BvdmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudCA9IHRhcmdldEVsZW1lbnQ7CiAgICAgICAgaGlnaGxpZ2h0ZWRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodC1lbGVtZW50Jyk7CiAgICAgICAgdGFyZ2V0RWxlbWVudC5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdjZW50ZXInLCBpbmxpbmU6ICdjZW50ZXInIH0pOwogICAgICAgIHBvcG92ZXJDb250ZW50LmlubmVySFRNTCA9IHN0ZXAuY29udGVudDsKICAgICAgICBzdGVwQ291bnRlci50ZXh0Q29udGVudCA9IGBTdGVwICR7aW5kZXggKyAxfSBvZiAke3R1dG9yaWFsU3RlcHMubGVuZ3RofWA7CiAgICAgICAgCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHBvc2l0aW9uUG9wb3Zlcih0YXJnZXRFbGVtZW50LCBzdGVwLnBvc2l0aW9uKTsKICAgICAgICAgICAgcG9zaXRpb25TcG90bGlnaHQodGFyZ2V0RWxlbWVudCk7CiAgICAgICAgfSwgMzAwKTsKCiAgICAgICAgcHJldkJ0bi5kaXNhYmxlZCA9IGluZGV4ID09PSAwOwogICAgICAgIG5leHRCdG4udGV4dENvbnRlbnQgPSBpbmRleCA9PT0gdHV0b3JpYWxTdGVwcy5sZW5ndGggLSAxID8gJ0ZpbmlzaCcgOiAnTmV4dCc7CiAgICB9CgogICAgZnVuY3Rpb24gcG9zaXRpb25TcG90bGlnaHQodGFyZ2V0KSB7CiAgICAgICAgY29uc3QgdGFyZ2V0UmVjdCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS10b3AnKS5zdHlsZS5oZWlnaHQgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktdG9wJykuc3R5bGUud2lkdGggPSAnMTAwdncnOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWJvdHRvbScpLnN0eWxlLnRvcCA9IGAke3RhcmdldFJlY3QuYm90dG9tfXB4YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1ib3R0b20nKS5zdHlsZS5oZWlnaHQgPSBgY2FsYygxMDB2aCAtICR7dGFyZ2V0UmVjdC5ib3R0b219cHgpYDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1ib3R0b20nKS5zdHlsZS53aWR0aCA9ICcxMDB2dyc7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktbGVmdCcpLnN0eWxlLnRvcCA9IGAke3RhcmdldFJlY3QudG9wfXB4YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1sZWZ0Jykuc3R5bGUuaGVpZ2h0ID0gYCR7dGFyZ2V0UmVjdC5oZWlnaHR9cHhgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWxlZnQnKS5zdHlsZS53aWR0aCA9IGAke3RhcmdldFJlY3QubGVmdH1weGA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktcmlnaHQnKS5zdHlsZS50b3AgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktcmlnaHQnKS5zdHlsZS5oZWlnaHQgPSBgJHt0YXJnZXRSZWN0LmhlaWdodH1weGA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktcmlnaHQnKS5zdHlsZS5sZWZ0ID0gYCR7dGFyZ2V0UmVjdC5yaWdodH1weGA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktcmlnaHQnKS5zdHlsZS53aWR0aCA9IGBjYWxjKDEwMHZ3IC0gJHt0YXJnZXRSZWN0LnJpZ2h0fXB4KWA7CiAgICB9CgogICAgZnVuY3Rpb24gcG9zaXRpb25Qb3BvdmVyKHRhcmdldCwgcG9zaXRpb24pIHsKICAgICAgICBjb25zdCB0YXJnZXRSZWN0ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGNvbnN0IHBvcG92ZXJOb2RlID0gdHV0b3JpYWxQb3BvdmVyOwogICAgICAgIHBvcG92ZXJOb2RlLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJzsKICAgICAgICBjb25zdCBwb3BvdmVyUmVjdCA9IHBvcG92ZXJOb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIHBvcG92ZXJOb2RlLnN0eWxlLnZpc2liaWxpdHkgPSAnJzsKICAgICAgICBjb25zdCBzcGFjaW5nID0gMTU7CiAgICAgICAgcG9wb3Zlck5vZGUuY2xhc3NOYW1lID0gJ3R1dG9yaWFsLXBvcG92ZXInOwogICAgICAgIGxldCB0b3AsIGxlZnQ7CgogICAgICAgIHN3aXRjaCAocG9zaXRpb24pIHsKICAgICAgICAgICAgY2FzZSAndG9wJzoKICAgICAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wIC0gcG9wb3ZlclJlY3QuaGVpZ2h0IC0gc3BhY2luZzsKICAgICAgICAgICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgKyAodGFyZ2V0UmVjdC53aWR0aCAvIDIpIC0gKHBvcG92ZXJSZWN0LndpZHRoIC8gMik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnYm90dG9tJzoKICAgICAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QuYm90dG9tICsgc3BhY2luZzsKICAgICAgICAgICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgKyAodGFyZ2V0UmVjdC53aWR0aCAvIDIpIC0gKHBvcG92ZXJSZWN0LndpZHRoIC8gMik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnbGVmdCc6CiAgICAgICAgICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5sZWZ0IC0gcG9wb3ZlclJlY3Qud2lkdGggLSBzcGFjaW5nOwogICAgICAgICAgICAgICAgdG9wID0gdGFyZ2V0UmVjdC50b3AgKyAodGFyZ2V0UmVjdC5oZWlnaHQgLyAyKSAtIChwb3BvdmVyUmVjdC5oZWlnaHQgLyAyKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdyaWdodCc6CiAgICAgICAgICAgICAgICBsZWZ0ID0gdGFyZ2V0UmVjdC5yaWdodCArIHNwYWNpbmc7CiAgICAgICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCArICh0YXJnZXRSZWN0LmhlaWdodCAvIDIpIC0gKHBvcG92ZXJSZWN0LmhlaWdodCAvIDIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIChsZWZ0IDwgc3BhY2luZykgbGVmdCA9IHNwYWNpbmc7CiAgICAgICAgaWYgKChsZWZ0ICsgcG9wb3ZlclJlY3Qud2lkdGgpID4gd2luZG93LmlubmVyV2lkdGggLSBzcGFjaW5nKSBsZWZ0ID0gd2luZG93LmlubmVyV2lkdGggLSBwb3BvdmVyUmVjdC53aWR0aCAtIHNwYWNpbmc7CiAgICAgICAgaWYgKHRvcCA8IHNwYWNpbmcpIHRvcCA9IHNwYWNpbmc7CiAgICAgICAgaWYgKCh0b3AgKyBwb3BvdmVyUmVjdC5oZWlnaHQpID4gd2luZG93LmlubmVySGVpZ2h0IC0gc3BhY2luZykgdG9wID0gd2luZG93LmlubmVySGVpZ2h0IC0gcG9wb3ZlclJlY3QuaGVpZ2h0IC0gc3BhY2luZzsKCiAgICAgICAgcG9wb3Zlck5vZGUuc3R5bGUudG9wID0gYCR7dG9wfXB4YDsKICAgICAgICBwb3BvdmVyTm9kZS5zdHlsZS5sZWZ0ID0gYCR7bGVmdH1weGA7CiAgICAgICAgcG9wb3Zlck5vZGUuY2xhc3NMaXN0LmFkZChgYXJyb3ctJHtwb3NpdGlvbn1gKTsKICAgIH0KCiAgICBzdGFydFR1dG9yaWFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIHR1dG9yaWFsUHJvbXB0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9kdWN0TG9hZGVyVHV0b3JpYWxTaG93bicsICd0cnVlJyk7CiAgICAgICAgc3RhcnRUdXRvcmlhbCgpOwogICAgfSk7CgogICAgc2tpcFR1dG9yaWFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIHR1dG9yaWFsUHJvbXB0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9kdWN0TG9hZGVyVHV0b3JpYWxTaG93bicsICd0cnVlJyk7CiAgICB9KTsKCiAgICBwcmV2QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGlmIChjdXJyZW50VHV0b3JpYWxTdGVwID4gMCkgewogICAgICAgICAgICBjdXJyZW50VHV0b3JpYWxTdGVwLS07CiAgICAgICAgICAgIHNob3dUdXRvcmlhbFN0ZXAoY3VycmVudFR1dG9yaWFsU3RlcCk7CiAgICAgICAgfQogICAgfSk7CgogICAgbmV4dEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICBpZiAoY3VycmVudFR1dG9yaWFsU3RlcCA8IHR1dG9yaWFsU3RlcHMubGVuZ3RoIC0gMSkgewogICAgICAgICAgICBjdXJyZW50VHV0b3JpYWxTdGVwKys7CiAgICAgICAgICAgIHNob3dUdXRvcmlhbFN0ZXAoY3VycmVudFR1dG9yaWFsU3RlcCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZW5kVHV0b3JpYWwoKTsKICAgICAgICB9CiAgICB9KTsKICAgIAogICAgLy8gLS0tIFJFR1VMQVIgQVBQIElOSVRJQUxJWkFUSU9OIC0tLQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hvd1RvR3VpZGVMaW5rJykuaHJlZiA9IEhPV19UT19HVUlERV9VUkw7CiAgICBsb2FkU3RhdGUoKTsKICAgIHVwZGF0ZVJlcXVpcmVkRmllbGRzKCk7CiAgICBzZXR1cElubGluZVZhbGlkYXRpb24oKTsKCiAgICBpZiAoIWRlZmF1bHRzU2V0KSB7CiAgICAgICAgc2Vzc2lvbkRlZmF1bHRzTW9kYWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgfSBlbHNlIHsKICAgICAgICBlZGl0U2Vzc2lvbkJ0bi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7CiAgICB9CgogICAgY29uc3Qgc2VjcmV0VHJpZ2dlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWNyZXRUcmlnZ2VyJyk7CiAgICBpZiAoc2VjcmV0VHJpZ2dlcikgewogICAgICAgIHNlY3JldFRyaWdnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHNlY3JldENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWNyZXRBY3Rpb25zQ29udGFpbmVyJyk7CiAgICAgICAgICAgIGlmIChzZWNyZXRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnKSB7CiAgICAgICAgICAgICAgICBzZWNyZXRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNlY3JldENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRhYi1saW5rJykuZm9yRWFjaChidXR0b24gPT4gewogICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgY29uc3QgdGFiSWQgPSBidXR0b24uZGF0YXNldC50YWI7CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWItbGluaycpLmZvckVhY2godGFiID0+IHRhYi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWItY29udGVudCcpLmZvckVhY2goY29udGVudCA9PiBjb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YWJJZCkuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgICAgfSk7CiAgICB9KTsKCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Nyb2xsVG9Ub3BCdG4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB3aW5kb3cuc2Nyb2xsVG8oeyB0b3A6IDAsIGJlaGF2aW9yOiAnc21vb3RoJyB9KSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Nyb2xsVG9Cb3R0b21CdG4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB3aW5kb3cuc2Nyb2xsVG8oeyB0b3A6IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LCBiZWhhdmlvcjogJ3Ntb290aCcgfSkpOwoKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0U2VhcmNoJykuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiBmaWx0ZXJUYWJsZSgncHJvZHVjdFNlYXJjaCcsICdwcm9kdWN0VGFibGUnLCAncHJvZHVjdENhdGVnb3J5RmlsdGVyJykpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RDYXRlZ29yeUZpbHRlcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IGZpbHRlclRhYmxlKCdwcm9kdWN0U2VhcmNoJywgJ3Byb2R1Y3RUYWJsZScsICdwcm9kdWN0Q2F0ZWdvcnlGaWx0ZXInKSk7CgogICAgcHJvZHVjdFR5cGVTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdXBkYXRlUmVxdWlyZWRGaWVsZHMpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RheEFwcGxpY2FibGUnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBzYXZlU3RhdGUpOwoKICAgIGNvbnN0IGZpZWxkc1RvQ2FwaXRhbGl6ZSA9IFsnc2Vzc2lvblNpdGUnLCAncHJvZHVjdE5hbWUnLCAncHJlcExvY2F0aW9uJywgJ21lbnVDYXRlZ29yeScsICdpbnZlbnRvcnlDYXRlZ29yeScsICdpbnZlbnRvcnlTdWJDYXRlZ29yeSddOwogICAgZmllbGRzVG9DYXBpdGFsaXplLmZvckVhY2goaWQgPT4gewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKT8uYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIChlKSA9PiB7CiAgICAgICAgICAgIGUudGFyZ2V0LnZhbHVlID0gY2FwaXRhbGl6ZVdvcmRzKGUudGFyZ2V0LnZhbHVlLnRyaW0oKSk7CiAgICAgICAgfSk7CiAgICB9KTsKICAgIAogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nsb3NlTGlua01vZGlmaWVyTW9kYWxCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgZ2VuZXJhdGVBbmRSZW5kZXJQcmljaW5nKCk7IAogICAgfSk7CiAgICAKICAgIC8vIC0tLSBQQVNURSBUSEUgQ1VUIEVWRU5UIExJU1RFTkVSUyBIRVJFIC0tLQogICAgbWFpbkFjdGlvbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZU1haW5BY3Rpb24pOwogICAgc2Vzc2lvbkRlZmluZVBsdVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7IGlmIChkZWZhdWx0c1NldCkgeyBzZXNzaW9uRGVmaW5lUGx1ID0gc2Vzc2lvbkRlZmluZVBsdVNlbGVjdC52YWx1ZTsgaGFuZGxlUGx1VmlzaWJpbGl0eSgpOyB9IH0pOwogICAgaW52ZW50b3J5Q2F0ZWdvcnlJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGhhbmRsZUludmVudG9yeUNhdGVnb3J5Q2hhbmdlKTsKICAgIGhhc0JhcmNvZGVTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlQmFyY29kZVZpc2liaWxpdHkpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ29wZW5MaWJyYXJ5TW9kYWxCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IGxpYnJhcnlNYW5hZ2VtZW50TW9kYWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcGVuTW9kaWZpZXJNb2RhbEJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGxpYnJhcnlNYW5hZ2VtZW50TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIHJlbmRlck1vZGlmaWVyTW9kYWwoKTsKICAgICAgICBtb2RpZmllck1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgIH0pOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hbmFnZVZhcmlhbnRQcmVzZXRzQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgbGlicmFyeU1hbmFnZW1lbnRNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgb3Blbk1hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwoKTsKICAgIH0pOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hbmFnZU1vZGlmaWVyUHJlc2V0c0J0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGxpYnJhcnlNYW5hZ2VtZW50TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIG9wZW5NYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbCgpOwogICAgfSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlQcmVzZXRCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5BcHBseVZhcmlhbnRQcmVzZXRNb2RhbCk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2F2ZUFzUHJlc2V0QnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzYXZlQ3VycmVudFZhcmlhbnRzQXNQcmVzZXQpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmtTaW5nbGVNb2RpZmllckJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gb3BlbkxpbmtNb2RpZmllck1vZGFsKCcnKSk7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0RGVmYXVsdHNCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNldERlZmF1bHRzKTsKICAgIGVkaXRTZXNzaW9uQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gc2Vzc2lvbkRlZmF1bHRzTW9kYWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zZU1vZGlmaWVyTW9kYWxCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IG1vZGlmaWVyTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlTW9kaWZpZXJzQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBzYXZlTW9kaWZpZXJzRnJvbU1vZGFsKHRydWUpKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlVmFyaWFudFByZXNldHNCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVWYXJpYW50UHJlc2V0c0Zyb21NYW5hZ2VyKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlTW9kaWZpZXJQcmVzZXRzQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzYXZlTW9kaWZpZXJQcmVzZXRzRnJvbU1hbmFnZXIpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5TW9kaWZpZXJQcmVzZXRCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5BcHBseU1vZGlmaWVyUHJlc2V0TW9kYWwpOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVNb2RpZmllcnNBc1ByZXNldEJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2F2ZU1vZGlmaWVyc0FzUHJlc2V0KTsKICAgIHN1cHBsaWVkUXVhbnRpdHlJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHVwZGF0ZUdob3N0VGV4dCk7CiAgICBzdXBwbGllZFF1YW50aXR5SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB1cGRhdGVHaG9zdFRleHQpOwogICAgc3VwcGxpZWRRdWFudGl0eUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB1cGRhdGVHaG9zdFRleHQpOwogICAgeWllbGRRdWFudGl0eUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdXBkYXRlWWllbGRHaG9zdFRleHQpOwogICAgeWllbGRRdWFudGl0eUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdXBkYXRlWWllbGRHaG9zdFRleHQpOwogICAgeWllbGRRdWFudGl0eUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB1cGRhdGVZaWVsZEdob3N0VGV4dCk7CiAgICB1b21TZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4gewogICAgICAgIHVwZGF0ZUdob3N0VGV4dCgpOwogICAgICAgIHVwZGF0ZVlpZWxkR2hvc3RUZXh0KCk7CiAgICB9KTsKICAgIHJlbWVtYmVyQ2F0ZWdvcmllc0NoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7CiAgICAgICAgcmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tlZCA9IGUudGFyZ2V0LmNoZWNrZWQ7CiAgICAgICAgc2F2ZVN0YXRlKCk7CiAgICB9KTsKfSk7CgogICAgLy8gLS0tIEhFTFBFUiBGVU5DVElPTlMgLS0tCiAgICBmdW5jdGlvbiBzYW5pdGl6ZUlucHV0KHN0cikgewogICAgICAgIGlmICghc3RyKSByZXR1cm4gJyc7CiAgICAgICAgY29uc3QgYWxsb3dlZENoYXJzUmVnZXggPSAvW15hLXpBLVowLTkgXC0uLCYoKVJdL2c7CiAgICAgICAgcmV0dXJuIHN0ci50b1N0cmluZygpLnJlcGxhY2UoYWxsb3dlZENoYXJzUmVnZXgsICcnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjYXBpdGFsaXplV29yZHMoc3RyKSB7CiAgICAgICAgaWYgKCFzdHIpIHJldHVybiAnJzsKICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1xiXHcvZywgY2hhciA9PiBjaGFyLnRvVXBwZXJDYXNlKCkpOwogICAgfQoKICAgIC8vIC0tLSBNT0RJRklFUiBMSUJSQVJZICYgUFJFU0VUIExPR0lDIC0tLQogICAgZnVuY3Rpb24gaW5pdGlhbGl6ZURlZmF1bHRNb2RpZmllclByZXNldHMoKSB7CiAgICAgICAgbW9kaWZpZXJQcmVzZXRzID0gWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuYW1lOiAiU3RlYWsgVGVtcGVyYXR1cmUiLAogICAgICAgICAgICAgICAgZ3JvdXBzOiBbeyBncm91cE5hbWU6ICJTdGVhayBUZW1wZXJhdHVyZSIsIG9wdGlvbnM6IFt7IG5hbWU6ICJSYXJlIiwgcHJpY2U6IDAgfSwgeyBuYW1lOiAiTWVkaXVtIFJhcmUiLCBwcmljZTogMCB9LCB7IG5hbWU6ICJNZWRpdW0iLCBwcmljZTogMCB9LCB7IG5hbWU6ICJNZWRpdW0gV2VsbCIsIHByaWNlOiAwIH0sIHsgbmFtZTogIldlbGwgRG9uZSIsIHByaWNlOiAwIH1dIH1dCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6ICJFZ2cgUHJlcGFyYXRpb24iLAogICAgICAgICAgICAgICAgZ3JvdXBzOiBbeyBncm91cE5hbWU6ICJFZ2cgU3R5bGUiLCBvcHRpb25zOiBbeyBuYW1lOiAiRnJpZWQiLCBwcmljZTogMCB9LCB7IG5hbWU6ICJTY3JhbWJsZWQiLCBwcmljZTogMCB9LCB7IG5hbWU6ICJQb2FjaGVkIiwgcHJpY2U6IDAgfSwgeyBuYW1lOiAiQm9pbGVkIFNvZnQiLCBwcmljZTogMCB9XSB9XQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuYW1lOiAiUGl6emEgVG9wcGluZ3MgKEV4dHJhcykiLAogICAgICAgICAgICAgICAgZ3JvdXBzOiBbeyBncm91cE5hbWU6ICJFeHRyYSBUb3BwaW5ncyIsIG9wdGlvbnM6IFt7IG5hbWU6ICJFeHRyYSBDaGVlc2UiLCBwcmljZTogMTUgfSwgeyBuYW1lOiAiQmFjb24iLCBwcmljZTogMjAgfSwgeyBuYW1lOiAiTXVzaHJvb20iLCBwcmljZTogMTIgfSwgeyBuYW1lOiAiT2xpdmVzIiwgcHJpY2U6IDEwIH0sIHsgbmFtZTogIkF2byIsIHByaWNlOiAyNSB9XSB9XQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuYW1lOiAiQnVyZ2VyL1NhbmR3aWNoIEFkZC1vbnMiLAogICAgICAgICAgICAgICAgZ3JvdXBzOiBbeyBncm91cE5hbWU6ICJBZGQtb25zIiwgb3B0aW9uczogW3sgbmFtZTogIkNoZWVzZSBTbGljZSIsIHByaWNlOiAxMCB9LCB7IG5hbWU6ICJCYWNvbiIsIHByaWNlOiAyMCB9LCB7IG5hbWU6ICJBdm8iLCBwcmljZTogMjUgfSwgeyBuYW1lOiAiTXVzaHJvb20gU2F1Y2UiLCBwcmljZTogMTggfV0gfV0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogIlNhbGFkIERyZXNzaW5ncyIsCiAgICAgICAgICAgICAgICBncm91cHM6IFt7IGdyb3VwTmFtZTogIkRyZXNzaW5nIENob2ljZSIsIG9wdGlvbnM6IFt7IG5hbWU6ICJWaW5haWdyZXR0ZSIsIHByaWNlOiAwIH0sIHsgbmFtZTogIlJhbmNoIiwgcHJpY2U6IDAgfSwgeyBuYW1lOiAiSXRhbGlhbiIsIHByaWNlOiAwIH0sIHsgbmFtZTogIkJsdWUgQ2hlZXNlIiwgcHJpY2U6IDAgfV0gfV0KICAgICAgICAgICAgfSwKICAgICAgICBdOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBzYXZlTW9kaWZpZXJzQXNQcmVzZXQoKSB7CiAgICAgICAgc2F2ZU1vZGlmaWVyc0Zyb21Nb2RhbChmYWxzZSk7IC8vIEZpcnN0LCBjYXB0dXJlIGFueSBjaGFuZ2VzIG1hZGUgaW4gdGhlIG1vZGFsIGlucHV0cwogICAgICAgIGlmIChjdXJyZW50TW9kaWZpZXJHcm91cHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgiVGhlIG1vZGlmaWVyIGxpYnJhcnkgaXMgZW1wdHkuIEFkZCBzb21lIGdyb3VwcyBiZWZvcmUgc2F2aW5nIGEgcHJlc2V0LiIsICJlcnJvciIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHNob3dQcm9tcHRNb2RhbCgiRW50ZXIgYSBuYW1lIGZvciB0aGlzIG5ldyBtb2RpZmllciBwcmVzZXQgbGlicmFyeToiLCAocHJlc2V0TmFtZSkgPT4gewogICAgICAgICAgICBpZiAobW9kaWZpZXJQcmVzZXRzLnNvbWUocCA9PiBwLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gcHJlc2V0TmFtZS50b0xvd2VyQ2FzZSgpKSkgewogICAgICAgICAgICAgICAgc2hvd01vZGFsKGBBIG1vZGlmaWVyIHByZXNldCBuYW1lZCAiJHtwcmVzZXROYW1lfSIgYWxyZWFkeSBleGlzdHMuYCwgImVycm9yIik7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgbmV3UHJlc2V0ID0geyBuYW1lOiBwcmVzZXROYW1lLCBncm91cHM6IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY3VycmVudE1vZGlmaWVyR3JvdXBzKSkgfTsKICAgICAgICAgICAgbW9kaWZpZXJQcmVzZXRzLnB1c2gobmV3UHJlc2V0KTsKICAgICAgICAgICAgc2F2ZVN0YXRlKCk7CiAgICAgICAgICAgIHNob3dNb2RhbChgTW9kaWZpZXIgcHJlc2V0ICIke3ByZXNldE5hbWV9IiBzYXZlZCBzdWNjZXNzZnVsbHkuYCwgJ3dhcm5pbmcnKTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcGVuQXBwbHlNb2RpZmllclByZXNldE1vZGFsKCkgewogICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseU1vZGlmaWVyUHJlc2V0TGlzdENvbnRhaW5lcicpOwogICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsKICAgICAgICBpZiAobW9kaWZpZXJQcmVzZXRzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gYDxwIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7Ij5ObyBtb2RpZmllciBwcmVzZXRzIGhhdmUgYmVlbiBzYXZlZCB5ZXQuPC9wPmA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbW9kaWZpZXJQcmVzZXRzLmZvckVhY2gocHJlc2V0ID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgIGl0ZW0uc3R5bGUgPSAnZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyBhbGlnbi1pdGVtczogY2VudGVyOyBwYWRkaW5nOiAxMHB4OyBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOyc7CiAgICAgICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IGA8c3Bhbj4ke3ByZXNldC5uYW1lfTwvc3Bhbj5gOwogICAgICAgICAgICAgICAgY29uc3QgYXBwbHlCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgICAgIGFwcGx5QnRuLnRleHRDb250ZW50ID0gJ0FwcGx5JzsKICAgICAgICAgICAgICAgIGFwcGx5QnRuLmNsYXNzTmFtZSA9ICdidG4tYWRkIGJ0bi1hZGQtZHluYW1pYyc7CiAgICAgICAgICAgICAgICBhcHBseUJ0bi5vbmNsaWNrID0gKCkgPT4gYXBwbHlNb2RpZmllclByZXNldChwcmVzZXQubmFtZSk7CiAgICAgICAgICAgICAgICBpdGVtLmFwcGVuZENoaWxkKGFwcGx5QnRuKTsKICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpdGVtKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNvbnN0IHdhcm5pbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlNb2RpZmllclByZXNldFdhcm5pbmcnKTsKICAgICAgICB3YXJuaW5nLnRleHRDb250ZW50ID0gY3VycmVudE1vZGlmaWVyR3JvdXBzLmxlbmd0aCA+IDAgPyAKICAgICAgICAgICAgJ1dhcm5pbmc6IEFwcGx5aW5nIGEgcHJlc2V0IHdpbGwgb3ZlcndyaXRlIHlvdXIgZW50aXJlIGN1cnJlbnQgbW9kaWZpZXIgbGlicmFyeS4nIDogCiAgICAgICAgICAgICdTZWxlY3QgYSBwcmVzZXQgdG8gbG9hZCBpbnRvIHRoZSBtb2RpZmllciBsaWJyYXJ5Lic7CiAgICAgICAgYXBwbHlNb2RpZmllclByZXNldE1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHBseU1vZGlmaWVyUHJlc2V0KHByZXNldE5hbWUpIHsKICAgICAgICBjb25zdCBwcmVzZXQgPSBtb2RpZmllclByZXNldHMuZmluZChwID0+IHAubmFtZSA9PT0gcHJlc2V0TmFtZSk7CiAgICAgICAgaWYgKCFwcmVzZXQpIHJldHVybjsKCiAgICAgICAgY29uc3QgYXBwbHkgPSAoKSA9PiB7CiAgICAgICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3VwcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocHJlc2V0Lmdyb3VwcykpOwogICAgICAgICAgICByZW5kZXJNb2RpZmllck1vZGFsKCk7IC8vIFJlLXJlbmRlciB0aGUgbWFpbiBtb2RpZmllciBtb2RhbCB3aXRoIG5ldyBkYXRhCiAgICAgICAgICAgIGFwcGx5TW9kaWZpZXJQcmVzZXRNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgICAgIHNob3dNb2RhbChgTW9kaWZpZXIgcHJlc2V0ICIke3ByZXNldE5hbWV9IiBoYXMgYmVlbiBsb2FkZWQuYCwgJ3dhcm5pbmcnKTsKICAgICAgICB9OwoKICAgICAgICBpZiAoY3VycmVudE1vZGlmaWVyR3JvdXBzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgc2hvd01vZGFsKGBBcmUgeW91IHN1cmU/IFRoaXMgd2lsbCByZXBsYWNlIHlvdXIgY3VycmVudCBtb2RpZmllciBsaWJyYXJ5IHdpdGggdGhlICIke3ByZXNldE5hbWV9IiBwcmVzZXQuYCwgJ3dhcm5pbmcnLCBhcHBseSwgdHJ1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYXBwbHkoKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIG9wZW5NYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbCgpIHsKICAgICAgICByZW5kZXJNYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbCgpOwogICAgICAgIG1hbmFnZU1vZGlmaWVyUHJlc2V0c01vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgIH0KCiAgICBmdW5jdGlvbiByZW5kZXJNYW5hZ2VNb2RpZmllclByZXNldHNNb2RhbCgpIHsKICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdE1vZGlmaWVyUHJlc2V0c0NvbnRhaW5lcicpOwogICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsKICAgICAgICBpZiAobW9kaWZpZXJQcmVzZXRzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gYDxwIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7Ij5ObyBtb2RpZmllciBwcmVzZXRzIHNhdmVkIHlldC48L3A+YDsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBtb2RpZmllclByZXNldHMuZm9yRWFjaChwcmVzZXQgPT4gewogICAgICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgcm93LnN0eWxlID0gJ2Rpc3BsYXk6IGZsZXg7IGdhcDogMTBweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgbWFyZ2luLWJvdHRvbTogMTBweDsnOwogICAgICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgICAgIGlucHV0LnR5cGUgPSAndGV4dCc7CiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gcHJlc2V0Lm5hbWU7CiAgICAgICAgICAgIGlucHV0LmRhdGFzZXQub3JpZ2luYWxOYW1lID0gcHJlc2V0Lm5hbWU7CiAgICAgICAgICAgIGlucHV0LnN0eWxlLmZsZXhHcm93ID0gJzEnOwogICAgICAgICAgICBjb25zdCBkZWxldGVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgZGVsZXRlQnRuLmNsYXNzTmFtZSA9ICdidG4tcmVtb3ZlJzsKICAgICAgICAgICAgZGVsZXRlQnRuLmlubmVySFRNTCA9IGAmbmRhc2g7YDsKICAgICAgICAgICAgZGVsZXRlQnRuLm9uY2xpY2sgPSAoKSA9PiBkZWxldGVNb2RpZmllclByZXNldChwcmVzZXQubmFtZSk7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChpbnB1dCk7CiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChkZWxldGVCdG4pOwogICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93KTsKICAgICAgICB9KTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gc2F2ZU1vZGlmaWVyUHJlc2V0c0Zyb21NYW5hZ2VyKCkgewogICAgICAgIGNvbnN0IGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNlZGl0TW9kaWZpZXJQcmVzZXRzQ29udGFpbmVyIGlucHV0Jyk7CiAgICAgICAgY29uc3QgbmV3UHJlc2V0cyA9IFtdOwogICAgICAgIGNvbnN0IG5hbWVzID0gbmV3IFNldCgpOwogICAgICAgIGxldCBoYXNFcnJvciA9IGZhbHNlOwoKICAgICAgICBpbnB1dHMuZm9yRWFjaChpbnB1dCA9PiB7CiAgICAgICAgICAgIGNvbnN0IG5ld05hbWUgPSBpbnB1dC52YWx1ZS50cmltKCk7CiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsTmFtZSA9IGlucHV0LmRhdGFzZXQub3JpZ2luYWxOYW1lOwogICAgICAgICAgICBpZiAoIW5ld05hbWUgfHwgbmFtZXMuaGFzKG5ld05hbWUudG9Mb3dlckNhc2UoKSkpIHsKICAgICAgICAgICAgICAgIGhhc0Vycm9yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHNob3dNb2RhbChuZXdOYW1lID8gYER1cGxpY2F0ZSBwcmVzZXQgbmFtZTogIiR7bmV3TmFtZX0iYCA6ICJQcmVzZXQgbmFtZXMgY2Fubm90IGJlIGVtcHR5LiIsICJlcnJvciIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5hbWVzLmFkZChuZXdOYW1lLnRvTG93ZXJDYXNlKCkpOwogICAgICAgICAgICBjb25zdCBvcmlnaW5hbFByZXNldCA9IG1vZGlmaWVyUHJlc2V0cy5maW5kKHAgPT4gcC5uYW1lID09PSBvcmlnaW5hbE5hbWUpOwogICAgICAgICAgICBpZihvcmlnaW5hbFByZXNldCkgbmV3UHJlc2V0cy5wdXNoKHsgbmFtZTogbmV3TmFtZSwgZ3JvdXBzOiBvcmlnaW5hbFByZXNldC5ncm91cHMgfSk7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChoYXNFcnJvcikgcmV0dXJuOwoKICAgICAgICBtb2RpZmllclByZXNldHMgPSBuZXdQcmVzZXRzOwogICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgIG1hbmFnZU1vZGlmaWVyUHJlc2V0c01vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICBzaG93TW9kYWwoIk1vZGlmaWVyIHByZXNldHMgdXBkYXRlZC4iLCAid2FybmluZyIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGV0ZU1vZGlmaWVyUHJlc2V0KHByZXNldE5hbWUpIHsKICAgICAgICBzaG93TW9kYWwoYERlbGV0ZSB0aGUgIiR7cHJlc2V0TmFtZX0iIG1vZGlmaWVyIHByZXNldD8gVGhpcyBjYW5ub3QgYmUgdW5kb25lLmAsICd3YXJuaW5nJywgKCkgPT4gewogICAgICAgICAgICBtb2RpZmllclByZXNldHMgPSBtb2RpZmllclByZXNldHMuZmlsdGVyKHAgPT4gcC5uYW1lICE9PSBwcmVzZXROYW1lKTsKICAgICAgICAgICAgc2F2ZVN0YXRlKCk7CiAgICAgICAgICAgIHJlbmRlck1hbmFnZU1vZGlmaWVyUHJlc2V0c01vZGFsKCk7CiAgICAgICAgfSwgdHJ1ZSk7CiAgICB9CiAgICAKICAgIGZ1bmN0aW9uIHJlbmRlck1vZGlmaWVyTW9kYWwoKSB7CiAgICAgICAgcmVuZGVyTmV3TW9kaWZpZXJHcm91cEZvcm0oKTsKICAgICAgICByZW5kZXJFeGlzdGluZ01vZGlmaWVyR3JvdXBzKCk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVuZGVyTmV3TW9kaWZpZXJHcm91cEZvcm0oKSB7CiAgICAgICAgbmV3TW9kaWZpZXJHcm91cEZvcm0uaW5uZXJIVE1MID0gYAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJtb2RpZmllci1ncm91cC1oZWFkZXIiPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJOZXcgR3JvdXAgTmFtZSAoZS5nLiwgQWRkLW9ucykiIGlkPSJuZXdNb2RpZmllckdyb3VwTmFtZSI+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGlkPSJuZXctbW9kaWZpZXItb3B0aW9ucy1jb250YWluZXIiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9kaWZpZXItb3B0aW9uLXJvdyI+CiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJPcHRpb24gTmFtZSIgY2xhc3M9Im5ldy1tb2RpZmllci1vcHRpb24tbmFtZSI+CiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Im51bWJlciIgc3RlcD0iMC4wMSIgcGxhY2Vob2xkZXI9IlByaWNlIiB2YWx1ZT0iMCIgY2xhc3M9Im5ldy1tb2RpZmllci1vcHRpb24tcHJpY2UiPgogICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuLXJlbW92ZSIgZGlzYWJsZWQ+Jm5kYXNoOzwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgaWQ9ImFkZE5ld01vZGlmaWVyT3B0aW9uQnRuIiBjbGFzcz0iYnRuLWFkZC1keW5hbWljIj5BZGQgT3B0aW9uPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBpZD0iY29tbWl0TmV3TW9kaWZpZXJHcm91cEJ0biIgY2xhc3M9ImJ0bi1hZGQiIHN0eWxlPSJtYXJnaW4tdG9wOjEwcHg7IHdpZHRoOiAxMDAlOyI+QWRkIEdyb3VwIHRvIExpYnJhcnk8L2J1dHRvbj4KICAgICAgICBgOwoKICAgICAgICBuZXdNb2RpZmllckdyb3VwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPSJ0ZXh0Il0nKS5mb3JFYWNoKGlucHV0ID0+IHsKICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGUgPT4gZS50YXJnZXQudmFsdWUgPSBjYXBpdGFsaXplV29yZHMoZS50YXJnZXQudmFsdWUudHJpbSgpKSk7CiAgICAgICAgfSk7CgogICAgICAgIG5ld01vZGlmaWVyR3JvdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoJyNhZGROZXdNb2RpZmllck9wdGlvbkJ0bicpLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IG5ld01vZGlmaWVyR3JvdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoJyNuZXctbW9kaWZpZXItb3B0aW9ucy1jb250YWluZXInKTsKICAgICAgICAgICAgY29uc3Qgb3B0aW9uUm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIG9wdGlvblJvdy5jbGFzc05hbWUgPSAnbW9kaWZpZXItb3B0aW9uLXJvdyc7CiAgICAgICAgICAgIG9wdGlvblJvdy5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9Ik9wdGlvbiBOYW1lIiBjbGFzcz0ibmV3LW1vZGlmaWVyLW9wdGlvbi1uYW1lIj4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJudW1iZXIiIHN0ZXA9IjAuMDEiIHBsYWNlaG9sZGVyPSJQcmljZSIgdmFsdWU9IjAiIGNsYXNzPSJuZXctbW9kaWZpZXItb3B0aW9uLXByaWNlIj4KICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuLXJlbW92ZSI+Jm5kYXNoOzwvYnV0dG9uPgogICAgICAgICAgICBgOwogICAgICAgICAgICBvcHRpb25Sb3cucXVlcnlTZWxlY3RvcignLmJ0bi1yZW1vdmUnKS5vbmNsaWNrID0gKCkgPT4gb3B0aW9uUm93LnJlbW92ZSgpOwogICAgICAgICAgICBvcHRpb25Sb3cucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT0idGV4dCJdJykuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGUgPT4gZS50YXJnZXQudmFsdWUgPSBjYXBpdGFsaXplV29yZHMoZS50YXJnZXQudmFsdWUudHJpbSgpKSk7CiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChvcHRpb25Sb3cpOwogICAgICAgIH07CgogICAgICAgIG5ld01vZGlmaWVyR3JvdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoJyNjb21taXROZXdNb2RpZmllckdyb3VwQnRuJykub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgY29uc3QgZ3JvdXBOYW1lID0gc2FuaXRpemVJbnB1dChuZXdNb2RpZmllckdyb3VwRm9ybS5xdWVyeVNlbGVjdG9yKCcjbmV3TW9kaWZpZXJHcm91cE5hbWUnKS52YWx1ZS50cmltKCkpOwogICAgICAgICAgICBpZiAoIWdyb3VwTmFtZSB8fCBjdXJyZW50TW9kaWZpZXJHcm91cHMuc29tZShnID0+IGcuZ3JvdXBOYW1lLnRvTG93ZXJDYXNlKCkgPT09IGdyb3VwTmFtZS50b0xvd2VyQ2FzZSgpKSkgewogICAgICAgICAgICAgICAgc2hvd01vZGFsKGdyb3VwTmFtZSA/IGBBIGdyb3VwIG5hbWVkICIke2dyb3VwTmFtZX0iIGFscmVhZHkgZXhpc3RzLmAgOiAiUGxlYXNlIGVudGVyIGEgZ3JvdXAgbmFtZS4iLCAiZXJyb3IiKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IEFycmF5LmZyb20obmV3TW9kaWZpZXJHcm91cEZvcm0ucXVlcnlTZWxlY3RvckFsbCgnLm1vZGlmaWVyLW9wdGlvbi1yb3cnKSkKICAgICAgICAgICAgICAgIC5tYXAocm93ID0+ICh7CiAgICAgICAgICAgICAgICAgICAgbmFtZTogc2FuaXRpemVJbnB1dChyb3cucXVlcnlTZWxlY3RvcignLm5ldy1tb2RpZmllci1vcHRpb24tbmFtZScpLnZhbHVlLnRyaW0oKSksCiAgICAgICAgICAgICAgICAgICAgcHJpY2U6IHBhcnNlRmxvYXQocm93LnF1ZXJ5U2VsZWN0b3IoJy5uZXctbW9kaWZpZXItb3B0aW9uLXByaWNlJykudmFsdWUpIHx8IDAKICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICAgICAgLmZpbHRlcihvcHQgPT4gb3B0Lm5hbWUpOwoKICAgICAgICAgICAgaWYgKG9wdGlvbnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICBzaG93TW9kYWwoIlBsZWFzZSBhZGQgYXQgbGVhc3Qgb25lIHZhbGlkIG9wdGlvbi4iLCAiZXJyb3IiKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBjdXJyZW50TW9kaWZpZXJHcm91cHMucHVzaCh7IGdyb3VwTmFtZSwgb3B0aW9ucyB9KTsKICAgICAgICAgICAgcmVuZGVyTW9kaWZpZXJNb2RhbCgpOwogICAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gcmVuZGVyRXhpc3RpbmdNb2RpZmllckdyb3VwcygpIHsKICAgICAgICBlZGl0TW9kaWZpZXJHcm91cHNDb250YWluZXIuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgY3VycmVudE1vZGlmaWVyR3JvdXBzLmZvckVhY2goKGdyb3VwLCBncm91cEluZGV4KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGdyb3VwRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgZ3JvdXBFbC5jbGFzc05hbWUgPSAnbW9kaWZpZXItZ3JvdXAtcm93JzsKICAgICAgICAgICAgZ3JvdXBFbC5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtb2RpZmllci1ncm91cC1oZWFkZXIiPgogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiB2YWx1ZT0iJHtncm91cC5ncm91cE5hbWV9IiBkYXRhLWdyb3VwLWluZGV4PSIke2dyb3VwSW5kZXh9IiBjbGFzcz0ibW9kaWZpZXItZ3JvdXAtbmFtZS1lZGl0Ij4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0bi1yZW1vdmUgcmVtb3ZlLW1vZGlmaWVyLWdyb3VwIiBkYXRhLWdyb3VwLWluZGV4PSIke2dyb3VwSW5kZXh9Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMyA2djE4aDE4di0xOGgtMTh6bTUgMTRjMCAuNTUyLS40NDggMS0xIDFzLTEtLjQ0OC0xLTF2LTEwYzAtLjU1Mi40NDgtMSAxLTFzMSAuNDQ4IDEgMXYxMHptNSAwYzAgLjU1Mi0uNDQ4IDEtMSAxcy0xLS40NDgtMS0xdi0xMGMwLS41NTIuNDQ4LTEgMS0xczEgLjQ0OCAxIDF2MTB6bTUgMGMwIC41NTItLjQ0OCAxLTEgMXMtMS0uNDQ4LTEtMXYtMTBjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjEwem00LTE4aC0yMHYtMmg2di0xLjVjMC0uODI3LjY3My0xLjUgMS41LTEuNWg1Yy44MjUgMCAxLjUuNjcxIDEuNSAxLjV2MS41aDZ2MnoiLz48L3N2Zz4KICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICBgOwogICAgICAgICAgICAKICAgICAgICAgICAgZ3JvdXAub3B0aW9ucy5mb3JFYWNoKChvcHRpb24sIG9wdGlvbkluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25Sb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgIG9wdGlvblJvdy5jbGFzc05hbWUgPSAnbW9kaWZpZXItb3B0aW9uLXJvdyc7CiAgICAgICAgICAgICAgICBvcHRpb25Sb3cuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiB2YWx1ZT0iJHtvcHRpb24ubmFtZX0iIGRhdGEtZ3JvdXAtaW5kZXg9IiR7Z3JvdXBJbmRleH0iIGRhdGEtb3B0aW9uLWluZGV4PSIke29wdGlvbkluZGV4fSIgY2xhc3M9Im1vZGlmaWVyLW9wdGlvbi1uYW1lLWVkaXQiPgogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJudW1iZXIiIHN0ZXA9IjAuMDEiIHZhbHVlPSIke29wdGlvbi5wcmljZX0iIGRhdGEtZ3JvdXAtaW5kZXg9IiR7Z3JvdXBJbmRleH0iIGRhdGEtb3B0aW9uLWluZGV4PSIke29wdGlvbkluZGV4fSIgY2xhc3M9Im1vZGlmaWVyLW9wdGlvbi1wcmljZS1lZGl0Ij4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0bi1yZW1vdmUgcmVtb3ZlLW1vZGlmaWVyLW9wdGlvbiIgZGF0YS1ncm91cC1pbmRleD0iJHtncm91cEluZGV4fSIgZGF0YS1vcHRpb24taW5kZXg9IiR7b3B0aW9uSW5kZXh9Ij4mbmRhc2g7PC9idXR0b24+CiAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICAgICAgZ3JvdXBFbC5hcHBlbmRDaGlsZChvcHRpb25Sb3cpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNvbnN0IGFkZE9wdGlvbkJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgICBhZGRPcHRpb25CdG4udHlwZSA9ICdidXR0b24nOwogICAgICAgICAgICBhZGRPcHRpb25CdG4udGV4dENvbnRlbnQgPSAnQWRkIE9wdGlvbic7CiAgICAgICAgICAgIGFkZE9wdGlvbkJ0bi5jbGFzc05hbWUgPSAnYnRuLWFkZC1keW5hbWljIGFkZC1tb2RpZmllci1vcHRpb24nOwogICAgICAgICAgICBhZGRPcHRpb25CdG4uZGF0YXNldC5ncm91cEluZGV4ID0gZ3JvdXBJbmRleDsKICAgICAgICAgICAgZ3JvdXBFbC5hcHBlbmRDaGlsZChhZGRPcHRpb25CdG4pOwogICAgICAgICAgICAKICAgICAgICAgICAgZWRpdE1vZGlmaWVyR3JvdXBzQ29udGFpbmVyLmFwcGVuZENoaWxkKGdyb3VwRWwpOwogICAgICAgIH0pOwoKICAgICAgICBlZGl0TW9kaWZpZXJHcm91cHNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT0idGV4dCJdJykuZm9yRWFjaChpbnB1dCA9PiB7CiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBlID0+IGUudGFyZ2V0LnZhbHVlID0gY2FwaXRhbGl6ZVdvcmRzKGUudGFyZ2V0LnZhbHVlLnRyaW0oKSkpOwogICAgICAgIH0pOwoKICAgICAgICBlZGl0TW9kaWZpZXJHcm91cHNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmFkZC1tb2RpZmllci1vcHRpb24nKS5mb3JFYWNoKGJ0biA9PiBidG4ub25jbGljayA9IChlKSA9PiB7CiAgICAgICAgICAgIHNhdmVNb2RpZmllcnNGcm9tTW9kYWwoZmFsc2UpOyAKICAgICAgICAgICAgY3VycmVudE1vZGlmaWVyR3JvdXBzW2UudGFyZ2V0LmRhdGFzZXQuZ3JvdXBJbmRleF0ub3B0aW9ucy5wdXNoKHsgbmFtZTogJycsIHByaWNlOiAwIH0pOwogICAgICAgICAgICByZW5kZXJFeGlzdGluZ01vZGlmaWVyR3JvdXBzKCk7CiAgICAgICAgfSk7CiAgICAgICAgZWRpdE1vZGlmaWVyR3JvdXBzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZW1vdmUtbW9kaWZpZXItZ3JvdXAnKS5mb3JFYWNoKGJ0biA9PiBidG4ub25jbGljayA9IChlKSA9PiB7CiAgICAgICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3Vwcy5zcGxpY2UoZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuZ3JvdXBJbmRleCwgMSk7CiAgICAgICAgICAgIHJlbmRlckV4aXN0aW5nTW9kaWZpZXJHcm91cHMoKTsKICAgICAgICB9KTsKICAgICAgICBlZGl0TW9kaWZpZXJHcm91cHNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnJlbW92ZS1tb2RpZmllci1vcHRpb24nKS5mb3JFYWNoKGJ0biA9PiBidG4ub25jbGljayA9IChlKSA9PiB7CiAgICAgICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3Vwc1tlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5ncm91cEluZGV4XS5vcHRpb25zLnNwbGljZShlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5vcHRpb25JbmRleCwgMSk7CiAgICAgICAgICAgIHJlbmRlckV4aXN0aW5nTW9kaWZpZXJHcm91cHMoKTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzYXZlTW9kaWZpZXJzRnJvbU1vZGFsKGNsb3NlTW9kYWwgPSB0cnVlKSB7CiAgICAgICAgY29uc3QgdGVtcEdyb3VwcyA9IFtdOwogICAgICAgIGNvbnN0IGdyb3VwTmFtZXMgPSBuZXcgU2V0KCk7CiAgICAgICAgbGV0IGhhc0Vycm9yID0gZmFsc2U7CgogICAgICAgIGVkaXRNb2RpZmllckdyb3Vwc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcubW9kaWZpZXItZ3JvdXAtcm93JykuZm9yRWFjaCgoZ3JvdXBFbCkgPT4gewogICAgICAgICAgICBjb25zdCBncm91cE5hbWUgPSBzYW5pdGl6ZUlucHV0KGdyb3VwRWwucXVlcnlTZWxlY3RvcignLm1vZGlmaWVyLWdyb3VwLW5hbWUtZWRpdCcpLnZhbHVlLnRyaW0oKSk7CiAgICAgICAgICAgIGlmIChncm91cE5hbWUgJiYgZ3JvdXBOYW1lcy5oYXMoZ3JvdXBOYW1lLnRvTG93ZXJDYXNlKCkpKSB7CiAgICAgICAgICAgICAgICBzaG93TW9kYWwoYER1cGxpY2F0ZSBtb2RpZmllciBncm91cCBuYW1lIGZvdW5kOiAiJHtncm91cE5hbWV9Ii4gUGxlYXNlIHVzZSB1bmlxdWUgbmFtZXMuYCwgImVycm9yIik7CiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGdyb3VwTmFtZSkgZ3JvdXBOYW1lcy5hZGQoZ3JvdXBOYW1lLnRvTG93ZXJDYXNlKCkpOwoKICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IFtdOwogICAgICAgICAgICBncm91cEVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RpZmllci1vcHRpb24tcm93JykuZm9yRWFjaChvcHRpb25FbCA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25OYW1lID0gc2FuaXRpemVJbnB1dChvcHRpb25FbC5xdWVyeVNlbGVjdG9yKCcubW9kaWZpZXItb3B0aW9uLW5hbWUtZWRpdCcpLnZhbHVlLnRyaW0oKSk7CiAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25QcmljZSA9IG9wdGlvbkVsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RpZmllci1vcHRpb24tcHJpY2UtZWRpdCcpLnZhbHVlOwogICAgICAgICAgICAgICAgaWYgKG9wdGlvbk5hbWUpIHsKICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnB1c2goeyBuYW1lOiBvcHRpb25OYW1lLCBwcmljZTogcGFyc2VGbG9hdChvcHRpb25QcmljZSkgfHwgMCB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmIChncm91cE5hbWUgJiYgb3B0aW9ucy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICB0ZW1wR3JvdXBzLnB1c2goeyBncm91cE5hbWUsIG9wdGlvbnMgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgaWYgKGhhc0Vycm9yKSByZXR1cm47CgogICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3VwcyA9IHRlbXBHcm91cHM7CiAgICAgICAgaWYgKGNsb3NlTW9kYWwpIHsKICAgICAgICAgICAgbW9kaWZpZXJNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgICAgIHNob3dNb2RhbCgnTW9kaWZpZXIgbGlicmFyeSB1cGRhdGVkLicsICd3YXJuaW5nJyk7CiAgICAgICAgfQogICAgICAgIGdlbmVyYXRlQW5kUmVuZGVyUHJpY2luZygpOwogICAgfQoKICAgIGZ1bmN0aW9uIG9wZW5CdWxrTGlua01vZGFsKCkgewogICAgICAgIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nsb3NlTGlua01vZGlmaWVyTW9kYWxCdG4nKTsKICAgICAgICBjb25zdCBkeW5hbWljQWN0aW9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkeW5hbWljTW9kYWxBY3Rpb25zJyk7CiAgICAgICAgZHluYW1pY0FjdGlvbnMuaW5uZXJIVE1MID0gJyc7IC8vIENsZWFyIHByZXZpb3VzIGJ1dHRvbnMKICAgICAgICBjbG9zZUJ0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAvLyBIaWRlIGRlZmF1bHQgRG9uZSBidXR0b24KICAgICAgICAKICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbFRpdGxlLnRleHRDb250ZW50ID0gJ0J1bGsgTGluayBNb2RpZmllcnMnOwogICAgICAgIGxpbmtNb2RpZmllckxpc3RDb250YWluZXIuaW5uZXJIVE1MID0gJyc7CgogICAgICAgIGNvbnN0IGFsbE1vZGlmaWVyR3JvdXBzID0gY3VycmVudE1vZGlmaWVyR3JvdXBzOwoKICAgICAgICBpZiAoYWxsTW9kaWZpZXJHcm91cHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGxpbmtNb2RpZmllckxpc3RDb250YWluZXIuaW5uZXJIVE1MID0gYDxwIHN0eWxlPSJjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7Ij5ObyBtb2RpZmllciBncm91cHMgYXJlIGRlZmluZWQgaW4gdGhlIGxpYnJhcnkuPC9wPmA7CiAgICAgICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSAnQ2xvc2UnOwogICAgICAgICAgICBjYW5jZWxCdG4uY2xhc3NOYW1lID0gJ2J0bi1leHBvcnQnOwogICAgICAgICAgICBjYW5jZWxCdG4ub25jbGljayA9ICgpID0+IGxpbmtNb2RpZmllck1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICAgICAgZHluYW1pY0FjdGlvbnMuYXBwZW5kQ2hpbGQoY2FuY2VsQnRuKTsKCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxsTW9kaWZpZXJHcm91cHMuZm9yRWFjaChncm91cCA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTmFtZSA9ICdtb2RpZmllci1saW5rLWl0ZW0nOwogICAgICAgICAgICAgICAgY29uc3QgaWQgPSBgYnVsay1tb2Qtc2VsLSR7Z3JvdXAuZ3JvdXBOYW1lLnJlcGxhY2UoL1xzKy9nLCAnLScpfWA7CiAgICAgICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSIke2lkfSIgdmFsdWU9IiR7Z3JvdXAuZ3JvdXBOYW1lfSIgY2xhc3M9ImJ1bGstbW9kaWZpZXItY2hlY2tib3giPgogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9IiR7aWR9Ij4ke2dyb3VwLmdyb3VwTmFtZX08L2xhYmVsPgogICAgICAgICAgICAgICAgYDsKICAgICAgICAgICAgICAgIGxpbmtNb2RpZmllckxpc3RDb250YWluZXIuYXBwZW5kQ2hpbGQoaXRlbSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgYXBwbHlCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgYXBwbHlCdG4udGV4dENvbnRlbnQgPSAnQXBwbHkgdG8gYWxsIHZhcmlhbnRzJzsKICAgICAgICAgICAgYXBwbHlCdG4uY2xhc3NOYW1lID0gJ2J0bi1hZGQnOwogICAgICAgICAgICBhcHBseUJ0bi5vbmNsaWNrID0gKCkgPT4gewogICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRHcm91cHMgPSBBcnJheS5mcm9tKGxpbmtNb2RpZmllckxpc3RDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmJ1bGstbW9kaWZpZXItY2hlY2tib3g6Y2hlY2tlZCcpKS5tYXAoY2IgPT4gY2IudmFsdWUpOwogICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkR3JvdXBzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgY3VycmVudFZhcmlhbnRQcmljaW5nLmZvckVhY2gocHJpY2VJdGVtID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGN1cnJlbnRMaW5rcyA9IGN1cnJlbnRNb2RpZmllckxpbmtzW3ByaWNlSXRlbS5jb21iaW5hdGlvbl0gfHwgW107CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkR3JvdXBzLmZvckVhY2goZ3JvdXBOYW1lID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY3VycmVudExpbmtzLmluY2x1ZGVzKGdyb3VwTmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50TGlua3MucHVzaChncm91cE5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudE1vZGlmaWVyTGlua3NbcHJpY2VJdGVtLmNvbWJpbmF0aW9uXSA9IGN1cnJlbnRMaW5rczsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgc2hvd01vZGFsKGBTZWxlY3RlZCBncm91cHMgd2VyZSBsaW5rZWQgdG8gYWxsIHZhcmlhbnRzLmAsICd3YXJuaW5nJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgICAgICAgICBnZW5lcmF0ZUFuZFJlbmRlclByaWNpbmcoKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgZHluYW1pY0FjdGlvbnMuYXBwZW5kQ2hpbGQoYXBwbHlCdG4pOwoKICAgICAgICAgICAgY29uc3QgY2FuY2VsQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIGNhbmNlbEJ0bi50ZXh0Q29udGVudCA9ICdDYW5jZWwnOwogICAgICAgICAgICBjYW5jZWxCdG4uY2xhc3NOYW1lID0gJ2J0bi1leHBvcnQnOwogICAgICAgICAgICBjYW5jZWxCdG4ub25jbGljayA9ICgpID0+IGxpbmtNb2RpZmllck1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICAgICAgZHluYW1pY0FjdGlvbnMuYXBwZW5kQ2hpbGQoY2FuY2VsQnRuKTsKICAgICAgICB9CgogICAgICAgIGxpbmtNb2RpZmllck1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcGVuTGlua01vZGlmaWVyTW9kYWwodmFyaWFudENvbWJpbmF0aW9uKSB7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nsb3NlTGlua01vZGlmaWVyTW9kYWxCdG4nKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHluYW1pY01vZGFsQWN0aW9ucycpLmlubmVySFRNTCA9ICcnOwoKICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbFRpdGxlLnRleHRDb250ZW50ID0gYExpbmsgTW9kaWZpZXJzIGZvcjogJHt2YXJpYW50Q29tYmluYXRpb24gfHwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3ROYW1lJykudmFsdWUgfHwgJ3RoaXMgcHJvZHVjdCd9YDsKICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbC5kYXRhc2V0LmFjdGl2ZVZhcmlhbnQgPSB2YXJpYW50Q29tYmluYXRpb247CiAgICAgICAgbGlua01vZGlmaWVyTGlzdENvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsKICAgICAgICBjb25zdCBsaW5rZWRHcm91cHMgPSBjdXJyZW50TW9kaWZpZXJMaW5rc1t2YXJpYW50Q29tYmluYXRpb25dIHx8IFtdOwoKICAgICAgICBpZiAoY3VycmVudE1vZGlmaWVyR3JvdXBzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBsaW5rTW9kaWZpZXJMaXN0Q29udGFpbmVyLmlubmVySFRNTCA9IGA8cCBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyI+Tm8gbW9kaWZpZXIgZ3JvdXBzIGRlZmluZWQuIFVzZSB0aGUgTGlicmFyeSBNYW5hZ2VtZW50IHNlY3Rpb24gdG8gY3JlYXRlIHNvbWUuPC9wPmA7CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50TW9kaWZpZXJHcm91cHMuZm9yRWFjaChncm91cCA9PiB7CiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgaXRlbS5jbGFzc05hbWUgPSAnbW9kaWZpZXItbGluay1pdGVtJzsKICAgICAgICAgICAgY29uc3QgaXNDaGVja2VkID0gbGlua2VkR3JvdXBzLmluY2x1ZGVzKGdyb3VwLmdyb3VwTmFtZSk7CiAgICAgICAgICAgIGNvbnN0IHNhbml0aXplZEdyb3VwTmFtZSA9IGdyb3VwLmdyb3VwTmFtZS5yZXBsYWNlKC9ccysvZywgJy0nKTsKICAgICAgICAgICAgaXRlbS5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSJtb2QtJHtzYW5pdGl6ZWRHcm91cE5hbWV9IiB2YWx1ZT0iJHtncm91cC5ncm91cE5hbWV9IiAke2lzQ2hlY2tlZCA/ICdjaGVja2VkJyA6ICcnfT4KICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9Im1vZC0ke3Nhbml0aXplZEdyb3VwTmFtZX0iPiR7Z3JvdXAuZ3JvdXBOYW1lfTwvbGFiZWw+CiAgICAgICAgICAgIGA7CiAgICAgICAgICAgIGxpbmtNb2RpZmllckxpc3RDb250YWluZXIuYXBwZW5kQ2hpbGQoaXRlbSk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpdGVtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jykub25jaGFuZ2UgPSAoZSkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgZ3JvdXBOYW1lID0gZS50YXJnZXQudmFsdWU7CiAgICAgICAgICAgICAgICBsZXQgY3VycmVudExpbmtzID0gY3VycmVudE1vZGlmaWVyTGlua3NbdmFyaWFudENvbWJpbmF0aW9uXSB8fCBbXTsKICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldC5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50TGlua3MuaW5jbHVkZXMoZ3JvdXBOYW1lKSkgY3VycmVudExpbmtzLnB1c2goZ3JvdXBOYW1lKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudExpbmtzID0gY3VycmVudExpbmtzLmZpbHRlcihuYW1lID0+IG5hbWUgIT09IGdyb3VwTmFtZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjdXJyZW50TW9kaWZpZXJMaW5rc1t2YXJpYW50Q29tYmluYXRpb25dID0gY3VycmVudExpbmtzOwogICAgICAgICAgICB9OwogICAgICAgIH0pOwoKICAgICAgICBsaW5rTW9kaWZpZXJNb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICB9CgogICAgLy8gLS0tIFZBUklBTlQgUFJFU0VUIExPR0lDIC0tLQogICAgZnVuY3Rpb24gaW5pdGlhbGl6ZURlZmF1bHRWYXJpYW50UHJlc2V0cygpIHsKICAgICAgICB2YXJpYW50UHJlc2V0cyA9IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogIlBpenphIFNpemVzIiwKICAgICAgICAgICAgICAgIGdyb3VwczogW3sgZ3JvdXBOYW1lOiAiU2l6ZSIsIG9wdGlvbnM6IFt7IG5hbWU6ICJTbWFsbCIgfSwgeyBuYW1lOiAiTWVkaXVtIiB9LCB7IG5hbWU6ICJMYXJnZSIgfV0gfV0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogIk1lYXQgQ2hvaWNlIChCdXJnZXIvU2FuZHdpY2gpIiwKICAgICAgICAgICAgICAgIGdyb3VwczogW3sgZ3JvdXBOYW1lOiAiUHJvdGVpbiIsIG9wdGlvbnM6IFt7IG5hbWU6ICJCZWVmIiB9LCB7IG5hbWU6ICJDaGlja2VuIEJyZWFzdCIgfSwgeyBuYW1lOiAiVmVnZ2llIFBhdHR5IiB9XSB9XQogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuYW1lOiAiQ29mZmVlIE9wdGlvbnMiLAogICAgICAgICAgICAgICAgZ3JvdXBzOiBbCiAgICAgICAgICAgICAgICAgICAgeyBncm91cE5hbWU6ICJUeXBlIiwgb3B0aW9uczogW3sgbmFtZTogIkNhZmZlaW5hdGVkIiB9LCB7IG5hbWU6ICJEZWNhZmZlaW5hdGVkIiB9XSB9LAogICAgICAgICAgICAgICAgICAgIHsgZ3JvdXBOYW1lOiAiTWlsayIsIG9wdGlvbnM6IFt7IG5hbWU6ICJGdWxsIENyZWFtIiB9LCB7IG5hbWU6ICJMb3cgRmF0IiB9LCB7IG5hbWU6ICJBbG1vbmQgTWlsayIgfSwgeyBuYW1lOiAiT2F0IE1pbGsiIH1dIH0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZTogIldpbmUgU2VydmluZyIsCiAgICAgICAgICAgICAgICBncm91cHM6IFt7IGdyb3VwTmFtZTogIlNlcnZpbmciLCBvcHRpb25zOiBbeyBuYW1lOiAiR2xhc3MgKDE3NW1sKSIgfSwgeyBuYW1lOiAiQm90dGxlIiB9XSB9XQogICAgICAgICAgICB9CiAgICAgICAgXTsKICAgIH0KCiAgICBmdW5jdGlvbiBzYXZlQ3VycmVudFZhcmlhbnRzQXNQcmVzZXQoKSB7CiAgICAgICAgaWYgKGN1cnJlbnRWYXJpYW50R3JvdXBzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBzaG93TW9kYWwoIkFkZCBhdCBsZWFzdCBvbmUgdmFyaWFudCBncm91cCBiZWZvcmUgc2F2aW5nIGEgcHJlc2V0LiIsICJlcnJvciIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBzaG93UHJvbXB0TW9kYWwoIkVudGVyIGEgbmFtZSBmb3IgdGhpcyBuZXcgdmFyaWFudCBwcmVzZXQ6IiwgKHByZXNldE5hbWUpID0+IHsKICAgICAgICAgICAgaWYgKHZhcmlhbnRQcmVzZXRzLnNvbWUocCA9PiBwLm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gcHJlc2V0TmFtZS50b0xvd2VyQ2FzZSgpKSkgewogICAgICAgICAgICAgICAgc2hvd01vZGFsKGBBIHByZXNldCBuYW1lZCAiJHtwcmVzZXROYW1lfSIgYWxyZWFkeSBleGlzdHMuYCwgImVycm9yIik7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgbmV3UHJlc2V0ID0gewogICAgICAgICAgICAgICAgbmFtZTogcHJlc2V0TmFtZSwKICAgICAgICAgICAgICAgIGdyb3VwczogSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjdXJyZW50VmFyaWFudEdyb3VwcykpCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHZhcmlhbnRQcmVzZXRzLnB1c2gobmV3UHJlc2V0KTsKICAgICAgICAgICAgc2F2ZVN0YXRlKCk7CiAgICAgICAgICAgIHNob3dNb2RhbChgUHJlc2V0ICIke3ByZXNldE5hbWV9IiBzYXZlZCBzdWNjZXNzZnVsbHkuYCwgJ3dhcm5pbmcnKTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBvcGVuQXBwbHlWYXJpYW50UHJlc2V0TW9kYWwoKSB7CiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5VmFyaWFudFByZXNldExpc3RDb250YWluZXInKTsKICAgICAgICBjb250YWluZXIuaW5uZXJIVE1MID0gJyc7CgogICAgICAgIGlmICh2YXJpYW50UHJlc2V0cy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IGA8cCBzdHlsZT0iY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOyI+Tm8gcHJlc2V0cyBoYXZlIGJlZW4gc2F2ZWQgeWV0LjwvcD5gOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhcmlhbnRQcmVzZXRzLmZvckVhY2gocHJlc2V0ID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgIGl0ZW0uc3R5bGUgPSAnZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyBhbGlnbi1pdGVtczogY2VudGVyOyBwYWRkaW5nOiAxMHB4OyBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOyc7CiAgICAgICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IGA8c3Bhbj4ke3ByZXNldC5uYW1lfTwvc3Bhbj5gOwogICAgICAgICAgICAgICAgY29uc3QgYXBwbHlCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgICAgIGFwcGx5QnRuLnRleHRDb250ZW50ID0gJ0FwcGx5JzsKICAgICAgICAgICAgICAgIGFwcGx5QnRuLmNsYXNzTmFtZSA9ICdidG4tYWRkIGJ0bi1hZGQtZHluYW1pYyc7CiAgICAgICAgICAgICAgICBhcHBseUJ0bi5vbmNsaWNrID0gKCkgPT4gYXBwbHlWYXJpYW50UHJlc2V0KHByZXNldC5uYW1lKTsKICAgICAgICAgICAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQoYXBwbHlCdG4pOwogICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGl0ZW0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgY29uc3Qgd2FybmluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHBseVZhcmlhbnRQcmVzZXRXYXJuaW5nJyk7CiAgICAgICAgd2FybmluZy50ZXh0Q29udGVudCA9IGN1cnJlbnRWYXJpYW50R3JvdXBzLmxlbmd0aCA+IDAgPwogICAgICAgICAgICAnV2FybmluZzogQXBwbHlpbmcgYSBwcmVzZXQgd2lsbCBvdmVyd3JpdGUgdGhlIGN1cnJlbnQgdmFyaWFudHMgaW4gdGhlIGZvcm0uJyA6CiAgICAgICAgICAgICdTZWxlY3QgYSBwcmVzZXQgdG8gYXBwbHkgdG8gdGhpcyBwcm9kdWN0Lic7CgogICAgICAgIGFwcGx5VmFyaWFudFByZXNldE1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhcHBseVZhcmlhbnRQcmVzZXQocHJlc2V0TmFtZSkgewogICAgICAgIGNvbnN0IHByZXNldCA9IHZhcmlhbnRQcmVzZXRzLmZpbmQocCA9PiBwLm5hbWUgPT09IHByZXNldE5hbWUpOwogICAgICAgIGlmICghcHJlc2V0KSByZXR1cm47CgogICAgICAgIGNvbnN0IGFwcGx5ID0gKCkgPT4gewogICAgICAgICAgICBjdXJyZW50VmFyaWFudEdyb3VwcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocHJlc2V0Lmdyb3VwcykpOwogICAgICAgICAgICBjdXJyZW50TW9kaWZpZXJMaW5rcyA9IHt9OyAvLyBDbGVhciBtb2RpZmllciBsaW5rcyBhcyB2YXJpYW50cyBoYXZlIGNoYW5nZWQKICAgICAgICAgICAgcmVuZGVyVmFyaWFudEdyb3VwcygpOwogICAgICAgICAgICBhcHBseVZhcmlhbnRQcmVzZXRNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgfTsKCiAgICAgICAgaWYgKGN1cnJlbnRWYXJpYW50R3JvdXBzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgc2hvd01vZGFsKGBBcHBseSB0aGUgIiR7cHJlc2V0TmFtZX0iIHByZXNldD8gVGhpcyB3aWxsIG92ZXJ3cml0ZSB5b3VyIGN1cnJlbnQgdmFyaWFudHMuYCwgJ3dhcm5pbmcnLCBhcHBseSwgdHJ1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYXBwbHkoKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gb3Blbk1hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwoKSB7CiAgICAgICAgcmVuZGVyTWFuYWdlVmFyaWFudFByZXNldHNNb2RhbCgpOwogICAgICAgIG1hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlbmRlck1hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwoKSB7CiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXRWYXJpYW50UHJlc2V0c0NvbnRhaW5lcicpOwogICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsKICAgICAgICBpZiAodmFyaWFudFByZXNldHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHAgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsiPk5vIHZhcmlhbnQgcHJlc2V0cyBzYXZlZCB5ZXQuPC9wPmA7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdmFyaWFudFByZXNldHMuZm9yRWFjaChwcmVzZXQgPT4gewogICAgICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgcm93LnN0eWxlID0gJ2Rpc3BsYXk6IGZsZXg7IGdhcDogMTBweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgbWFyZ2luLWJvdHRvbTogMTBweDsnOwogICAgICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgICAgIGlucHV0LnR5cGUgPSAndGV4dCc7CiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gcHJlc2V0Lm5hbWU7CiAgICAgICAgICAgIGlucHV0LmRhdGFzZXQub3JpZ2luYWxOYW1lID0gcHJlc2V0Lm5hbWU7CiAgICAgICAgICAgIGlucHV0LnN0eWxlLmZsZXhHcm93ID0gJzEnOwogICAgICAgICAgICBjb25zdCBkZWxldGVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgZGVsZXRlQnRuLmNsYXNzTmFtZSA9ICdidG4tcmVtb3ZlJzsKICAgICAgICAgICAgZGVsZXRlQnRuLmlubmVySFRNTCA9IGAmbmRhc2g7YDsKICAgICAgICAgICAgZGVsZXRlQnRuLm9uY2xpY2sgPSAoKSA9PiBkZWxldGVWYXJpYW50UHJlc2V0KHByZXNldC5uYW1lKTsKICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGlucHV0KTsKICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGRlbGV0ZUJ0bik7CiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChyb3cpOwogICAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIHNhdmVWYXJpYW50UHJlc2V0c0Zyb21NYW5hZ2VyKCkgewogICAgICAgIGNvbnN0IGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNlZGl0VmFyaWFudFByZXNldHNDb250YWluZXIgaW5wdXQnKTsKICAgICAgICBjb25zdCBuZXdQcmVzZXRzID0gW107CiAgICAgICAgY29uc3QgbmFtZXMgPSBuZXcgU2V0KCk7CiAgICAgICAgbGV0IGhhc0Vycm9yID0gZmFsc2U7CgogICAgICAgIGlucHV0cy5mb3JFYWNoKGlucHV0ID0+IHsKICAgICAgICAgICAgY29uc3QgbmV3TmFtZSA9IGlucHV0LnZhbHVlLnRyaW0oKTsKICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxOYW1lID0gaW5wdXQuZGF0YXNldC5vcmlnaW5hbE5hbWU7CiAgICAgICAgICAgIGlmICghbmV3TmFtZSB8fCBuYW1lcy5oYXMobmV3TmFtZS50b0xvd2VyQ2FzZSgpKSkgewogICAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgICAgc2hvd01vZGFsKG5ld05hbWUgPyBgRHVwbGljYXRlIHByZXNldCBuYW1lOiAiJHtuZXdOYW1lfSJgIDogIlByZXNldCBuYW1lcyBjYW5ub3QgYmUgZW1wdHkuIiwgImVycm9yIik7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbmFtZXMuYWRkKG5ld05hbWUudG9Mb3dlckNhc2UoKSk7CiAgICAgICAgICAgIGNvbnN0IG9yaWdpbmFsUHJlc2V0ID0gdmFyaWFudFByZXNldHMuZmluZChwID0+IHAubmFtZSA9PT0gb3JpZ2luYWxOYW1lKTsKICAgICAgICAgICAgaWYob3JpZ2luYWxQcmVzZXQpIG5ld1ByZXNldHMucHVzaCh7IG5hbWU6IG5ld05hbWUsIGdyb3Vwczogb3JpZ2luYWxQcmVzZXQuZ3JvdXBzIH0pOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoaGFzRXJyb3IpIHJldHVybjsKCiAgICAgICAgdmFyaWFudFByZXNldHMgPSBuZXdQcmVzZXRzOwogICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgIG1hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIHNob3dNb2RhbCgiVmFyaWFudCBwcmVzZXRzIHVwZGF0ZWQuIiwgIndhcm5pbmciKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxldGVWYXJpYW50UHJlc2V0KHByZXNldE5hbWUpIHsKICAgICAgICBzaG93TW9kYWwoYERlbGV0ZSB0aGUgIiR7cHJlc2V0TmFtZX0iIHZhcmlhbnQgcHJlc2V0PyBUaGlzIGNhbm5vdCBiZSB1bmRvbmUuYCwgJ3dhcm5pbmcnLCAoKSA9PiB7CiAgICAgICAgICAgIHZhcmlhbnRQcmVzZXRzID0gdmFyaWFudFByZXNldHMuZmlsdGVyKHAgPT4gcC5uYW1lICE9PSBwcmVzZXROYW1lKTsKICAgICAgICAgICAgc2F2ZVN0YXRlKCk7CiAgICAgICAgICAgIHJlbmRlck1hbmFnZVZhcmlhbnRQcmVzZXRzTW9kYWwoKTsKICAgICAgICB9LCB0cnVlKTsKICAgIH0KCgogICAgLy8gLS0tIERBVEEgUEVSU0lTVEVOQ0UgJiBTVEFURSBNQU5BR0VNRU5UIC0tLQogICAgZnVuY3Rpb24gc2F2ZVN0YXRlKCkgewogICAgICBjb25zdCBzdGF0ZSA9IHsgCiAgICAgICAgICBwcm9kdWN0cywgcGx1Q291bnRlciwgc2Vzc2lvblNpdGUsIHNlc3Npb25EZWZpbmVQbHUsIGRlZmF1bHRzU2V0LAogICAgICAgICAgY3VycmVudE1vZGlmaWVyR3JvdXBzLCByZW1lbWJlckNhdGVnb3JpZXNDaGVja2VkLCBsYXN0VXNlZENhdGVnb3JpZXMsCiAgICAgICAgICB2YXJpYW50UHJlc2V0cywgbW9kaWZpZXJQcmVzZXRzLAogICAgICAgICAgc2Vzc2lvblRheDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RheEFwcGxpY2FibGUnKS52YWx1ZSwKICAgICAgICAgIHNlc3Npb25Qcm9kVHlwZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RUeXBlJykudmFsdWUKICAgICAgfTsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2R1Y3REYXRhJywgSlNPTi5zdHJpbmdpZnkoc3RhdGUpKTsKICAgICAgc2hvd1NhdmVTdGF0dXMoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBsb2FkU3RhdGUoKSB7CiAgICAgIGNvbnN0IHNhdmVkRGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwcm9kdWN0RGF0YScpOwogICAgICBpZiAoc2F2ZWREYXRhKSB7CiAgICAgICAgY29uc3Qgc3RhdGUgPSBKU09OLnBhcnNlKHNhdmVkRGF0YSk7CiAgICAgICAgcHJvZHVjdHMgPSBzdGF0ZS5wcm9kdWN0cyB8fCBbXTsKICAgICAgICBwbHVDb3VudGVyID0gc3RhdGUucGx1Q291bnRlciB8fCAxMDAwOwogICAgICAgIHNlc3Npb25TaXRlID0gc3RhdGUuc2Vzc2lvblNpdGUgfHwgJyc7CiAgICAgICAgc2Vzc2lvbkRlZmluZVBsdSA9IHN0YXRlLnNlc3Npb25EZWZpbmVQbHUgfHwgJ25vJzsKICAgICAgICBkZWZhdWx0c1NldCA9IHN0YXRlLmRlZmF1bHRzU2V0IHx8IGZhbHNlOwogICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3VwcyA9IHN0YXRlLmN1cnJlbnRNb2RpZmllckdyb3VwcyB8fCBbXTsKICAgICAgICByZW1lbWJlckNhdGVnb3JpZXNDaGVja2VkID0gc3RhdGUucmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tlZCAhPT0gZmFsc2U7CiAgICAgICAgbGFzdFVzZWRDYXRlZ29yaWVzID0gc3RhdGUubGFzdFVzZWRDYXRlZ29yaWVzIHx8IHsgcHJlcDogJycsIG1lbnU6ICcnLCBpbnY6ICcnLCBzdWJJbnY6ICcnLCB1b206ICcnIH07CiAgICAgICAgdmFyaWFudFByZXNldHMgPSBzdGF0ZS52YXJpYW50UHJlc2V0cyB8fCBbXTsKICAgICAgICBtb2RpZmllclByZXNldHMgPSBzdGF0ZS5tb2RpZmllclByZXNldHMgfHwgW107CgogICAgICAgIGlmICh2YXJpYW50UHJlc2V0cy5sZW5ndGggPT09IDApIGluaXRpYWxpemVEZWZhdWx0VmFyaWFudFByZXNldHMoKTsKICAgICAgICBpZiAobW9kaWZpZXJQcmVzZXRzLmxlbmd0aCA9PT0gMCkgaW5pdGlhbGl6ZURlZmF1bHRNb2RpZmllclByZXNldHMoKTsKCiAgICAgICAgLy8gSWYgdGhlIGN1cnJlbnQgbGlicmFyeSBpcyBlbXB0eSwgcG9wdWxhdGUgaXQgZnJvbSBwcmVzZXRzLgogICAgICAgIGlmIChjdXJyZW50TW9kaWZpZXJHcm91cHMubGVuZ3RoID09PSAwICYmIG1vZGlmaWVyUHJlc2V0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGNvbnN0IGNvbWJpbmVkR3JvdXBzID0gW107CiAgICAgICAgICAgIGNvbnN0IGdyb3VwTmFtZXMgPSBuZXcgU2V0KCk7CiAgICAgICAgICAgIG1vZGlmaWVyUHJlc2V0cy5mb3JFYWNoKHByZXNldCA9PiB7CiAgICAgICAgICAgICAgICBwcmVzZXQuZ3JvdXBzLmZvckVhY2goZ3JvdXAgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwTmFtZUxvd2VyID0gZ3JvdXAuZ3JvdXBOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGdyb3VwLmdyb3VwTmFtZSAmJiAhZ3JvdXBOYW1lcy5oYXMoZ3JvdXBOYW1lTG93ZXIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbWJpbmVkR3JvdXBzLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShncm91cCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBOYW1lcy5hZGQoZ3JvdXBOYW1lTG93ZXIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY3VycmVudE1vZGlmaWVyR3JvdXBzID0gY29tYmluZWRHcm91cHM7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RhdGUuc2Vzc2lvblRheCkgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RheEFwcGxpY2FibGUnKS52YWx1ZSA9IHN0YXRlLnNlc3Npb25UYXg7CiAgICAgICAgaWYgKHN0YXRlLnNlc3Npb25Qcm9kVHlwZSkgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RUeXBlJykudmFsdWUgPSBzdGF0ZS5zZXNzaW9uUHJvZFR5cGU7CiAgICAgICAgcmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tib3guY2hlY2tlZCA9IHJlbWVtYmVyQ2F0ZWdvcmllc0NoZWNrZWQ7CgogICAgICAgIGlmIChkZWZhdWx0c1NldCkgCiAgICAgICAgewogICAgICAgICAgICBzZXNzaW9uU2l0ZUlucHV0LnZhbHVlID0gc2Vzc2lvblNpdGU7CiAgICAgICAgICAgIHNlc3Npb25EZWZpbmVQbHVTZWxlY3QudmFsdWUgPSBzZXNzaW9uRGVmaW5lUGx1OwogICAgICAgIH0KICAgICAgICBjb25zdCBzaXRlcyA9IG5ldyBTZXQocHJvZHVjdHMubWFwKHAgPT4gcC5TaXRlKSk7CiAgICAgICAgY29uc3QgcHJlcHMgPSBuZXcgU2V0KHByb2R1Y3RzLm1hcChwID0+IHBbIlByZXBhcmF0aW9uIExvY2F0aW9uIl0pKTsKICAgICAgICBjb25zdCBtZW51Q2F0ZWdvcmllcyA9IG5ldyBTZXQocHJvZHVjdHMubWFwKHAgPT4gcFsiTWVudSBDYXRlZ29yeSJdKSk7CiAgICAgICAgY29uc3QgaW52Q2F0ZWdvcmllcyA9IG5ldyBTZXQocHJvZHVjdHMubWFwKHAgPT4gcFsiSW52ZW50b3J5IENhdGVnb3J5Il0pKTsKICAgICAgICBjb25zdCBpbnZTdWJDYXRlZ29yaWVzID0gbmV3IFNldChwcm9kdWN0cy5tYXAocCA9PiBwWyJJbnZlbnRvcnkgU3ViLUNhdGVnb3J5Il0pKTsKICAgICAgICAKICAgICAgICBzaXRlcy5mb3JFYWNoKHNpdGUgPT4gYWRkVG9EYXRhbGlzdCgic2l0ZUxpc3QiLCBzaXRlKSk7CiAgICAgICAgcHJlcHMuZm9yRWFjaChwcmVwID0+IGFkZFRvRGF0YWxpc3QoInByZXBMaXN0IiwgcHJlcCkpOwogICAgICAgIG1lbnVDYXRlZ29yaWVzLmZvckVhY2gobWVudSA9PiBhZGRUb0RhdGFsaXN0KCJtZW51TGlzdCIsIG1lbnUpKTsKICAgICAgICBpbnZDYXRlZ29yaWVzLmZvckVhY2goY2F0ID0+IGFkZFRvRGF0YWxpc3QoImludmVudG9yeUNhdGVnb3J5TGlzdCIsIGNhdCkpOwogICAgICAgIGludlN1YkNhdGVnb3JpZXMuZm9yRWFjaChzdWIgPT4gYWRkVG9EYXRhbGlzdCgiaW52ZW50b3J5U3ViQ2F0ZWdvcnlMaXN0Iiwgc3ViKSk7CiAgICAgICAgdXBkYXRlVGFibGUoKTsKICAgICAgfSAKICAgICAgZWxzZSB7CiAgICAgICAgaW5pdGlhbGl6ZURlZmF1bHRWYXJpYW50UHJlc2V0cygpOwogICAgICAgIGluaXRpYWxpemVEZWZhdWx0TW9kaWZpZXJQcmVzZXRzKCk7CiAgICAgICAgLy8gUG9wdWxhdGUgdGhlIGxpYnJhcnkgZnJvbSB0aGUgZGVmYXVsdCBwcmVzZXRzIG9uIGZpcnN0IHJ1bgogICAgICAgIGNvbnN0IGNvbWJpbmVkR3JvdXBzID0gW107CiAgICAgICAgY29uc3QgZ3JvdXBOYW1lcyA9IG5ldyBTZXQoKTsKICAgICAgICBtb2RpZmllclByZXNldHMuZm9yRWFjaChwcmVzZXQgPT4gewogICAgICAgICAgICBwcmVzZXQuZ3JvdXBzLmZvckVhY2goZ3JvdXAgPT4gewogICAgICAgICAgICAgICAgY29uc3QgZ3JvdXBOYW1lTG93ZXIgPSBncm91cC5ncm91cE5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgIGlmIChncm91cC5ncm91cE5hbWUgJiYgIWdyb3VwTmFtZXMuaGFzKGdyb3VwTmFtZUxvd2VyKSkgewogICAgICAgICAgICAgICAgICAgIGNvbWJpbmVkR3JvdXBzLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShncm91cCkpKTsKICAgICAgICAgICAgICAgICAgICBncm91cE5hbWVzLmFkZChncm91cE5hbWVMb3dlcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIGN1cnJlbnRNb2RpZmllckdyb3VwcyA9IGNvbWJpbmVkR3JvdXBzOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gY2xlYXJBbGxEYXRhKCkgewogICAgICAgIHByb2R1Y3RzID0gW107IHBsdUNvdW50ZXIgPSAxMDAwOyBzZXNzaW9uU2l0ZSA9ICcnOyBzZXNzaW9uRGVmaW5lUGx1ID0gJ25vJzsgZGVmYXVsdHNTZXQgPSBmYWxzZTsgCiAgICAgICAgY3VycmVudE1vZGlmaWVyR3JvdXBzID0gW107IHZhcmlhbnRQcmVzZXRzID0gW107IG1vZGlmaWVyUHJlc2V0cyA9IFtdOwogICAgICAgIGxhc3RVc2VkQ2F0ZWdvcmllcyA9IHsgcHJlcDogJycsIG1lbnU6ICcnLCBpbnY6ICcnLCBzdWJJbnY6ICcnLCB1b206ICcnIH07CiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3Byb2R1Y3REYXRhJyk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3Byb2R1Y3RMb2FkZXJUdXRvcmlhbFNob3duJyk7CiAgICAgICAgc2Vzc2lvblNpdGVJbnB1dC52YWx1ZSA9ICcnOyBzZXNzaW9uRGVmaW5lUGx1U2VsZWN0LnZhbHVlID0gJ25vJzsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGF4QXBwbGljYWJsZScpLnZhbHVlID0gJyc7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RUeXBlJykudmFsdWUgPSAnJzsKICAgICAgICBlZGl0U2Vzc2lvbkJ0bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIHNlc3Npb25EZWZhdWx0c01vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgICAgICBpbml0aWFsaXplRGVmYXVsdFZhcmlhbnRQcmVzZXRzKCk7CiAgICAgICAgaW5pdGlhbGl6ZURlZmF1bHRNb2RpZmllclByZXNldHMoKTsKICAgICAgICB1cGRhdGVUYWJsZSgpOwogICAgfQoKCiAgICAvLyAtLS0gVUkgTE9HSUMgJiBGT1JNIEhBTkRMSU5HIC0tLQogICAgZnVuY3Rpb24gc2hvd1NhdmVTdGF0dXMoKSB7CiAgICAgICAgc2F2ZVN0YXR1cy5zdHlsZS5vcGFjaXR5ID0gJzEnOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4geyBzYXZlU3RhdHVzLnN0eWxlLm9wYWNpdHkgPSAnMCc7IH0sIDIwMDApOwogICAgfQogICAgZnVuY3Rpb24gc2hvd01vZGFsKG1lc3NhZ2UsIHR5cGUgPSAnZXJyb3InLCBvbkNvbmZpcm0gPSBudWxsLCBzaG93Q2FuY2VsID0gZmFsc2UpIHsKICAgICAgICBtb2RhbE1lc3NhZ2UuaW5uZXJIVE1MID0gbWVzc2FnZTsKICAgICAgICBjdXN0b21Nb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtY29udGVudCcpLmNsYXNzTmFtZSA9ICdtb2RhbC1jb250ZW50ICcgKyB0eXBlOwogICAgICAgIG1vZGFsQWN0aW9ucy5pbm5lckhUTUwgPSAnJzsKICAgICAgICBpZiAob25Db25maXJtKSB7CiAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1CdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgY29uZmlybUJ0bi50ZXh0Q29udGVudCA9ICdDb250aW51ZSc7IGNvbmZpcm1CdG4uY2xhc3NOYW1lID0gJ2J0bi1hZGQnOwogICAgICAgICAgICBjb25maXJtQnRuLm9uY2xpY2sgPSAoKSA9PiB7IG9uQ29uZmlybSgpOyBjdXN0b21Nb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7IH07CiAgICAgICAgICAgIG1vZGFsQWN0aW9ucy5hcHBlbmRDaGlsZChjb25maXJtQnRuKTsKICAgICAgICB9CiAgICAgICAgaWYgKHNob3dDYW5jZWwgfHwgIW9uQ29uZmlybSkgewogICAgICAgICAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgICAgICBjbG9zZUJ0bi50ZXh0Q29udGVudCA9IG9uQ29uZmlybSA/ICdDYW5jZWwnIDogJ0Nsb3NlJzsgY2xvc2VCdG4uY2xhc3NOYW1lID0gJ2J0bi1leHBvcnQnOwogICAgICAgICAgICBjbG9zZUJ0bi5vbmNsaWNrID0gKCkgPT4gY3VzdG9tTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgICAgICBtb2RhbEFjdGlvbnMuYXBwZW5kQ2hpbGQoY2xvc2VCdG4pOwogICAgICAgIH0KICAgICAgICBjdXN0b21Nb2RhbC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgICB9CiAgICBmdW5jdGlvbiBzaG93UHJvbXB0TW9kYWwobWVzc2FnZSwgb25Db25maXJtKSB7CiAgICAgICAgbW9kYWxNZXNzYWdlLmlubmVySFRNTCA9IGAke21lc3NhZ2V9PGJyPjxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0icHJvbXB0SW5wdXQiIHN0eWxlPSJtYXJnaW4tdG9wOiAxNXB4OyB3aWR0aDogMTAwJTsiIHBsYWNlaG9sZGVyPSJFbnRlciBwcmVzZXQgbmFtZS4uLiI+YDsKICAgICAgICBjdXN0b21Nb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtY29udGVudCcpLmNsYXNzTmFtZSA9ICdtb2RhbC1jb250ZW50JzsgLy8gUmVzZXQgY2xhc3MKICAgICAgICBtb2RhbEFjdGlvbnMuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgY29uc3QgY29uZmlybUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgIGNvbmZpcm1CdG4udGV4dENvbnRlbnQgPSAnU2F2ZSc7IGNvbmZpcm1CdG4uY2xhc3NOYW1lID0gJ2J0bi1hZGQnOwogICAgICAgIGNvbmZpcm1CdG4ub25jbGljayA9ICgpID0+IHsKICAgICAgICAgICAgY29uc3QgaW5wdXRFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb21wdElucHV0Jyk7CiAgICAgICAgICAgIGNvbnN0IGlucHV0VmFsdWUgPSBpbnB1dEVsZW1lbnQudmFsdWUudHJpbSgpOwogICAgICAgICAgICBpZiAoaW5wdXRWYWx1ZSkgewogICAgICAgICAgICAgICAgb25Db25maXJtKGlucHV0VmFsdWUpOwogICAgICAgICAgICAgICAgY3VzdG9tTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2lucHV0LWludmFsaWQnKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgbW9kYWxBY3Rpb25zLmFwcGVuZENoaWxkKGNvbmZpcm1CdG4pOwoKICAgICAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgIGNsb3NlQnRuLnRleHRDb250ZW50ID0gJ0NhbmNlbCc7IGNsb3NlQnRuLmNsYXNzTmFtZSA9ICdidG4tZXhwb3J0JzsKICAgICAgICBjbG9zZUJ0bi5vbmNsaWNrID0gKCkgPT4gY3VzdG9tTW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogICAgICAgIG1vZGFsQWN0aW9ucy5hcHBlbmRDaGlsZChjbG9zZUJ0bik7CiAgICAgICAgY3VzdG9tTW9kYWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb21wdElucHV0JykuZm9jdXMoKSwgMTAwKTsKICAgIH0KICAgIGZ1bmN0aW9uIGNvbmZpcm1DbGVhckFsbCgpIHsKICAgICAgICBzaG93TW9kYWwoJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjbGVhciBhbGwgcHJvZHVjdHMsIHByZXNldHMsIGFuZCBzZXNzaW9uIGRlZmF1bHRzPycsICd3YXJuaW5nJywgKCkgPT4gewogICAgICAgICAgICAgICAgY2xlYXJBbGxEYXRhKCk7IHNob3dNb2RhbCgnQWxsIGRhdGEgaGFzIGJlZW4gY2xlYXJlZC4nLCAnd2FybmluZycpOwogICAgICAgICAgICB9LCB0cnVlCiAgICAgICAgKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXREZWZhdWx0cygpIHsKICAgIGNvbnN0IHNpdGVWYWx1ZSA9IHNlc3Npb25TaXRlSW5wdXQudmFsdWUudHJpbSgpOwogICAgaWYgKHNpdGVWYWx1ZSA9PT0gIiIpIHsgCiAgICAgICAgc2hvd01vZGFsKCJQbGVhc2UgZW50ZXIgYSBTaXRlIGZvciB0aGlzIHNlc3Npb24uIiwgImVycm9yIik7IAogICAgICAgIHJldHVybjsgCiAgICB9CiAgICBzZXNzaW9uU2l0ZSA9IHNpdGVWYWx1ZTsgCiAgICBzZXNzaW9uRGVmaW5lUGx1ID0gc2Vzc2lvbkRlZmluZVBsdVNlbGVjdC52YWx1ZTsKICAgIGRlZmF1bHRzU2V0ID0gdHJ1ZTsgCiAgICAKICAgIHNlc3Npb25EZWZhdWx0c01vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgIGVkaXRTZXNzaW9uQnRuLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJzsKICAgIAogICAgaGFuZGxlUGx1VmlzaWJpbGl0eSgpOyAKICAgIHNhdmVTdGF0ZSgpOwogICAgCiAgICAvLyBTaG93IHR1dG9yaWFsIHByb21wdCBpZiBpdCBoYXNuJ3QgYmVlbiBzZWVuIGJlZm9yZQogICAgCiAgICAgICAgY29uc3QgdHV0b3JpYWxQcm9tcHRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1wcm9tcHQtbW9kYWwnKTsKICAgICAgICBpZiAodHV0b3JpYWxQcm9tcHRNb2RhbCkgewogICAgICAgICAgICB0dXRvcmlhbFByb21wdE1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlR2hvc3RUZXh0KCkgewogICAgICAgIGNvbnN0IHVvbVZhbHVlID0gdW9tU2VsZWN0LnZhbHVlOwogICAgICAgIGNvbnN0IHF1YW50aXR5VmFsdWUgPSBzdXBwbGllZFF1YW50aXR5SW5wdXQudmFsdWU7CiAgICAgICAgY29uc3QgZ2hvc3RUZXh0U3BhbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxdWFudGl0eUdob3N0VGV4dCcpOwoKICAgICAgICBpZiAodW9tVmFsdWUgJiYgcXVhbnRpdHlWYWx1ZSkgewogICAgICAgICAgICBnaG9zdFRleHRTcGFuLnRleHRDb250ZW50ID0gdW9tTWFwW3VvbVZhbHVlXSB8fCAnJzsKICAgICAgICAgICAgZ2hvc3RUZXh0U3Bhbi5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGdob3N0VGV4dFNwYW4uc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOwogICAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIHVwZGF0ZVlpZWxkR2hvc3RUZXh0KCkgewogICAgICAgIGNvbnN0IHVvbVZhbHVlID0gdW9tU2VsZWN0LnZhbHVlOwogICAgICAgIGNvbnN0IHF1YW50aXR5VmFsdWUgPSB5aWVsZFF1YW50aXR5SW5wdXQudmFsdWU7CiAgICAgICAgY29uc3QgZ2hvc3RUZXh0U3BhbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd5aWVsZEdob3N0VGV4dCcpOwoKICAgICAgICBpZiAodW9tVmFsdWUgJiYgcXVhbnRpdHlWYWx1ZSkgewogICAgICAgICAgICBnaG9zdFRleHRTcGFuLnRleHRDb250ZW50ID0gdW9tTWFwW3VvbVZhbHVlXSB8fCAnJzsKICAgICAgICAgICAgZ2hvc3RUZXh0U3Bhbi5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGdob3N0VGV4dFNwYW4uc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOwogICAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIGhhbmRsZVBsdVZpc2liaWxpdHkoKSB7CiAgICAgICAgcGx1RW50cnlHcm91cC5zdHlsZS5kaXNwbGF5ID0gKHNlc3Npb25EZWZpbmVQbHUgPT09ICd5ZXMnKSA/ICdmbGV4JyA6ICdub25lJzsKICAgICAgICBjb25zdCBwbHVMYWJlbCA9IHBsdUVudHJ5R3JvdXAucXVlcnlTZWxlY3RvcignbGFiZWwgLmxhYmVsLXRleHQnKTsKICAgICAgICBjb25zdCBoYXNWYXJpYW50cyA9IGN1cnJlbnRWYXJpYW50R3JvdXBzLmxlbmd0aCA+IDA7CiAgICAgICAgcGx1TGFiZWwudGV4dENvbnRlbnQgPSAnQ3VzdG9tIEJhc2UgUExVL1NLVSc7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImN1c3RvbVBsdSIpLnBsYWNlaG9sZGVyID0gJ2UuZy4sIFBJWlpBLUNIRSc7CiAgICB9CiAgICBmdW5jdGlvbiB1cGRhdGVSZXF1aXJlZEZpZWxkcygpIHsKICAgICAgICBjb25zdCBzZWxlY3RlZFR5cGUgPSBwcm9kdWN0VHlwZVNlbGVjdC52YWx1ZTsKICAgICAgICBjb25zdCBpbnZlbnRvcnlDYXRlZ29yeUxhYmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ludmVudG9yeUNhdGVnb3J5TGFiZWwnKS5xdWVyeVNlbGVjdG9yKCcubGFiZWwtdGV4dCcpOwogICAgICAgIGNvbnN0IGludmVudG9yeVN1YkNhdGVnb3J5TGFiZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW52ZW50b3J5U3ViQ2F0ZWdvcnlMYWJlbCcpLnF1ZXJ5U2VsZWN0b3IoJy5sYWJlbC10ZXh0Jyk7CiAgICAgICAgY29uc3QgY29zdFByaWNlTGFiZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29zdFByaWNlTGFiZWwnKS5xdWVyeVNlbGVjdG9yKCcubGFiZWwtdGV4dCcpOwogICAgICAgIGNvbnN0IHN1cHBsaWVkUXVhbnRpdHlHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdXBwbGllZFF1YW50aXR5R3JvdXAnKTsKICAgICAgICBjb25zdCBzdXBwbGllZFF1YW50aXR5TGFiZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3VwcGxpZWRRdWFudGl0eUxhYmVsJykucXVlcnlTZWxlY3RvcignLmxhYmVsLXRleHQnKTsKICAgICAgICBjb25zdCB5aWVsZFF1YW50aXR5R3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgneWllbGRRdWFudGl0eUdyb3VwJyk7CiAgICAgICAgY29uc3QgeWllbGRRdWFudGl0eUxhYmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3lpZWxkUXVhbnRpdHlMYWJlbCcpLnF1ZXJ5U2VsZWN0b3IoJy5sYWJlbC10ZXh0Jyk7CiAgICAgICAgY29uc3QgcHJlcExvY2F0aW9uR3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJlcExvY2F0aW9uR3JvdXAnKTsKICAgICAgICBjb25zdCBtZW51Q2F0ZWdvcnlHcm91cCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZW51Q2F0ZWdvcnlHcm91cCcpOwogICAgICAgIGNvbnN0IHByZXBMb2NhdGlvbklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXBMb2NhdGlvbicpOwogICAgICAgIGNvbnN0IG1lbnVDYXRlZ29yeUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lbnVDYXRlZ29yeScpOwogICAgICAgIGNvbnN0IHB1cmNoYXNlZEZvclJlc2FsZUdyb3VwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3B1cmNoYXNlZEZvclJlc2FsZUdyb3VwJyk7CiAgICAgICAgY29uc3QgdW9tU2VsZWN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndW9tJyk7CgogICAgICAgIGNvc3RQcmljZUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgc2VsbGluZ1ByaWNlR3JvdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICBwcmVwTG9jYXRpb25Hcm91cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgIG1lbnVDYXRlZ29yeUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgaW52ZW50b3J5Q2F0ZWdvcnlMYWJlbC5pbm5lckhUTUwgPSBgSW52ZW50b3J5IENhdGVnb3J5YDsKICAgICAgICBpbnZlbnRvcnlTdWJDYXRlZ29yeUxhYmVsLmlubmVySFRNTCA9IGBJbnZlbnRvcnkgU3ViLUNhdGVnb3J5YDsKICAgICAgICBjb3N0UHJpY2VMYWJlbC5pbm5lckhUTUwgPSBgRGVmYXVsdCBDb3N0IFByaWNlIChleC4gVmF0KWA7CiAgICAgICAgc3VwcGxpZWRRdWFudGl0eUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgeWllbGRRdWFudGl0eUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgc2luZ2xlUHJvZHVjdE1vZGlmaWVyQ29udHJvbHMuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICBwdXJjaGFzZWRGb3JSZXNhbGVHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwoKICAgICAgICBpZihjdXJyZW50VmFyaWFudEdyb3Vwcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgc2luZ2xlUHJvZHVjdE1vZGlmaWVyQ29udHJvbHMuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKGN1cnJlbnRWYXJpYW50R3JvdXBzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgc2VsbGluZ1ByaWNlR3JvdXAuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKHNlbGVjdGVkVHlwZSA9PT0gJ2ZpbmlzaGVkR29vZCcpIHsKICAgICAgICAgICAgaW52ZW50b3J5Q2F0ZWdvcnlMYWJlbC5pbm5lckhUTUwgPSBgSW52ZW50b3J5IENhdGVnb3J5IChOb3QgUmVxdWlyZWQpYDsKICAgICAgICAgICAgaW52ZW50b3J5U3ViQ2F0ZWdvcnlMYWJlbC5pbm5lckhUTUwgPSBgSW52ZW50b3J5IFN1Yi1DYXRlZ29yeSAoTm90IFJlcXVpcmVkKWA7CiAgICAgICAgICAgIHVvbVNlbGVjdEVsLnZhbHVlID0gJ2VhJzsKICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkVHlwZSA9PT0gJ3Jhd01hdGVyaWFsJykgewogICAgICAgICAgICB1b21TZWxlY3RFbC52YWx1ZSA9ICcnOwogICAgICAgICAgICBzZWxsaW5nUHJpY2VHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBwcmVwTG9jYXRpb25Hcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBwcmVwTG9jYXRpb25JbnB1dC52YWx1ZSA9ICcnOwogICAgICAgICAgICBtZW51Q2F0ZWdvcnlHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBtZW51Q2F0ZWdvcnlJbnB1dC52YWx1ZSA9ICcnOwogICAgICAgICAgICBpbnZlbnRvcnlDYXRlZ29yeUxhYmVsLmlubmVySFRNTCA9IGBJbnZlbnRvcnkgQ2F0ZWdvcnkgPHNwYW4gY2xhc3M9InJlcXVpcmVkLXN0YXIiPio8L3NwYW4+YDsKICAgICAgICAgICAgY29zdFByaWNlR3JvdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgY29zdFByaWNlTGFiZWwuaW5uZXJIVE1MID0gYFRvdGFsIENvc3QgUHJpY2UgKGV4LiBWYXQpIDxzcGFuIGNsYXNzPSJyZXF1aXJlZC1zdGFyIj4qPC9zcGFuPmA7CiAgICAgICAgICAgIHN1cHBsaWVkUXVhbnRpdHlHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgICAgICBzdXBwbGllZFF1YW50aXR5TGFiZWwuaW5uZXJIVE1MID0gYFN1cHBsaWVkIFF1YW50aXR5IDxzcGFuIGNsYXNzPSJyZXF1aXJlZC1zdGFyIj4qPC9zcGFuPmA7CiAgICAgICAgfSBlbHNlIGlmIChzZWxlY3RlZFR5cGUgPT09ICdmaW5pc2hlZEdvb2QgJiByYXdNYXRlcmlhbCcpIHsKICAgICAgICAgICAgdW9tU2VsZWN0RWwudmFsdWUgPSAnJzsKICAgICAgICAgICAgaW52ZW50b3J5Q2F0ZWdvcnlMYWJlbC5pbm5lckhUTUwgPSBgSW52ZW50b3J5IENhdGVnb3J5IDxzcGFuIGNsYXNzPSJyZXF1aXJlZC1zdGFyIj4qPC9zcGFuPmA7CiAgICAgICAgICAgIGNvc3RQcmljZUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgICAgIGNvc3RQcmljZUxhYmVsLmlubmVySFRNTCA9IGBUb3RhbCBDb3N0IFByaWNlIChleC4gVmF0KSA8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj5gOwogICAgICAgICAgICBzdXBwbGllZFF1YW50aXR5R3JvdXAuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICAgICAgICAgICAgc3VwcGxpZWRRdWFudGl0eUxhYmVsLmlubmVySFRNTCA9IGBTdXBwbGllZCBRdWFudGl0eSA8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj5gOwogICAgICAgICAgICBwdXJjaGFzZWRGb3JSZXNhbGVHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzZWxlY3RlZFR5cGUgPT09ICdNYW51ZmFjdHVyZWQnKSB7CiAgICAgICAgICAgIHVvbVNlbGVjdEVsLnZhbHVlID0gJyc7CiAgICAgICAgICAgIHNlbGxpbmdQcmljZUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIHByZXBMb2NhdGlvbkdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIHByZXBMb2NhdGlvbklucHV0LnZhbHVlID0gJyc7CiAgICAgICAgICAgIG1lbnVDYXRlZ29yeUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIG1lbnVDYXRlZ29yeUlucHV0LnZhbHVlID0gJyc7CiAgICAgICAgICAgIGludmVudG9yeUNhdGVnb3J5TGFiZWwuaW5uZXJIVE1MID0gYEludmVudG9yeSBDYXRlZ29yeSA8c3BhbiBjbGFzcz0icmVxdWlyZWQtc3RhciI+Kjwvc3Bhbj5gOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICB1b21TZWxlY3RFbC52YWx1ZSA9ICcnOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgaXNEaXNhYmxlZCA9IHNlbGVjdGVkVHlwZSA9PT0gJ3Jhd01hdGVyaWFsJyB8fCBzZWxlY3RlZFR5cGUgPT09ICdNYW51ZmFjdHVyZWQnOwogICAgICAgIGFkZFZhcmlhbnRHcm91cEJ0bi5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcGx5UHJlc2V0QnRuJykuZGlzYWJsZWQgPSBpc0Rpc2FibGVkOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlQXNQcmVzZXRCdG4nKS5kaXNhYmxlZCA9IGlzRGlzYWJsZWQ7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmtTaW5nbGVNb2RpZmllckJ0bicpLmRpc2FibGVkID0gaXNEaXNhYmxlZDsKCiAgICAgICAgdXBkYXRlU2luZ2xlUHJvZHVjdE1vZGlmaWVySW5kaWNhdG9yKCk7CiAgICAgICAgc2F2ZVN0YXRlKCk7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlU2luZ2xlUHJvZHVjdE1vZGlmaWVySW5kaWNhdG9yKCkgewogICAgICAgIGNvbnN0IGluZGljYXRvcldyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2luZ2xlTW9kaWZpZXJJbmRpY2F0b3InKTsKICAgICAgICBpbmRpY2F0b3JXcmFwcGVyLmlubmVySFRNTCA9ICcnOwogICAgICAgIGNvbnN0IGNvdW50ID0gY3VycmVudE1vZGlmaWVyTGlua3NbJyddPy5sZW5ndGggfHwgMDsKICAgICAgICAKICAgICAgICBpZiAoY291bnQgPiAwKSB7CiAgICAgICAgICAgIGNvbnN0IHRvb2x0aXBEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgdG9vbHRpcERpdi5jbGFzc05hbWUgPSAndG9vbHRpcCBtb2RpZmllci1pbmRpY2F0b3Itd3JhcHBlcic7CiAgICAgICAgICAgIGNvbnN0IGluZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgICAgICAgaW5kaWNhdG9yLmNsYXNzTmFtZSA9ICdtb2RpZmllci1pbmRpY2F0b3InOwogICAgICAgICAgICBpbmRpY2F0b3IudGV4dENvbnRlbnQgPSBjb3VudDsKICAgICAgICAgICAgY29uc3QgdG9vbHRpcFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgIHRvb2x0aXBUZXh0LmNsYXNzTmFtZSA9ICd0b29sdGlwdGV4dCc7CiAgICAgICAgICAgIHRvb2x0aXBUZXh0LmlubmVySFRNTCA9IChjdXJyZW50TW9kaWZpZXJMaW5rc1snJ10gfHwgW10pLmpvaW4oJzxicj4nKTsKICAgICAgICAgICAgdG9vbHRpcERpdi5hcHBlbmRDaGlsZChpbmRpY2F0b3IpOwogICAgICAgICAgICB0b29sdGlwRGl2LmFwcGVuZENoaWxkKHRvb2x0aXBUZXh0KTsKICAgICAgICAgICAgaW5kaWNhdG9yV3JhcHBlci5hcHBlbmRDaGlsZCh0b29sdGlwRGl2KTsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBoYW5kbGVJbnZlbnRvcnlDYXRlZ29yeUNoYW5nZShldmVudCkgewogICAgICAgIGNvbnN0IHN1YkNhdGVnb3JpZXMgPSBjYXRlZ29yeU1hcFtldmVudC50YXJnZXQudmFsdWVdOwogICAgICAgIGlmIChzdWJDYXRlZ29yaWVzKSB7IHN1YkNhdGVnb3JpZXMuZm9yRWFjaChzdWIgPT4gYWRkVG9EYXRhbGlzdCgiaW52ZW50b3J5U3ViQ2F0ZWdvcnlMaXN0Iiwgc3ViKSk7IH0KICAgIH0KICAgIGZ1bmN0aW9uIGhhbmRsZUJhcmNvZGVWaXNpYmlsaXR5KCkgewogICAgICAgIGJhcmNvZGVFbnRyeUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAoaGFzQmFyY29kZVNlbGVjdC52YWx1ZSA9PT0gJ3llcycpID8gJ2ZsZXgnIDogJ25vbmUnOwogICAgfQoKICAgIGZ1bmN0aW9uIGFkZFZhcmlhbnRHcm91cCgpIHsKICAgICAgICBjdXJyZW50VmFyaWFudEdyb3Vwcy5wdXNoKHsgZ3JvdXBOYW1lOiAnJywgb3B0aW9uczogW3sgbmFtZTogJycgfV0gfSk7CiAgICAgICAgdXBkYXRlUmVxdWlyZWRGaWVsZHMoKTsKICAgICAgICByZW5kZXJWYXJpYW50R3JvdXBzKCk7CiAgICB9CiAgICBmdW5jdGlvbiByZW1vdmVWYXJpYW50R3JvdXAoZ3JvdXBJbmRleCkgewogICAgICAgIGN1cnJlbnRWYXJpYW50R3JvdXBzLnNwbGljZShncm91cEluZGV4LCAxKTsKICAgICAgICB1cGRhdGVSZXF1aXJlZEZpZWxkcygpOwogICAgICAgIHJlbmRlclZhcmlhbnRHcm91cHMoKTsKICAgIH0KICAgIGZ1bmN0aW9uIGFkZFZhcmlhbnRPcHRpb24oZ3JvdXBJbmRleCkgewogICAgICAgIGN1cnJlbnRWYXJpYW50R3JvdXBzW2dyb3VwSW5kZXhdLm9wdGlvbnMucHVzaCh7IG5hbWU6ICcnIH0pOwogICAgICAgIHJlbmRlclZhcmlhbnRHcm91cHMoKTsKICAgIH0KICAgIGZ1bmN0aW9uIHJlbW92ZVZhcmlhbnRPcHRpb24oZ3JvdXBJbmRleCwgb3B0aW9uSW5kZXgpIHsKICAgICAgICBjdXJyZW50VmFyaWFudEdyb3Vwc1tncm91cEluZGV4XS5vcHRpb25zLnNwbGljZShvcHRpb25JbmRleCwgMSk7CiAgICAgICAgaWYgKGN1cnJlbnRWYXJpYW50R3JvdXBzW2dyb3VwSW5kZXhdLm9wdGlvbnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHJlbW92ZVZhcmlhbnRHcm91cChncm91cEluZGV4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZW5kZXJWYXJpYW50R3JvdXBzKCk7CiAgICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gcmVuZGVyVmFyaWFudEdyb3VwcygpIHsKICAgICAgICB2YXJpYW50R3JvdXBzQ29udGFpbmVyLmlubmVySFRNTCA9ICcnOwogICAgICAgIGN1cnJlbnRWYXJpYW50R3JvdXBzLmZvckVhY2goKGdyb3VwLCBncm91cEluZGV4KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGdyb3VwRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgZ3JvdXBFbC5jbGFzc05hbWUgPSAndmFyaWFudC1ncm91cC1yb3cnOwoKICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIGhlYWRlci5jbGFzc05hbWUgPSAndmFyaWFudC1ncm91cC1oZWFkZXInOwogICAgICAgICAgICBjb25zdCBncm91cE5hbWVJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgICAgIGdyb3VwTmFtZUlucHV0LnR5cGUgPSAndGV4dCc7CiAgICAgICAgICAgIGdyb3VwTmFtZUlucHV0LnBsYWNlaG9sZGVyID0gJ0dyb3VwIE5hbWUgKGUuZy4sIFNpemUpJzsKICAgICAgICAgICAgZ3JvdXBOYW1lSW5wdXQudmFsdWUgPSBncm91cC5ncm91cE5hbWU7CiAgICAgICAgICAgIGdyb3VwTmFtZUlucHV0Lm9uaW5wdXQgPSAoZSkgPT4gewogICAgICAgICAgICAgICAgY3VycmVudFZhcmlhbnRHcm91cHNbZ3JvdXBJbmRleF0uZ3JvdXBOYW1lID0gZS50YXJnZXQudmFsdWU7CiAgICAgICAgICAgICAgICBnZW5lcmF0ZUFuZFJlbmRlclByaWNpbmcoKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgZ3JvdXBOYW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnRhcmdldC52YWx1ZSA9IGNhcGl0YWxpemVXb3JkcyhlLnRhcmdldC52YWx1ZS50cmltKCkpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZChncm91cE5hbWVJbnB1dCk7CiAgICAgICAgICAgIGNvbnN0IHJlbW92ZUdyb3VwQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIHJlbW92ZUdyb3VwQnRuLnR5cGUgPSAnYnV0dG9uJzsKICAgICAgICAgICAgcmVtb3ZlR3JvdXBCdG4uY2xhc3NOYW1lID0gJ2J0bi1yZW1vdmUnOwogICAgICAgICAgICByZW1vdmVHcm91cEJ0bi5pbm5lckhUTUwgPSBgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMyA2djE4aDE4di0xOGgtMTh6bTUgMTRjMCAuNTUyLS40NDggMS0xIDFzLTEtLjQ0OC0xLTF2LTEwYzAtLjU1Mi40NDgtMSAxLTFzMSAuNDQ4IDEgMXYxMHptNSAwYzAgLjU1Mi0uNDQ4IDEtMSAxcy0xLS40NDgtMS0xdi0xMGMwLS41NTIuNDQ4LTEgMS0xczEgLjQ0OCAxIDF2MTB6bTUgMGMwIC41NTItLjQ0OCAxLTEgMXMtMS0uNDQ4LTEtMXYtMTBjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjEwem00LTE4aC0yMHYtMmg2di0xLjVjMC0uODI3LjY3My0xLjUgMS41LTEuNWg1Yy44MjUgMCAxLjUuNjcxIDEuNSAxLjV2MS41aDZ2MnoiLz48L3N2Zz5gOwogICAgICAgICAgICByZW1vdmVHcm91cEJ0bi5vbmNsaWNrID0gKCkgPT4gcmVtb3ZlVmFyaWFudEdyb3VwKGdyb3VwSW5kZXgpOwogICAgICAgICAgICBoZWFkZXIuYXBwZW5kQ2hpbGQocmVtb3ZlR3JvdXBCdG4pOwogICAgICAgICAgICBncm91cEVsLmFwcGVuZENoaWxkKGhlYWRlcik7CgogICAgICAgICAgICBjb25zdCBvcHRpb25zQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIG9wdGlvbnNDb250YWluZXIuY2xhc3NOYW1lID0gJ3ZhcmlhbnQtb3B0aW9ucy1jb250YWluZXInOwogICAgICAgICAgICBvcHRpb25zQ29udGFpbmVyLmRhdGFzZXQuZ3JvdXBJbmRleCA9IGdyb3VwSW5kZXg7CiAgICAgICAgICAgIAogICAgICAgICAgICBncm91cC5vcHRpb25zLmZvckVhY2goKG9wdGlvbiwgb3B0aW9uSW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvblJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgb3B0aW9uUm93LmNsYXNzTmFtZSA9ICd2YXJpYW50LW9wdGlvbi1yb3cnOwogICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uTmFtZUlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICAgICAgICAgIG9wdGlvbk5hbWVJbnB1dC50eXBlID0gJ3RleHQnOwogICAgICAgICAgICAgICAgb3B0aW9uTmFtZUlucHV0LnBsYWNlaG9sZGVyID0gYE9wdGlvbiAke29wdGlvbkluZGV4ICsgMX0gTmFtZSAoZS5nLiwgU21hbGwpYDsKICAgICAgICAgICAgICAgIG9wdGlvbk5hbWVJbnB1dC52YWx1ZSA9IG9wdGlvbi5uYW1lOwogICAgICAgICAgICAgICAgb3B0aW9uTmFtZUlucHV0Lm9uaW5wdXQgPSAoZSkgPT4gewogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRWYXJpYW50R3JvdXBzW2dyb3VwSW5kZXhdLm9wdGlvbnNbb3B0aW9uSW5kZXhdLm5hbWUgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBnZW5lcmF0ZUFuZFJlbmRlclByaWNpbmcoKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBvcHRpb25OYW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIChlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQudmFsdWUgPSBjYXBpdGFsaXplV29yZHMoZS50YXJnZXQudmFsdWUudHJpbSgpKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgb3B0aW9uUm93LmFwcGVuZENoaWxkKG9wdGlvbk5hbWVJbnB1dCk7CiAgICAgICAgICAgICAgICBjb25zdCByZW1vdmVPcHRpb25CdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgICAgIHJlbW92ZU9wdGlvbkJ0bi50eXBlID0gJ2J1dHRvbic7CiAgICAgICAgICAgICAgICByZW1vdmVPcHRpb25CdG4uY2xhc3NOYW1lID0gJ2J0bi1yZW1vdmUnOwogICAgICAgICAgICAgICAgcmVtb3ZlT3B0aW9uQnRuLmlubmVySFRNTCA9IGAmbmRhc2g7YDsKICAgICAgICAgICAgICAgIHJlbW92ZU9wdGlvbkJ0bi5vbmNsaWNrID0gKCkgPT4gcmVtb3ZlVmFyaWFudE9wdGlvbihncm91cEluZGV4LCBvcHRpb25JbmRleCk7CiAgICAgICAgICAgICAgICBvcHRpb25Sb3cuYXBwZW5kQ2hpbGQocmVtb3ZlT3B0aW9uQnRuKTsKICAgICAgICAgICAgICAgIG9wdGlvbnNDb250YWluZXIuYXBwZW5kQ2hpbGQob3B0aW9uUm93KTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBncm91cEVsLmFwcGVuZENoaWxkKG9wdGlvbnNDb250YWluZXIpOwoKICAgICAgICAgICAgY29uc3QgYWRkT3B0aW9uQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIGFkZE9wdGlvbkJ0bi50eXBlID0gJ2J1dHRvbic7CiAgICAgICAgICAgIGFkZE9wdGlvbkJ0bi50ZXh0Q29udGVudCA9ICdBZGQgT3B0aW9uJzsKICAgICAgICAgICAgYWRkT3B0aW9uQnRuLmNsYXNzTmFtZSA9ICdidG4tYWRkLWR5bmFtaWMnOwogICAgICAgICAgICBhZGRPcHRpb25CdG4uc3R5bGUuYWxpZ25TZWxmID0gJ2ZsZXgtc3RhcnQnOwogICAgICAgICAgICBhZGRPcHRpb25CdG4uc3R5bGUubWFyZ2luTGVmdCA9ICcyMHB4JzsKICAgICAgICAgICAgYWRkT3B0aW9uQnRuLm9uY2xpY2sgPSAoKSA9PiBhZGRWYXJpYW50T3B0aW9uKGdyb3VwSW5kZXgpOwogICAgICAgICAgICBncm91cEVsLmFwcGVuZENoaWxkKGFkZE9wdGlvbkJ0bik7CgogICAgICAgICAgICB2YXJpYW50R3JvdXBzQ29udGFpbmVyLmFwcGVuZENoaWxkKGdyb3VwRWwpOwogICAgICAgIH0pOwogICAgICAgIAogICAgICAgIG5ldyBTb3J0YWJsZSh2YXJpYW50R3JvdXBzQ29udGFpbmVyLCB7CiAgICAgICAgICAgIGFuaW1hdGlvbjogMTUwLAogICAgICAgICAgICBoYW5kbGU6ICcudmFyaWFudC1ncm91cC1yb3cnLAogICAgICAgICAgICBvbkVuZDogKGV2dCkgPT4gewogICAgICAgICAgICAgICAgY29uc3QgbW92ZWRJdGVtID0gY3VycmVudFZhcmlhbnRHcm91cHMuc3BsaWNlKGV2dC5vbGRJbmRleCwgMSlbMF07CiAgICAgICAgICAgICAgICBjdXJyZW50VmFyaWFudEdyb3Vwcy5zcGxpY2UoZXZ0Lm5ld0luZGV4LCAwLCBtb3ZlZEl0ZW0pOwogICAgICAgICAgICAgICAgcmVuZGVyVmFyaWFudEdyb3VwcygpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy52YXJpYW50LW9wdGlvbnMtY29udGFpbmVyJykuZm9yRWFjaChjb250YWluZXIgPT4gewogICAgICAgICAgICBuZXcgU29ydGFibGUoY29udGFpbmVyLCB7CiAgICAgICAgICAgICAgICBhbmltYXRpb246IDE1MCwKICAgICAgICAgICAgICAgIG9uRW5kOiAoZXZ0KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZ3JvdXBJbmRleCA9IGV2dC5mcm9tLmRhdGFzZXQuZ3JvdXBJbmRleDsKICAgICAgICAgICAgICAgICAgICBjb25zdCBtb3ZlZE9wdGlvbiA9IGN1cnJlbnRWYXJpYW50R3JvdXBzW2dyb3VwSW5kZXhdLm9wdGlvbnMuc3BsaWNlKGV2dC5vbGRJbmRleCwgMSlbMF07CiAgICAgICAgICAgICAgICAgICAgY3VycmVudFZhcmlhbnRHcm91cHNbZ3JvdXBJbmRleF0ub3B0aW9ucy5zcGxpY2UoZXZ0Lm5ld0luZGV4LCAwLCBtb3ZlZE9wdGlvbik7CiAgICAgICAgICAgICAgICAgICAgcmVuZGVyVmFyaWFudEdyb3VwcygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKCiAgICAgICAgZ2VuZXJhdGVBbmRSZW5kZXJQcmljaW5nKCk7CiAgICAgICAgaGFuZGxlUGx1VmlzaWJpbGl0eSgpOwogICAgICAgIHVwZGF0ZVJlcXVpcmVkRmllbGRzKCk7CiAgICB9CiAgICBmdW5jdGlvbiBnZW5lcmF0ZUFuZFJlbmRlclByaWNpbmcoKSB7CiAgICAgICAgY29uc3QgdmFsaWRHcm91cHMgPSBjdXJyZW50VmFyaWFudEdyb3Vwcy5maWx0ZXIoZyA9PiBnLmdyb3VwTmFtZS50cmltKCkgJiYgZy5vcHRpb25zLnNvbWUobyA9PiBvLm5hbWUudHJpbSgpKSk7CiAgICAgICAgcHJpY2luZ0NvbHVtbi5zdHlsZS5kaXNwbGF5ID0gKHZhbGlkR3JvdXBzLmxlbmd0aCA+IDApID8gJ2Jsb2NrJyA6ICdub25lJzsKICAgICAgICB2YXJpYW50UHJpY2luZ0NvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsKCiAgICAgICAgaWYgKHZhbGlkR3JvdXBzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBjdXJyZW50VmFyaWFudFByaWNpbmcgPSBbXTsKICAgICAgICAgICAgdXBkYXRlUmVxdWlyZWRGaWVsZHMoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgYXJyYXlzVG9Db21iaW5lID0gdmFsaWRHcm91cHMubWFwKGcgPT4gZy5vcHRpb25zLmZpbHRlcihvID0+IG8ubmFtZS50cmltKCkpLm1hcChvID0+ICh7IGdyb3VwTmFtZTogZy5ncm91cE5hbWUudHJpbSgpLCBvcHRpb25OYW1lOiBvLm5hbWUudHJpbSgpIH0pKSk7CiAgICAgICAgY29uc3QgY2FydGVzaWFuID0gKC4uLmEpID0+IGEucmVkdWNlKChBLCBCKSA9PiBBLmZsYXRNYXAoeCA9PiBCLm1hcCh5ID0+IFsuLi54LCB5XSkpLCBbW11dKTsKICAgICAgICBjb25zdCBjb21iaW5hdGlvbnMgPSBjYXJ0ZXNpYW4oLi4uYXJyYXlzVG9Db21iaW5lKTsKCiAgICAgICAgY29uc3QgbmV3UHJpY2luZ0RhdGEgPSBjb21iaW5hdGlvbnMubWFwKGNvbWJvID0+IHsKICAgICAgICAgICAgY29uc3QgY29tYmluYXRpb25TdHJpbmcgPSBjb21iby5tYXAoYyA9PiBgJHtjLmdyb3VwTmFtZX06ICR7Yy5vcHRpb25OYW1lfWApLmpvaW4oJzsgJyk7CiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nID0gY3VycmVudFZhcmlhbnRQcmljaW5nLmZpbmQocCA9PiBwLmNvbWJpbmF0aW9uID09PSBjb21iaW5hdGlvblN0cmluZyk7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBjb21iaW5hdGlvbjogY29tYmluYXRpb25TdHJpbmcsCiAgICAgICAgICAgICAgICBzZWxsaW5nUHJpY2U6IGV4aXN0aW5nID8gZXhpc3Rpbmcuc2VsbGluZ1ByaWNlIDogJycsCiAgICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgICAgY3VycmVudFZhcmlhbnRQcmljaW5nID0gbmV3UHJpY2luZ0RhdGE7CiAgICAgICAgCiAgICAgICAgY29uc3QgcHJpY2luZ0hlYWRlckxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTsKICAgICAgICBwcmljaW5nSGVhZGVyTGFiZWwuY2xhc3NOYW1lID0gJ3Rvb2x0aXAnOwogICAgICAgIHByaWNpbmdIZWFkZXJMYWJlbC5pbm5lckhUTUwgPSBgQ29tYmluYXRpb24gUHJpY2luZyA8c3BhbiBjbGFzcz0idG9vbHRpcHRleHQiPlNldCB0aGUgc2VsbGluZyBwcmljZSBmb3IgZWFjaCB1bmlxdWUgY29tYmluYXRpb24gb2YgdmFyaWFudHMuPC9zcGFuPmA7CiAgICAgICAgdmFyaWFudFByaWNpbmdDb250YWluZXIuYXBwZW5kQ2hpbGQocHJpY2luZ0hlYWRlckxhYmVsKTsKCiAgICAgICAgY29uc3QgZGVmYXVsdFByaWNlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGxpbmdQcmljZScpLnZhbHVlOwogICAgICAgIGNvbnN0IHByaWNpbmdDb250cm9scyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIHByaWNpbmdDb250cm9scy5jbGFzc05hbWUgPSAncHJpY2luZy1jb250cm9scyc7CiAgICAgICAgcHJpY2luZ0NvbnRyb2xzLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcyMHB4JzsKICAgICAgICBwcmljaW5nQ29udHJvbHMuaW5uZXJIVE1MID0gYAogICAgICAgICAgICA8aW5wdXQgdHlwZT0ibnVtYmVyIiBpZD0iYnVsa1ByaWNlSW5wdXQiIHBsYWNlaG9sZGVyPSJTZXQgcHJpY2UgZm9yIGFsbCIgc3RlcD0iMC4wMSIgdmFsdWU9IiR7ZGVmYXVsdFByaWNlIHx8ICcnfSI+CiAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBpZD0iYXBwbHlCdWxrUHJpY2VCdG4iIGNsYXNzPSJidG4tYWRkIGJ0bi1hZGQtZHluYW1pYyI+QXBwbHkgdG8gYWxsPC9idXR0b24+CiAgICAgICAgYDsKICAgICAgICB2YXJpYW50UHJpY2luZ0NvbnRhaW5lci5hcHBlbmRDaGlsZChwcmljaW5nQ29udHJvbHMpOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwbHlCdWxrUHJpY2VCdG4nKS5vbmNsaWNrID0gKCkgPT4gewogICAgICAgICAgICBjb25zdCBwcmljZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidWxrUHJpY2VJbnB1dCcpLnZhbHVlOwogICAgICAgICAgICBpZiAocHJpY2UgIT09ICcnICYmICFpc05hTihwcmljZSkpIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRWYXJpYW50UHJpY2luZy5mb3JFYWNoKHAgPT4gcC5zZWxsaW5nUHJpY2UgPSBwYXJzZUZsb2F0KHByaWNlKSk7CiAgICAgICAgICAgICAgICBnZW5lcmF0ZUFuZFJlbmRlclByaWNpbmcoKTsKICAgICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGN1cnJlbnRWYXJpYW50UHJpY2luZy5mb3JFYWNoKChwcmljZUl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICByb3cuY2xhc3NOYW1lID0gJ3ZhcmlhbnQtcHJpY2luZy1yb3cnOwogICAgICAgICAgICByb3cuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9ICcyZnIgMWZyIGF1dG8nOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgbmFtZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogICAgICAgICAgICBuYW1lRWwuY2xhc3NOYW1lID0gJ2NvbWJvLW5hbWUnOwogICAgICAgICAgICBuYW1lRWwudGV4dENvbnRlbnQgPSBwcmljZUl0ZW0uY29tYmluYXRpb247CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBzcElucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICAgICAgc3BJbnB1dC50eXBlID0gJ251bWJlcic7IHNwSW5wdXQuc3RlcCA9ICcwLjAxJzsgc3BJbnB1dC5wbGFjZWhvbGRlciA9ICdTZWxsaW5nIFByaWNlKic7CiAgICAgICAgICAgIHNwSW5wdXQudmFsdWUgPSBwcmljZUl0ZW0uc2VsbGluZ1ByaWNlOwogICAgICAgICAgICBzcElucHV0Lm9uaW5wdXQgPSAoZSkgPT4gY3VycmVudFZhcmlhbnRQcmljaW5nW2luZGV4XS5zZWxsaW5nUHJpY2UgPSBlLnRhcmdldC52YWx1ZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IGFjdGlvbnNXcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIGFjdGlvbnNXcmFwcGVyLnN0eWxlID0gJ2Rpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogOHB4Oyc7CgogICAgICAgICAgICBjb25zdCBsaW5rQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIGxpbmtCdG4udHlwZSA9ICdidXR0b24nOwogICAgICAgICAgICBsaW5rQnRuLnRleHRDb250ZW50ID0gJ0xpbmsgTW9kaWZpZXInOwogICAgICAgICAgICBsaW5rQnRuLnRpdGxlID0gJ0xpbmsgTW9kaWZpZXJzJzsKICAgICAgICAgICAgbGlua0J0bi5jbGFzc05hbWUgPSAnYnRuLWFkZCBidG4tYWRkLWR5bmFtaWMnOwogICAgICAgICAgICBsaW5rQnRuLm9uY2xpY2sgPSAoKSA9PiBvcGVuTGlua01vZGlmaWVyTW9kYWwocHJpY2VJdGVtLmNvbWJpbmF0aW9uKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJvdy5hcHBlbmRDaGlsZChuYW1lRWwpOwogICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoc3BJbnB1dCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBsaW5rZWRNb2RpZmllcnMgPSBjdXJyZW50TW9kaWZpZXJMaW5rc1twcmljZUl0ZW0uY29tYmluYXRpb25dIHx8IFtdOwogICAgICAgICAgICBpZiAobGlua2VkTW9kaWZpZXJzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGNvbnN0IHRvb2x0aXBEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgIHRvb2x0aXBEaXYuY2xhc3NOYW1lID0gJ3Rvb2x0aXAgbW9kaWZpZXItaW5kaWNhdG9yLXdyYXBwZXInOwogICAgICAgICAgICAgICAgY29uc3QgaW5kaWNhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogICAgICAgICAgICAgICAgaW5kaWNhdG9yLmNsYXNzTmFtZSA9ICdtb2RpZmllci1pbmRpY2F0b3InOwogICAgICAgICAgICAgICAgaW5kaWNhdG9yLnRleHRDb250ZW50ID0gbGlua2VkTW9kaWZpZXJzLmxlbmd0aDsKICAgICAgICAgICAgICAgIGNvbnN0IHRvb2x0aXBUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogICAgICAgICAgICAgICAgdG9vbHRpcFRleHQuY2xhc3NOYW1lID0gJ3Rvb2x0aXB0ZXh0JzsKICAgICAgICAgICAgICAgIHRvb2x0aXBUZXh0LmlubmVySFRNTCA9IGxpbmtlZE1vZGlmaWVycy5qb2luKCc8YnI+Jyk7CiAgICAgICAgICAgICAgICB0b29sdGlwRGl2LmFwcGVuZENoaWxkKGluZGljYXRvcik7CiAgICAgICAgICAgICAgICB0b29sdGlwRGl2LmFwcGVuZENoaWxkKHRvb2x0aXBUZXh0KTsKICAgICAgICAgICAgICAgIGFjdGlvbnNXcmFwcGVyLmFwcGVuZENoaWxkKHRvb2x0aXBEaXYpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBhY3Rpb25zV3JhcHBlci5hcHBlbmRDaGlsZChsaW5rQnRuKTsKICAgICAgICAgICAgcm93LmFwcGVuZENoaWxkKGFjdGlvbnNXcmFwcGVyKTsKICAgICAgICAgICAgdmFyaWFudFByaWNpbmdDb250YWluZXIuYXBwZW5kQ2hpbGQocm93KTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGN1cnJlbnRNb2RpZmllckdyb3Vwcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGNvbnN0IGJ1bGtTZXR0aW5nV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBidWxrU2V0dGluZ1dyYXBwZXIuc3R5bGUgPSAnbWFyZ2luLXRvcDogMjBweDsgcGFkZGluZy10b3A6IDIwcHg7IGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7JzsKICAgICAgICAgICAgY29uc3QgYnVsa0xhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTsKICAgICAgICAgICAgYnVsa0xhYmVsLmNsYXNzTmFtZSA9ICd0b29sdGlwJzsKICAgICAgICAgICAgYnVsa0xhYmVsLmlubmVySFRNTCA9IGBCdWxrIE1vZGlmaWVyIFNldHRpbmcgPHNwYW4gY2xhc3M9InRvb2x0aXB0ZXh0Ij5BcHBseSBvbmUgb3IgbW9yZSBtb2RpZmllciBncm91cHMgdG8gYWxsIHZhcmlhbnRzIG9mIHRoaXMgcHJvZHVjdC48L3NwYW4+YDsKICAgICAgICAgICAgYnVsa1NldHRpbmdXcmFwcGVyLmFwcGVuZENoaWxkKGJ1bGtMYWJlbCk7CgogICAgICAgICAgICBjb25zdCBidWxrQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIGJ1bGtCdG4udGV4dENvbnRlbnQgPSAnQXBwbHkgQnVsayBNb2RpZmllcic7CiAgICAgICAgICAgIGJ1bGtCdG4udHlwZSA9ICdidXR0b24nOwogICAgICAgICAgICBidWxrQnRuLmNsYXNzTmFtZSA9ICdidG4tYWRkIGJ0bi1hZGQtZHluYW1pYyc7CiAgICAgICAgICAgIGJ1bGtCdG4uc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnOwogICAgICAgICAgICBidWxrQnRuLm9uY2xpY2sgPSAoKSA9PiBvcGVuQnVsa0xpbmtNb2RhbCgpOwogICAgICAgICAgICBidWxrU2V0dGluZ1dyYXBwZXIuYXBwZW5kQ2hpbGQoYnVsa0J0bik7CiAgICAgICAgICAgIHZhcmlhbnRQcmljaW5nQ29udGFpbmVyLmFwcGVuZENoaWxkKGJ1bGtTZXR0aW5nV3JhcHBlcik7CiAgICAgICAgfQoKICAgICAgICB1cGRhdGVSZXF1aXJlZEZpZWxkcygpOwogICAgfQoKCiAgICAvLyAtLS0gTUFJTiBGT1JNIEFDVElPTlMsIFBST0RVQ1QgSEFORExJTkcgLS0tCiAgICBmdW5jdGlvbiBoYW5kbGVNYWluQWN0aW9uKCkgewogICAgICAgIGNsZWFyQWxsVmFsaWRhdGlvbkVycm9ycygpOwogICAgICAgIGNvbnN0IGVycm9ycyA9IHZhbGlkYXRlRm9ybSh0cnVlKTsKICAgICAgICBpZiAoZXJyb3JzLmxlbmd0aCA+IDApIHsgCiAgICAgICAgICAgIHNob3dNb2RhbCgiUGxlYXNlIGZpeCB0aGUgZXJyb3JzIGhpZ2hsaWdodGVkIG9uIHRoZSBmb3JtLiIsICJlcnJvciIpOyAKICAgICAgICAgICAgcmV0dXJuOyAKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgY29uc3QgZWRpdGluZ0luZGV4ID0gcGFyc2VJbnQoZWRpdGluZ0luZGV4SW5wdXQudmFsdWUsIDEwKTsKICAgICAgICBpZiAoZWRpdGluZ0luZGV4ID4gLTEpIHsKICAgICAgICAgICAgdXBkYXRlUHJvZHVjdChlZGl0aW5nSW5kZXgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFkZFByb2R1Y3QoKTsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiB2YWxpZGF0ZUZvcm0oc2hvd0lubGluZUVycm9ycyA9IGZhbHNlKSB7CiAgICAgICAgY29uc3QgZ2V0RWwgPSAoaWQpID0+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKICAgICAgICBjb25zdCBlbGVtZW50cyA9IHsKICAgICAgICAgICAgcHJvZHVjdE5hbWU6IGdldEVsKCJwcm9kdWN0TmFtZSIpLCB1b206IGdldEVsKCJ1b20iKSwgcHJlcExvY2F0aW9uOiBnZXRFbCgicHJlcExvY2F0aW9uIiksCiAgICAgICAgICAgIG1lbnVDYXRlZ29yeTogZ2V0RWwoIm1lbnVDYXRlZ29yeSIpLCBwcm9kdWN0VHlwZTogZ2V0RWwoInByb2R1Y3RUeXBlIiksIGludkNhdGVnb3J5OiBnZXRFbCgiaW52ZW50b3J5Q2F0ZWdvcnkiKSwKICAgICAgICAgICAgc3VwcGxpZWRRdWFudGl0eTogZ2V0RWwoInN1cHBsaWVkUXVhbnRpdHkiKSwgeWllbGRRdWFudGl0eTogZ2V0RWwoInlpZWxkUXVhbnRpdHkiKSwgY29zdFByaWNlOiBnZXRFbCgiY29zdFByaWNlIiksCiAgICAgICAgICAgIHNlbGxpbmdQcmljZTogZ2V0RWwoInNlbGxpbmdQcmljZSIpLCB0YXhBcHBsaWNhYmxlOiBnZXRFbCgidGF4QXBwbGljYWJsZSIpLCBiYXJjb2RlOiBnZXRFbCgiYmFyY29kZSIpLAogICAgICAgICAgICBjdXN0b21QbHU6IGdldEVsKCJjdXN0b21QbHUiKSwKICAgICAgICB9OwogICAgICAgIAogICAgICAgIGNvbnN0IHZhbHVlcyA9IHsKICAgICAgICAgICAgYmFzZVByb2R1Y3ROYW1lOiBlbGVtZW50cy5wcm9kdWN0TmFtZS52YWx1ZS50cmltKCksIHVvbTogZWxlbWVudHMudW9tLnZhbHVlLCBwcmVwOiBlbGVtZW50cy5wcmVwTG9jYXRpb24udmFsdWUudHJpbSgpLAogICAgICAgICAgICBtZW51OiBlbGVtZW50cy5tZW51Q2F0ZWdvcnkudmFsdWUudHJpbSgpLCBwcm9kdWN0VHlwZTogZWxlbWVudHMucHJvZHVjdFR5cGUudmFsdWUsIGludkNhdDogZWxlbWVudHMuaW52Q2F0ZWdvcnkudmFsdWUudHJpbSgpLAogICAgICAgICAgICBzdXBwbGllZFF1YW50aXR5OiBlbGVtZW50cy5zdXBwbGllZFF1YW50aXR5LnZhbHVlLnRyaW0oKSwgeWllbGRRdWFudGl0eTogZWxlbWVudHMueWllbGRRdWFudGl0eS52YWx1ZS50cmltKCksCiAgICAgICAgICAgIGRlZmF1bHRDb3N0OiBwYXJzZUZsb2F0KGVsZW1lbnRzLmNvc3RQcmljZS52YWx1ZSksIGRlZmF1bHRQcmljZTogcGFyc2VGbG9hdChlbGVtZW50cy5zZWxsaW5nUHJpY2UudmFsdWUpLAogICAgICAgICAgICB0YXhBcHBsaWNhYmxlOiBlbGVtZW50cy50YXhBcHBsaWNhYmxlLnZhbHVlLCBoYXNCYXJjb2RlOiBoYXNCYXJjb2RlU2VsZWN0LnZhbHVlLCBiYXJjb2RlOiBlbGVtZW50cy5iYXJjb2RlLnZhbHVlLnRyaW0oKSwKICAgICAgICAgICAgY3VzdG9tUGx1OiBlbGVtZW50cy5jdXN0b21QbHUudmFsdWUudHJpbSgpLAogICAgICAgIH07CgogICAgICAgIGNvbnN0IGVkaXRpbmdJbmRleCA9IHBhcnNlSW50KGVkaXRpbmdJbmRleElucHV0LnZhbHVlLCAxMCk7CiAgICAgICAgbGV0IGVycm9ycyA9IFtdOwogICAgICAgIGNvbnN0IGNoZWNrID0gKGNvbmRpdGlvbiwgZWxlbWVudCwgbWVzc2FnZSkgPT4gewogICAgICAgICAgICBpZiAoY29uZGl0aW9uKSB7CiAgICAgICAgICAgICAgICBlcnJvcnMucHVzaChtZXNzYWdlKTsKICAgICAgICAgICAgICAgIGlmIChzaG93SW5saW5lRXJyb3JzKSBzaG93VmFsaWRhdGlvbkVycm9yKGVsZW1lbnQsIG1lc3NhZ2UpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgY2hlY2sodmFsdWVzLmJhc2VQcm9kdWN0TmFtZSA9PT0gIiIsIGVsZW1lbnRzLnByb2R1Y3ROYW1lLCAiUHJvZHVjdCBOYW1lIGlzIHJlcXVpcmVkLiIpOwogICAgICAgIGNoZWNrKCF2YWx1ZXMudW9tLCBlbGVtZW50cy51b20sICJTZWxsaW5nIFVPTSBpcyByZXF1aXJlZC4iKTsKICAgICAgICBjaGVjayghdmFsdWVzLnByb2R1Y3RUeXBlLCBlbGVtZW50cy5wcm9kdWN0VHlwZSwgIlByb2R1Y3QgVHlwZSBpcyByZXF1aXJlZC4iKTsKICAgICAgICBjaGVjayghdmFsdWVzLnRheEFwcGxpY2FibGUsIGVsZW1lbnRzLnRheEFwcGxpY2FibGUsICJUYXggQXBwbGljYWJsZSBpcyByZXF1aXJlZC4iKTsKICAgICAgICAKICAgICAgICBpZiAodmFsdWVzLnByb2R1Y3RUeXBlID09PSAnZmluaXNoZWRHb29kJyB8fCB2YWx1ZXMucHJvZHVjdFR5cGUgPT09ICdmaW5pc2hlZEdvb2QgJiByYXdNYXRlcmlhbCcpIHsKICAgICAgICAgICAgY2hlY2sodmFsdWVzLnByZXAgPT09ICIiLCBlbGVtZW50cy5wcmVwTG9jYXRpb24sICJQcmVwYXJhdGlvbiBMb2NhdGlvbiBpcyByZXF1aXJlZC4iKTsKICAgICAgICAgICAgY2hlY2sodmFsdWVzLm1lbnUgPT09ICIiLCBlbGVtZW50cy5tZW51Q2F0ZWdvcnksICJNZW51IENhdGVnb3J5IGlzIHJlcXVpcmVkLiIpOwogICAgICAgIH0KICAgICAgICBpZiAodmFsdWVzLnByb2R1Y3RUeXBlID09PSAncmF3TWF0ZXJpYWwnIHx8IHZhbHVlcy5wcm9kdWN0VHlwZSA9PT0gJ2ZpbmlzaGVkR29vZCAmIHJhd01hdGVyaWFsJykgewogICAgICAgICAgICBjaGVjayh2YWx1ZXMuaW52Q2F0ID09PSAiIiwgZWxlbWVudHMuaW52Q2F0ZWdvcnksICJJbnZlbnRvcnkgQ2F0ZWdvcnkgaXMgcmVxdWlyZWQuIik7CiAgICAgICAgICAgIGNoZWNrKHZhbHVlcy5zdXBwbGllZFF1YW50aXR5ID09PSAiIiwgZWxlbWVudHMuc3VwcGxpZWRRdWFudGl0eSwgIlN1cHBsaWVkIFF1YW50aXR5IGlzIHJlcXVpcmVkLiIpOwogICAgICAgICAgICBjaGVjayhpc05hTih2YWx1ZXMuZGVmYXVsdENvc3QpLCBlbGVtZW50cy5jb3N0UHJpY2UsICJUb3RhbCBDb3N0IFByaWNlIGlzIHJlcXVpcmVkLiIpOwogICAgICAgIH0KICAgICAgICBpZiAodmFsdWVzLnByb2R1Y3RUeXBlID09PSAnTWFudWZhY3R1cmVkJykgewogICAgICAgICAgICAgY2hlY2sodmFsdWVzLmludkNhdCA9PT0gIiIsIGVsZW1lbnRzLmludkNhdGVnb3J5LCAiSW52ZW50b3J5IENhdGVnb3J5IGlzIHJlcXVpcmVkLiIpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoY3VycmVudFZhcmlhbnRHcm91cHMubGVuZ3RoID09PSAwICYmICh2YWx1ZXMucHJvZHVjdFR5cGUgPT09ICdmaW5pc2hlZEdvb2QnIHx8IHZhbHVlcy5wcm9kdWN0VHlwZSA9PT0gJ2ZpbmlzaGVkR29vZCAmIHJhd01hdGVyaWFsJykpIHsKICAgICAgICAgICAgY2hlY2soaXNOYU4odmFsdWVzLmRlZmF1bHRQcmljZSksIGVsZW1lbnRzLnNlbGxpbmdQcmljZSwgIkEgRGVmYXVsdCBTZWxsaW5nIFByaWNlIGlzIHJlcXVpcmVkIGlmIG5vIHZhcmlhbnRzIGFyZSBhZGRlZC4iKTsKICAgICAgICB9CgogICAgICAgIGNoZWNrKHZhbHVlcy5oYXNCYXJjb2RlID09PSAneWVzJyAmJiB2YWx1ZXMuYmFyY29kZSA9PT0gIiIsIGVsZW1lbnRzLmJhcmNvZGUsICJCYXJjb2RlIGlzIHJlcXVpcmVkLiIpOwogICAgICAgIGNoZWNrKHNlc3Npb25EZWZpbmVQbHUgPT09ICd5ZXMnICYmIHZhbHVlcy5jdXN0b21QbHUgPT09ICIiLCBlbGVtZW50cy5jdXN0b21QbHUsICJDdXN0b20gQmFzZSBQTFUvU0tVIGlzIHJlcXVpcmVkLiIpOwogICAgICAgIAogICAgICAgIGNvbnN0IGVkaXRpbmdHcm91cElkID0gZWRpdGluZ0luZGV4ID4gLTEgPyBwcm9kdWN0c1tlZGl0aW5nSW5kZXhdLnByb2R1Y3RHcm91cElkIDogbnVsbDsKICAgICAgICBjb25zdCBwbHVFeGlzdHMgPSBwcm9kdWN0cy5zb21lKHAgPT4gcC5wcm9kdWN0R3JvdXBJZCA9PT0gdmFsdWVzLmN1c3RvbVBsdSAmJiBwLnByb2R1Y3RHcm91cElkICE9PSBlZGl0aW5nR3JvdXBJZCk7CiAgICAgICAgY2hlY2soc2Vzc2lvbkRlZmluZVBsdSA9PT0gJ3llcycgJiYgcGx1RXhpc3RzLCBlbGVtZW50cy5jdXN0b21QbHUsIGBCYXNlIFBMVS9TS1UgIiR7dmFsdWVzLmN1c3RvbVBsdX0iIGFscmVhZHkgZXhpc3RzLmApOwoKICAgICAgICBjb25zdCBpc0R1cGxpY2F0ZSA9IHByb2R1Y3RzLnNvbWUocCA9PiBwLl9zb3VyY2UgJiYgcC5wcm9kdWN0R3JvdXBJZCAhPT0gZWRpdGluZ0dyb3VwSWQgJiYKICAgICAgICAgICAgcC5fc291cmNlLnByb2R1Y3ROYW1lLnRvTG93ZXJDYXNlKCkgPT09IHZhbHVlcy5iYXNlUHJvZHVjdE5hbWUudG9Mb3dlckNhc2UoKSAmJgogICAgICAgICAgICBwLl9zb3VyY2UucHJvZHVjdFR5cGUgPT09IHZhbHVlcy5wcm9kdWN0VHlwZSk7CiAgICAgICAgY2hlY2soaXNEdXBsaWNhdGUsIGVsZW1lbnRzLnByb2R1Y3ROYW1lLCBgQSBwcm9kdWN0IG5hbWVkICIke3ZhbHVlcy5iYXNlUHJvZHVjdE5hbWV9IiB3aXRoIHR5cGUgIiR7dmFsdWVzLnByb2R1Y3RUeXBlfSIgYWxyZWFkeSBleGlzdHMuYCk7CiAgICAgICAgICAgIAogICAgICAgIHJldHVybiBlcnJvcnM7CiAgICB9CgogICAgZnVuY3Rpb24gZ2F0aGVyUHJvZHVjdERhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcHJvZHVjdE5hbWU6IHNhbml0aXplSW5wdXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInByb2R1Y3ROYW1lIikudmFsdWUudHJpbSgpKSwKICAgICAgICAgICAgdGF4QXBwbGljYWJsZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRheEFwcGxpY2FibGUiKS52YWx1ZSwKICAgICAgICAgICAgcHJvZHVjdFR5cGU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcm9kdWN0VHlwZSIpLnZhbHVlLAogICAgICAgICAgICB1b206IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ1b20iKS52YWx1ZSwKICAgICAgICAgICAgcHJlcExvY2F0aW9uOiBzYW5pdGl6ZUlucHV0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcmVwTG9jYXRpb24iKS52YWx1ZS50cmltKCkpLAogICAgICAgICAgICBtZW51Q2F0ZWdvcnk6IHNhbml0aXplSW5wdXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1lbnVDYXRlZ29yeSIpLnZhbHVlLnRyaW0oKSksCiAgICAgICAgICAgIGludkNhdGVnb3J5OiBzYW5pdGl6ZUlucHV0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnZlbnRvcnlDYXRlZ29yeSIpLnZhbHVlLnRyaW0oKSksCiAgICAgICAgICAgIGludlN1YkNhdGVnb3J5OiBzYW5pdGl6ZUlucHV0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnZlbnRvcnlTdWJDYXRlZ29yeSIpLnZhbHVlLnRyaW0oKSksCiAgICAgICAgICAgIHN1cHBsaWVkUXVhbnRpdHk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdXBwbGllZFF1YW50aXR5IikudmFsdWUudHJpbSgpLAogICAgICAgICAgICB5aWVsZFF1YW50aXR5OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgieWllbGRRdWFudGl0eSIpLnZhbHVlLnRyaW0oKSwKICAgICAgICAgICAgZGVmYXVsdENvc3Q6IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvc3RQcmljZSIpLnZhbHVlKSB8fCAwLAogICAgICAgICAgICBkZWZhdWx0UHJpY2U6IHBhcnNlRmxvYXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInNlbGxpbmdQcmljZSIpLnZhbHVlKSB8fCAwLAogICAgICAgICAgICBoYXNCYXJjb2RlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGFzQmFyY29kZSIpLnZhbHVlLAogICAgICAgICAgICBiYXJjb2RlOiBzYW5pdGl6ZUlucHV0KChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGFzQmFyY29kZSIpLnZhbHVlID09PSAneWVzJykgPyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYmFyY29kZSIpLnZhbHVlLnRyaW0oKSA6ICIiKSwKICAgICAgICAgICAgY3VzdG9tUGx1OiBzYW5pdGl6ZUlucHV0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjdXN0b21QbHUiKS52YWx1ZS50cmltKCkpLAogICAgICAgICAgICBpc1B1cmNoYXNlZEZvclJlc2FsZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImlzUHVyY2hhc2VkRm9yUmVzYWxlIikuY2hlY2tlZCwKICAgICAgICAgICAgdmFyaWFudEdyb3VwczogSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjdXJyZW50VmFyaWFudEdyb3VwcykpLAogICAgICAgICAgICB2YXJpYW50UHJpY2luZzogSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjdXJyZW50VmFyaWFudFByaWNpbmcpKSwKICAgICAgICAgICAgbW9kaWZpZXJHcm91cHM6IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY3VycmVudE1vZGlmaWVyR3JvdXBzKSksCiAgICAgICAgICAgIG1vZGlmaWVyTGlua3M6IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY3VycmVudE1vZGlmaWVyTGlua3MpKQogICAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gYWRkUHJvZHVjdCgpIHsKICAgICAgICBpZiAoIWRlZmF1bHRzU2V0KSB7IHNob3dNb2RhbCgiUGxlYXNlIHNldCBTZXNzaW9uIERlZmF1bHRzIGZpcnN0LiIsICJlcnJvciIpOyByZXR1cm47IH0KICAgICAgICAKICAgICAgICBjb25zdCBkYXRhID0gZ2F0aGVyUHJvZHVjdERhdGEoKTsKICAgICAgICBjb25zdCBoYXNaZXJvUHJpY2VWYXJpYW50ID0gZGF0YS52YXJpYW50UHJpY2luZy5sZW5ndGggPiAwICYmIGRhdGEudmFyaWFudFByaWNpbmcuc29tZSh2ID0+IChwYXJzZUZsb2F0KHYuc2VsbGluZ1ByaWNlKSB8fCAwKSA9PT0gMCk7CiAgICAgICAgaWYgKGhhc1plcm9QcmljZVZhcmlhbnQpIHsKICAgICAgICAgICAgc2hvd01vZGFsKCdTb21lIHZhcmlhbnRzIGhhdmUgUjAuMDAgcHJpY2UuIENvbnRpbnVlPycsICd3YXJuaW5nJywgKCkgPT4gY3JlYXRlQW5kQWRkUHJvZHVjdHMoZGF0YSksIHRydWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNyZWF0ZUFuZEFkZFByb2R1Y3RzKGRhdGEpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBjcmVhdGVBbmRBZGRQcm9kdWN0cyhkYXRhLCBleGlzdGluZ0dyb3VwSWQgPSBudWxsLCBpc0JhdGNoID0gZmFsc2UpIHsKICAgICAgICBpZiAocmVtZW1iZXJDYXRlZ29yaWVzQ2hlY2tlZCAmJiAhaXNCYXRjaCkgewogICAgICAgICAgICBsYXN0VXNlZENhdGVnb3JpZXMucHJlcCA9IGRhdGEucHJlcExvY2F0aW9uOwogICAgICAgICAgICBsYXN0VXNlZENhdGVnb3JpZXMubWVudSA9IGRhdGEubWVudUNhdGVnb3J5OwogICAgICAgICAgICBsYXN0VXNlZENhdGVnb3JpZXMuaW52ID0gZGF0YS5pbnZDYXRlZ29yeTsKICAgICAgICAgICAgbGFzdFVzZWRDYXRlZ29yaWVzLnN1YkludiA9IGRhdGEuaW52U3ViQ2F0ZWdvcnk7CiAgICAgICAgICAgIGxhc3RVc2VkQ2F0ZWdvcmllcy51b20gPSBkYXRhLnVvbTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGlzRmluaXNoZWRBbmRSYXcgPSBkYXRhLnByb2R1Y3RUeXBlID09PSAnZmluaXNoZWRHb29kICYgcmF3TWF0ZXJpYWwnOwogICAgICAgIGNvbnN0IG5ld1Byb2R1Y3RTdGFydEluZGV4ID0gcHJvZHVjdHMubGVuZ3RoOwoKICAgICAgICBpZiAoaXNGaW5pc2hlZEFuZFJhdykgewogICAgICAgICAgICBjb25zdCBncm91cElkID0gZXhpc3RpbmdHcm91cElkIHx8IChzZXNzaW9uRGVmaW5lUGx1ID09PSAneWVzJyAmJiBkYXRhLmN1c3RvbVBsdSA/IGRhdGEuY3VzdG9tUGx1IDogKytwbHVDb3VudGVyKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChkYXRhLmlzUHVyY2hhc2VkRm9yUmVzYWxlKSB7CiAgICAgICAgICAgICAgICBjb25zdCB1bml0Q29zdCA9IChkYXRhLmRlZmF1bHRDb3N0ICYmIGRhdGEuc3VwcGxpZWRRdWFudGl0eSA+IDApID8gZGF0YS5kZWZhdWx0Q29zdCAvIGRhdGEuc3VwcGxpZWRRdWFudGl0eSA6IDA7CiAgICAgICAgICAgICAgICBjb25zdCBjb21iaW5hdGlvbnNUb1Byb2Nlc3MgPSBkYXRhLnZhcmlhbnRQcmljaW5nLmxlbmd0aCA+IDAgPyBkYXRhLnZhcmlhbnRQcmljaW5nIDogW3sgY29tYmluYXRpb246ICcnLCBzZWxsaW5nUHJpY2U6IGRhdGEuZGVmYXVsdFByaWNlIH1dOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb21iaW5hdGlvbnNUb1Byb2Nlc3MuZm9yRWFjaCgoY29tYm8sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmluYWxOYW1lID0gY29tYm8uY29tYmluYXRpb24gPyBgJHtkYXRhLnByb2R1Y3ROYW1lfSAtICR7Y29tYm8uY29tYmluYXRpb259YCA6IGRhdGEucHJvZHVjdE5hbWU7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmluYWxQcmljZSA9IHBhcnNlRmxvYXQoY29tYm8uc2VsbGluZ1ByaWNlKSB8fCAwOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGdwID0gKGZpbmFsUHJpY2UgPiAwICYmIHVuaXRDb3N0ID4gMCkgPyAoKGZpbmFsUHJpY2UgLSB1bml0Q29zdCkgLyBmaW5hbFByaWNlKSAqIDEwMCA6IDA7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvZHVjdFBsdSA9IChjb21iaW5hdGlvbnNUb1Byb2Nlc3MubGVuZ3RoID4gMSkgPyBgUExVLSR7Z3JvdXBJZH0tJHtpbmRleCArIDF9YCA6IGBQTFUtJHtncm91cElkfWA7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlua2VkTW9kaWZpZXJHcm91cE5hbWVzID0gZGF0YS5tb2RpZmllckxpbmtzW2NvbWJvLmNvbWJpbmF0aW9uIHx8ICcnXSB8fCBbXTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBtb2RpZmllclN0cmluZyA9IGN1cnJlbnRNb2RpZmllckdyb3VwcwogICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGdyb3VwID0+IGxpbmtlZE1vZGlmaWVyR3JvdXBOYW1lcy5pbmNsdWRlcyhncm91cC5ncm91cE5hbWUpKQogICAgICAgICAgICAgICAgICAgICAgICAuZmxhdE1hcChncm91cCA9PiBncm91cC5vcHRpb25zLm1hcChvcHQgPT4gYCR7Z3JvdXAuZ3JvdXBOYW1lfTogJHtvcHQubmFtZX0gKCR7KG9wdC5wcmljZSB8fCAwKS50b0ZpeGVkKDIpfSlgKSkKICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oJywgJyk7CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IGh5YnJpZFByb2R1Y3QgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3RHcm91cElkOiBncm91cElkLCBwbHVCYXNlOiBgUExVLSR7Z3JvdXBJZH1gLCBfc291cmNlOiBkYXRhLAogICAgICAgICAgICAgICAgICAgICAgICAiUHJvZHVjdCBQTFUiOiBwcm9kdWN0UGx1LCAiUHJvZHVjdCBOYW1lICYgVmFyaWFudCI6IGZpbmFsTmFtZSwgIkJhc2UgTmFtZSI6IGRhdGEucHJvZHVjdE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYW50IE5hbWUiOiBjb21iby5jb21iaW5hdGlvbiB8fCAnJywgIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSI6ICJmaW5pc2hlZEdvb2QiLCAiU2l0ZSI6IHNlc3Npb25TaXRlLAogICAgICAgICAgICAgICAgICAgICAgICAiR1AiOiBncCwgIlNlbGxpbmcgVU9NIjogZGF0YS51b20sICJQcmVwYXJhdGlvbiBMb2NhdGlvbiI6IGRhdGEucHJlcExvY2F0aW9uLCAiTWVudSBDYXRlZ29yeSI6IGRhdGEubWVudUNhdGVnb3J5LAogICAgICAgICAgICAgICAgICAgICAgICAiSW52ZW50b3J5IENhdGVnb3J5IjogZGF0YS5pbnZDYXRlZ29yeSwgIkludmVudG9yeSBTdWItQ2F0ZWdvcnkiOiBkYXRhLmludlN1YkNhdGVnb3J5LAogICAgICAgICAgICAgICAgICAgICAgICAiUHJvZHVjdCBUeXBlIjogJ3NpbmdsZScsICJTdXBwbGllZCBRdWFudGl0eSI6IGRhdGEuc3VwcGxpZWRRdWFudGl0eSwgIk1hbnVmYWN0dXJlZCBZaWVsZCI6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAiRW5hYmxlZCI6IHRydWUsICJDb3N0IFByaWNlIjogdW5pdENvc3QsICJTZWxsaW5nIFByaWNlIjogZmluYWxQcmljZSwKICAgICAgICAgICAgICAgICAgICAgICAgIlRheCBBcHBsaWNhYmxlIjogZGF0YS50YXhBcHBsaWNhYmxlID09PSAndHJ1ZScsICJNb2RpZmllciI6IG1vZGlmaWVyU3RyaW5nLCAiQmFyY29kZSI6IGRhdGEuYmFyY29kZQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHMucHVzaChoeWJyaWRQcm9kdWN0KTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJhd1BsdUJhc2UgPSBgUkFXLSR7Z3JvdXBJZH1gOwogICAgICAgICAgICAgICAgY29uc3QgcmF3TmFtZSA9IGAoUkFXKSAke2RhdGEucHJvZHVjdE5hbWV9YDsKICAgICAgICAgICAgICAgIGNvbnN0IHJhd1Byb2R1Y3QgPSB7CiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdEdyb3VwSWQ6IGdyb3VwSWQsIHBsdUJhc2U6IHJhd1BsdUJhc2UsIF9zb3VyY2U6IGRhdGEsCiAgICAgICAgICAgICAgICAgICAgIlByb2R1Y3QgUExVIjogcmF3UGx1QmFzZSwgIlByb2R1Y3QgTmFtZSAmIFZhcmlhbnQiOiByYXdOYW1lLCAiQmFzZSBOYW1lIjogcmF3TmFtZSwKICAgICAgICAgICAgICAgICAgICAiVmFyaWFudCBOYW1lIjogJycsICJPcmlnaW5hbCBQcm9kdWN0IFR5cGUiOiAncmF3TWF0ZXJpYWwnLCAiU2l0ZSI6IHNlc3Npb25TaXRlLCAiR1AiOiAwLCAKICAgICAgICAgICAgICAgICAgICAiU2VsbGluZyBVT00iOiBkYXRhLnVvbSwgIlByZXBhcmF0aW9uIExvY2F0aW9uIjogJycsICJNZW51IENhdGVnb3J5IjogJycsCiAgICAgICAgICAgICAgICAgICAgIkludmVudG9yeSBDYXRlZ29yeSI6IGRhdGEuaW52Q2F0ZWdvcnksICJJbnZlbnRvcnkgU3ViLUNhdGVnb3J5IjogZGF0YS5pbnZTdWJDYXRlZ29yeSwKICAgICAgICAgICAgICAgICAgICAiUHJvZHVjdCBUeXBlIjogJ3NpbmdsZScsICJTdXBwbGllZCBRdWFudGl0eSI6IGRhdGEuc3VwcGxpZWRRdWFudGl0eSwgIk1hbnVmYWN0dXJlZCBZaWVsZCI6ICcnLAogICAgICAgICAgICAgICAgICAgICJFbmFibGVkIjogdHJ1ZSwgIkNvc3QgUHJpY2UiOiBkYXRhLmRlZmF1bHRDb3N0LCAiU2VsbGluZyBQcmljZSI6IDAsICJUYXggQXBwbGljYWJsZSI6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICJNb2RpZmllciI6ICcnLCAiQmFyY29kZSI6ICcnCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgcHJvZHVjdHMucHVzaChyYXdQcm9kdWN0KTsKCiAgICAgICAgICAgICAgICBjb25zdCBmaW5pc2hlZFBsdUJhc2UgPSBgUExVLSR7Z3JvdXBJZH1gOwogICAgICAgICAgICAgICAgY29uc3QgY29tYmluYXRpb25zVG9Qcm9jZXNzID0gZGF0YS52YXJpYW50UHJpY2luZy5sZW5ndGggPiAwID8gZGF0YS52YXJpYW50UHJpY2luZyA6IFt7IGNvbWJpbmF0aW9uOiAnJywgc2VsbGluZ1ByaWNlOiBkYXRhLmRlZmF1bHRQcmljZSB9XTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29tYmluYXRpb25zVG9Qcm9jZXNzLmZvckVhY2goKGNvbWJvLCBpbmRleCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbmFsTmFtZSA9IGNvbWJvLmNvbWJpbmF0aW9uID8gYCR7ZGF0YS5wcm9kdWN0TmFtZX0gLSAke2NvbWJvLmNvbWJpbmF0aW9ufWAgOiBkYXRhLnByb2R1Y3ROYW1lOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbmFsUHJpY2UgPSBwYXJzZUZsb2F0KGNvbWJvLnNlbGxpbmdQcmljZSkgfHwgMDsKICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9kdWN0UGx1ID0gKGNvbWJpbmF0aW9uc1RvUHJvY2Vzcy5sZW5ndGggPiAxKSA/IGAke2ZpbmlzaGVkUGx1QmFzZX0tJHtpbmRleCArIDF9YCA6IGZpbmlzaGVkUGx1QmFzZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5rZWRNb2RpZmllckdyb3VwTmFtZXMgPSBkYXRhLm1vZGlmaWVyTGlua3NbY29tYm8uY29tYmluYXRpb24gfHwgJyddIHx8IFtdOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGlmaWVyU3RyaW5nID0gY3VycmVudE1vZGlmaWVyR3JvdXBzCiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZ3JvdXAgPT4gbGlua2VkTW9kaWZpZXJHcm91cE5hbWVzLmluY2x1ZGVzKGdyb3VwLmdyb3VwTmFtZSkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5mbGF0TWFwKGdyb3VwID0+IGdyb3VwLm9wdGlvbnMubWFwKG9wdCA9PiBgJHtncm91cC5ncm91cE5hbWV9OiAke29wdC5uYW1lfSAoJHsob3B0LnByaWNlIHx8IDApLnRvRml4ZWQoMil9KWApKQogICAgICAgICAgICAgICAgICAgICAgICAuam9pbignLCAnKTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmluaXNoZWRQcm9kdWN0ID0gewogICAgICAgICAgICAgICAgICAgICAgICBwcm9kdWN0R3JvdXBJZDogZ3JvdXBJZCwgcGx1QmFzZTogZmluaXNoZWRQbHVCYXNlLCBfc291cmNlOiBkYXRhLAogICAgICAgICAgICAgICAgICAgICAgICAiUHJvZHVjdCBQTFUiOiBwcm9kdWN0UGx1LCAiUHJvZHVjdCBOYW1lICYgVmFyaWFudCI6IGZpbmFsTmFtZSwgIkJhc2UgTmFtZSI6IGRhdGEucHJvZHVjdE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICJWYXJpYW50IE5hbWUiOiBjb21iby5jb21iaW5hdGlvbiB8fCAnJywgIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSI6ICdmaW5pc2hlZEdvb2QnLCAiU2l0ZSI6IHNlc3Npb25TaXRlLAogICAgICAgICAgICAgICAgICAgICAgICAiR1AiOiAxMDAsICJTZWxsaW5nIFVPTSI6ICJlYSIsICJQcmVwYXJhdGlvbiBMb2NhdGlvbiI6IGRhdGEucHJlcExvY2F0aW9uLCAiTWVudSBDYXRlZ29yeSI6IGRhdGEubWVudUNhdGVnb3J5LAogICAgICAgICAgICAgICAgICAgICAgICAiSW52ZW50b3J5IENhdGVnb3J5IjogJycsICJJbnZlbnRvcnkgU3ViLUNhdGVnb3J5IjogJycsICJQcm9kdWN0IFR5cGUiOiAnc2luZ2xlJywgIlN1cHBsaWVkIFF1YW50aXR5IjogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICJNYW51ZmFjdHVyZWQgWWllbGQiOiAnJywgIkVuYWJsZWQiOiB0cnVlLCAiQ29zdCBQcmljZSI6IDAsICJTZWxsaW5nIFByaWNlIjogZmluYWxQcmljZSwKICAgICAgICAgICAgICAgICAgICAgICAgIlRheCBBcHBsaWNhYmxlIjogZGF0YS50YXhBcHBsaWNhYmxlID09PSAndHJ1ZScsICJNb2RpZmllciI6IG1vZGlmaWVyU3RyaW5nLCAiQmFyY29kZSI6IGRhdGEuYmFyY29kZQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHMucHVzaChmaW5pc2hlZFByb2R1Y3QpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3QgZ3JvdXBJZCA9IGV4aXN0aW5nR3JvdXBJZCB8fCAoc2Vzc2lvbkRlZmluZVBsdSA9PT0gJ3llcycgJiYgZGF0YS5jdXN0b21QbHUgPyBkYXRhLmN1c3RvbVBsdSA6ICsrcGx1Q291bnRlcik7CiAgICAgICAgICAgIGNvbnN0IHBsdUJhc2UgPSBgUExVLSR7Z3JvdXBJZH1gOwogICAgICAgICAgICBjb25zdCBjb21iaW5hdGlvbnNUb1Byb2Nlc3MgPSBkYXRhLnZhcmlhbnRQcmljaW5nLmxlbmd0aCA+IDAgCiAgICAgICAgICAgICAgICA/IGRhdGEudmFyaWFudFByaWNpbmcgCiAgICAgICAgICAgICAgICA6IFt7IGNvbWJpbmF0aW9uOiAnJywgc2VsbGluZ1ByaWNlOiBkYXRhLmRlZmF1bHRQcmljZSwgY29zdFByaWNlOiBkYXRhLmRlZmF1bHRDb3N0IH1dOwogICAgICAgICAgICAKICAgICAgICAgICAgY29tYmluYXRpb25zVG9Qcm9jZXNzLmZvckVhY2goKGNvbWJvLCBpbmRleCkgPT4gewogICAgICAgICAgICAgICAgbGV0IHByZWZpeGVkQmFzZU5hbWUgPSBkYXRhLnByb2R1Y3ROYW1lOwogICAgICAgICAgICAgICAgaWYgKGRhdGEucHJvZHVjdFR5cGUgPT09ICJyYXdNYXRlcmlhbCIpIHByZWZpeGVkQmFzZU5hbWUgPSAiKFJBVykgIiArIGRhdGEucHJvZHVjdE5hbWU7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChkYXRhLnByb2R1Y3RUeXBlID09PSAiTWFudWZhY3R1cmVkIikgcHJlZml4ZWRCYXNlTmFtZSA9ICIoTUFOKSAiICsgZGF0YS5wcm9kdWN0TmFtZTsKCiAgICAgICAgICAgICAgICBjb25zdCBmaW5hbE5hbWUgPSAoY29tYm8uY29tYmluYXRpb24pID8gYCR7cHJlZml4ZWRCYXNlTmFtZX0gLSAke2NvbWJvLmNvbWJpbmF0aW9ufWAgOiBwcmVmaXhlZEJhc2VOYW1lOwogICAgICAgICAgICAgICAgY29uc3QgZmluYWxQcmljZSA9IHBhcnNlRmxvYXQoY29tYm8uc2VsbGluZ1ByaWNlKSB8fCAwOwogICAgICAgICAgICAgICAgY29uc3QgZmluYWxDb3N0ID0gcGFyc2VGbG9hdChjb21iby5jb3N0UHJpY2UpIHx8IDA7CiAgICAgICAgICAgICAgICBjb25zdCBncCA9IChmaW5hbFByaWNlID4gMCAmJiBmaW5hbENvc3QgPiAwKSA/ICgoZmluYWxQcmljZSAtIGZpbmFsQ29zdCkgLyBmaW5hbFByaWNlKSAqIDEwMCA6IDA7CiAgICAgICAgICAgICAgICBjb25zdCBwcm9kdWN0UGx1ID0gKGNvbWJpbmF0aW9uc1RvUHJvY2Vzcy5sZW5ndGggPiAxKSA/IGAke3BsdUJhc2V9LSR7aW5kZXggKyAxfWAgOiBwbHVCYXNlOwoKICAgICAgICAgICAgICAgIGNvbnN0IGxpbmtlZE1vZGlmaWVyR3JvdXBOYW1lcyA9IGRhdGEubW9kaWZpZXJMaW5rc1tjb21iby5jb21iaW5hdGlvbiB8fCAnJ10gfHwgW107CiAgICAgICAgICAgICAgICBjb25zdCBtb2RpZmllclN0cmluZyA9IGN1cnJlbnRNb2RpZmllckdyb3VwcwogICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZ3JvdXAgPT4gbGlua2VkTW9kaWZpZXJHcm91cE5hbWVzLmluY2x1ZGVzKGdyb3VwLmdyb3VwTmFtZSkpCiAgICAgICAgICAgICAgICAgICAgLmZsYXRNYXAoZ3JvdXAgPT4gZ3JvdXAub3B0aW9ucy5tYXAob3B0ID0+IGAke2dyb3VwLmdyb3VwTmFtZX06ICR7b3B0Lm5hbWV9ICgkeyhvcHQucHJpY2UgfHwgMCkudG9GaXhlZCgyKX0pYCkpCiAgICAgICAgICAgICAgICAgICAgLmpvaW4oJywgJyk7CgogICAgICAgICAgICAgICAgY29uc3QgcHJvZHVjdCA9IHsKICAgICAgICAgICAgICAgICAgICBwcm9kdWN0R3JvdXBJZDogZ3JvdXBJZCwgcGx1QmFzZTogcGx1QmFzZSwgX3NvdXJjZTogZGF0YSwKICAgICAgICAgICAgICAgICAgICAiUHJvZHVjdCBQTFUiOiBwcm9kdWN0UGx1LCAiUHJvZHVjdCBOYW1lICYgVmFyaWFudCI6IGZpbmFsTmFtZSwgIkJhc2UgTmFtZSI6IHByZWZpeGVkQmFzZU5hbWUsCiAgICAgICAgICAgICAgICAgICAgIlZhcmlhbnQgTmFtZSI6IGNvbWJvLmNvbWJpbmF0aW9uIHx8ICcnLCAiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIjogZGF0YS5wcm9kdWN0VHlwZSwgIlNpdGUiOiBzZXNzaW9uU2l0ZSwKICAgICAgICAgICAgICAgICAgICAiR1AiOiBncCwgIlNlbGxpbmcgVU9NIjogZGF0YS51b20sICJQcmVwYXJhdGlvbiBMb2NhdGlvbiI6IGRhdGEucHJlcExvY2F0aW9uLCAiTWVudSBDYXRlZ29yeSI6IGRhdGEubWVudUNhdGVnb3J5LAogICAgICAgICAgICAgICAgICAgICJJbnZlbnRvcnkgQ2F0ZWdvcnkiOiBkYXRhLmludkNhdGVnb3J5LCAiSW52ZW50b3J5IFN1Yi1DYXRlZ29yeSI6IGRhdGEuaW52U3ViQ2F0ZWdvcnksCiAgICAgICAgICAgICAgICAgICAgIlByb2R1Y3QgVHlwZSI6IGRhdGEucHJvZHVjdFR5cGUgPT09ICdNYW51ZmFjdHVyZWQnID8gJ3ByZXBhcmF0aW9uJyA6ICdzaW5nbGUnLAogICAgICAgICAgICAgICAgICAgICJTdXBwbGllZCBRdWFudGl0eSI6IChkYXRhLnByb2R1Y3RUeXBlID09PSAncmF3TWF0ZXJpYWwnKSA/IGRhdGEuc3VwcGxpZWRRdWFudGl0eSA6ICcnLAogICAgICAgICAgICAgICAgICAgICJNYW51ZmFjdHVyZWQgWWllbGQiOiAoZGF0YS5wcm9kdWN0VHlwZSA9PT0gJ01hbnVmYWN0dXJlZCcpID8gZGF0YS55aWVsZFF1YW50aXR5IDogJycsCiAgICAgICAgICAgICAgICAgICAgIkVuYWJsZWQiOiB0cnVlLCAiQ29zdCBQcmljZSI6IGZpbmFsQ29zdCwgIlNlbGxpbmcgUHJpY2UiOiBmaW5hbFByaWNlLAogICAgICAgICAgICAgICAgICAgICJUYXggQXBwbGljYWJsZSI6IGRhdGEudGF4QXBwbGljYWJsZSA9PT0gJ3RydWUnLAogICAgICAgICAgICAgICAgICAgICJNb2RpZmllciI6IG1vZGlmaWVyU3RyaW5nLCAiQmFyY29kZSI6IGRhdGEuYmFyY29kZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHByb2R1Y3RzLnB1c2gocHJvZHVjdCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFpc0JhdGNoKSB7CiAgICAgICAgICAgIHNhdmVTdGF0ZSgpOwogICAgICAgICAgICB1cGRhdGVUYWJsZShuZXdQcm9kdWN0U3RhcnRJbmRleCk7CiAgICAgICAgICAgIGFkZFRvRGF0YWxpc3QoInByZXBMaXN0IiwgZGF0YS5wcmVwTG9jYXRpb24pOyAKICAgICAgICAgICAgYWRkVG9EYXRhbGlzdCgibWVudUxpc3QiLCBkYXRhLm1lbnVDYXRlZ29yeSk7CiAgICAgICAgICAgIGFkZFRvRGF0YWxpc3QoImludmVudG9yeUNhdGVnb3J5TGlzdCIsIGRhdGEuaW52Q2F0ZWdvcnkpOyAKICAgICAgICAgICAgYWRkVG9EYXRhbGlzdCgiaW52ZW50b3J5U3ViQ2F0ZWdvcnlMaXN0IiwgZGF0YS5pbnZTdWJDYXRlZ29yeSk7CiAgICAgICAgICAgIHJlc2V0Rm9ybSgpOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicHJvZHVjdE5hbWUiKS5mb2N1cygpOwogICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oeyB0b3A6IDAsIGJlaGF2aW9yOiAnc21vb3RoJyB9KTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlUHJvZHVjdChpbmRleCkgewogICAgICAgIGNvbnN0IGRhdGEgPSBnYXRoZXJQcm9kdWN0RGF0YSgpOwogICAgICAgIGNvbnN0IG9yaWdpbmFsUHJvZHVjdCA9IHByb2R1Y3RzW2luZGV4XTsKICAgICAgICBjb25zdCBncm91cElkVG9VcGRhdGUgPSBvcmlnaW5hbFByb2R1Y3QucHJvZHVjdEdyb3VwSWQ7CgogICAgICAgIGlmICghZ3JvdXBJZFRvVXBkYXRlKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgnQ2Fubm90IGVkaXQgdGhpcyBsZWdhY3kgcHJvZHVjdC4gUGxlYXNlIHJlbW92ZSBhbmQgcmUtYWRkIGl0LicsICdlcnJvcicpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBwcm9kdWN0cyA9IHByb2R1Y3RzLmZpbHRlcihwID0+IHAucHJvZHVjdEdyb3VwSWQgIT09IGdyb3VwSWRUb1VwZGF0ZSk7CiAgICAgICAgY3JlYXRlQW5kQWRkUHJvZHVjdHMoZGF0YSwgZ3JvdXBJZFRvVXBkYXRlKTsKICAgICAgICByZXNldEZvcm0oKTsKICAgICAgICBzaG93TW9kYWwoJ1Byb2R1Y3QgdXBkYXRlZCBzdWNjZXNzZnVsbHkhJywgJ3dhcm5pbmcnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBlZGl0UHJvZHVjdChpbmRleCkgewogICAgICAgIGNvbnN0IHByb2R1Y3QgPSBwcm9kdWN0c1tpbmRleF07CiAgICAgICAgaWYgKCFwcm9kdWN0IHx8ICFwcm9kdWN0Ll9zb3VyY2UgfHwgIXByb2R1Y3QucHJvZHVjdEdyb3VwSWQpIHsKICAgICAgICAgICAgc2hvd01vZGFsKCdUaGlzIHByb2R1Y3Qgd2FzIGNyZWF0ZWQgd2l0aCBhbiBvbGRlciB2ZXJzaW9uIGFuZCBjYW5ub3QgYmUgc2FmZWx5IGVkaXRlZC4gUGxlYXNlIHJlbW92ZSBhbmQgcmUtYWRkIGl0LicsICdlcnJvcicpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNvbnN0IHJlbGF0ZWRQcm9kdWN0cyA9IHByb2R1Y3RzLmZpbHRlcihwID0+IHAucHJvZHVjdEdyb3VwSWQgPT09IHByb2R1Y3QucHJvZHVjdEdyb3VwSWQpOwogICAgICAgIGlmIChyZWxhdGVkUHJvZHVjdHMubGVuZ3RoID4gMSkgewogICAgICAgICAgICBjb25zdCBvdGhlclZhcmlhbnRzID0gcmVsYXRlZFByb2R1Y3RzLmxlbmd0aCAtIDE7CiAgICAgICAgICAgIGxldCBtZXNzYWdlID0gYFRoaXMgcHJvZHVjdCBoYXMgJHtvdGhlclZhcmlhbnRzfSBvdGhlciByZWxhdGVkIGNvbXBvbmVudChzKS92YXJpYW50KHMpLiBFZGl0aW5nIGl0IHdpbGwgYWZmZWN0IGFsbCBvZiB0aGVtLiBDb250aW51ZT9gOwogICAgICAgICAgICBzaG93TW9kYWwobWVzc2FnZSwgJ3dhcm5pbmcnLCAoKSA9PiBwcm9jZWVkV2l0aEVkaXQocHJvZHVjdCwgaW5kZXgpLCB0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwcm9jZWVkV2l0aEVkaXQocHJvZHVjdCwgaW5kZXgpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBwcm9jZWVkV2l0aEVkaXQocHJvZHVjdCwgaW5kZXgpIHsKICAgICAgICBjb25zdCBzb3VyY2UgPSBwcm9kdWN0Ll9zb3VyY2U7CiAgICAgICAgZWRpdGluZ0luZGV4SW5wdXQudmFsdWUgPSBpbmRleDsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRheEFwcGxpY2FibGUiKS52YWx1ZSA9IHNvdXJjZS50YXhBcHBsaWNhYmxlOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcm9kdWN0VHlwZSIpLnZhbHVlID0gc291cmNlLnByb2R1Y3RUeXBlOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcm9kdWN0TmFtZSIpLnZhbHVlID0gc291cmNlLnByb2R1Y3ROYW1lOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ1b20iKS52YWx1ZSA9IHNvdXJjZS51b207CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInByZXBMb2NhdGlvbiIpLnZhbHVlID0gc291cmNlLnByZXBMb2NhdGlvbjsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWVudUNhdGVnb3J5IikudmFsdWUgPSBzb3VyY2UubWVudUNhdGVnb3J5OwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnZlbnRvcnlDYXRlZ29yeSIpLnZhbHVlID0gc291cmNlLmludkNhdGVnb3J5OwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpbnZlbnRvcnlTdWJDYXRlZ29yeSIpLnZhbHVlID0gc291cmNlLmludlN1YkNhdGVnb3J5OwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdXBwbGllZFF1YW50aXR5IikudmFsdWUgPSBzb3VyY2Uuc3VwcGxpZWRRdWFudGl0eTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgieWllbGRRdWFudGl0eSIpLnZhbHVlID0gc291cmNlLnlpZWxkUXVhbnRpdHk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvc3RQcmljZSIpLnZhbHVlID0gaXNOYU4oc291cmNlLmRlZmF1bHRDb3N0KSA/ICcnIDogc291cmNlLmRlZmF1bHRDb3N0OwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZWxsaW5nUHJpY2UiKS52YWx1ZSA9IGlzTmFOKHNvdXJjZS5kZWZhdWx0UHJpY2UpID8gJycgOiBzb3VyY2UuZGVmYXVsdFByaWNlOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJoYXNCYXJjb2RlIikudmFsdWUgPSBzb3VyY2UuaGFzQmFyY29kZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYmFyY29kZSIpLnZhbHVlID0gc291cmNlLmJhcmNvZGU7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImlzUHVyY2hhc2VkRm9yUmVzYWxlIikuY2hlY2tlZCA9IHNvdXJjZS5pc1B1cmNoYXNlZEZvclJlc2FsZTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY3VzdG9tUGx1IikudmFsdWUgPSBwcm9kdWN0LnByb2R1Y3RHcm91cElkOwogICAgICAgIAogICAgICAgIGN1cnJlbnRWYXJpYW50R3JvdXBzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzb3VyY2UudmFyaWFudEdyb3VwcyB8fCBbXSkpOwogICAgICAgIGN1cnJlbnRWYXJpYW50UHJpY2luZyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc291cmNlLnZhcmlhbnRQcmljaW5nIHx8IFtdKSk7CiAgICAgICAgY3VycmVudE1vZGlmaWVyR3JvdXBzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzb3VyY2UubW9kaWZpZXJHcm91cHMgfHwgW10pKTsKICAgICAgICBjdXJyZW50TW9kaWZpZXJMaW5rcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc291cmNlLm1vZGlmaWVyTGlua3MgfHwge30pKTsKICAgICAgICAKICAgICAgICB1cGRhdGVSZXF1aXJlZEZpZWxkcygpOwogICAgICAgIHJlbmRlclZhcmlhbnRHcm91cHMoKTsKICAgICAgICBoYW5kbGVCYXJjb2RlVmlzaWJpbGl0eSgpOwogICAgICAgIGhhbmRsZVBsdVZpc2liaWxpdHkoKTsKCiAgICAgICAgbWFpbkFjdGlvbkJ1dHRvbi50ZXh0Q29udGVudCA9ICdVcGRhdGUgUHJvZHVjdCc7CiAgICAgICAgbWFpbkFjdGlvbkJ1dHRvbi5jbGFzc0xpc3QucmVwbGFjZSgnYnRuLWFkZCcsICdidG4tdXBkYXRlJyk7CgogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNwcm9kdWN0VGFibGUgdGJvZHkgdHIsICNzdG9ja1RhYmxlIHRib2R5IHRyJykuZm9yRWFjaChyb3cgPT4gcm93LmNsYXNzTGlzdC5yZW1vdmUoJ2VkaXRpbmctcm93JykpOwogICAgICAgIGNvbnN0IHJvd3NUb0hpZ2hsaWdodCA9IHByb2R1Y3RzLmZpbHRlcihwID0+IHAucHJvZHVjdEdyb3VwSWQgPT09IHByb2R1Y3QucHJvZHVjdEdyb3VwSWQpLm1hcChwID0+IHBbJ1Byb2R1Y3QgUExVJ10pOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNwcm9kdWN0VGFibGUgdGJvZHkgdHIsICNzdG9ja1RhYmxlIHRib2R5IHRyJykuZm9yRWFjaChyb3cgPT4gewogICAgICAgICAgICBpZiAocm93c1RvSGlnaGxpZ2h0LmluY2x1ZGVzKHJvdy5jZWxsc1swXS50ZXh0Q29udGVudCkpIHsKICAgICAgICAgICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdlZGl0aW5nLXJvdycpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIHdpbmRvdy5zY3JvbGxUbyh7IHRvcDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y3RGb3JtJykub2Zmc2V0VG9wLCBiZWhhdmlvcjogJ3Ntb290aCcgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVzZXRGb3JtKCkgewogICAgICAgIGNsZWFyQWxsVmFsaWRhdGlvbkVycm9ycygpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0Rm9ybScpLnJlc2V0KCk7CiAgICAgICAgCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VvbScpLnZhbHVlID0gJyc7IC8vIEVuc3VyZSBzZWxlY3Qgd2l0aCBkaXNhYmxlZCBvcHRpb24gaXMgY2xlYXJlZAogICAgICAgIGVkaXRpbmdJbmRleElucHV0LnZhbHVlID0gJy0xJzsKICAgICAgICBjdXJyZW50VmFyaWFudEdyb3VwcyA9IFtdOwogICAgICAgIGN1cnJlbnRWYXJpYW50UHJpY2luZyA9IFtdOwogICAgICAgIGN1cnJlbnRNb2RpZmllckxpbmtzID0ge307CiAgICAgICAgCiAgICAgICAgbWFpbkFjdGlvbkJ1dHRvbi50ZXh0Q29udGVudCA9ICdBZGQgUHJvZHVjdCc7CiAgICAgICAgbWFpbkFjdGlvbkJ1dHRvbi5jbGFzc0xpc3QucmVwbGFjZSgnYnRuLXVwZGF0ZScsICdidG4tYWRkJyk7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVkaXRpbmctcm93JykuZm9yRWFjaChyb3cgPT4gcm93LmNsYXNzTGlzdC5yZW1vdmUoJ2VkaXRpbmctcm93JykpOwogICAgICAgIAogICAgICAgIHJlbmRlclZhcmlhbnRHcm91cHMoKTsKICAgICAgICB1cGRhdGVSZXF1aXJlZEZpZWxkcygpOwogICAgICAgIGhhbmRsZUJhcmNvZGVWaXNpYmlsaXR5KCk7CgogICAgICAgIGlmIChyZW1lbWJlckNhdGVnb3JpZXNDaGVja2JveC5jaGVja2VkKSB7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmVwTG9jYXRpb24nKS52YWx1ZSA9IGxhc3RVc2VkQ2F0ZWdvcmllcy5wcmVwIHx8ICcnOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVudUNhdGVnb3J5JykudmFsdWUgPSBsYXN0VXNlZENhdGVnb3JpZXMubWVudSB8fCAnJzsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ludmVudG9yeUNhdGVnb3J5JykudmFsdWUgPSBsYXN0VXNlZENhdGVnb3JpZXMuaW52IHx8ICcnOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW52ZW50b3J5U3ViQ2F0ZWdvcnknKS52YWx1ZSA9IGxhc3RVc2VkQ2F0ZWdvcmllcy5zdWJJbnYgfHwgJyc7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1b20nKS52YWx1ZSA9IGxhc3RVc2VkQ2F0ZWdvcmllcy51b20gfHwgJyc7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIG5hdmlnYXRlVG9SYXcoZ3JvdXBJZCkgewogICAgICAgIGNvbnN0IHJhd1Byb2R1Y3QgPSBwcm9kdWN0cy5maW5kKHAgPT4gcC5wcm9kdWN0R3JvdXBJZCA9PT0gZ3JvdXBJZCAmJiBwWyJPcmlnaW5hbCBQcm9kdWN0IFR5cGUiXSA9PT0gJ3Jhd01hdGVyaWFsJyk7CiAgICAgICAgaWYgKCFyYXdQcm9kdWN0KSByZXR1cm47CgogICAgICAgIGNvbnN0IHJhd1BsdSA9IHJhd1Byb2R1Y3RbIlByb2R1Y3QgUExVIl07CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhYi1saW5rW2RhdGEtdGFiPSJwcm9kdWN0cyJdJykuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhYi1jb250ZW50I3Byb2R1Y3RzJykuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhYi1saW5rW2RhdGEtdGFiPSJzdG9jayJdJykuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhYi1jb250ZW50I3N0b2NrJykuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CgogICAgICAgIGNvbnN0IHJvd1RvSGlnaGxpZ2h0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3N0b2NrVGFibGUgdHJbZGF0YS1wbHU9IiR7cmF3UGx1fSJdYCk7CiAgICAgICAgaWYgKHJvd1RvSGlnaGxpZ2h0KSB7CiAgICAgICAgICAgIHJvd1RvSGlnaGxpZ2h0LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ2NlbnRlcicgfSk7CiAgICAgICAgICAgIHJvd1RvSGlnaGxpZ2h0LmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodC1yb3cnKTsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiByb3dUb0hpZ2hsaWdodC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQtcm93JyksIDMwMDApOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVUYWJsZShuZXdQcm9kdWN0U3RhcnRJbmRleCA9IC0xKSB7CiAgICAgICAgY29uc3QgcHJvZHVjdFRib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3Byb2R1Y3RUYWJsZSB0Ym9keSIpOwogICAgICAgIGNvbnN0IHN0b2NrVGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjc3RvY2tUYWJsZSB0Ym9keSIpOwogICAgICAgIHByb2R1Y3RUYm9keS5pbm5lckhUTUwgPSAiIjsKICAgICAgICBzdG9ja1Rib2R5LmlubmVySFRNTCA9ICIiOwoKICAgICAgICBsZXQgbGFzdEdyb3VwSWQgPSBudWxsOwogICAgICAgIGxldCBncm91cENsYXNzVG9nZ2xlID0gZmFsc2U7CgogICAgICAgIGNvbnN0IGNyZWF0ZUFjdGlvbnNDZWxsID0gKHAsIGluZGV4KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGFjdGlvbnNDZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGQiKTsKICAgICAgICAgICAgYWN0aW9uc0NlbGwuY2xhc3NOYW1lID0gImFjdGlvbnMtY2VsbCI7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBlZGl0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgICAgICAgIGVkaXRCdG4uY2xhc3NOYW1lID0gImJ0bi1lZGl0IjsKICAgICAgICAgICAgZWRpdEJ0bi50aXRsZSA9ICJFZGl0IFByb2R1Y3QiOwogICAgICAgICAgICBlZGl0QnRuLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xOS43NjkgOS45MjNsLTEyLjY0MiAxMi42MzktNy4xMjcgMS40MzggMS40MzgtNy4xMjcgMTIuNjQxLTEyLjY0IDUuNjkgNS42OTF6bTEuNDE0LTEuNDE0bDIuODE3LTIuODE3LTUuNjkxLTUuNjktMi44MTYgMi44MTcgNS42OSA1LjY5eiIvPjwvc3ZnPmA7CiAgICAgICAgICAgIGVkaXRCdG4ub25jbGljayA9ICgpID0+IGVkaXRQcm9kdWN0KGluZGV4KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IHJlbW92ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJ1dHRvbiIpOwogICAgICAgICAgICByZW1vdmVCdG4uY2xhc3NOYW1lID0gImJ0bi1yZW1vdmUiOwogICAgICAgICAgICByZW1vdmVCdG4udGl0bGUgPSAiUmVtb3ZlIFByb2R1Y3QiOwogICAgICAgICAgICByZW1vdmVCdG4uaW5uZXJIVE1MID0gYDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTMgNnYxOGgxOHYtMThoLTE4em01IDE0YzAgLjU1Mi0uNDQ4IDEtMSAxcy0xLS40NDgtMS0xdi0xMGMwLS41NTIuNDQ4LTEgMS0xczEgLjQ0OCAxIDF2MTB6bTUgMGMwIC41NTItLjQ0OCAxLTEgMXMtMS0uNDQ4LTEtMXYtMTBjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjEwem01IDBjMCAuNTUyLS40NDggMS0xIDFzLTEtLjQ0OC0xLTF2LTEwYzAtLjU1Mi40NDgtMSAxLTFzMSAuNDQ4IDEgMXYxMHptNC0xOGgtMjB2LTJoNnYtMS41YzAtLjgyNy42NzMtMS41IDEuNS0xLjVoNWMuODI1IDAgMS41LjY3MSAxLjUgMS41djEuNWg2djJ6Ii8+PC9zdmc+YDsKICAgICAgICAgICAgcmVtb3ZlQnRuLm9uY2xpY2sgPSAoKSA9PiB7IAogICAgICAgICAgICAgICAgY29uc3QgZ3JvdXBJZFRvUmVtb3ZlID0gcC5wcm9kdWN0R3JvdXBJZDsKICAgICAgICAgICAgICAgIGlmICghZ3JvdXBJZFRvUmVtb3ZlKSB7CiAgICAgICAgICAgICAgICAgICAgc2hvd01vZGFsKCJDYW5ub3QgcmVtb3ZlIGxlZ2FjeSBwcm9kdWN0LiBQbGVhc2UgY2xlYXIgYWxsIGRhdGEgaWYgeW91IHdpc2ggdG8gcmVtb3ZlIGl0LiIsICJlcnJvciIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IHByb2R1Y3RzSW5Hcm91cCA9IHByb2R1Y3RzLmZpbHRlcihwcm9kID0+IHByb2QucHJvZHVjdEdyb3VwSWQgPT09IGdyb3VwSWRUb1JlbW92ZSk7CiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gYFJlbW92ZSAiJHtwLl9zb3VyY2UucHJvZHVjdE5hbWV9IiBhbmQgYWxsIGl0cyAke3Byb2R1Y3RzSW5Hcm91cC5sZW5ndGggLSAxfSByZWxhdGVkIGNvbXBvbmVudHMvdmFyaWFudHM/YDsKICAgICAgICAgICAgICAgIHNob3dNb2RhbChtZXNzYWdlLCAnd2FybmluZycsICgpID0+IHsgCiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHMgPSBwcm9kdWN0cy5maWx0ZXIocHJvZCA9PiBwcm9kLnByb2R1Y3RHcm91cElkICE9PSBncm91cElkVG9SZW1vdmUpOwogICAgICAgICAgICAgICAgICAgIHNhdmVTdGF0ZSgpOyAKICAgICAgICAgICAgICAgICAgICB1cGRhdGVUYWJsZSgpOyAKICAgICAgICAgICAgICAgIH0sIHRydWUpOyAKICAgICAgICAgICAgfTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGFjdGlvbnNDZWxsLmFwcGVuZENoaWxkKGVkaXRCdG4pOwogICAgICAgICAgICBhY3Rpb25zQ2VsbC5hcHBlbmRDaGlsZChyZW1vdmVCdG4pOwoKICAgICAgICAgICAgY29uc3QgaXNNYW51ZmFjdHVyZWQgPSBwWyJPcmlnaW5hbCBQcm9kdWN0IFR5cGUiXSA9PT0gJ2ZpbmlzaGVkR29vZCcgJiYgcC5fc291cmNlLnByb2R1Y3RUeXBlID09PSAnZmluaXNoZWRHb29kICYgcmF3TWF0ZXJpYWwnICYmICFwLl9zb3VyY2UuaXNQdXJjaGFzZWRGb3JSZXNhbGU7CiAgICAgICAgICAgIGlmIChpc01hbnVmYWN0dXJlZCkgewogICAgICAgICAgICAgICAgY29uc3QgcmF3UHJvZHVjdCA9IHByb2R1Y3RzLmZpbmQocmF3UCA9PiByYXdQLnByb2R1Y3RHcm91cElkID09PSBwLnByb2R1Y3RHcm91cElkICYmIHJhd1BbIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSJdID09PSAncmF3TWF0ZXJpYWwnKTsKICAgICAgICAgICAgICAgIGlmIChyYXdQcm9kdWN0KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9vbHRpcERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgIHRvb2x0aXBEaXYuY2xhc3NOYW1lID0gJ3Rvb2x0aXAgbW9kaWZpZXItaW5kaWNhdG9yLXdyYXBwZXInOwogICAgICAgICAgICAgICAgICAgIHRvb2x0aXBEaXYudGl0bGUgPSBgTWFwcyB0bzogJHtyYXdQcm9kdWN0WyJCYXNlIE5hbWUiXX1gOwogICAgICAgICAgICAgICAgICAgIHRvb2x0aXBEaXYuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInOwogICAgICAgICAgICAgICAgICAgIHRvb2x0aXBEaXYub25jbGljayA9ICgpID0+IG5hdmlnYXRlVG9SYXcocC5wcm9kdWN0R3JvdXBJZCk7CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3IuY2xhc3NOYW1lID0gJ21vZGlmaWVyLWluZGljYXRvcic7CiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yLnRleHRDb250ZW50ID0gJ1InOwoKICAgICAgICAgICAgICAgICAgICB0b29sdGlwRGl2LmFwcGVuZENoaWxkKGluZGljYXRvcik7CiAgICAgICAgICAgICAgICAgICAgYWN0aW9uc0NlbGwuYXBwZW5kQ2hpbGQodG9vbHRpcERpdik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNDZWxsOwogICAgICAgIH07CgogICAgICAgIHByb2R1Y3RzLmZvckVhY2goKHAsIGluZGV4KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRHcm91cElkID0gcC5wcm9kdWN0R3JvdXBJZDsKICAgICAgICAgICAgaWYgKGN1cnJlbnRHcm91cElkICYmIGN1cnJlbnRHcm91cElkICE9PSBsYXN0R3JvdXBJZCkgewogICAgICAgICAgICAgICAgZ3JvdXBDbGFzc1RvZ2dsZSA9ICFncm91cENsYXNzVG9nZ2xlOwogICAgICAgICAgICAgICAgbGFzdEdyb3VwSWQgPSBjdXJyZW50R3JvdXBJZDsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgaXNTZWxsYWJsZSA9IFsnZmluaXNoZWRHb29kJ10uaW5jbHVkZXMocFsiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIl0pOwogICAgICAgICAgICBjb25zdCBpc1N0b2NrID0gWydyYXdNYXRlcmlhbCcsICdNYW51ZmFjdHVyZWQnXS5pbmNsdWRlcyhwWyJPcmlnaW5hbCBQcm9kdWN0IFR5cGUiXSk7CgogICAgICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJ0ciIpOwogICAgICAgICAgICByb3cuZGF0YXNldC5wbHUgPSBwWyJQcm9kdWN0IFBMVSJdOwogICAgICAgICAgICBpZiAoY3VycmVudEdyb3VwSWQpIHJvdy5jbGFzc0xpc3QuYWRkKGdyb3VwQ2xhc3NUb2dnbGUgPyAnZ3JvdXAtYScgOiAnZ3JvdXAtYicpOwogICAgICAgICAgICBpZiAoaW5kZXggPj0gbmV3UHJvZHVjdFN0YXJ0SW5kZXgpIHJvdy5jbGFzc0xpc3QuYWRkKCduZXctcm93Jyk7CgogICAgICAgICAgICBpZiAoaXNTZWxsYWJsZSkgewogICAgICAgICAgICAgICAgcm93LmlubmVySFRNTCA9IGA8dGQ+JHtwWyJQcm9kdWN0IFBMVSJdfTwvdGQ+PHRkPiR7cFsiQmFzZSBOYW1lIl19PC90ZD48dGQ+JHtwWyJWYXJpYW50IE5hbWUiXX08L3RkPjx0ZD4ke3BbIk1lbnUgQ2F0ZWdvcnkiXX08L3RkPjx0ZD4keyhwYXJzZUZsb2F0KHBbIlNlbGxpbmcgUHJpY2UiXSkgfHwgMCkudG9GaXhlZCgyKX08L3RkPjx0ZD48L3RkPmA7CiAgICAgICAgICAgICAgICBjb25zdCBtb2RpZmllckNlbGwgPSByb3cuY2VsbHNbNV07CiAgICAgICAgICAgICAgICBjb25zdCBsaW5rZWRHcm91cHMgPSBwLl9zb3VyY2U/Lm1vZGlmaWVyTGlua3M/LltwWyJWYXJpYW50IE5hbWUiXSB8fCAnJ10gfHwgW107CiAgICAgICAgICAgICAgICBpZiAobGlua2VkR3JvdXBzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICBtb2RpZmllckNlbGwuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9vbHRpcERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgIHRvb2x0aXBEaXYuY2xhc3NOYW1lID0gJ3Rvb2x0aXAgbW9kaWZpZXItaW5kaWNhdG9yLXdyYXBwZXInOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3IuY2xhc3NOYW1lID0gJ21vZGlmaWVyLWluZGljYXRvcic7CiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yLnRleHRDb250ZW50ID0gbGlua2VkR3JvdXBzLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICBjb25zdCB0b29sdGlwVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgICAgICAgICAgICAgICB0b29sdGlwVGV4dC5jbGFzc05hbWUgPSAndG9vbHRpcHRleHQnOwogICAgICAgICAgICAgICAgICAgIHRvb2x0aXBUZXh0LnN0eWxlLnRleHRBbGlnbiA9ICdsZWZ0JzsKICAgICAgICAgICAgICAgICAgICB0b29sdGlwVGV4dC5pbm5lckhUTUwgPSBgPHN0cm9uZz5MaW5rZWQ6PC9zdHJvbmc+PGJyPiR7bGlua2VkR3JvdXBzLmpvaW4oJzxicj4nKX1gOwogICAgICAgICAgICAgICAgICAgIHRvb2x0aXBEaXYuYXBwZW5kQ2hpbGQoaW5kaWNhdG9yKTsKICAgICAgICAgICAgICAgICAgICB0b29sdGlwRGl2LmFwcGVuZENoaWxkKHRvb2x0aXBUZXh0KTsKICAgICAgICAgICAgICAgICAgICBtb2RpZmllckNlbGwuYXBwZW5kQ2hpbGQodG9vbHRpcERpdik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoY3JlYXRlQWN0aW9uc0NlbGwocCwgaW5kZXgpKTsKICAgICAgICAgICAgICAgIHByb2R1Y3RUYm9keS5hcHBlbmRDaGlsZChyb3cpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChpc1N0b2NrKSB7CiAgICAgICAgICAgICAgICBjb25zdCBzdG9ja1JvdyA9IHJvdy5jbG9uZU5vZGUodHJ1ZSk7CiAgICAgICAgICAgICAgICBzdG9ja1Jvdy5pbm5lckhUTUwgPSBgPHRkPiR7cFsiUHJvZHVjdCBQTFUiXX08L3RkPjx0ZD4ke3BbIkJhc2UgTmFtZSJdfTwvdGQ+PHRkPiR7cFsiSW52ZW50b3J5IENhdGVnb3J5Il19PC90ZD48dGQ+JHtwWyJTZWxsaW5nIFVPTSJdfTwvdGQ+PHRkPiR7KHBhcnNlRmxvYXQocFsiQ29zdCBQcmljZSJdKSB8fCAwKS50b0ZpeGVkKDIpfTwvdGQ+YDsKICAgICAgICAgICAgICAgIHN0b2NrUm93LmFwcGVuZENoaWxkKGNyZWF0ZUFjdGlvbnNDZWxsKHAsIGluZGV4KSk7CiAgICAgICAgICAgICAgICBzdG9ja1Rib2R5LmFwcGVuZENoaWxkKHN0b2NrUm93KTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgaWYgKG5ld1Byb2R1Y3RTdGFydEluZGV4ICE9PSAtMSkgeyAKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5uZXctcm93JykuZm9yRWFjaChyID0+IHIuY2xhc3NMaXN0LnJlbW92ZSgnbmV3LXJvdycpKSwgMjUwMCk7IAogICAgICB9CiAgICAgIGNvbnN0IG1lbnVDYXRlZ29yaWVzID0gbmV3IFNldChwcm9kdWN0cy5maWx0ZXIocCA9PiBwWyJNZW51IENhdGVnb3J5Il0pLm1hcChwID0+IHBbIk1lbnUgQ2F0ZWdvcnkiXSkpOwogICAgICAgICAgICBjb25zdCBjYXRlZ29yeUZpbHRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0Q2F0ZWdvcnlGaWx0ZXInKTsKICAgICAgICAgICAgY29uc3QgY3VycmVudFZhbCA9IGNhdGVnb3J5RmlsdGVyLnZhbHVlOwogICAgICAgICAgICBjYXRlZ29yeUZpbHRlci5pbm5lckhUTUwgPSAnPG9wdGlvbiB2YWx1ZT0iIj5GaWx0ZXIgYnkgTWVudSBDYXRlZ29yeS4uLjwvb3B0aW9uPic7CiAgICAgICAgICAgIG1lbnVDYXRlZ29yaWVzLmZvckVhY2goY2F0ID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOwogICAgICAgICAgICAgICAgb3B0aW9uLnZhbHVlID0gY2F0OwogICAgICAgICAgICAgICAgb3B0aW9uLnRleHRDb250ZW50ID0gY2F0OwogICAgICAgICAgICAgICAgY2F0ZWdvcnlGaWx0ZXIuYXBwZW5kQ2hpbGQob3B0aW9uKTsKICAgICAgICAgICAgfSk7CiAgICAgIGNhdGVnb3J5RmlsdGVyLnZhbHVlID0gY3VycmVudFZhbDsgLy8gUHJlc2VydmUgdGhlIHNlbGVjdGVkIGZpbHRlcgogICAgICAKICAgICAgLy8gQ29ycmVjdGVkIGZpbHRlciBjYWxscyBhcmUgaGVyZQogICAgICBmaWx0ZXJUYWJsZSgncHJvZHVjdFNlYXJjaCcsICdwcm9kdWN0VGFibGUnLCAncHJvZHVjdENhdGVnb3J5RmlsdGVyJyk7CiAgICAgIGZpbHRlclRhYmxlKCdzdG9ja1NlYXJjaCcsICdzdG9ja1RhYmxlJyk7CiAgICB9CgogICAgLy8gLS0tIElOTElORSBWQUxJREFUSU9OIC0tLQogICAgZnVuY3Rpb24gc2hvd1ZhbGlkYXRpb25FcnJvcihlbGVtZW50LCBtZXNzYWdlKSB7CiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdpbnB1dC1pbnZhbGlkJyk7CiAgICAgICAgY29uc3QgcGFyZW50ID0gZWxlbWVudC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5mb3JtLWdyb3VwLCAucmVtZW1iZXItbWUtY29udGFpbmVyJyk7CiAgICAgICAgbGV0IGVycm9yU3BhbiA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCcuZXJyb3ItbWVzc2FnZScpOwogICAgICAgIGlmICghZXJyb3JTcGFuKSB7CiAgICAgICAgICAgIGVycm9yU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBlcnJvclNwYW4uY2xhc3NOYW1lID0gJ2Vycm9yLW1lc3NhZ2UnOwogICAgICAgICAgICBwYXJlbnQuYXBwZW5kQ2hpbGQoZXJyb3JTcGFuKTsKICAgICAgICB9CiAgICAgICAgZXJyb3JTcGFuLnRleHRDb250ZW50ID0gbWVzc2FnZTsKICAgIH0KICAgIGZ1bmN0aW9uIGNsZWFyVmFsaWRhdGlvbkVycm9yKGVsZW1lbnQpIHsKICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2lucHV0LWludmFsaWQnKTsKICAgICAgICBjb25zdCBwYXJlbnQgPSBlbGVtZW50LnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAsIC5yZW1lbWJlci1tZS1jb250YWluZXInKTsKICAgICAgICBwYXJlbnQucXVlcnlTZWxlY3RvcignLmVycm9yLW1lc3NhZ2UnKT8ucmVtb3ZlKCk7CiAgICB9CiAgICBmdW5jdGlvbiBjbGVhckFsbFZhbGlkYXRpb25FcnJvcnMoKSB7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LWludmFsaWQnKS5mb3JFYWNoKGVsID0+IGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2lucHV0LWludmFsaWQnKSk7CiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVycm9yLW1lc3NhZ2UnKS5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZSgpKTsKICAgIH0KICAgIGZ1bmN0aW9uIHNldHVwSW5saW5lVmFsaWRhdGlvbigpIHsKICAgICAgICBjb25zdCBmaWVsZHNUb1ZhbGlkYXRlID0gWydwcm9kdWN0TmFtZScsICd0YXhBcHBsaWNhYmxlJywgJ3Byb2R1Y3RUeXBlJywgJ3VvbScsICdwcmVwTG9jYXRpb24nLCAnbWVudUNhdGVnb3J5JywgJ2ludmVudG9yeUNhdGVnb3J5JywgJ3N1cHBsaWVkUXVhbnRpdHknLCAneWllbGRRdWFudGl0eSddOwogICAgICAgIGZpZWxkc1RvVmFsaWRhdGUuZm9yRWFjaChpZCA9PiB7CiAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOwogICAgICAgICAgICBpZiAoZWwpIHsKICAgICAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCAoZSkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmKGUudGFyZ2V0Lmhhc0F0dHJpYnV0ZSgncmVxdWlyZWQnKSAmJiBlLnRhcmdldC52YWx1ZS50cmltKCkgPT09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICBzaG93VmFsaWRhdGlvbkVycm9yKGUudGFyZ2V0LCAnVGhpcyBmaWVsZCBpcyByZXF1aXJlZC4nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpID0+IGNsZWFyVmFsaWRhdGlvbkVycm9yKGUudGFyZ2V0KSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KCgogICAgZnVuY3Rpb24gZXhwb3J0VG9FeGNlbCgpIHsKICAgICAgICBpZiAocHJvZHVjdHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgiTm8gcHJvZHVjdHMgdG8gZXhwb3J0ISIsICJ3YXJuaW5nIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKCFzZXNzaW9uU2l0ZSB8fCBzZXNzaW9uU2l0ZS50cmltKCkgPT09ICcnKSB7CiAgICAgICAgICAgIHNob3dNb2RhbCgiUGxlYXNlIHNldCB0aGUgJ1NpdGUnIGluIFNlc3Npb24gRGVmYXVsdHMgYmVmb3JlIGV4cG9ydGluZy4iLCAiZXJyb3IiKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgdmlkZW9PdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZGVvT3ZlcmxheScpOwogICAgICAgIGNvbnN0IGV4cG9ydFZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4cG9ydFZpZGVvJyk7CgogICAgICAgIGNvbnN0IGV4cG9ydERhdGEgPSBwcm9kdWN0cy5tYXAocCA9PiB7CiAgICAgICAgICAgIGxldCBpbnZlbnRvcnlDYXRlZ29yeSA9IHBbIkludmVudG9yeSBDYXRlZ29yeSJdOwogICAgICAgICAgICBpZiAoaW52ZW50b3J5Q2F0ZWdvcnkpIHsgCiAgICAgICAgICAgICAgICBzd2l0Y2ggKHBbIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSJdKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAiZmluaXNoZWRHb29kIjogCiAgICAgICAgICAgICAgICAgICAgICAgIGludmVudG9yeUNhdGVnb3J5ICs9IHAuX3NvdXJjZS5pc1B1cmNoYXNlZEZvclJlc2FsZSA/ICIgLSBSQVcgTUFURVJJQUxTIiA6ICIgLSBGSU5JU0hFRCBHT09EIjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAicmF3TWF0ZXJpYWwiOiBjYXNlICJmaW5pc2hlZEdvb2QgJiByYXdNYXRlcmlhbCI6IGNhc2UgIk1hbnVmYWN0dXJlZCI6CiAgICAgICAgICAgICAgICAgICAgICAgIGludmVudG9yeUNhdGVnb3J5ICs9ICIgLSBSQVcgTUFURVJJQUxTIjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGZpbmFsQ29zdFByaWNlID0gcFsiQ29zdCBQcmljZSJdOwogICAgICAgICAgICBpZiAocFsiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIl0gPT09ICdyYXdNYXRlcmlhbCcgJiYgcFsiU3VwcGxpZWQgUXVhbnRpdHkiXSAmJiBOdW1iZXIocFsiU3VwcGxpZWQgUXVhbnRpdHkiXSkgPiAwKSB7CiAgICAgICAgICAgICAgICBmaW5hbENvc3RQcmljZSA9IHBbIkNvc3QgUHJpY2UiXSAvIE51bWJlcihwWyJTdXBwbGllZCBRdWFudGl0eSJdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAiUHJvZHVjdCBQTFUiOiBwWyJQcm9kdWN0IFBMVSJdLCAiUHJvZHVjdCBOYW1lICYgVmFyaWFudCI6IHBbIlByb2R1Y3QgTmFtZSAmIFZhcmlhbnQiXSwgIlNpdGUiOiBwLlNpdGUsCiAgICAgICAgICAgICAgIkdQIjogcFsiR1AiXSwgIlNlbGxpbmcgVU9NIjogcFsiU2VsbGluZyBVT00iXSwgIlByZXBhcmF0aW9uIExvY2F0aW9uIjogcFsiUHJlcGFyYXRpb24gTG9jYXRpb24iXSwKICAgICAgICAgICAgICAiTWVudSBDYXRlZ29yeSI6IHBbIk1lbnUgQ2F0ZWdvcnkiXSwgIkludmVudG9yeSBDYXRlZ29yeSI6IGludmVudG9yeUNhdGVnb3J5LCAiSW52ZW50b3J5IFN1Yi1DYXRlZ29yeSI6IHBbIkludmVudG9yeSBTdWItQ2F0ZWdvcnkiXSwKICAgICAgICAgICAgICAiUHJvZHVjdCBUeXBlIjogcFsiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIl0gPT09ICJNYW51ZmFjdHVyZWQiID8gInNpbmdsZSIgOiBwWyJQcm9kdWN0IFR5cGUiXSwgCiAgICAgICAgICAgICAgIkVuYWJsZWQiOiBwLkVuYWJsZWQsICJDb3N0IFByaWNlIjogZmluYWxDb3N0UHJpY2UsICJTZWxsaW5nIFByaWNlIjogcFsiU2VsbGluZyBQcmljZSJdLAogICAgICAgICAgICAgICJEeW5hbWljIFByaWNlIjogZmFsc2UsICJWaXNpYmxlIG9uIEFwcCI6IGZhbHNlLCAiRGVmYXVsdCBTZWxsaW5nIExvY2F0aW9uIjogIkRlZmF1bHQgU2VsbGluZyBMb2NhdGlvbiIsICJEZWZhdWx0IFN0b3JhZ2UgTG9jYXRpb24iOiAiRGVmYXVsdCBTdG9yYWdlIExvY2F0aW9uIiwKICAgICAgICAgICAgICAiVGF4IEFwcGxpY2FibGUiOiBwWyJUYXggQXBwbGljYWJsZSJdLCAiQmFyY29kZSI6IHAuQmFyY29kZSwgCiAgICAgICAgICAgICAgIlN1cHBsaWVkIFF1YW50aXR5IjogcFsiU3VwcGxpZWQgUXVhbnRpdHkiXSA/IGAke3BbIlN1cHBsaWVkIFF1YW50aXR5Il19ICR7cFsiU2VsbGluZyBVT00iXX1gIDogJycsCiAgICAgICAgICAgICAgIlN1cHBsaWVkIFF1YW50aXR5IENvc3QgUHJpY2UiOiBwWyJTdXBwbGllZCBRdWFudGl0eSJdID8gcFsiQ29zdCBQcmljZSJdIDogJycsIAogICAgICAgICAgICAgICJNYW51ZmFjdHVyZWQgWWllbGQiOiBwWyJNYW51ZmFjdHVyZWQgWWllbGQiXSwgIlByb2R1Y3QgUExVIChFbmQpIjogcFsiUHJvZHVjdCBQTFUiXSwgIlByb2R1Y3QgTmFtZSI6IHBbIkJhc2UgTmFtZSJdLAogICAgICAgICAgICAgICJWYXJpYW50IjogcFsiVmFyaWFudCBOYW1lIl0gfHwgIiIsIAogICAgICAgICAgICAgICJMaXN0ZWQgUHJvZHVjdCBUeXBlIjogcFsiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIl0gPT09ICJNYW51ZmFjdHVyZWQiID8gInJhd01hdGVyaWFsIiA6IHBbIk9yaWdpbmFsIFByb2R1Y3QgVHlwZSJdCiAgICAgICAgICAgIH07CiAgICAgICAgfSk7CgogICAgICAgIGNvbnN0IGNyZWF0ZVByb2R1Y3RTdHJ1Y3R1cmVEYXRhID0gcHJvZHVjdHMubWFwKHAgPT4gewogICAgICAgICAgICBjb25zdCB2YXJpYW50TmFtZSA9IHBbIlZhcmlhbnQgTmFtZSJdIHx8ICcnOwogICAgICAgICAgICBjb25zdCBsaW5rZWRHcm91cHMgPSBwLl9zb3VyY2U/Lm1vZGlmaWVyTGlua3M/Llt2YXJpYW50TmFtZV0gfHwgW107CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAiUHJvZHVjdCBQTFUiOiBwWyJQcm9kdWN0IFBMVSJdLCAiTmFtZSI6IHBbIkJhc2UgTmFtZSJdLCAiVmFyaWFudHMiOiBwWyJWYXJpYW50IE5hbWUiXSB8fCAiIiwKICAgICAgICAgICAgICAgICJNb2RpZmllcnMiOiBsaW5rZWRHcm91cHMuam9pbignLCAnKSwgIk1lbnUgQ2F0ZWdvcmllcyI6IHBbIk1lbnUgQ2F0ZWdvcnkiXSwgCiAgICAgICAgICAgICAgICAiSW52ZW50b3J5IFR5cGUiOiBwWyJPcmlnaW5hbCBQcm9kdWN0IFR5cGUiXSA9PT0gIk1hbnVmYWN0dXJlZCIgPyAicmF3TWF0ZXJpYWwiIDogcFsiT3JpZ2luYWwgUHJvZHVjdCBUeXBlIl0sIAogICAgICAgICAgICAgICAgIlRhZ3MiOiAiIiwgIlNlbGxpbmcgVU9NIjogcFsiU2VsbGluZyBVT00iXSwgIlRheCBBcHBsaWNhYmxlIjogcFsiVGF4IEFwcGxpY2FibGUiXSwgIlNob3cgb24gUm95YWx0eSI6IGZhbHNlLAogICAgICAgICAgICAgICAgIkludmVudG9yeSBDYXRlZ29yeSI6IHBbIkludmVudG9yeSBDYXRlZ29yeSJdLCAiSW52ZW50b3J5IFN1Yi1DYXRlZ29yeSI6IHBbIkludmVudG9yeSBTdWItQ2F0ZWdvcnkiXSwKICAgICAgICAgICAgICAgICJCYXJjb2RlcyI6IHAuQmFyY29kZSwgIlByb2R1Y3QgU0tVIjogcFsiUHJvZHVjdCBQTFUiXSwgIkRlc2NyaXB0aW9uIjogIiIKICAgICAgICAgICAgfTsKICAgICAgICB9KTsKCiAgICAgICAgY29uc3QgbW9kaWZpZXJTaGVldERhdGEgPSBbXTsKICAgICAgICBpZiAoY3VycmVudE1vZGlmaWVyR3JvdXBzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgY3VycmVudE1vZGlmaWVyR3JvdXBzLmZvckVhY2goZ3JvdXAgPT4gewogICAgICAgICAgICAgICAgY29uc3QgbGlua2VkUHJvZHVjdHMgPSBwcm9kdWN0cy5maWx0ZXIocCA9PiAocC5fc291cmNlPy5tb2RpZmllckxpbmtzPy5bcFsiVmFyaWFudCBOYW1lIl0gfHwgJyddIHx8IFtdKS5pbmNsdWRlcyhncm91cC5ncm91cE5hbWUpKS5tYXAocCA9PiBwWyJQcm9kdWN0IE5hbWUgJiBWYXJpYW50Il0pOwogICAgICAgICAgICAgICAgbW9kaWZpZXJTaGVldERhdGEucHVzaCh7ICJMaW5lIEl0ZW0iOiBgTU9ESUZJRVIgR1JPVVA6ICR7Z3JvdXAuZ3JvdXBOYW1lfWAsICJEZXRhaWxzIjogIiIgfSk7CiAgICAgICAgICAgICAgICBtb2RpZmllclNoZWV0RGF0YS5wdXNoKHsgIkxpbmUgSXRlbSI6ICJPcHRpb25zIiwgIkRldGFpbHMiOiAiUHJpY2UiIH0pOwogICAgICAgICAgICAgICAgZ3JvdXAub3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiBtb2RpZmllclNoZWV0RGF0YS5wdXNoKHsgIkxpbmUgSXRlbSI6IG9wdGlvbi5uYW1lLCAiRGV0YWlscyI6IChvcHRpb24ucHJpY2UgfHwgMCkudG9GaXhlZCgyKSB9KSk7CiAgICAgICAgICAgICAgICBtb2RpZmllclNoZWV0RGF0YS5wdXNoKHt9LCB7ICJMaW5lIEl0ZW0iOiAiTGlua2VkIFNlbGxpbmcgUHJvZHVjdHMiLCAiRGV0YWlscyI6IGAoJHtsaW5rZWRQcm9kdWN0cy5sZW5ndGh9IGl0ZW0vcylgIH0pOwogICAgICAgICAgICAgICAgbGlua2VkUHJvZHVjdHMuZm9yRWFjaChuYW1lID0+IG1vZGlmaWVyU2hlZXREYXRhLnB1c2goeyAiTGluZSBJdGVtIjogbmFtZSwgIkRldGFpbHMiOiAiIiB9KSk7CiAgICAgICAgICAgICAgICBtb2RpZmllclNoZWV0RGF0YS5wdXNoKHt9LCB7fSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG1vZGlmaWVyU2hlZXREYXRhLnB1c2goeyAiTGluZSBJdGVtIjogIk5vIG1vZGlmaWVyIGdyb3VwcyBkZWZpbmVkIGluIGxpYnJhcnkuIiwgIkRldGFpbHMiOiAiIiB9KTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHdzMSA9IFhMU1gudXRpbHMuanNvbl90b19zaGVldChleHBvcnREYXRhKTsKICAgICAgICBjb25zdCB3czIgPSBYTFNYLnV0aWxzLmpzb25fdG9fc2hlZXQoY3JlYXRlUHJvZHVjdFN0cnVjdHVyZURhdGEpOwogICAgICAgIGNvbnN0IHdzMyA9IFhMU1gudXRpbHMuanNvbl90b19zaGVldChtb2RpZmllclNoZWV0RGF0YSwge3NraXBIZWFkZXI6IGZhbHNlfSk7CiAgICAgICAgd3MzWychY29scyddID0gWyB7d2NoOjYwfSwge3djaDoyMH0gXTsKICAgICAgICAKICAgICAgICBjb25zdCB3YiA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsKICAgICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCB3czEsICJTaXRlIFByb2R1Y3QgU3RydWN0dXJlIik7CiAgICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3Yiwgd3MyLCAiQ3JlYXRlIFByb2R1Y3Qgc3RydWN0dXJlIik7CiAgICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3Yiwgd3MzLCAiTW9kaWZpZXIgR3JvdXBzIik7CiAgICAgIAogICAgICAgIGNvbnN0IHNhbml0aXplZFNpdGVOYW1lID0gc2Vzc2lvblNpdGUudHJpbSgpLnJlcGxhY2UoL1teYS16QS1aMC05XHNfLV0vZywgJycpLnJlcGxhY2UoL1xzKy9nLCAnXycpOwogICAgICAgIGNvbnN0IGZpbGVOYW1lID0gYCR7c2FuaXRpemVkU2l0ZU5hbWV9X1RhYmxlX2J5X1lvY28ueGxzeGA7CiAgICAgICAgWExTWC53cml0ZUZpbGUod2IsIGZpbGVOYW1lKTsKCiAgICAgICAgdmlkZW9PdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgICAgICAgZXhwb3J0VmlkZW8uY3VycmVudFRpbWUgPSAwOwogICAgICAgIGV4cG9ydFNvdW5kRWxlbWVudC5jdXJyZW50VGltZSA9IDA7CiAgICAgICAgZXhwb3J0VmlkZW8ucGxheSgpOwogICAgICAgIGV4cG9ydFNvdW5kRWxlbWVudC5wbGF5KCk7CgogICAgICAgIGV4cG9ydFZpZGVvLm9uZW5kZWQgPSAoKSA9PiB7CiAgICAgICAgICAgIHZpZGVvT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICBzaG93TW9kYWwoJ0V4cG9ydCBzdWNjZXNzZnVsISBDbGVhciBhbGwgZGF0YT8nLCAnd2FybmluZycsICgpID0+IGNsZWFyQWxsRGF0YSgpLCB0cnVlKTsKICAgICAgICB9OwogICAgfQogICAgZnVuY3Rpb24gYWRkVG9EYXRhbGlzdChpZCwgdmFsdWUpIHsKICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuOyAKICAgICAgY29uc3QgZGF0YWxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CiAgICAgIGlmIChkYXRhbGlzdCAmJiAhWy4uLmRhdGFsaXN0Lm9wdGlvbnNdLnNvbWUobyA9PiBvLnZhbHVlID09PSB2YWx1ZSkpIHsKICAgICAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsgb3B0LnZhbHVlID0gdmFsdWU7IGRhdGFsaXN0LmFwcGVuZENoaWxkKG9wdCk7CiAgICAgIH0KICAgIH0KCgoKCgoKPC9zY3JpcHQ+CjxkaXYgY2xhc3M9Im1vZGFsLWJhY2tkcm9wIiBpZD0idHV0b3JpYWwtcHJvbXB0LW1vZGFsIj4KPGRpdiBjbGFzcz0ibW9kYWwtY29udGVudCI+CjxoMz5RdWljayBUdXRvcmlhbDwvaDM+CjxwPldvdWxkIHlvdSBsaWtlIGEgcXVpY2sgdG91ciBvZiB0aGUgbWFpbiBmZWF0dXJlcz88L3A+CjxkaXYgY2xhc3M9Im1vZGFsLWJ1dHRvbnMiPgo8YnV0dG9uIGNsYXNzPSJidG4tYWRkIiBpZD0ic3RhcnQtdHV0b3JpYWwtYnRuIj5ZZXMsIHBsZWFzZTwvYnV0dG9uPgo8YnV0dG9uIGNsYXNzPSJidG4tZXhwb3J0IiBpZD0ic2tpcC10dXRvcmlhbC1idG4iPk5vLCB0aGFua3M8L2J1dHRvbj4KPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPGRpdiBjbGFzcz0idHV0b3JpYWwtb3ZlcmxheSIgaWQ9InR1dG9yaWFsLW92ZXJsYXkiPgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5LXBhcnQiIGlkPSJ0dXRvcmlhbC1vdmVybGF5LXRvcCI+PC9kaXY+CjxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktYm90dG9tIj48L2Rpdj4KPGRpdiBjbGFzcz0idHV0b3JpYWwtb3ZlcmxheS1wYXJ0IiBpZD0idHV0b3JpYWwtb3ZlcmxheS1sZWZ0Ij48L2Rpdj4KPGRpdiBjbGFzcz0idHV0b3JpYWwtb3ZlcmxheS1wYXJ0IiBpZD0idHV0b3JpYWwtb3ZlcmxheS1yaWdodCI+PC9kaXY+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyIiBpZD0idHV0b3JpYWwtcG9wb3ZlciI+CjxkaXYgY2xhc3M9InR1dG9yaWFsLXBvcG92ZXItaGVhZGVyIj4KPHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjI0IiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIHZpZXdib3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xMiAyMnM4LTQgOC0xMFY1bC04LTMtOCAzdjdjMCA2IDggMTAgOCAxMHoiPjwvcGF0aD48L3N2Zz4KPHNwYW4+UXVpY2sgR3VpZGU8L3NwYW4+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQiIGlkPSJ0dXRvcmlhbC1wb3BvdmVyLWNvbnRlbnQiPjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1wb3BvdmVyLW5hdiI+CjxzcGFuIGNsYXNzPSJ0ZXh0LXNtIiBpZD0idHV0b3JpYWwtc3RlcC1jb3VudGVyIj48L3NwYW4+CjxkaXY+CjxidXR0b24gY2xhc3M9ImJ0bi1leHBvcnQiIGlkPSJ0dXRvcmlhbC1wcmV2LWJ0biI+UHJldjwvYnV0dG9uPgo8YnV0dG9uIGNsYXNzPSJidG4tYWRkIiBpZD0idHV0b3JpYWwtbmV4dC1idG4iPk5leHQ8L2J1dHRvbj4KPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPHNjcmlwdD4KLy8gLS0tIFNtYXJ0IFRvb2x0aXAgQ29udHJvbGxlciAodjUpOiBjbGljay10by1vcGVuLCBsaW5nZXIgMXMgb24gYmx1ciAtLS0KKGZ1bmN0aW9uICgpIHsKICBpZiAod2luZG93Ll9fc21hcnRUb29sdGlwc1Y1KSByZXR1cm47IHdpbmRvdy5fX3NtYXJ0VG9vbHRpcHNWNSA9IHRydWU7CgogIGNvbnN0IExPTkdfUFJFU1NfTVMgPSAzNTA7CiAgY29uc3QgTElOR0VSX09OX0JMVVJfTVMgPSAxMDAwOyAvLyA8LS0gcGVyIHJlcXVpcmVtZW50CiAgY29uc3QgbGluZ2VyVGltZXJzID0gbmV3IFdlYWtNYXAoKTsKCiAgY29uc3QgZHluYW1pY0JvZGllcyA9IHsKICAgIHByb2R1Y3RUeXBlOiAoKSA9PiB7CiAgICAgIGNvbnN0IHR5cGVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWN0VHlwZScpOwogICAgICBjb25zdCB0eXBlID0gdHlwZUVsID8gKHR5cGVFbC52YWx1ZSB8fCAiIikgOiAiIjsKICAgICAgY29uc3QgYmFzZSA9IFsiPGI+V2hhdCBpcyB0aGlzIGl0ZW0/PC9iPiBZb3VyIGNob2ljZSBjaGFuZ2VzIHdoaWNoIGZpZWxkcyBhcmUgcmVxdWlyZWQuIl07CiAgICAgIGNvbnN0IG1hcCA9IHsKICAgICAgICBmaW5pc2hlZEdvb2Q6CiAgICAgICAgICAiPGI+RmluaXNoZWQgR29vZDo8L2I+IFlvdSBzZWxsIGl0IHRvIGN1c3RvbWVycyAoZS5nLiwgPGk+Q2xhc3NpYyBCdXJnZXI8L2k+KS4gWW914oCZbGwgc2V0IGNhdGVnb3J5LCBwcmVwIGFyZWEsIGFuZCBwcmljZS4iLAogICAgICAgIHJhd01hdGVyaWFsOgogICAgICAgICAgIjxiPlJhdyBNYXRlcmlhbDo8L2I+IFlvdSBkb27igJl0IHNlbGwgaXQ7IHlvdSA8aT51c2U8L2k+IGl0IChlLmcuLCA8aT41IGtnIGJhZyBvZiBmbG91cjwvaT4pLiBZb3XigJlsbCBzZXQgY29zdCBhbmQgc3VwcGxpZWQgcXVhbnRpdHkuIiwKICAgICAgICAiZmluaXNoZWRHb29kICYgcmF3TWF0ZXJpYWwiOgogICAgICAgICAgIjxiPkZpbmlzaGVkIEdvb2QgJiBSYXcgTWF0ZXJpYWw6PC9iPiBZb3Ugc2VsbCBpdCA8aT5hbmQ8L2k+IHVzZSBpdCAoZS5nLiwgPGk+Ym90dGxlZCBzYXVjZTwvaT4pLiBDb25zaWRlciDigJxQdXJjaGFzZWQgZm9yIFJlc2FsZeKAnS4iLAogICAgICAgIE1hbnVmYWN0dXJlZDoKICAgICAgICAgICI8Yj5NYW51ZmFjdHVyZWQ6PC9iPiBZb3UgbWFrZSBpdCBmcm9tIGluZ3JlZGllbnRzIChlLmcuLCA8aT5ob3VzZSBwYXR0eTwvaT4pLiBUcmFjayBpbnZlbnRvcnkgYXMgYSBwcmVwYXJhdGlvbi4iCiAgICAgIH07CiAgICAgIGlmIChtYXBbdHlwZV0pIGJhc2UucHVzaChtYXBbdHlwZV0pOwogICAgICByZXR1cm4gYmFzZS5qb2luKCI8YnI+Iik7CiAgICB9LAogICAgdW9tOiAoKSA9PiAiPGI+VW5pdCBvZiBNZWFzdXJlPC9iPjxicj5Ib3cgeW91IHNlbGwvc3RvY2sgdGhpcyBpdGVtLiBFeGFtcGxlczogZWEsIGtnLCBsLiIsCiAgICBzdXBwbGllZFF1YW50aXR5OiAoKSA9PiB7CiAgICAgIGNvbnN0IHUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndW9tJyk7IGNvbnN0IHYgPSB1ID8gKHUudmFsdWUgfHwgInVuaXQiKSA6ICJ1bml0IjsKICAgICAgcmV0dXJuIGA8Yj5TdXBwbGllZCBRdWFudGl0eTwvYj48YnI+SG93IG11Y2ggeW91IHJlY2VpdmUgZnJvbSB0aGUgc3VwcGxpZXIgKGUuZy4sIDxpPjU8L2k+IGZvciBhIDUgJHt2fSBiYWcpLmA7CiAgICB9LAogICAgZGVmYXVsdFNlbGxpbmdQcmljZTogKCkgPT4gIjxiPkRlZmF1bHQgU2VsbGluZyBQcmljZTwvYj48YnI+VXNlZCBvbmx5IHdoZW4gdGhlcmUgYXJlIG5vIHZhcmlhbnRzLiIsCiAgICBjdXN0b21QbHU6ICgpID0+ICI8Yj5DdXN0b20gQmFzZSBQTFUvU0tVPC9iPjxicj5Vc2UgeW91ciBvd24gY29kZSBpZiB5b3UgYWxyZWFkeSBoYXZlIG9uZTsgb3RoZXJ3aXNlIHdl4oCZbGwgZ2VuZXJhdGUgaXQuIiwKICAgIGhhc0JhcmNvZGU6ICgpID0+ICI8Yj5IYXMgYSBiYXJjb2RlPzwvYj48YnI+Q2hvb3NlIOKAnFllc+KAnSB0byBlbnRlciB0aGUgc2Nhbm5hYmxlIGJhcmNvZGUgbnVtYmVyLiIsCiAgICB2YXJpYW50czogKCkgPT4gIjxiPlZhcmlhbnQgR3JvdXBzPC9iPjxicj5BZGQgb3B0aW9ucyBsaWtlIDxpPlNpemU8L2k+IChTLCBNLCBMKSBvciA8aT5NaWxrPC9pPiAoRnVsbCwgT2F0KS4iCiAgfTsKCiAgZnVuY3Rpb24gY2xlYXJMaW5nZXIobGFiZWwpewogICAgY29uc3QgdCA9IGxpbmdlclRpbWVycy5nZXQobGFiZWwpOwogICAgaWYgKHQpIHsgY2xlYXJUaW1lb3V0KHQpOyBsaW5nZXJUaW1lcnMuZGVsZXRlKGxhYmVsKTsgfQogICAgbGFiZWwuZGF0YXNldC5saW5nZXJBY3RpdmUgPSAiMCI7CiAgfQogIGZ1bmN0aW9uIHN0YXJ0TGluZ2VyKGxhYmVsLCBtcyl7CiAgICBjbGVhckxpbmdlcihsYWJlbCk7CiAgICBsYWJlbC5kYXRhc2V0LmxpbmdlckFjdGl2ZSA9ICIxIjsKICAgIGNvbnN0IHQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgbGFiZWwuZGF0YXNldC5saW5nZXJBY3RpdmUgPSAiMCI7CiAgICAgIGNvbnN0IGN0cmwgPSBmaW5kQ29udHJvbEZvckxhYmVsKGxhYmVsKTsKICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7CiAgICAgIC8vIGlmIGZvY3VzIHJldHVybmVkIHRvIHRoaXMgbGFiZWwvY29udHJvbCwgZG9uJ3QgY2xvc2UKICAgICAgaWYgKGEgJiYgKGxhYmVsLmNvbnRhaW5zKGEpIHx8IChjdHJsICYmIChjdHJsPT09YSB8fCAoY3RybC5jb250YWlucyAmJiBjdHJsLmNvbnRhaW5zKGEpKSkpKSkgcmV0dXJuOwogICAgICBjbG9zZVRpcChsYWJlbCk7CiAgICB9LCBtcyk7CiAgICBsaW5nZXJUaW1lcnMuc2V0KGxhYmVsLCB0KTsKICB9CgogIGZ1bmN0aW9uIGdldFRpcENvbnRlbnQobGFiZWwpIHsKICAgIGNvbnN0IGR5bmFtaWNLZXkgPSBsYWJlbC5kYXRhc2V0LnRpcER5bmFtaWM7CiAgICBjb25zdCBzdGF0aWNUaXRsZSA9IGxhYmVsLmRhdGFzZXQudGlwVGl0bGUgfHwgIiI7CiAgICBjb25zdCBidWJibGUgPSBsYWJlbC5xdWVyeVNlbGVjdG9yKCcudG9vbHRpcHRleHQnKTsKICAgIGNvbnN0IHN0YXRpY0JvZHkgPSBidWJibGUgPyBidWJibGUuaW5uZXJIVE1MIDogIiI7CiAgICBjb25zdCBib2R5ID0gZHluYW1pY0tleSAmJiBkeW5hbWljQm9kaWVzW2R5bmFtaWNLZXldID8gZHluYW1pY0JvZGllc1tkeW5hbWljS2V5XSgpIDogc3RhdGljQm9keTsKICAgIHJldHVybiBgPGRpdiBjbGFzcz0idG9vbHRpcC10ZXh0LWNvbnRlbnQiPiR7c3RhdGljVGl0bGUgPyBgPGI+JHtzdGF0aWNUaXRsZX08L2I+PGJyPmAgOiAiIn0ke2JvZHl9PC9kaXY+YDsKICB9CgogIGZ1bmN0aW9uIHBvc2l0aW9uVGlwKGxhYmVsLCBidWJibGUpIHsKICAgIGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtdG9wJywncG9zLWJvdHRvbScsJ3Bvcy1sZWZ0JywncG9zLXJpZ2h0Jyk7CiAgICBidWJibGUuc3R5bGUubGVmdCA9ICcnOyBidWJibGUuc3R5bGUucmlnaHQgPSAnJzsgYnViYmxlLnN0eWxlLnRvcCA9ICcnOyBidWJibGUuc3R5bGUuYm90dG9tID0gJyc7IGJ1YmJsZS5zdHlsZS50cmFuc2Zvcm0gPSAnJzsKICAgIGNvbnN0IHZ3ID0gd2luZG93LmlubmVyV2lkdGgsIHZoID0gd2luZG93LmlubmVySGVpZ2h0OwogICAgY29uc3QgbHIgPSBsYWJlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGNvbnN0IGN0cmwgPSBmaW5kQ29udHJvbEZvckxhYmVsKGxhYmVsKTsKICAgIGNvbnN0IGNyID0gY3RybCA/IGN0cmwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiBudWxsOwogICAgY29uc3Qgc3BhY2VUb3AgPSBsci50b3A7CiAgICBjb25zdCBzcGFjZUJvdHRvbSA9IHZoIC0gbHIuYm90dG9tOwogICAgY29uc3Qgc3BhY2VMZWZ0ID0gbHIubGVmdDsKICAgIGNvbnN0IHNwYWNlUmlnaHQgPSB2dyAtIGxyLnJpZ2h0OwoKICAgIGZ1bmN0aW9uIG92ZXJsYXBzQ29udHJvbCgpIHsKICAgICAgaWYgKCFjcikgcmV0dXJuIGZhbHNlOwogICAgICBjb25zdCBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgY29uc3Qgbm9PdmVybGFwID0gYnIucmlnaHQgPCBjci5sZWZ0IHx8IGJyLmxlZnQgPiBjci5yaWdodCB8fCBici5ib3R0b20gPCBjci50b3AgfHwgYnIudG9wID4gY3IuYm90dG9tOwogICAgICByZXR1cm4gIW5vT3ZlcmxhcDsKICAgIH0KICAgIGZ1bmN0aW9uIGNsYW1wSG9yaXpvbnRhbCgpIHsKICBjb25zdCBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICBjb25zdCBtYXJnaW4gPSA4OwogIGlmIChici5yaWdodCA+IHZ3IC0gbWFyZ2luKSB7CiAgICBidWJibGUuc3R5bGUucmlnaHQgPSBtYXJnaW4gKyAncHgnOwogICAgYnViYmxlLnN0eWxlLnRyYW5zZm9ybSA9ICdub25lJzsKICB9IGVsc2UgaWYgKGJyLmxlZnQgPCBtYXJnaW4pIHsKICAgIGJ1YmJsZS5zdHlsZS5sZWZ0ID0gbWFyZ2luICsgJ3B4JzsKICAgIGJ1YmJsZS5zdHlsZS50cmFuc2Zvcm0gPSAnbm9uZSc7CiAgfQp9CgogICAgLy8gUHJlZmVyIHRvcCBpZiBpbnB1dCBpcyBkaXJlY3RseSBiZWxvdyB0aGUgbGFiZWwgdG8gYXZvaWQgY292ZXJpbmcgdGhlIGZpZWxkCiAgICBjb25zdCBwcmVmZXJUb3AgPSBjciA/IChjci50b3AgPj0gbHIuYm90dG9tIC0gMikgOiBmYWxzZTsKCiAgICBmdW5jdGlvbiB0cnlCb3R0b20oKXsKICAgICAgYnViYmxlLmNsYXNzTGlzdC5hZGQoJ3Bvcy1ib3R0b20nKTsKICAgICAgbGV0IGJyID0gYnViYmxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICBpZiAoc3BhY2VCb3R0b20gPj0gYnIuaGVpZ2h0ICsgMTIpIHsgY2xhbXBIb3Jpem9udGFsKCk7IHJldHVybiAhb3ZlcmxhcHNDb250cm9sKCk7IH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgZnVuY3Rpb24gdHJ5VG9wKCl7CiAgICAgIGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtYm90dG9tJyk7IGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtdG9wJyk7CiAgICAgIGxldCBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgaWYgKHNwYWNlVG9wID49IGJyLmhlaWdodCArIDEyKSB7IGNsYW1wSG9yaXpvbnRhbCgpOyByZXR1cm4gIW92ZXJsYXBzQ29udHJvbCgpOyB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIGZ1bmN0aW9uIHRyeVJpZ2h0KCl7CiAgICAgIGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtdG9wJywncG9zLWJvdHRvbScpOyBidWJibGUuY2xhc3NMaXN0LmFkZCgncG9zLXJpZ2h0Jyk7CiAgICAgIGxldCBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgcmV0dXJuIHNwYWNlUmlnaHQgPj0gYnIud2lkdGggKyAxMiAmJiAhb3ZlcmxhcHNDb250cm9sKCk7CiAgICB9CiAgICBmdW5jdGlvbiB0cnlMZWZ0KCl7CiAgICAgIGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtcmlnaHQnKTsgYnViYmxlLmNsYXNzTGlzdC5hZGQoJ3Bvcy1sZWZ0Jyk7CiAgICAgIGxldCBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgcmV0dXJuIHNwYWNlTGVmdCA+PSBici53aWR0aCArIDEyICYmICFvdmVybGFwc0NvbnRyb2woKTsKICAgIH0KCiAgICAvLyBQcmlvcml0eTogYXZvaWQgb3ZlcmxhcHBpbmcgdGhlIGNvbnRyb2wuIElmIHByZWZlclRvcCwgdHJ5IHRvcCBmaXJzdC4KICAgIGlmIChwcmVmZXJUb3AgPyAodHJ5VG9wKCkgfHwgdHJ5Qm90dG9tKCkgfHwgdHJ5UmlnaHQoKSB8fCB0cnlMZWZ0KCkpIDogKHRyeUJvdHRvbSgpIHx8IHRyeVRvcCgpIHx8IHRyeVJpZ2h0KCkgfHwgdHJ5TGVmdCgpKSkgcmV0dXJuOwoKICAgIC8vIEZhbGxiYWNrOiBjaG9vc2Ugc2lkZSB3aXRoIG1vc3Qgc3BhY2UsIHRoZW4gY2xhbXAgc2l6ZSBhbmQgZW5zdXJlIG5vdCBvdmVybGFwcGluZwogICAgYnViYmxlLmNsYXNzTGlzdC5yZW1vdmUoJ3Bvcy1sZWZ0JywncG9zLXJpZ2h0JywncG9zLXRvcCcsJ3Bvcy1ib3R0b20nKTsKICAgIGlmIChNYXRoLm1heChzcGFjZUJvdHRvbSwgc3BhY2VUb3ApID49IE1hdGgubWF4KHNwYWNlTGVmdCwgc3BhY2VSaWdodCkpIHsKICAgICAgaWYgKHNwYWNlQm90dG9tID49IHNwYWNlVG9wKSB7IGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtYm90dG9tJyk7IGJ1YmJsZS5zdHlsZS5tYXhIZWlnaHQgPSBNYXRoLm1heCgxMjAsIHNwYWNlQm90dG9tIC0gMTIpICsgJ3B4JzsgfQogICAgICBlbHNlIHsgYnViYmxlLmNsYXNzTGlzdC5hZGQoJ3Bvcy10b3AnKTsgYnViYmxlLnN0eWxlLm1heEhlaWdodCA9IE1hdGgubWF4KDEyMCwgc3BhY2VUb3AgLSAxMikgKyAncHgnOyB9CiAgICAgIGNsYW1wSG9yaXpvbnRhbCgpOwogICAgICBpZiAob3ZlcmxhcHNDb250cm9sKCkpIHsgYnViYmxlLmNsYXNzTGlzdC5yZW1vdmUoJ3Bvcy10b3AnLCdwb3MtYm90dG9tJyk7IGJ1YmJsZS5jbGFzc0xpc3QuYWRkKHNwYWNlUmlnaHQgPj0gc3BhY2VMZWZ0ID8gJ3Bvcy1yaWdodCcgOiAncG9zLWxlZnQnKTsgfQogICAgfSBlbHNlIHsKICAgICAgYnViYmxlLmNsYXNzTGlzdC5hZGQoc3BhY2VSaWdodCA+PSBzcGFjZUxlZnQgPyAncG9zLXJpZ2h0JyA6ICdwb3MtbGVmdCcpOwogICAgICBjb25zdCBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgaWYgKHNwYWNlUmlnaHQgPCBici53aWR0aCArIDEyICYmIHNwYWNlTGVmdCA8IGJyLndpZHRoICsgMTIpIHsKICAgICAgICBidWJibGUuc3R5bGUubWF4V2lkdGggPSBNYXRoLm1heCgxODAsIE1hdGgubWF4KHNwYWNlUmlnaHQsIHNwYWNlTGVmdCkgLSAxMikgKyAncHgnOwogICAgICB9CiAgICB9CiAgewogICAgY29uc3QgbWFyZ2luID0gODsKICAgIGNvbnN0IGJyID0gYnViYmxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgaWYgKGJyLmxlZnQgPCBtYXJnaW4pIHsgYnViYmxlLnN0eWxlLmxlZnQgPSBtYXJnaW4gKyAncHgnOyBidWJibGUuc3R5bGUudHJhbnNmb3JtID0gJ25vbmUnOyB9CiAgfQoKICAgIC8vIFRyeSBib3R0b20KICAgIGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtYm90dG9tJyk7CiAgICBsZXQgYnIgPSBidWJibGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICBpZiAoc3BhY2VCb3R0b20gPj0gYnIuaGVpZ2h0ICsgMTIpIHsKICAgICAgY2xhbXBIb3Jpem9udGFsKCk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIC8vIFRyeSB0b3AKICAgIGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtYm90dG9tJyk7IGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtdG9wJyk7CiAgICBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGlmIChzcGFjZVRvcCA+PSBici5oZWlnaHQgKyAxMikgewogICAgICBjbGFtcEhvcml6b250YWwoKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgLy8gVHJ5IHJpZ2h0CiAgICBidWJibGUuY2xhc3NMaXN0LnJlbW92ZSgncG9zLXRvcCcpOyBidWJibGUuY2xhc3NMaXN0LmFkZCgncG9zLXJpZ2h0Jyk7CiAgICBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGlmIChzcGFjZVJpZ2h0ID49IGJyLndpZHRoICsgMTIpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgLy8gVHJ5IGxlZnQKICAgIGJ1YmJsZS5jbGFzc0xpc3QucmVtb3ZlKCdwb3MtcmlnaHQnKTsgYnViYmxlLmNsYXNzTGlzdC5hZGQoJ3Bvcy1sZWZ0Jyk7CiAgICBiciA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGlmIChzcGFjZUxlZnQgPj0gYnIud2lkdGggKyAxMikgewogICAgICByZXR1cm47CiAgICB9CiAgICAvLyBGYWxsYmFjazogcGljayB0aGUgc2lkZSB3aXRoIG1vc3Qgc3BhY2UgYW5kIGNvbnN0cmFpbiBzaXplCiAgICBidWJibGUuY2xhc3NMaXN0LnJlbW92ZSgncG9zLWxlZnQnLCdwb3MtcmlnaHQnLCdwb3MtdG9wJywncG9zLWJvdHRvbScpOwogICAgaWYgKE1hdGgubWF4KHNwYWNlQm90dG9tLCBzcGFjZVRvcCkgPj0gTWF0aC5tYXgoc3BhY2VMZWZ0LCBzcGFjZVJpZ2h0KSkgewogICAgICAvLyBVc2UgdmVydGljYWwgd2l0aCBtYXgtaGVpZ2h0IGNsYW1wCiAgICAgIGlmIChzcGFjZUJvdHRvbSA+PSBzcGFjZVRvcCkgewogICAgICAgIGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtYm90dG9tJyk7CiAgICAgICAgYnViYmxlLnN0eWxlLm1heEhlaWdodCA9IE1hdGgubWF4KDEyMCwgc3BhY2VCb3R0b20gLSAxMikgKyAncHgnOwogICAgICB9IGVsc2UgewogICAgICAgIGJ1YmJsZS5jbGFzc0xpc3QuYWRkKCdwb3MtdG9wJyk7CiAgICAgICAgYnViYmxlLnN0eWxlLm1heEhlaWdodCA9IE1hdGgubWF4KDEyMCwgc3BhY2VUb3AgLSAxMikgKyAncHgnOwogICAgICB9CiAgICAgIGNsYW1wSG9yaXpvbnRhbCgpOwogICAgfSBlbHNlIHsKICAgICAgLy8gVXNlIGhvcml6b250YWwgd2l0aCB3aWR0aCBjbGFtcAogICAgICBpZiAoc3BhY2VSaWdodCA+PSBzcGFjZUxlZnQpIHsKICAgICAgICBidWJibGUuY2xhc3NMaXN0LmFkZCgncG9zLXJpZ2h0Jyk7CiAgICAgICAgYnViYmxlLnN0eWxlLm1heFdpZHRoID0gTWF0aC5tYXgoMTgwLCBzcGFjZVJpZ2h0IC0gMTIpICsgJ3B4JzsKICAgICAgfSBlbHNlIHsKICAgICAgICBidWJibGUuY2xhc3NMaXN0LmFkZCgncG9zLWxlZnQnKTsKICAgICAgICBidWJibGUuc3R5bGUubWF4V2lkdGggPSBNYXRoLm1heCgxODAsIHNwYWNlTGVmdCAtIDEyKSArICdweCc7CiAgICAgIH0KICB7CiAgICBjb25zdCBtYXJnaW4gPSA4OwogICAgY29uc3QgcmVjdCA9IGJ1YmJsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGlmIChyZWN0LnJpZ2h0ID4gdncgLSBtYXJnaW4pIHsKICAgICAgYnViYmxlLnN0eWxlLnJpZ2h0ID0gbWFyZ2luICsgJ3B4JzsgYnViYmxlLnN0eWxlLnRyYW5zZm9ybSA9ICdub25lJzsKICAgIH0gZWxzZSBpZiAocmVjdC5sZWZ0IDwgbWFyZ2luKSB7CiAgICAgIGJ1YmJsZS5zdHlsZS5sZWZ0ID0gbWFyZ2luICsgJ3B4JzsgYnViYmxlLnN0eWxlLnRyYW5zZm9ybSA9ICdub25lJzsKICAgIH0KICAgIGlmIChyZWN0LnRvcCA8IG1hcmdpbikgewogICAgICBidWJibGUuc3R5bGUuYm90dG9tID0gJ2F1dG8nOyBidWJibGUuc3R5bGUudG9wID0gJzEwMCUnOwogICAgfSBlbHNlIHsKICAgICAgYnViYmxlLnN0eWxlLnRvcCA9ICcnOyBidWJibGUuc3R5bGUuYm90dG9tID0gJzEyNSUnOwogICAgfQogIH0KCn0KICBmdW5jdGlvbiBvcGVuVGlwKGxhYmVsKSB7CiAgICAvLyBDbG9zZSBhbGwgb3RoZXIgb3BlbiB0b29sdGlwcyBmaXJzdAogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvb2x0aXAuaXMtb3BlbicpLmZvckVhY2gobCA9PiB7CiAgICAgIGlmIChsICE9PSBsYWJlbCkgewogICAgICAgIGwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtb3BlbicpOwogICAgICAgIGlmICh3aW5kb3cuX19hY3RpdmVUb29sdGlwTGFiZWwgPT09IGwpIHsgdHJ5IHsgd2luZG93Ll9fYWN0aXZlVG9vbHRpcExhYmVsID0gbnVsbDsgfSBjYXRjaChlKXt9IH0KICAgICAgfQogICAgfSk7CiAgICBjbGVhckxpbmdlcihsYWJlbCk7CiAgICBsYWJlbC5kYXRhc2V0LnRpcFN0YXRlID0gJ29wZW4nOwogICAgbGFiZWwuY2xhc3NMaXN0LmFkZCgnaXMtb3BlbicpOwogICAgY29uc3QgYnViYmxlID0gbGFiZWwucXVlcnlTZWxlY3RvcignLnRvb2x0aXB0ZXh0Jyk7CiAgICB0cnkgeyB3aW5kb3cuX19hY3RpdmVUb29sdGlwTGFiZWwgPSBsYWJlbDsgfSBjYXRjaChlKSB7fQogICAgCiAgICBpZiAoIWJ1YmJsZSkgcmV0dXJuOwogICAgYnViYmxlLnNldEF0dHJpYnV0ZSgncm9sZScsICd0b29sdGlwJyk7CiAgICBidWJibGUuaW5uZXJIVE1MID0gZ2V0VGlwQ29udGVudChsYWJlbCk7CiAgICBwb3NpdGlvblRpcChsYWJlbCwgYnViYmxlKTsKICB9CgogIGZ1bmN0aW9uIGNsb3NlVGlwKGxhYmVsKSB7CiAgICBsYWJlbC5kYXRhc2V0LnRpcFN0YXRlID0gJ2Nsb3NlZCc7CiAgICBsYWJlbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1vcGVuJyk7CiAgICBpZiAod2luZG93Ll9fYWN0aXZlVG9vbHRpcExhYmVsID09PSBsYWJlbCkgeyB0cnkgeyB3aW5kb3cuX19hY3RpdmVUb29sdGlwTGFiZWwgPSBudWxsOyB9IGNhdGNoKGUpe30gfQogIH0KCiAgZnVuY3Rpb24gZmluZENvbnRyb2xGb3JMYWJlbChsYWJlbCkgewogICAgY29uc3QgaHRtbEZvciA9IGxhYmVsLmdldEF0dHJpYnV0ZSgnZm9yJyk7CiAgICBsZXQgY3RybCA9IG51bGw7CiAgICBpZiAoaHRtbEZvcikgY3RybCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGh0bWxGb3IpOwogICAgaWYgKCFjdHJsKSBjdHJsID0gbGFiZWwucXVlcnlTZWxlY3RvcignaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEsIGJ1dHRvbicpOwogICAgaWYgKCFjdHJsKSB7CiAgICAgIGxldCBzaWIgPSBsYWJlbC5uZXh0RWxlbWVudFNpYmxpbmcsIHN0ZXBzID0gMDsKICAgICAgd2hpbGUgKHNpYiAmJiBzdGVwcyA8IDYgJiYgIWN0cmwpIHsKICAgICAgICBpZiAoc2liLm1hdGNoZXMgJiYgc2liLm1hdGNoZXMoJ2lucHV0LHNlbGVjdCx0ZXh0YXJlYSxidXR0b24nKSkgeyBjdHJsID0gc2liOyBicmVhazsgfQoKICAvLyBSb2J1c3RseSBsb2NhdGUgYSB0b29sdGlwIGxhYmVsIGZvciBhIGdpdmVuIGNvbnRyb2wKICBmdW5jdGlvbiBmaW5kTGFiZWxGb3JDb250cm9sKGN0cmwpIHsKICAgIGlmICghY3RybCB8fCAhKGN0cmwgaW5zdGFuY2VvZiBFbGVtZW50KSkgcmV0dXJuIG51bGw7CiAgICAvLyAxKSBEaXJlY3QgYnkgaWQvZm9yCiAgICBpZiAoY3RybC5pZCkgewogICAgICBsZXQgbGFiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnRvb2x0aXBbZm9yPSIke2N0cmwuaWR9Il1gKTsKICAgICAgaWYgKGxhYikgcmV0dXJuIGxhYjsKICAgICAgbGFiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgbGFiZWxbZm9yPSIke2N0cmwuaWR9Il0udG9vbHRpcGApOwogICAgICBpZiAobGFiKSByZXR1cm4gbGFiOwogICAgfQogICAgLy8gMikgQW5jZXN0b3IgdG9vbHRpcAogICAgbGV0IGFuYyA9IGN0cmwuY2xvc2VzdCgnLnRvb2x0aXAnKTsKICAgIGlmIChhbmMpIHJldHVybiBhbmM7CiAgICAvLyAzKSBOZWFyYnkgc2libGluZ3MgKGJlZm9yZS9hZnRlcikKICAgIGxldCBjdXIgPSBjdHJsLnByZXZpb3VzRWxlbWVudFNpYmxpbmcsIHN0ZXBzPTA7CiAgICB3aGlsZSAoY3VyICYmIHN0ZXBzIDwgOCkgewogICAgICBpZiAoY3VyLmNsYXNzTGlzdCAmJiBjdXIuY2xhc3NMaXN0LmNvbnRhaW5zKCd0b29sdGlwJykpIHJldHVybiBjdXI7CiAgICAgIGlmIChjdXIubWF0Y2hlcyAmJiBjdXIubWF0Y2hlcygnbGFiZWwudG9vbHRpcCcpKSByZXR1cm4gY3VyOwogICAgICBjdXIgPSBjdXIucHJldmlvdXNFbGVtZW50U2libGluZzsgc3RlcHMrKzsKICAgIH0KICAgIGN1ciA9IGN0cmwubmV4dEVsZW1lbnRTaWJsaW5nOyBzdGVwcz0wOwogICAgd2hpbGUgKGN1ciAmJiBzdGVwcyA8IDgpIHsKICAgICAgaWYgKGN1ci5jbGFzc0xpc3QgJiYgY3VyLmNsYXNzTGlzdC5jb250YWlucygndG9vbHRpcCcpKSByZXR1cm4gY3VyOwogICAgICBpZiAoY3VyLm1hdGNoZXMgJiYgY3VyLm1hdGNoZXMoJ2xhYmVsLnRvb2x0aXAnKSkgcmV0dXJuIGN1cjsKICAgICAgY3VyID0gY3VyLm5leHRFbGVtZW50U2libGluZzsgc3RlcHMrKzsKICAgIH0KICAgIC8vIDQpIENvbnRhaW5lci1hd2FyZSBzZWFyY2g6IHNjYW4gdXAgYW5jZXN0b3JzLCBwaWNrIG5lYXJlc3QgdG9vbHRpcCBsYWJlbCBhYm92ZSB0aGUgY29udHJvbAogICAgY29uc3QgY2FuZGlkYXRlcyA9IFtdOwogICAgbGV0IHAgPSBjdHJsLnBhcmVudEVsZW1lbnQ7IGxldCBkZXB0aCA9IDA7CiAgICBjb25zdCBtYXhEZXB0aCA9IDQ7CiAgICB3aGlsZSAocCAmJiBkZXB0aCA8IG1heERlcHRoKSB7CiAgICAgIHAucXVlcnlTZWxlY3RvckFsbCAmJiBwLnF1ZXJ5U2VsZWN0b3JBbGwoJ2xhYmVsLnRvb2x0aXAsIC50b29sdGlwJykuZm9yRWFjaChlbCA9PiB7IGlmIChlbCBpbnN0YW5jZW9mIEVsZW1lbnQpIGNhbmRpZGF0ZXMucHVzaChlbCk7IH0pOwogICAgICBwID0gcC5wYXJlbnRFbGVtZW50OyBkZXB0aCsrOwogICAgfQogICAgaWYgKGNhbmRpZGF0ZXMubGVuZ3RoKSB7CiAgICAgIGNvbnN0IGNSZWN0ID0gY3RybC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgbGV0IGJlc3QgPSBudWxsLCBiZXN0U2NvcmUgPSBJbmZpbml0eTsKICAgICAgY2FuZGlkYXRlcy5mb3JFYWNoKGxhYiA9PiB7CiAgICAgICAgY29uc3QgciA9IGxhYi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICAvLyBQcmVmZXIgbGFiZWxzIHRoYXQgYXJlIGFib3ZlIHRoZSBjb250cm9sIGFuZCBob3Jpem9udGFsbHkgb3ZlcmxhcHBpbmcKICAgICAgICBjb25zdCBob3Jpek92ZXJsYXAgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihyLnJpZ2h0LCBjUmVjdC5yaWdodCkgLSBNYXRoLm1heChyLmxlZnQsIGNSZWN0LmxlZnQpKTsKICAgICAgICBjb25zdCB2ZXJ0aWNhbERlbHRhID0gY1JlY3QudG9wIC0gci5ib3R0b207IC8vIHBvc2l0aXZlIGlmIGxhYmVsIGlzIGFib3ZlCiAgICAgICAgaWYgKHZlcnRpY2FsRGVsdGEgPj0gLTYgJiYgaG9yaXpPdmVybGFwID4gMCkgewogICAgICAgICAgY29uc3Qgc2NvcmUgPSB2ZXJ0aWNhbERlbHRhICsgKE1hdGguYWJzKChyLmxlZnQgKyByLnJpZ2h0KS8yIC0gKGNSZWN0LmxlZnQgKyBjUmVjdC5yaWdodCkvMikgKiAwLjAxKTsKICAgICAgICAgIGlmIChzY29yZSA8IGJlc3RTY29yZSkgeyBiZXN0U2NvcmUgPSBzY29yZTsgYmVzdCA9IGxhYjsgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGlmIChiZXN0KSByZXR1cm4gYmVzdDsKICAgICAgLy8gZmFsbGJhY2s6IG5lYXJlc3QgYnkgZGlzdGFuY2UKICAgICAgbGV0IGJlc3RBbnkgPSBudWxsLCBiZXN0RGlzdCA9IEluZmluaXR5OwogICAgICBjYW5kaWRhdGVzLmZvckVhY2gobGFiID0+IHsKICAgICAgICBjb25zdCByID0gbGFiLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGNvbnN0IGR4ID0gKHIubGVmdCArIHIucmlnaHQpLzIgLSAoY1JlY3QubGVmdCArIGNSZWN0LnJpZ2h0KS8yOwogICAgICAgIGNvbnN0IGR5ID0gKHIudG9wICsgci5ib3R0b20pLzIgLSAoY1JlY3QudG9wICsgY1JlY3QuYm90dG9tKS8yOwogICAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLmh5cG90KGR4LCBkeSk7CiAgICAgICAgaWYgKGRpc3QgPCBiZXN0RGlzdCkgeyBiZXN0RGlzdCA9IGRpc3Q7IGJlc3RBbnkgPSBsYWI7IH0KICAgICAgfSk7CiAgICAgIGlmIChiZXN0QW55KSByZXR1cm4gYmVzdEFueTsKICAgIH0KICAgIHJldHVybiBudWxsOwogIH0KICAgICAgICBpZiAoc2liLnF1ZXJ5U2VsZWN0b3IpIHsgY29uc3QgZm91bmQgPSBzaWIucXVlcnlTZWxlY3RvcignaW5wdXQsc2VsZWN0LHRleHRhcmVhLGJ1dHRvbicpOyBpZiAoZm91bmQpIHsgY3RybCA9IGZvdW5kOyBicmVhazsgfSB9CiAgICAgICAgc2liID0gc2liLm5leHRFbGVtZW50U2libGluZzsgc3RlcHMrKzsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGN0cmw7CiAgfQoKICBmdW5jdGlvbiB3aXJlUGFpcihjdHJsLCBsYWJlbCkgewogICAgaWYgKGxhYmVsLmRhdGFzZXQudG9vbHRpcFdpcmVkID09PSAnMScpIHJldHVybjsKICAgIGxhYmVsLmRhdGFzZXQudG9vbHRpcFdpcmVkID0gJzEnOwoKICAgIGxldCBwcmVzc1RpbWVyID0gbnVsbDsKCiAgICAvLyBDbGlja2luZyB0aGUgbGFiZWwgdG9nZ2xlcyAoYnV0IGlnbm9yZSBpZiBjbGlja2luZyB0aGUgY29udHJvbCBpbnNpZGUgaXQpCiAgICBsYWJlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CiAgICAgIGlmICgoZS50YXJnZXQgaW5zdGFuY2VvZiBFbGVtZW50KSAmJiAoZS50YXJnZXQubWF0Y2hlcygnaW5wdXQsc2VsZWN0LHRleHRhcmVhLGJ1dHRvbicpIHx8IGUudGFyZ2V0LmNsb3Nlc3QoJy50b29sdGlwdGV4dCcpKSkgcmV0dXJuOwogICAgICBpZiAobGFiZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdpcy1vcGVuJykpIGNsb3NlVGlwKGxhYmVsKTsKICAgICAgZWxzZSBvcGVuVGlwKGxhYmVsKTsKICAgIH0pOwogICAgbGFiZWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsICgpID0+IHsgcHJlc3NUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gb3BlblRpcChsYWJlbCksIExPTkdfUFJFU1NfTVMpOyB9LCB7cGFzc2l2ZTp0cnVlfSk7CiAgICBsYWJlbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsICgpID0+IGNsZWFyVGltZW91dChwcmVzc1RpbWVyKSk7CgogICAgLy8gQ29udHJvbCBpbnRlcmFjdGlvbnM6IG9wZW4gb24gZm9jdXMvY2xpY2svaW5wdXQ7IERPIE5PVCBhdXRvLWNsb3NlIGhlcmUKICAgIGlmIChjdHJsKSB7CiAgICAgIFsnZm9jdXMnLCdjbGljaycsJ2lucHV0J10uZm9yRWFjaChldnQgPT4gY3RybC5hZGRFdmVudExpc3RlbmVyKGV2dCwgKCkgPT4gb3BlblRpcChsYWJlbCkpKTsKICAgICAgY3RybC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsICgpID0+IG9wZW5UaXAobGFiZWwpKTsKICAgICAgY3RybC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7IG9wZW5UaXAobGFiZWwpOyAvKiBubyBsaW5nZXIgaGVyZTsgYmx1ciB3aWxsIGhhbmRsZSBpdCAqLyB9KTsKICAgIH0KCiAgICAvLyBLZWVwIG9wZW4gd2hpbGUgZm9jdXNlZAogICAgbGFiZWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsICgpID0+IG9wZW5UaXAobGFiZWwpKTsKICAgIGlmIChjdHJsKSBjdHJsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCAoKSA9PiBvcGVuVGlwKGxhYmVsKSk7CgogICAgLy8gT24gYmx1ciBvZiBsYWJlbCBvciBjb250cm9sLCBsaW5nZXIgMXMgdGhlbiBjbG9zZSAodW5sZXNzIGZvY3VzIHJldHVybnMpCiAgICBmdW5jdGlvbiBvbkJsdXJTY2hlZHVsZUxpbmdlcigpewogICAgICBzdGFydExpbmdlcihsYWJlbCwgTElOR0VSX09OX0JMVVJfTVMpOwogICAgfQogICAgbGFiZWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBvbkJsdXJTY2hlZHVsZUxpbmdlciwgdHJ1ZSk7CiAgICBpZiAoY3RybCkgY3RybC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIG9uQmx1clNjaGVkdWxlTGluZ2VyLCB0cnVlKTsKCiAgICAvLyBFc2MgY2xvc2VzIGltbWVkaWF0ZWx5CiAgICBmdW5jdGlvbiBlc2NIYW5kbGVyKGUpeyBpZiAoZS5rZXk9PT0nRXNjYXBlJyl7IGNsZWFyTGluZ2VyKGxhYmVsKTsgY2xvc2VUaXAobGFiZWwpOyB9IH0KICAgIGxhYmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlc2NIYW5kbGVyKTsKICAgIGlmIChjdHJsKSBjdHJsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlc2NIYW5kbGVyKTsKICAKICAgIC8vIFByZXZlbnQgY2xpY2tzIGluc2lkZSBidWJibGUgZnJvbSB0b2dnbGluZy9jbG9zaW5nIHRoZSBsYWJlbAogICAgY29uc3QgYnViYmxlRWwgPSBsYWJlbC5xdWVyeVNlbGVjdG9yKCcudG9vbHRpcHRleHQnKTsKICAgIGlmIChidWJibGVFbCkgewogICAgICBjb25zdCBzdG9wID0gKGV2KSA9PiB7IGV2LnN0b3BQcm9wYWdhdGlvbigpOyB9OwogICAgICBidWJibGVFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN0b3AsIHRydWUpOwogICAgICBidWJibGVFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBzdG9wLCB0cnVlKTsKICAgICAgYnViYmxlRWwuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCBzdG9wLCB0cnVlKTsKICAgIH0KCiAgICAvLyBIb3ZlciBzdXBwb3J0OiBzaG93IG9uIGhvdmVyIG9mIHRoZSB0aXRsZS9sYWJlbCwgY2xvc2UgYWZ0ZXIgbGluZ2VyIG9uIGxlYXZlCiAgICBsYWJlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4gb3BlblRpcChsYWJlbCkpOwogICAgbGFiZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHN0YXJ0TGluZ2VyKGxhYmVsLCBMSU5HRVJfT05fQkxVUl9NUykpOwogIH0KCiAgZnVuY3Rpb24gYnVpbGRQYWlyc0FuZFdpcmUoKSB7CiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9vbHRpcCcpLmZvckVhY2gobGFiZWwgPT4gewogICAgICBjb25zdCBjdHJsID0gZmluZENvbnRyb2xGb3JMYWJlbChsYWJlbCk7CiAgICAgIHdpcmVQYWlyKGN0cmwsIGxhYmVsKTsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gaW5pdCgpIHsKICAgIGJ1aWxkUGFpcnNBbmRXaXJlKCk7CgogICAgLy8gQWxsb3cgZXh0ZXJuYWwgInNtYXJ0VG9vbHRpcDpvcGVuIiByZXF1ZXN0cyAoZS5nLiwgdHV0b3JpYWwpCiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdzbWFydFRvb2x0aXA6b3BlbicsIChlKSA9PiB7CiAgICAgIGNvbnN0IGxhYmVsID0gZS50YXJnZXQuY2xvc2VzdCgnLnRvb2x0aXAnKTsKICAgICAgaWYgKGxhYmVsKSBvcGVuVGlwKGxhYmVsKTsKICAgIH0sIHRydWUpOwoKICAgIC8vIE9wZW4gdG9vbHRpcCB3aGVuIGEgY29udHJvbCBpcyBtYXJrZWQgaW52YWxpZCBieSBhZGRpbmcgY2xhc3M7IHRocm90dGxlZCBieSByQUYKICAgIGxldCBzY2hlZHVsZWQgPSBmYWxzZTsKICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dHMpID0+IHsKICAgICAgaWYgKHNjaGVkdWxlZCkgcmV0dXJuOwogICAgICBzY2hlZHVsZWQgPSB0cnVlOwogICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gewogICAgICAgIHNjaGVkdWxlZCA9IGZhbHNlOwogICAgICAgIG11dHMuZm9yRWFjaChtID0+IHsKICAgICAgICAgIGNvbnN0IGVsID0gbS50YXJnZXQ7CiAgICAgICAgICBpZiAoIShlbCBpbnN0YW5jZW9mIEVsZW1lbnQpKSByZXR1cm47CiAgICAgICAgICBpZiAoIWVsLm1hdGNoZXMoJ2lucHV0LHNlbGVjdCx0ZXh0YXJlYScpKSByZXR1cm47CiAgICAgICAgICBpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdpbnB1dC1pbnZhbGlkJykpIHsKICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAudG9vbHRpcFtmb3I9IiR7ZWwuaWR9Il1gKSB8fCBlbC5jbG9zZXN0KCcudG9vbHRpcCcpOwogICAgICAgICAgICBpZiAobGFiZWwpIG9wZW5UaXAobGFiZWwpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pOwogICAgb2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7c3VidHJlZTp0cnVlLCBhdHRyaWJ1dGVzOnRydWUsIGF0dHJpYnV0ZUZpbHRlcjpbJ2NsYXNzJ119KTsKICB9CgogIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnbG9hZGluZycpIHsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0LCB7b25jZTp0cnVlfSk7CiAgfSBlbHNlIHsKICAgIGluaXQoKTsKICB9CgogIC8vIE1pbmltYWwgcHVibGljIEFQSQogIHdpbmRvdy5TbWFydFRvb2x0aXBzID0gd2luZG93LlNtYXJ0VG9vbHRpcHMgfHwgewogICAgb3BlbkZvcih0YXJnZXQpewogICAgICBjb25zdCBlbCA9ICh0eXBlb2YgdGFyZ2V0PT09J3N0cmluZycpID8gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpIDogdGFyZ2V0OwogICAgICBpZiAoIWVsKSByZXR1cm4gZmFsc2U7CiAgICAgIGNvbnN0IGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAudG9vbHRpcFtmb3I9IiR7ZWwuaWR9Il1gKSB8fCBlbC5jbG9zZXN0KCcudG9vbHRpcCcpOwogICAgICBpZiAobCl7IG9wZW5UaXAobCk7IGVsLmZvY3VzICYmIGVsLmZvY3VzKCk7IHJldHVybiB0cnVlOyB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBjbG9zZUFsbCgpeyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9vbHRpcC5pcy1vcGVuJykuZm9yRWFjaChsID0+IGwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtb3BlbicpKTsgfQogIH07Cn0KfSkoKTsKPC9zY3JpcHQ+CjxzY3JpcHQ+Ci8qIFByb2R1Y3QgVHlwZSBVWDoKICAgLSBkZWZhdWx0IG9wdGlvbiAiLSBTZWxlY3QgLSIKICAgLSBzaG93IEFMTCBleHBsYW5hdGlvbnMgb24gZm9jdXMgd2hlbiB1bnNlbGVjdGVkCiAgIC0gc3dpdGNoIHRvIGZvY3VzZWQgZXhhbXBsZSBhZnRlciBzZWxlY3Rpb24gKyAiU2hvdyBhbGwgdHlwZXMiIHRvZ2dsZQoqLwooZnVuY3Rpb24gKCkgewogIGNvbnN0IEZJRUxEX0lEID0gInByb2R1Y3RUeXBlIjsKCiAgZnVuY3Rpb24gZW5zdXJlRGVmYXVsdE9wdGlvbigpIHsKICAgIGNvbnN0IHNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKEZJRUxEX0lEKTsKICAgIGlmICghc2VsKSByZXR1cm47CiAgICBjb25zdCBoYXNCbGFuayA9IEFycmF5LmZyb20oc2VsLm9wdGlvbnMpLnNvbWUobyA9PiBvLnZhbHVlID09PSAiIiAmJiAvc2VsZWN0L2kudGVzdChvLnRleHRDb250ZW50IHx8ICIiKSk7CiAgICBpZiAoIWhhc0JsYW5rKSB7CiAgICAgIGNvbnN0IG9wdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpOwogICAgICBvcHQudmFsdWUgPSAiIjsgb3B0LnRleHRDb250ZW50ID0gIi0gU2VsZWN0IC0iOyBvcHQuZGlzYWJsZWQgPSB0cnVlOwogICAgICBzZWwuaW5zZXJ0QmVmb3JlKG9wdCwgc2VsLmZpcnN0Q2hpbGQpOwogICAgfQogICAgY29uc3Qgb2sgPSBBcnJheS5mcm9tKHNlbC5vcHRpb25zKS5zb21lKG8gPT4gby52YWx1ZSA9PT0gc2VsLnZhbHVlICYmICFvLmRpc2FibGVkKTsKICAgIGlmICghb2spIHsgc2VsLnZhbHVlID0gIiI7IGNvbnN0IGJsYW5rID0gQXJyYXkuZnJvbShzZWwub3B0aW9ucykuZmluZChvID0+IG8udmFsdWUgPT09ICIiKTsgaWYgKGJsYW5rKSBibGFuay5zZWxlY3RlZCA9IHRydWU7IH0KICB9CgogIGNvbnN0IGh0bWxBbGwgPSAoKSA9PiBbCiAgICAiPGI+V2hhdCBpcyB0aGlzIGl0ZW0/PC9iPiBZb3VyIGNob2ljZSBjaGFuZ2VzIHdoaWNoIGZpZWxkcyBhcmUgcmVxdWlyZWQuPGJyPjxicj4iLAogICAgIjx1bCBzdHlsZT0nbWFyZ2luOjAgMCAwLjVyZW0gMS4ycmVtOyBwYWRkaW5nOjA7Jz4iLAogICAgIjxsaT48Yj5GaW5pc2hlZCBHb29kPC9iPjogWW91IHNlbGwgaXQgdG8gY3VzdG9tZXJzIChlLmcuLCA8aT5DbGFzc2ljIEJ1cmdlcjwvaT4pLiBZb3XigJlsbCBzZXQgY2F0ZWdvcnksIHByZXAgYXJlYSwgYW5kIHByaWNlLjwvbGk+IiwKICAgICI8bGk+PGI+UmF3IE1hdGVyaWFsPC9iPjogWW91IGRvbid0IHNlbGwgaXQ7IHlvdSA8aT51c2U8L2k+IGl0IChlLmcuLCA8aT41IGtnIGJhZyBvZiBmbG91cjwvaT4pLiBZb3XigJlsbCBzZXQgY29zdCBhbmQgc3VwcGxpZWQgcXVhbnRpdHkuPC9saT4iLAogICAgIjxsaT48Yj5GaW5pc2hlZCBHb29kICYgUmF3IE1hdGVyaWFsPC9iPjogWW91IHNlbGwgaXQgPGk+YW5kPC9pPiB1c2UgaXQgKGUuZy4sIDxpPmJvdHRsZWQgc2F1Y2U8L2k+KS4gQ29uc2lkZXIg4oCcUHVyY2hhc2VkIGZvciBSZXNhbGXigJ0uPC9saT4iLAogICAgIjxsaT48Yj5NYW51ZmFjdHVyZWQ8L2I+OiBZb3UgbWFrZSBpdCBmcm9tIGluZ3JlZGllbnRzIChlLmcuLCA8aT5ob3VzZSBwYXR0eTwvaT4pLiBUcmFjayBpbnZlbnRvcnkgYXMgYSBwcmVwYXJhdGlvbi48L2xpPiIsCiAgICAiPC91bD4iLAogICAgIjxkaXYgc3R5bGU9J2ZvbnQtc2l6ZToxMnB4O2NvbG9yOiM1NTUnPlRpcDogWW91IGNhbiBjaGFuZ2UgdGhpcyBsYXRlcuKAlGRvd25zdHJlYW0gZmllbGRzIHdpbGwgYWRqdXN0LjwvZGl2PiIKICBdLmpvaW4oIiIpOwoKICBjb25zdCBodG1sRm9yID0gKHZhbDApID0+IHsKICAgIGNvbnN0IHYgPSBTdHJpbmcodmFsMCB8fCAiIikudHJpbSgpLnRvTG93ZXJDYXNlKCk7CiAgICBjb25zdCB0b2dnbGUgPSAnPGRpdiBzdHlsZT0ibWFyZ2luLXRvcDo4cHg7Ij48YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9InB0LXZpZXctYWxsIiBzdHlsZT0iZm9udC1zaXplOjEycHg7YmFja2dyb3VuZDpub25lO2JvcmRlcjpub25lO2NvbG9yOiMwYTY7Y3Vyc29yOnBvaW50ZXI7cGFkZGluZzowOyI+U2hvdyBhbGwgdHlwZXM8L2J1dHRvbj48L2Rpdj4nOwogICAgaWYgKHYgPT09ICJmaW5pc2hlZGdvb2QiIHx8IHYgPT09ICJmaW5pc2hlZCBnb29kIikgewogICAgICByZXR1cm4gIjxiPkZpbmlzaGVkIEdvb2Q8L2I+PGJyPllvdSBzZWxsIHRoaXMgdG8gY3VzdG9tZXJzIChlLmcuLCA8aT5DbGFzc2ljIEJ1cmdlcjwvaT4pLiBTZXQgY2F0ZWdvcnksIHByZXAgYXJlYSwgYW5kIHByaWNlLjxicj48Yj5FeGFtcGxlOjwvYj4gQSBidXJnZXIgeW91IHNlbGwgb24gdGhlIG1lbnUuIiArIHRvZ2dsZTsKICAgIH0KICAgIGlmICh2ID09PSAicmF3bWF0ZXJpYWwiIHx8IHYgPT09ICJyYXcgbWF0ZXJpYWwiKSB7CiAgICAgIHJldHVybiAiPGI+UmF3IE1hdGVyaWFsPC9iPjxicj5Zb3UgZG9u4oCZdCBzZWxsIHRoaXMgZGlyZWN0bHk7IHlvdSA8aT51c2U8L2k+IGl0IHRvIG1ha2Ugb3RoZXIgaXRlbXMuIFlvdeKAmWxsIHNldCBjb3N0IGFuZCBzdXBwbGllZCBxdWFudGl0eS48YnI+PGI+RXhhbXBsZTo8L2I+IEEgPGk+NSBrZyBiYWcgb2YgZmxvdXI8L2k+IHVzZWQgaW4gYmFraW5nLiIgKyB0b2dnbGU7CiAgICB9CiAgICBpZiAodiA9PT0gImZpbmlzaGVkZ29vZCAmIHJhd21hdGVyaWFsIiB8fCB2ID09PSAiZmluaXNoZWRnb29kJnJhd21hdGVyaWFsIiB8fCB2ID09PSAiZmluaXNoZWQgZ29vZCAmIHJhdyBtYXRlcmlhbCIpIHsKICAgICAgcmV0dXJuICI8Yj5GaW5pc2hlZCBHb29kICYgUmF3IE1hdGVyaWFsPC9iPjxicj5Zb3UgYm90aCBzZWxsIHRoaXMgYW5kIHVzZSBpdCBlbHNld2hlcmUuIENvbnNpZGVyIOKAnFB1cmNoYXNlZCBmb3IgUmVzYWxl4oCdLjxicj48Yj5FeGFtcGxlOjwvYj4gQSA8aT5ib3R0bGVkIHNhdWNlPC9pPiB5b3Ugc2VsbCBhbmQgYWxzbyB1c2UgaW4gcmVjaXBlcy4iICsgdG9nZ2xlOwogICAgfQogICAgaWYgKHYgPT09ICJtYW51ZmFjdHVyZWQiKSB7CiAgICAgIHJldHVybiAiPGI+TWFudWZhY3R1cmVkPC9iPjxicj5Zb3UgbWFrZSB0aGlzIGZyb20gaW5ncmVkaWVudHMgYW5kIHRyYWNrIGl0cyBwcmVwIChiYXRjaGluZywgeWllbGRzKS48YnI+PGI+RXhhbXBsZTo8L2I+IEFuIDxpPmluLWhvdXNlIHBhdHR5PC9pPiBwcmVwYXJlZCBmcm9tIG1pbmNlIGFuZCBzcGljZXMuIiArIHRvZ2dsZTsKICAgIH0KICAgIHJldHVybiBodG1sQWxsKCk7CiAgfTsKCiAgZnVuY3Rpb24gZ2V0TGFiZWxBbmRCdWJibGUoKSB7CiAgICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b29sdGlwW2Zvcj0iJyArIEZJRUxEX0lEICsgJyJdJykgfHwKICAgICAgKGZ1bmN0aW9uKCl7IGNvbnN0IGN0cmw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRklFTERfSUQpOyByZXR1cm4gY3RybD8gY3RybC5jbG9zZXN0KCcudG9vbHRpcCcpOiBudWxsOyB9KSgpOwogICAgaWYgKCFsYWJlbCkgcmV0dXJuIHt9OwogICAgcmV0dXJuIHsgbGFiZWwsIGJ1YmJsZTogbGFiZWwucXVlcnlTZWxlY3RvcignLnRvb2x0aXB0ZXh0JykgfTsKICB9CgogIGZ1bmN0aW9uIHJlZnJlc2goeyBrZWVwT3BlbkFmdGVyPWZhbHNlLCBvcGVuPWZhbHNlIH0gPSB7fSkgewogICAgY29uc3Qgc2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoRklFTERfSUQpOwogICAgY29uc3QgeyBsYWJlbCwgYnViYmxlIH0gPSBnZXRMYWJlbEFuZEJ1YmJsZSgpOwogICAgaWYgKCFzZWwgfHwgIWxhYmVsIHx8ICFidWJibGUpIHJldHVybjsKICAgIGNvbnN0IHZhbCA9IHNlbC52YWx1ZSB8fCAiIjsKICAgIGJ1YmJsZS5pbm5lckhUTUwgPSB2YWwgPyBodG1sRm9yKHZhbCkgOiBodG1sQWxsKCk7CiAgICAKICAgIGlmIChvcGVuKSB7IGxhYmVsLmNsYXNzTGlzdC5hZGQoJ2lzLW9wZW4nKTsgfSBlbHNlIHsgbGFiZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtb3BlbicpOyB9CgogICAgY29uc3QgYnRuID0gYnViYmxlLnF1ZXJ5U2VsZWN0b3IoJy5wdC12aWV3LWFsbCcpOwogICAgaWYgKGJ0bikgewogICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiBvbkNsaWNrKCkgewogICAgICAgIGJ1YmJsZS5pbm5lckhUTUwgPSBodG1sQWxsKCk7CiAgICAgICAgbGFiZWwuY2xhc3NMaXN0LmFkZCgnaXMtb3BlbicpOwogICAgICAgIHRyeSB7IGJ0bi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xpY2ssIHRydWUpOyB9IGNhdGNoIChlKSB7fQogICAgICB9LCB0cnVlKTsKICAgIH0KICAgIGlmIChrZWVwT3BlbkFmdGVyKSB7CiAgICAgIGNsZWFyVGltZW91dChyZWZyZXNoLl90KTsKICAgICAgcmVmcmVzaC5fdCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50ICE9PSBzZWwgJiYgIWxhYmVsLmNvbnRhaW5zKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpKSB7CiAgICAgICAgICBsYWJlbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1vcGVuJyk7CiAgICAgICAgfQogICAgICB9LCAxMDAwKTsgLy8gYWxpZ24gd2l0aCBibHVyIGxpbmdlcgogICAgfQogIH0KCiAgZnVuY3Rpb24gd2lyZSgpIHsKICAgIGNvbnN0IHNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKEZJRUxEX0lEKTsKICAgIGlmICghc2VsIHx8IHNlbC5kYXRhc2V0LnB0V2lyZWQgPT09ICcxJykgcmV0dXJuOwogICAgc2VsLmRhdGFzZXQucHRXaXJlZCA9ICcxJzsKICAgIGVuc3VyZURlZmF1bHRPcHRpb24oKTsKCiAgICBjb25zdCB7bGFiZWx9ID0gZ2V0TGFiZWxBbmRCdWJibGUoKTsKICAgIC8vIHJlbmRlciBvbmNlIGluaXRpYWxseSAobm8gYXV0by1vcGVuKQogICAgcmVmcmVzaCh7b3BlbjpmYWxzZX0pOwogIH0KCiAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdsb2FkaW5nJykgewogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIHdpcmUpOwogIH0gZWxzZSB7CiAgICB3aXJlKCk7CiAgfQp9KSgpOwo8L3NjcmlwdD4KPHNjcmlwdD4oZnVuY3Rpb24oKXsgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvb2x0aXAuaXMtb3BlbicpLmZvckVhY2goZWw9PmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLW9wZW4nKSk7IH0pKCk7PC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPg==</script>
<script id="b64-recipe" type="application/json">PCFET0NUWVBFIGh0bWw+Cgo8aHRtbCBsYW5nPSJlbiI+CjxoZWFkPgo8bWV0YSBjaGFyc2V0PSJ1dGYtOCIvPgo8bWV0YSBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIiBuYW1lPSJ2aWV3cG9ydCIvPgo8dGl0bGU+VGFibGUgQnkgWW9jbyBSZWNpcGUgTG9hZGVyPC90aXRsZT4KPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3hsc3gvMC4xOC41L3hsc3guZnVsbC5taW4uanMiPjwvc2NyaXB0Pgo8bGluayBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tIiByZWw9InByZWNvbm5lY3QiLz4KPGxpbmsgY3Jvc3NvcmlnaW49IiIgaHJlZj0iaHR0cHM6Ly9mb250cy5nc3RhdGljLmNvbSIgcmVsPSJwcmVjb25uZWN0Ii8+CjxsaW5rIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9UG9wcGluczp3Z2h0QDQwMDs1MDA7NjAwOzcwMCZhbXA7ZGlzcGxheT1zd2FwIiByZWw9InN0eWxlc2hlZXQiLz4KPHN0eWxlPgogICAgOnJvb3QgewogICAgICAtLXlvY28tYmc6ICMxMjEyMTI7CiAgICAgIC0teW9jby1zdXJmYWNlOiAjMWUxZTFlOwogICAgICAtLXlvY28tc3VyZmFjZS1saWdodDogIzJhMmEyYTsKICAgICAgLS15b2NvLXByaW1hcnk6ICMwMEEzRkY7CiAgICAgIC0teW9jby1wcmltYXJ5LWhvdmVyOiAjMDA4YmRmOwogICAgICAtLXlvY28tdGV4dC1wcmltYXJ5OiAjRkZGRkZGOwogICAgICAtLXlvY28tdGV4dC1zZWNvbmRhcnk6ICNiM2IzYjM7CiAgICAgIC0teW9jby1ib3JkZXI6ICMzMzMzMzM7CiAgICAgIC0teW9jby1ncmVlbjogIzI3YWU2MDsKICAgICAgLS15b2NvLW9yYW5nZTogI2YzOWMxMjsKICAgICAgLS15b2NvLXJlZDogI2ViNTc1NzsKICAgICAgLS1zaGFkb3c6IDAgOHB4IDI0cHggcmdiYSgwLCAwLCAwLCAwLjMpOwogICAgfQoKICAgICogewogICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgICAgbWFyZ2luOiAwOwogICAgICAgIHBhZGRpbmc6IDA7CiAgICB9CgogICAgYm9keSB7CiAgICAgIGZvbnQtZmFtaWx5OiAnUG9wcGlucycsIHNhbnMtc2VyaWY7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tYmcpOwogICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICBwYWRkaW5nOiAyMHB4OwogICAgfQogICAgCiAgICAubWFpbi1oZWFkZXIgewogICAgICAgIG1heC13aWR0aDogMTgwMHB4OwogICAgICAgIG1hcmdpbjogMCBhdXRvIDIwcHggYXV0bzsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQoKICAgIC5tYWluLWhlYWRlciBoMSB7CiAgICAgICAgZm9udC1zaXplOiAyLjVyZW07CiAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDsKICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDkwZGVnLCAjM0I4MkY2LCAjRkZGRkZGKTsKICAgICAgICAtd2Via2l0LWJhY2tncm91bmQtY2xpcDogdGV4dDsKICAgICAgICAtd2Via2l0LXRleHQtZmlsbC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICB9CgogICAgLmhlYWRlci1hY3Rpb25zIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGdhcDogMTVweDsKICAgIH0KCiAgICAuY29udGFpbmVyIHsKICAgICAgICBtYXgtd2lkdGg6IDE4MDBweDsKICAgICAgICBtYXJnaW46IDAgYXV0bzsKICAgICAgICBkaXNwbGF5OiBncmlkOwogICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDJmcjsKICAgICAgICBnYXA6IDIwcHg7CiAgICAgICAgYWxpZ24taXRlbXM6IHN0YXJ0OwogICAgfQogICAgCiAgICAucGFuZWwgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDE2cHg7CiAgICAgICAgcGFkZGluZzogMjVweDsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICB9CgogICAgLnBhbmVsLWhlYWRlciB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBtYXJnaW4tYm90dG9tOiAyMHB4OwogICAgICAgIGZsZXgtc2hyaW5rOiAwOwogICAgfQoKICAgIC5wYW5lbC1oZWFkZXIgaDIgewogICAgICAgIGZvbnQtc2l6ZTogMS44cmVtOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CgogICAgLyogLS0tIExlZnQgUGFuZWw6IEltcG9ydCAmIEluZ3JlZGllbnRzIC0tLSAqLwogICAgLmxlZnQtcGFuZWwgewogICAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgICAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiBhdXRvIDFmcjsKICAgICAgICBnYXA6IDIwcHg7CiAgICAgICAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gMTAwcHgpOwogICAgICAgIHBvc2l0aW9uOiBzdGlja3k7CiAgICAgICAgdG9wOiAyMHB4OwogICAgfQoKICAgIC5pbXBvcnQtc2VjdGlvbiB7CiAgICAgICAgcGFkZGluZzogMjBweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UtbGlnaHQpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgfQoKICAgIC5pbXBvcnQtc2VjdGlvbiAudG9vbHRpcC1jb250YWluZXIgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBnYXA6IDhweDsKICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4OwogICAgfQoKICAgIC5pbXBvcnQtc2VjdGlvbiBsYWJlbCB7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMDsKICAgICAgICBmb250LXdlaWdodDogNTAwOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsKICAgIH0KCiAgICBpbnB1dFt0eXBlPSJmaWxlIl0gewogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CgogICAgLmZpbGUtdXBsb2FkLWJ0biB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICAgIHBhZGRpbmc6IDEycHggMjRweDsKICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvcjogMC4yczsKICAgIH0KCiAgICAuZmlsZS11cGxvYWQtYnRuOmhvdmVyIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnktaG92ZXIpOwogICAgfQoKICAgICNmaWxlTmFtZSB7CiAgICAgICAgbWFyZ2luLXRvcDogMTBweDsKICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tZ3JlZW4pOwogICAgfQoKICAgIC5saWJyYXJ5LXNlY3Rpb24gewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICBvdmVyZmxvdzogaGlkZGVuOyAvKiBSZXN0b3JlZCBmb3IgbmVhdCBjb250YWluZXIgbG9vayAqLwogICAgfQoKICAgIC50YWJzIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsKICAgICAgICBmbGV4LXNocmluazogMDsKICAgICAgICBvdmVyZmxvdy14OiBhdXRvOwogICAgfQoKICAgIC50YWItYnV0dG9uIHsKICAgICAgICBwYWRkaW5nOiAxMHB4IDIwcHg7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgdHJhbnNpdGlvbjogY29sb3IgMC4yczsKICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgfQoKICAgIC50YWItYnV0dG9uLmFjdGl2ZSB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAKICAgIC50YWItYnV0dG9uLmFjdGl2ZTo6YWZ0ZXIgewogICAgICAgIGNvbnRlbnQ6ICcnOwogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICBib3R0b206IC0xcHg7CiAgICAgICAgbGVmdDogMDsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICBoZWlnaHQ6IDJweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgCiAgICAudGFiLWNvbnRlbnQtY29udGFpbmVyIHsKICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICBmbGV4LWdyb3c6IDE7CiAgICB9CgogICAgI3RhYkNvbnRlbnRzIHsKICAgICAgICBmbGV4LWdyb3c6IDE7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgIG1pbi1oZWlnaHQ6IDA7IC8qIFByZXZlbnRzIGZsZXhib3ggb3ZlcmZsb3cgaXNzdWVzICovCiAgICB9CgogICAgLnRhYi1jb250ZW50IHsKICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgIG92ZXJmbG93LXk6IGF1dG87CiAgICAgICAgcGFkZGluZy1yaWdodDogMTBweDsKICAgICAgICAvKiBGaWxsIHRoZSBwYXJlbnQgI3RhYkNvbnRlbnRzIGNvbnRhaW5lciAqLwogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICB0b3A6IDA7CiAgICAgICAgbGVmdDogMDsKICAgICAgICByaWdodDogMDsKICAgICAgICBib3R0b206IDA7CiAgICB9CiAgICAKICAgIC50YWItY29udGVudC5hY3RpdmUgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgIH0KCiAgICAuc2VhcmNoLWJhciB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgcGFkZGluZzogMTBweDsKICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1iZyk7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgICAgZmxleC1zaHJpbms6IDA7CiAgICB9CgogICAgLmluZ3JlZGllbnQtbGlzdCB7CiAgICAgICAgbGlzdC1zdHlsZTogbm9uZTsKICAgIH0KCiAgICAuaW5ncmVkaWVudC1pdGVtIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIHBhZGRpbmc6IDEycHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgIG1hcmdpbi1ib3R0b206IDhweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UtbGlnaHQpOwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuMnMsIHRyYW5zZm9ybSAwLjJzOwogICAgfQogICAgCiAgICAuaW5ncmVkaWVudC1pdGVtOmhvdmVyIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjM2MzYzNjOwogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCg1cHgpOwogICAgfQoKICAgIC5pbmdyZWRpZW50LWl0ZW0gc3BhbiB7CiAgICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgfQogICAgLmluZ3JlZGllbnQtaXRlbSAubmFtZSB7CiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgIH0KICAgIC5pbmdyZWRpZW50LWl0ZW0gLnVvbSB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgICAgIG1hcmdpbi1sZWZ0OiAxMHB4OwogICAgfQogICAgLmluZ3JlZGllbnQtaXRlbSAuY29zdCB7CiAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby1ncmVlbik7CiAgICB9CgogICAgLyogLS0tIFJpZ2h0IFBhbmVscyAtLS0gKi8KICAgIC5yaWdodC1jb2x1bW4gewogICAgICAgIGRpc3BsYXk6IGdyaWQ7CiAgICAgICAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiBhdXRvIGF1dG87CiAgICAgICAgZ2FwOiAyMHB4OwogICAgfQoKICAgIC5yaWdodC1wYW5lbC1ncm91cCAucGFuZWwgewogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICB9CiAgICAucmlnaHQtcGFuZWwtZ3JvdXAgLnBhbmVsLmFjdGl2ZSB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgIH0KICAgIAogICAgLnJlY2lwZS1idWlsZGVyIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgZ2FwOiAyMHB4OwogICAgfQoKICAgIC5tYXN0ZXItcHJvZHVjdC1mb3JtIHsKICAgICAgICBkaXNwbGF5OiBncmlkOwogICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDJmcjsKICAgICAgICBnYXA6IDE1cHg7CiAgICAgICAgcGFkZGluZzogMjBweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UtbGlnaHQpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgICAgYWxpZ24taXRlbXM6IGVuZDsKICAgIH0KCiAgICAuZm9ybS1ncm91cCB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgfQoKICAgIC5mb3JtLWdyb3VwIGxhYmVsIHsKICAgICAgICBtYXJnaW4tYm90dG9tOiA4cHg7CiAgICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgfQoKICAgIC5mb3JtLWdyb3VwIGlucHV0LCAuZm9ybS1ncm91cCBzZWxlY3QgewogICAgICAgIHBhZGRpbmc6IDEycHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWJnKTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICAgIGZvbnQtc2l6ZTogMTZweDsKICAgICAgICBmb250LWZhbWlseTogJ1BvcHBpbnMnLCBzYW5zLXNlcmlmOwogICAgfQogICAgCiAgICAuZm9ybS1ncm91cCBpbnB1dDpyZWFkLW9ubHkgewogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZS1saWdodCk7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgICAgIGJvcmRlci1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICAgICAgcGFkZGluZy1sZWZ0OiAwOwogICAgICAgIGN1cnNvcjogZGVmYXVsdDsKICAgIH0KCgogICAgLyogU3R5bGVzIGZvciBjbGVhcmFibGUgaW5wdXQgKi8KICAgIC5pbnB1dC13aXRoLWNsZWFyIHsKICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgfQogICAgLmlucHV0LXdpdGgtY2xlYXIgaW5wdXQgewogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIHBhZGRpbmctcmlnaHQ6IDMwcHg7IC8qIE1ha2Ugc3BhY2UgZm9yIHRoZSBYICovCiAgICB9CiAgICAuY2xlYXItYnRuLWlucHV0IHsKICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgcmlnaHQ6IDEwcHg7CiAgICAgICAgdG9wOiA1MCU7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgZm9udC1zaXplOiAyMHB4OwogICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICAgIGRpc3BsYXk6IG5vbmU7IC8qIEhpZGUgYnkgZGVmYXVsdCAqLwogICAgICAgIGxpbmUtaGVpZ2h0OiAxOwogICAgICAgIHRyYW5zaXRpb246IGNvbG9yIDAuMnM7CiAgICB9CiAgICAuY2xlYXItYnRuLWlucHV0OmhvdmVyIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgfQoKCiAgICAucmVjaXBlLWRldGFpbHMgewogICAgICAgIGZsZXgtZ3JvdzogMTsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIH0KCiAgICAucmVjaXBlLXRhYmxlLWNvbnRhaW5lciB7CiAgICAgICAgb3ZlcmZsb3cteTogYXV0bzsKICAgIH0KCiAgICB0YWJsZSB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsKICAgIH0KCiAgICB0aCwgdGQgewogICAgICAgIHBhZGRpbmc6IDE0cHg7CiAgICAgICAgdGV4dC1hbGlnbjogbGVmdDsKICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgfQoKICAgIHRoIHsKICAgICAgICBiYWNrZ3JvdW5kOiAjMmEyYTJhOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKICAgICAgICB0ZXh0LXRyYW5zZm9ybTogdXBwZXJjYXNlOwogICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICBsZXR0ZXItc3BhY2luZzogMC44cHg7CiAgICAgICAgcG9zaXRpb246IHN0aWNreTsKICAgICAgICB0b3A6IDA7CiAgICAgICAgei1pbmRleDogMTsKICAgIH0KICAgIAogICAgdGQgaW5wdXRbdHlwZT0ibnVtYmVyIl0sIHRkIGlucHV0W3R5cGU9InRleHQiXSB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgbWluLXdpZHRoOiA4MHB4OwogICAgICAgIHBhZGRpbmc6IDhweDsKICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tYmcpOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgICB9CiAgICB0ZCBpbnB1dFt0eXBlPSJ0ZXh0Il0gewogICAgICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICB9CiAgICB0ZCBpbnB1dFt0eXBlPSJudW1iZXIiXSB7CiAgICAgIC1tb3otYXBwZWFyYW5jZTogdGV4dGZpZWxkOyAvKiBGaXJlZm94ICovCiAgICB9CiAgICAvKiBIaWRlIHNwaW4gYnV0dG9ucyBvbiBudW1iZXIgaW5wdXRzIGZvciBDaHJvbWUsIFNhZmFyaSwgRWRnZSwgT3BlcmEgKi8KICAgIHRkIGlucHV0W3R5cGU9Im51bWJlciJdOjotd2Via2l0LW91dGVyLXNwaW4tYnV0dG9uLAogICAgdGQgaW5wdXRbdHlwZT0ibnVtYmVyIl06Oi13ZWJraXQtaW5uZXItc3Bpbi1idXR0b24gewogICAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAgIG1hcmdpbjogMDsKICAgIH0KICAgIAogICAgLnJlbW92ZS1idG4gewogICAgICAgIGJhY2tncm91bmQ6IG5vbmU7CiAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby1yZWQpOwogICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOwogICAgICAgIGZvbnQtc2l6ZTogMThweDsKICAgIH0KCiAgICAucmVjaXBlLXN1bW1hcnkgewogICAgICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICAgICAgcGFkZGluZzogMjBweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UtbGlnaHQpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBmbGV4LXNocmluazogMDsKICAgICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgICAgZ2FwOiAxNXB4OwogICAgfQoKICAgIC5jb3N0LWRldGFpbHMgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgICBnYXA6IDhweDsKICAgIH0KCiAgICAucmVjaXBlLXN1bW1hcnkgLnRvdGFsLWNvc3QsIC5yZWNpcGUtc3VtbWFyeSAuc2VsbGluZy1wcmljZSwgLnJlY2lwZS1zdW1tYXJ5IC5ncC1wZXJjZW50YWdlIHsKICAgICAgICBmb250LXNpemU6IDEuMnJlbTsKICAgICAgICBmb250LXdlaWdodDogNzAwOwogICAgfQoKICAgIC5yZWNpcGUtc3VtbWFyeSAudG90YWwtY29zdCBzcGFuIHsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby1ncmVlbik7CiAgICB9CgogICAgLnJlY2lwZS1zdW1tYXJ5IC5zZWxsaW5nLXByaWNlIHNwYW4gewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgCiAgICAucmVjaXBlLXN1bW1hcnkgLmdwLXBlcmNlbnRhZ2Ugc3BhbiB7CiAgICAgICAgdHJhbnNpdGlvbjogY29sb3IgMC4zczsKICAgIH0KICAgIAogICAgLmFjdGlvbi1idG4gewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgICAgcGFkZGluZzogMTJweCAyNHB4OwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnM7CiAgICB9CiAgICAuYWN0aW9uLWJ0bjpkaXNhYmxlZCB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzU1NSAhaW1wb3J0YW50OwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KSAhaW1wb3J0YW50OwogICAgICAgIGN1cnNvcjogbm90LWFsbG93ZWQ7CiAgICAgICAgYm9yZGVyLWNvbG9yOiAjNTU1ICFpbXBvcnRhbnQ7CiAgICB9CgogICAgLnNhdmUtYnRuLCAudXBkYXRlLXlpZWxkLWJ0biB7IGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IH0KICAgIC5zYXZlLWJ0bjpob3Zlcjpub3QoOmRpc2FibGVkKSwgLnVwZGF0ZS15aWVsZC1idG46aG92ZXI6bm90KDpkaXNhYmxlZCkgeyBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnktaG92ZXIpOyB9CiAgICAKICAgIC5leHBvcnQtYnRuIHsgCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICAgICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgIH0KICAgIC5leHBvcnQtYnRuOmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHsgCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1wcmltYXJ5KTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgfQoKICAgIC5jbGVhci1idG4gewogICAgICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXJlZCk7CiAgICAgICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0teW9jby1yZWQpOwogICAgICAgIHBhZGRpbmc6IDEwcHg7CiAgICAgICAgd2lkdGg6IDQ0cHg7CiAgICAgICAgaGVpZ2h0OiA0NHB4OwogICAgfQogICAgLmNsZWFyLWJ0bjpob3Zlcjpub3QoOmRpc2FibGVkKSB7CiAgICAgICAgYmFja2dyb3VuZDogdmFyKC0teW9jby1yZWQpOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICB9CiAgICAuY2xlYXItYnRuIHN2ZyB7CiAgICAgICAgZmlsbDogdmFyKC0teW9jby1yZWQpOwogICAgICAgIHRyYW5zaXRpb246IGZpbGwgMC4yczsKICAgIH0KICAgIC5jbGVhci1idG46aG92ZXI6bm90KDpkaXNhYmxlZCkgc3ZnIHsKICAgICAgICBmaWxsOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICB9CgoKICAgIC8qIFNhdmVkIFJlY2lwZXMgUGFuZWwgKi8KICAgIC5zYXZlZC1yZWNpcGVzLXBhbmVsIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgZ2FwOiAxNXB4OwogICAgfQogICAgI3NhdmVkUmVjaXBlc0NvbnRhaW5lciB7CiAgICAgICAgb3ZlcmZsb3cteDogYXV0bzsKICAgIH0KICAgIC5zYXZlZC1yZWNpcGVzLXBhbmVsIC5hY3Rpb25zLWNvbCB7CiAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgICB9CiAgICAuc2F2ZWQtcmVjaXBlcy1wYW5lbCAuYWN0aW9ucy1jb2wgYnV0dG9uIHsKICAgICAgICBiYWNrZ3JvdW5kOiBub25lOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7CiAgICAgICAgcGFkZGluZzogNnB4IDEycHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICBtYXJnaW4tbGVmdDogOHB4OwogICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzOwogICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7CiAgICB9CiAgICAuc2F2ZWQtcmVjaXBlcy1wYW5lbCAuYWN0aW9ucy1jb2wgYnV0dG9uOmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLWJvcmRlcik7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKICAgIH0KICAgIC5zYXZlZC1yZWNpcGVzLWZvb3RlciB7CiAgICAgICAgbWFyZ2luLXRvcDogYXV0bzsKICAgICAgICBwYWRkaW5nLXRvcDogMTVweDsKICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsKICAgIH0KICAgIC5ncC1sb3cgeyBjb2xvcjogdmFyKC0teW9jby1yZWQpOyBmb250LXdlaWdodDogNjAwOyB9CiAgICAuZ3AtbWVkaXVtIHsgY29sb3I6IHZhcigtLXlvY28tb3JhbmdlKTsgZm9udC13ZWlnaHQ6IDYwMDsgfQogICAgLmdwLWhpZ2ggeyBjb2xvcjogdmFyKC0teW9jby1ncmVlbik7IGZvbnQtd2VpZ2h0OiA2MDA7IH0KCiAgICAvKiBUb29sdGlwIFN0eWxlcyAqLwogICAgLnRvb2x0aXAtY29udGFpbmVyIHsKICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgZGlzcGxheTogaW5saW5lLWZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBnYXA6IDhweDsKICAgIH0KICAgIC50b29sdGlwLXRyaWdnZXIgewogICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgICAgY3Vyc29yOiBoZWxwOwogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsKICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICAgICAgd2lkdGg6IDE4cHg7CiAgICAgICAgaGVpZ2h0OiAxOHB4OwogICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICBsaW5lLWhlaWdodDogMTZweDsKICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgZmxleC1zaHJpbms6IDA7CiAgICB9CiAgICAudG9vbHRpcC1jb250YWluZXI6aG92ZXIgLnRvb2x0aXAtdHJpZ2dlciB7CiAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgfQogICAgLnRvb2x0aXAtdGV4dCB7CiAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjsKICAgICAgd2lkdGg6IDI4MHB4OwogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmEyYTJhOwogICAgICBjb2xvcjogdmFyKC0teW9jby10ZXh0LXByaW1hcnkpOwogICAgICB0ZXh0LWFsaWduOiBsZWZ0OwogICAgICBwYWRkaW5nOiAxMnB4OwogICAgICBib3JkZXItcmFkaXVzOiA4cHg7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICB6LWluZGV4OiAxMDAwOwogICAgICB0b3A6IDEyNSU7CiAgICAgIGxlZnQ6IDUwJTsKICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpOwogICAgICBvcGFjaXR5OiAwOwogICAgICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuM3M7CiAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7CiAgICAgIGZvbnQtc2l6ZTogMTNweDsKICAgICAgbGluZS1oZWlnaHQ6IDEuNjsKICAgICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsMCwwLDAuNCk7CiAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOwogICAgfQogICAgLnRvb2x0aXAtdGV4dDo6YWZ0ZXIgewogICAgICBjb250ZW50OiAiIjsKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICBib3R0b206IDEwMCU7CiAgICAgIGxlZnQ6IDUwJTsKICAgICAgbWFyZ2luLWxlZnQ6IC01cHg7CiAgICAgIGJvcmRlci13aWR0aDogNXB4OwogICAgICBib3JkZXItc3R5bGU6IHNvbGlkOwogICAgICBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50IHRyYW5zcGFyZW50ICMyYTJhMmEgdHJhbnNwYXJlbnQ7CiAgICB9CiAgICAudG9vbHRpcC10cmlnZ2VyOmhvdmVyICsgLnRvb2x0aXAtdGV4dCB7CiAgICAgICAgdmlzaWJpbGl0eTogdmlzaWJsZTsKICAgICAgICBvcGFjaXR5OiAxOwogICAgfQogICAgCiAgICAvKiBHZW5lcmFsIHB1cnBvc2UgdG9vbHRpcCB1c2luZyBkYXRhLXRvb2x0aXAgYXR0cmlidXRlICovCiAgICAudG9vbHRpcCB7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgfQogICAgLnRvb2x0aXA6OmFmdGVyIHsKICAgICAgY29udGVudDogYXR0cihkYXRhLXRvb2x0aXApOwogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHotaW5kZXg6IDEwMDA7CiAgICAgIAogICAgICAvKiBQb3NpdGlvbmluZyAqLwogICAgICBsZWZ0OiA1MCU7CiAgICAgIGJvdHRvbTogMTIwJTsgLyogR2l2ZSBpdCBzb21lIHNwYWNlICovCiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKCiAgICAgIC8qIEFwcGVhcmFuY2UgKi8KICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzJhMmEyYTsKICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKICAgICAgcGFkZGluZzogOHB4IDEycHg7CiAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICBmb250LXdlaWdodDogNDAwOwogICAgICBmb250LXNpemU6IDEzcHg7CiAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7CiAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLDAsMCwwLjQpOwoKICAgICAgLyogVmlzaWJpbGl0eSAqLwogICAgICBvcGFjaXR5OiAwOwogICAgICB2aXNpYmlsaXR5OiBoaWRkZW47CiAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4ycyBlYXNlLWluLW91dCwgdmlzaWJpbGl0eSAwLjJzIGVhc2UtaW4tb3V0OwogICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgIH0KICAgIC50b29sdGlwOmhvdmVyOjphZnRlciB7CiAgICAgIG9wYWNpdHk6IDE7CiAgICAgIHZpc2liaWxpdHk6IHZpc2libGU7CiAgICB9CgoKICAgIC8qIFNjcm9sbGJhciBzdHlsZXMgKi8KICAgIDo6LXdlYmtpdC1zY3JvbGxiYXIgewogICAgICB3aWR0aDogOHB4OwogICAgfQogICAgOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICB9CiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsKICAgICAgYmFja2dyb3VuZDogdmFyKC0teW9jby1ib3JkZXIpOwogICAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICB9CiAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvdmVyIHsKICAgICAgYmFja2dyb3VuZDogIzU1NTsKICAgIH0KICAgIC5idG4taWNvbiB7CiAgICAgICAgcGFkZGluZzogMC43NXJlbTsKICAgIH0KICAgIC5idG4gewogICAgICBwYWRkaW5nOiAwLjc1cmVtIDEuNXJlbTsKICAgICAgYm9yZGVyLXJhZGl1czogMC41cmVtOwogICAgICBmb250LXdlaWdodDogNjAwOwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2UtaW4tb3V0OwogICAgICBib3JkZXI6IG5vbmU7CiAgICAgIGRpc3BsYXk6IGlubGluZS1mbGV4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBnYXA6IDAuNXJlbTsKICAgICAgYm94LXNoYWRvdzogMCA0cHggNnB4IHJnYmEoMCwgMCwgMCwgMC4yKTsKICAgIH0KICAgIC5idG4tcHJpbWFyeSB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICAgIGNvbG9yOiB3aGl0ZTsKICAgIH0KICAgIC5idG4tcHJpbWFyeTpob3Zlcjpub3QoOmRpc2FibGVkKSB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeS1ob3Zlcik7CiAgICB9CiAgICAuYnRuLXNlY29uZGFyeSB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXlvY28tc3VyZmFjZSk7CiAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXRleHQtcHJpbWFyeSk7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgIH0KICAgIAogICAgI3lpZWxkRmllbGRzQ29udGFpbmVyIC5hY3Rpb24tYnRuIHsKICAgICAgICBwYWRkaW5nOiAxMHB4OwogICAgICAgIHdpZHRoOiA0NHB4OwogICAgICAgIGhlaWdodDogNDRweDsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UtbGlnaHQpOwogICAgfQogICAgI3lpZWxkRmllbGRzQ29udGFpbmVyIC5hY3Rpb24tYnRuOmhvdmVyOm5vdCg6ZGlzYWJsZWQpIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgfQogICAgCiAgICAvKiAtLS0gVHV0b3JpYWwgU3R5bGVzIC0tLSAqLwogICAgLm1vZGFsLWJhY2tkcm9wIHsKICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgdG9wOiAwOwogICAgICAgIGxlZnQ6IDA7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC43KTsKICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAgei1pbmRleDogMTAwMDA7CiAgICB9CiAgICAubW9kYWwtYmFja2Ryb3Auc2hvdyB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgIH0KICAgIC5tb2RhbC1jb250ZW50IHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS15b2NvLXN1cmZhY2UpOwogICAgICAgIHBhZGRpbmc6IDJyZW07CiAgICAgICAgYm9yZGVyLXJhZGl1czogMC43NXJlbTsKICAgICAgICB3aWR0aDogOTAlOwogICAgICAgIG1heC13aWR0aDogNTAwcHg7CiAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDMwcHggcmdiYSgwLDAsMCwwLjUpOwogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXlvY28tYm9yZGVyKTsKICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICB9CiAgICAgLm1vZGFsLWNvbnRlbnQgaDMgewogICAgICAgIGZvbnQtc2l6ZTogMS41cmVtOwogICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1wcmltYXJ5KTsKICAgICB9CiAgICAgLm1vZGFsLWNvbnRlbnQgcCB7CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tdGV4dC1zZWNvbmRhcnkpOwogICAgICAgIG1hcmdpbi1ib3R0b206IDJyZW07CiAgICAgfQogICAgIC5tb2RhbC1idXR0b25zIHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgIGdhcDogMXJlbTsKICAgICB9CgogICAgLnR1dG9yaWFsLW92ZXJsYXkgewogICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICB0b3A6IDA7CiAgICAgICAgbGVmdDogMDsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgei1pbmRleDogOTk5ODsKICAgICAgICBkaXNwbGF5OiBub25lOwogICAgfQogICAgLnR1dG9yaWFsLW92ZXJsYXktcGFydCB7CiAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC44NSk7CiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuNHMgZWFzZS1pbi1vdXQ7CiAgICB9CiAgICAuaGlnaGxpZ2h0LWVsZW1lbnQgewogICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICB6LWluZGV4OiA5OTk5OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICB0cmFuc2l0aW9uOiBib3gtc2hhZG93IDAuM3MgZWFzZS1pbi1vdXQ7CiAgICAgICAgYm94LXNoYWRvdzogMCAwIDE1cHggNXB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNyk7CiAgICAgICAgYW5pbWF0aW9uOiBwdWxzZS1nbG93IDJzIGluZmluaXRlIGVhc2UtaW4tb3V0OwogICAgfQogICAgLnR1dG9yaWFsLXBvcG92ZXIgewogICAgICAgIHBvc2l0aW9uOiBmaXhlZDsgCiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0teW9jby1zdXJmYWNlKTsKICAgICAgICBjb2xvcjogI0ZGRkZGRjsKICAgICAgICBwYWRkaW5nOiAwOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDAuOHJlbTsKICAgICAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIHotaW5kZXg6IDEwMDAxOwogICAgICAgIHdpZHRoOiA5MCU7CiAgICAgICAgbWF4LXdpZHRoOiAzODBweDsKICAgICAgICBib3gtc2hhZG93OiAwIDEwcHggNDBweCByZ2JhKDAsMCwwLDAuNyksIDAgMCAzMHB4IHJnYmEoMCwgMTYzLCAyNTUsIDAuNSk7CiAgICAgICAgYW5pbWF0aW9uOiBmYWRlSW5Qb3BvdmVyIDAuNHMgZWFzZS1vdXQgZm9yd2FyZHM7CiAgICAgICAgZGlzcGxheTogbm9uZTsKICAgIH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLWhlYWRlciB7CiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAxNjMsIDI1NSwgMC4xKTsKICAgICAgICBwYWRkaW5nOiAxcmVtIDEuNXJlbTsKICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgIGZvbnQtc2l6ZTogMS4xcmVtOwogICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBnYXA6IDAuNzVyZW07CiAgICAgICAgY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci1jb250ZW50IHsKICAgICAgICBwYWRkaW5nOiAxLjVyZW07CiAgICAgICAgZm9udC1zaXplOiAxLjA1cmVtOwogICAgICAgIGxpbmUtaGVpZ2h0OiAxLjY7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci1jb250ZW50IGIgewogICAgICAgIGNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOwogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci1uYXYgewogICAgICAgIHBhZGRpbmc6IDFyZW0gMS41cmVtOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwwLDAsMC4yKTsKICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0teW9jby1ib3JkZXIpOwogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICB9CiAgICAudHV0b3JpYWwtcG9wb3Zlcjo6YWZ0ZXIgewogICAgICAgIGNvbnRlbnQ6ICcnOwogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICBib3JkZXItd2lkdGg6IDEwcHg7CiAgICAgICAgYm9yZGVyLXN0eWxlOiBzb2xpZDsKICAgICAgICBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50OwogICAgfQogICAgLnR1dG9yaWFsLXBvcG92ZXIuYXJyb3ctdG9wOjphZnRlciB7IGJvdHRvbTogMTAwJTsgbGVmdDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSk7IGJvcmRlci1ib3R0b20tY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLmFycm93LWJvdHRvbTo6YWZ0ZXIgeyB0b3A6IDEwMCU7IGxlZnQ6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpOyBib3JkZXItdG9wLWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyB9CiAgICAudHV0b3JpYWwtcG9wb3Zlci5hcnJvdy1sZWZ0OjphZnRlciB7IHJpZ2h0OiAxMDAlOyB0b3A6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOyBib3JkZXItcmlnaHQtY29sb3I6IHZhcigtLXlvY28tcHJpbWFyeSk7IH0KICAgIC50dXRvcmlhbC1wb3BvdmVyLmFycm93LXJpZ2h0OjphZnRlciB7IGxlZnQ6IDEwMCU7IHRvcDogNTAlOyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7IGJvcmRlci1sZWZ0LWNvbG9yOiB2YXIoLS15b2NvLXByaW1hcnkpOyB9CiAgICAKICAgIEBrZXlmcmFtZXMgZmFkZUluUG9wb3ZlciB7IGZyb20geyBvcGFjaXR5OiAwOyB0cmFuc2Zvcm06IHNjYWxlKDAuOTUpOyB9IHRvIHsgb3BhY2l0eTogMTsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgfSB9CiAgICBAa2V5ZnJhbWVzIHB1bHNlLWdsb3cgeyAwJSwgMTAwJSB7IGJveC1zaGFkb3c6IDAgMCAxNXB4IDVweCByZ2JhKDAsIDE2MywgMjU1LCAwLjcpOyB9IDUwJSB7IGJveC1zaGFkb3c6IDAgMCAyNXB4IDEwcHggcmdiYSgwLCAxNjMsIDI1NSwgMC43KTsgfSB9CgogIDwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CjxoZWFkZXIgY2xhc3M9Im1haW4taGVhZGVyIiBpZD0idHV0b3JpYWwtaGVhZGVyIj4KPGRpdiBjbGFzcz0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTMiPgo8YSBhcmlhLWxhYmVsPSJWaWV3IFJlY2lwZSBMb2FkZXIg4oCUIEhvdy1UbyBHdWlkZSIgY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IGJ0bi1pY29uIHRvb2x0aXAiIGRhdGEtdG9vbHRpcD0iVmlldyBIb3cgVG8gR3VpZGUiIGhyZWY9Imh0dHBzOi8vZHJpdmUuZ29vZ2xlLmNvbS9maWxlL2QvMVM2b3RDLU9RT0trY3IwUmIwSGV5aHFaLVFjZloxSFJqL3ZpZXc/dXNwPWRyaXZlX2xpbmsiIGlkPSJ0dXRvcmlhbC1ob3ctdG8tZ3VpZGUiIHJlbD0ibm9vcGVuZXIgbm9yZWZlcnJlciIgcm9sZT0iYnV0dG9uIiBzdHlsZT0icGFkZGluZzogMC43NXJlbTsiIHRhcmdldD0iX2JsYW5rIj4KPHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjIwIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIHZpZXdib3g9IjAgMCAyNCAyNCIgd2lkdGg9IjIwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xNCAySDZhMiAyIDAgMCAwLTIgMnYxNmEyIDIgMCAwIDAgMiAyaDEyYTIgMiAwIDAgMCAyLTJWOHoiPjwvcGF0aD48cG9seWxpbmUgcG9pbnRzPSIxNCAyIDE0IDggMjAgOCI+PC9wb2x5bGluZT48bGluZSB4MT0iMTYiIHgyPSI4IiB5MT0iMTMiIHkyPSIxMyI+PC9saW5lPjxsaW5lIHgxPSIxNiIgeDI9IjgiIHkxPSIxNyIgeTI9IjE3Ij48L2xpbmU+PHBvbHlsaW5lIHBvaW50cz0iMTAgOSA5IDkgOCA5Ij48L3BvbHlsaW5lPjwvc3ZnPgo8L2E+CjxkaXYgY2xhc3M9InRvb2x0aXAtY29udGFpbmVyIj4KPGgxPlRhYmxlIEJ5IFlvY28gUmVjaXBlIExvYWRlcjwvaDE+CjxzcGFuIGNsYXNzPSJ0b29sdGlwLXRyaWdnZXIiPj88L3NwYW4+CjxkaXYgY2xhc3M9InRvb2x0aXAtdGV4dCI+QW4gYXBwbGljYXRpb24gdG8gYnVpbGQgYW5kIG1hbmFnZSBwcm9kdWN0IHJlY2lwZXMgZnJvbSBhbiBpbXBvcnRlZCBsaXN0LjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9ImhlYWRlci1hY3Rpb25zIiBpZD0idHV0b3JpYWwtYWN0aW9ucyI+CjxidXR0b24gY2xhc3M9ImFjdGlvbi1idG4gZXhwb3J0LWJ0biIgaWQ9ImV4cG9ydEFsbEJ0bkhlYWRlciIgdGl0bGU9IkV4cG9ydCBhbGwgc2F2ZWQgcmVjaXBlcyB0byBhbiBFeGNlbCBmaWxlIGFuZCBjbGVhciBhbGwgZGF0YS4iPkV4cG9ydCBBbGwgUmVjaXBlczwvYnV0dG9uPgo8YnV0dG9uIGNsYXNzPSJhY3Rpb24tYnRuIGNsZWFyLWJ0biIgaWQ9ImNsZWFyQWxsQnRuIiB0aXRsZT0iQ2xlYXIgYWxsIGltcG9ydGVkIHByb2R1Y3RzIGFuZCBzYXZlZCByZWNpcGVzIGZyb20gdGhlIGFwcGxpY2F0aW9uLiI+CjxzdmcgaGVpZ2h0PSIyMCIgdmlld2JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTMgNnYxOGgxOHYtMThoLTE4em01IDE0YzAgLjU1Mi0uNDQ4IDEtMSAxcy0xLS40NDgtMS0xdi0xMGMwLS41NTIuNDQ4LTEgMS0xczEgLjQ0OCAxIDF2MTB6bTUgMGMwIC41NTItLjQ0OCAxLTEgMXMtMS0uNDQ4LTEtMXYtMTBjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjEwem01IDBjMCAuNTUyLS40NDggMS0xIDFzLTEtLjQ0OC0xLTF2LTEwYzAtLjU1Mi40NDgtMSAxLTFzMSAuNDQ4IDEgMXYxMHptNC0xOGgtMjB2LTJoNnYtMS41YzAtLjgyNy42NzMtMS41IDEuNS0xLjVoNWMuODI1IDAgMS41LjY3MSAxLjUgMS41djEuNWg2djJ6Ij48L3BhdGg+PC9zdmc+CjwvYnV0dG9uPgo8L2Rpdj4KPC9oZWFkZXI+CjxkaXYgY2xhc3M9ImNvbnRhaW5lciI+CjwhLS0gTGVmdCBQYW5lbDogSW1wb3J0IGFuZCBMaWJyYXJ5IC0tPgo8ZGl2IGNsYXNzPSJsZWZ0LXBhbmVsIj4KPGRpdiBjbGFzcz0icGFuZWwgaW1wb3J0LXNlY3Rpb24iIGlkPSJ0dXRvcmlhbC1pbXBvcnQiPgo8ZGl2IGNsYXNzPSJ0b29sdGlwLWNvbnRhaW5lciI+CjxsYWJlbCBmb3I9ImV4Y2VsRmlsZSI+SW1wb3J0IFByb2R1Y3QgU2hlZXQ8L2xhYmVsPgo8c3BhbiBjbGFzcz0idG9vbHRpcC10cmlnZ2VyIj4/PC9zcGFuPgo8ZGl2IGNsYXNzPSJ0b29sdGlwLXRleHQiPlRoZSBwcm9kdWN0IGV4Y2VsIHNoZWV0IGZyb20gdGhlIFRhYmxlIGJ5IFlvY28gUHJvZHVjdCBMb2FkZXIgbXVzdCBiZSBsb2FkZWQuPC9kaXY+CjwvZGl2Pgo8aW5wdXQgYWNjZXB0PSIueGxzeCwgLnhscywgLmNzdiIgaWQ9ImV4Y2VsRmlsZSIgdHlwZT0iZmlsZSIvPgo8bGFiZWwgY2xhc3M9ImZpbGUtdXBsb2FkLWJ0biIgZm9yPSJleGNlbEZpbGUiIHRpdGxlPSJJbXBvcnQgYW4gRXhjZWwgZmlsZSAoLnhsc3gsIC54bHMsIC5jc3YpIHdpdGggeW91ciBwcm9kdWN0IGxpc3QuIj5DaG9vc2UgRmlsZTwvbGFiZWw+CjxwIGlkPSJmaWxlTmFtZSI+PC9wPgo8L2Rpdj4KPGRpdiBjbGFzcz0icGFuZWwgbGlicmFyeS1zZWN0aW9uIiBpZD0idHV0b3JpYWwtbGlicmFyeSI+CjxkaXYgY2xhc3M9InBhbmVsLWhlYWRlciI+CjxkaXYgY2xhc3M9InRvb2x0aXAtY29udGFpbmVyIj4KPGgyPkluZ3JlZGllbnQgTGlicmFyeTwvaDI+CjxzcGFuIGNsYXNzPSJ0b29sdGlwLXRyaWdnZXIiPj88L3NwYW4+CjxkaXYgY2xhc3M9InRvb2x0aXAtdGV4dCI+QnJvd3NlIGFuZCBzZWxlY3QgaW5ncmVkaWVudHMgZnJvbSB5b3VyIGltcG9ydGVkIHByb2R1Y3QgbGlzdCwgc29ydGVkIGJ5IGNhdGVnb3J5LjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9InRhYnMiIGlkPSJsaWJyYXJ5VGFicyI+CjwhLS0gVGFicyB3aWxsIGJlIGdlbmVyYXRlZCBoZXJlIC0tPgo8L2Rpdj4KPGRpdiBjbGFzcz0idGFiLWNvbnRlbnQtY29udGFpbmVyIiBpZD0idGFiQ29udGVudHMiPgo8IS0tIFRhYiBjb250ZW50cyB3aWxsIGJlIGdlbmVyYXRlZCBoZXJlIC0tPgo8L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8IS0tIFJpZ2h0IENvbHVtbiAtLT4KPGRpdiBjbGFzcz0icmlnaHQtY29sdW1uIj4KPCEtLSBSaWdodC1zaWRlIFRhYiBOYXZpZ2F0aW9uIC0tPgo8ZGl2IGNsYXNzPSJ0YWJzIiBpZD0icmlnaHRQYW5lbFRhYnMiPgo8YnV0dG9uIGNsYXNzPSJ0YWItYnV0dG9uIGFjdGl2ZSIgZGF0YS10YWI9InJlY2lwZUJ1aWxkZXJQYW5lbCI+UmVjaXBlIEJ1aWxkZXI8L2J1dHRvbj4KPGJ1dHRvbiBjbGFzcz0idGFiLWJ1dHRvbiIgZGF0YS10YWI9InlpZWxkRWRpdG9yUGFuZWwiPllpZWxkIEVkaXRvcjwvYnV0dG9uPgo8L2Rpdj4KPCEtLSBSaWdodC1zaWRlIFRhYiBDb250ZW50IC0tPgo8ZGl2IGNsYXNzPSJyaWdodC1wYW5lbC1ncm91cCI+CjwhLS0gVG9wIFJpZ2h0IFBhbmVsOiBSZWNpcGUgQnVpbGRlciAtLT4KPGRpdiBjbGFzcz0icGFuZWwgcmVjaXBlLWJ1aWxkZXIgYWN0aXZlIiBpZD0icmVjaXBlQnVpbGRlclBhbmVsIj4KPGRpdiBjbGFzcz0icGFuZWwtaGVhZGVyIj4KPGRpdiBjbGFzcz0idG9vbHRpcC1jb250YWluZXIiPgo8aDI+UmVjaXBlIEJ1aWxkZXI8L2gyPgo8c3BhbiBjbGFzcz0idG9vbHRpcC10cmlnZ2VyIj4/PC9zcGFuPgo8ZGl2IGNsYXNzPSJ0b29sdGlwLXRleHQiPkNvbnN0cnVjdCBhIG5ldyByZWNpcGUgZm9yIGEgc2VsZWN0ZWQgbWFzdGVyIHByb2R1Y3QuPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPGRpdiBjbGFzcz0ibWFzdGVyLXByb2R1Y3QtZm9ybSIgaWQ9InR1dG9yaWFsLW1hc3Rlci1wcm9kdWN0Ij4KPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CjxsYWJlbCBmb3I9Im1lbnVDYXRlZ29yeUZpbHRlciI+RmlsdGVyIGJ5IE1lbnUgQ2F0ZWdvcnk8L2xhYmVsPgo8c2VsZWN0IGlkPSJtZW51Q2F0ZWdvcnlGaWx0ZXIiPjwvc2VsZWN0Pgo8L2Rpdj4KPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CjxsYWJlbCBmb3I9Im1hc3RlclByb2R1Y3RJbnB1dCI+U2VhcmNoIGZvciBNYXN0ZXIgUHJvZHVjdDwvbGFiZWw+CjxkaXYgY2xhc3M9ImlucHV0LXdpdGgtY2xlYXIiPgo8aW5wdXQgaWQ9Im1hc3RlclByb2R1Y3RJbnB1dCIgbGlzdD0ibWFzdGVyUHJvZHVjdExpc3QiIHBsYWNlaG9sZGVyPSItLSBJbXBvcnQgcHJvZHVjdHMgZmlyc3QgLS0iIHRpdGxlPSJTZWxlY3QgdGhlIG1haW4gcHJvZHVjdCB5b3UgYXJlIGJ1aWxkaW5nIGEgcmVjaXBlIGZvci4iIHR5cGU9InRleHQiLz4KPHNwYW4gY2xhc3M9ImNsZWFyLWJ0bi1pbnB1dCIgaWQ9Im1hc3RlclByb2R1Y3RDbGVhckJ0biI+w5c8L3NwYW4+CjwvZGl2Pgo8ZGF0YWxpc3QgaWQ9Im1hc3RlclByb2R1Y3RMaXN0Ij48L2RhdGFsaXN0Pgo8L2Rpdj4KPCEtLSBZaWVsZCBGaWVsZHMgZm9yIE1hbnVmYWN0dXJlZCBQcm9kdWN0cyAtLT4KPGRpdiBpZD0ieWllbGRGaWVsZHNDb250YWluZXIiIHN0eWxlPSJkaXNwbGF5OiBub25lOyBncmlkLWNvbHVtbjogMSAvIC0xOyBkaXNwbGF5OiBncmlkOyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAxZnIgYXV0bzsgZ2FwOiAxNXB4OyBtYXJnaW4tdG9wOiAxMHB4OyBhbGlnbi1pdGVtczogZW5kOyI+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgo8bGFiZWwgZm9yPSJ5aWVsZFF0eUlucHV0Ij5ZaWVsZCBRdWFudGl0eTwvbGFiZWw+CjxpbnB1dCBpZD0ieWllbGRRdHlJbnB1dCIgbWluPSIwLjAwMSIgcGxhY2Vob2xkZXI9ImUuZy4sIDEuNSIgcmVhZG9ubHk9IiIgc3RlcD0iMC4wMDEiIHRpdGxlPSJIb3cgbXVjaCBkb2VzIHRoaXMgcmVjaXBlIHByb2R1Y2U/IiB0eXBlPSJudW1iZXIiLz4KPC9kaXY+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgo8bGFiZWwgZm9yPSJ5aWVsZFVvbUlucHV0Ij5ZaWVsZCBVT008L2xhYmVsPgo8aW5wdXQgaWQ9InlpZWxkVW9tSW5wdXQiIHBsYWNlaG9sZGVyPSJlLmcuLCBrZywgTCwgZWFjaCIgcmVhZG9ubHk9IiIgdGl0bGU9IldoYXQgaXMgdGhlIHVuaXQgZm9yIHRoZSB5aWVsZCBxdWFudGl0eT8iIHR5cGU9InRleHQiLz4KPC9kaXY+CjxidXR0b24gY2xhc3M9ImFjdGlvbi1idG4gYnRuLWljb24iIGlkPSJlZGl0WWllbGRCdG4iIHRpdGxlPSJFZGl0IFlpZWxkIj4KPHN2ZyBjbGFzcz0iZWRpdC1pY29uIiBmaWxsPSJub25lIiBoZWlnaHQ9IjIwIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIHZpZXdib3g9IjAgMCAyNCAyNCIgd2lkdGg9IjIwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0xMSA0SDRhMiAyIDAgMCAwLTIgMnYxNGEyIDIgMCAwIDAgMiAyaDE0YTIgMiAwIDAgMCAyLTJ2LTciPjwvcGF0aD48cGF0aCBkPSJNMTguNSAyLjVhMi4xMjEgMi4xMjEgMCAwIDEgMyAzTDEyIDE1bC00IDEgMS00IDkuNS05LjV6Ij48L3BhdGg+PC9zdmc+CjxzdmcgY2xhc3M9InNhdmUtaWNvbiIgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyMCIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiIHZpZXdib3g9IjAgMCAyNCAyNCIgd2lkdGg9IjIwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwb2x5bGluZSBwb2ludHM9IjIwIDYgOSAxNyA0IDEyIj48L3BvbHlsaW5lPjwvc3ZnPgo8L2J1dHRvbj4KPC9kaXY+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJyZWNpcGUtZGV0YWlscyIgaWQ9InR1dG9yaWFsLXJlY2lwZS10YWJsZSI+CjxkaXYgY2xhc3M9InJlY2lwZS10YWJsZS1jb250YWluZXIiPgo8dGFibGUgaWQ9InJlY2lwZVRhYmxlIj4KPHRoZWFkPgo8dHI+Cjx0aD5QTFU8L3RoPgo8dGg+UHJvZHVjdCBOYW1lPC90aD4KPHRoPlVPTTwvdGg+Cjx0aD5Db3N0L1VPTTwvdGg+Cjx0aD5RdWFudGl0eTwvdGg+Cjx0aD5Ub3RhbCBDb3N0PC90aD4KPHRoPkFjdGlvbjwvdGg+CjwvdHI+CjwvdGhlYWQ+Cjx0Ym9keT4KPCEtLSBSZWNpcGUgaXRlbXMgd2lsbCBiZSBhZGRlZCBoZXJlIC0tPgo8L3Rib2R5Pgo8L3RhYmxlPgo8L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9InJlY2lwZS1zdW1tYXJ5Ij4KPGRpdiBjbGFzcz0iY29zdC1kZXRhaWxzIj4KPGRpdiBjbGFzcz0idG90YWwtY29zdCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb3RhbCBSZWNpcGUgQ29zdDogPHNwYW4gaWQ9InRvdGFsQ29zdCI+UjAuMDA8L3NwYW4+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJzZWxsaW5nLXByaWNlIiBpZD0ic2VsbGluZ1ByaWNlQ29udGFpbmVyIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFzdGVyIFNlbGxpbmcgUHJpY2U6IDxzcGFuIGlkPSJtYXN0ZXJTZWxsaW5nUHJpY2UiPlIwLjAwPC9zcGFuPgo8L2Rpdj4KPGRpdiBjbGFzcz0iZ3AtcGVyY2VudGFnZSIgaWQ9ImdwUGVyY2VudGFnZUNvbnRhaW5lciIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdyb3NzIFByb2ZpdCAlOiA8c3BhbiBpZD0iZ3BQZXJjZW50YWdlIj4wLjAwJTwvc3Bhbj4KPC9kaXY+CjwvZGl2Pgo8YnV0dG9uIGNsYXNzPSJhY3Rpb24tYnRuIHNhdmUtYnRuIiBpZD0ic2F2ZVJlY2lwZUJ0biIgdGl0bGU9IlNhdmUgdGhlIGN1cnJlbnQgcmVjaXBlIGluIHRoZSBidWlsZGVyIHRvIHRoZSAnU2F2ZWQgUmVjaXBlcycgbGlzdCBiZWxvdy4iPlNhdmUgUmVjaXBlPC9idXR0b24+CjwvZGl2Pgo8L2Rpdj4KPCEtLSBZaWVsZCBFZGl0b3IgUGFuZWwgLS0+CjxkaXYgY2xhc3M9InBhbmVsIiBpZD0ieWllbGRFZGl0b3JQYW5lbCI+CjxkaXYgY2xhc3M9InBhbmVsLWhlYWRlciI+CjxkaXYgY2xhc3M9InRvb2x0aXAtY29udGFpbmVyIj4KPGgyPllpZWxkIEVkaXRvcjwvaDI+CjxzcGFuIGNsYXNzPSJ0b29sdGlwLXRyaWdnZXIiPj88L3NwYW4+CjxkaXYgY2xhc3M9InRvb2x0aXAtdGV4dCI+RWRpdCB0aGUgeWllbGQgZm9yIHNhdmVkIG1hbnVmYWN0dXJlZCBwcm9kdWN0cy4gVXBkYXRpbmcgdGhlIHlpZWxkIHdpbGwgYXV0b21hdGljYWxseSByZWNhbGN1bGF0ZSBpdHMgY29zdCBhbmQgdXBkYXRlIGl0IGV2ZXJ5d2hlcmUgaXQncyB1c2VkIGFzIGFuIGluZ3JlZGllbnQuPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPGlucHV0IGNsYXNzPSJzZWFyY2gtYmFyIiBpZD0ieWllbGRFZGl0b3JTZWFyY2giIHBsYWNlaG9sZGVyPSJTZWFyY2ggbWFudWZhY3R1cmVkIHByb2R1Y3RzLi4uIiB0eXBlPSJ0ZXh0Ii8+CjxkaXYgY2xhc3M9InJlY2lwZS10YWJsZS1jb250YWluZXIiIGlkPSJ5aWVsZEVkaXRvckNvbnRhaW5lciI+CjwhLS0gWWllbGQgZWRpdG9yIHRhYmxlIHdpbGwgYmUgZ2VuZXJhdGVkIGhlcmUgLS0+CjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjwhLS0gQm90dG9tIFJpZ2h0IFBhbmVsOiBTYXZlZCBSZWNpcGVzIC0tPgo8ZGl2IGNsYXNzPSJwYW5lbCBzYXZlZC1yZWNpcGVzLXBhbmVsIiBpZD0idHV0b3JpYWwtc2F2ZWQtcmVjaXBlcyI+CjxkaXYgY2xhc3M9InBhbmVsLWhlYWRlciI+CjxkaXYgY2xhc3M9InRvb2x0aXAtY29udGFpbmVyIj4KPGgyPlNhdmVkIFJlY2lwZXM8L2gyPgo8c3BhbiBjbGFzcz0idG9vbHRpcC10cmlnZ2VyIj4/PC9zcGFuPgo8ZGl2IGNsYXNzPSJ0b29sdGlwLXRleHQiPlZpZXcsIGVkaXQsIGNvcHksIG9yIGRlbGV0ZSB5b3VyIHNhdmVkIHJlY2lwZXMuPC9kaXY+CjwvZGl2Pgo8L2Rpdj4KPGlucHV0IGNsYXNzPSJzZWFyY2gtYmFyIiBpZD0ic2F2ZWRSZWNpcGVTZWFyY2giIHBsYWNlaG9sZGVyPSJTZWFyY2ggc2F2ZWQgcmVjaXBlcy4uLiIgdHlwZT0idGV4dCIvPgo8ZGl2IGlkPSJzYXZlZFJlY2lwZXNDb250YWluZXIiPgo8IS0tIFNhdmVkIHJlY2lwZXMgdGFibGUgd2lsbCBiZSBnZW5lcmF0ZWQgaGVyZSAtLT4KPC9kaXY+CjxkaXYgY2xhc3M9InNhdmVkLXJlY2lwZXMtZm9vdGVyIj4KPGJ1dHRvbiBjbGFzcz0iYWN0aW9uLWJ0biBleHBvcnQtYnRuIiBpZD0iZXhwb3J0QWxsQnRuRm9vdGVyIiB0aXRsZT0iRXhwb3J0IGFsbCBzYXZlZCByZWNpcGVzIHRvIGFuIEV4Y2VsIGZpbGUgYW5kIGNsZWFyIGFsbCBkYXRhLiI+RXhwb3J0IEFsbCBSZWNpcGVzPC9idXR0b24+CjwvZGl2Pgo8L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8IS0tIFR1dG9yaWFsIEVsZW1lbnRzIC0tPgo8ZGl2IGNsYXNzPSJtb2RhbC1iYWNrZHJvcCIgaWQ9InR1dG9yaWFsLXByb21wdC1tb2RhbCI+CjxkaXYgY2xhc3M9Im1vZGFsLWNvbnRlbnQiPgo8aDM+V2VsY29tZSB0byBZb3VyIFlvY28gSm91cm5leTwvaDM+CjxwPldl4oCZbGwgZ3VpZGUgeW91IHRocm91Z2ggdGhlIHN0ZXBzIG5lZWRlZCB0byBnZXQgc3RhcnRlZC4gRWFjaCBzZWN0aW9uIHdpbGwgaGlnaGxpZ2h0IHdoYXTigJlzIHJlcXVpcmVkIGZyb20geW91LjwvcD4KPGRpdiBjbGFzcz0ibW9kYWwtYnV0dG9ucyI+CjxidXR0b24gY2xhc3M9ImJ0biBidG4tcHJpbWFyeSIgaWQ9InN0YXJ0LXR1dG9yaWFsLWJ0biI+WWVzLCBwbGVhc2U8L2J1dHRvbj4KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiIGlkPSJza2lwLXR1dG9yaWFsLWJ0biI+Tm8sIHRoYW5rczwvYnV0dG9uPgo8L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5IiBpZD0idHV0b3JpYWwtb3ZlcmxheSI+CjxkaXYgY2xhc3M9InR1dG9yaWFsLW92ZXJsYXktcGFydCIgaWQ9InR1dG9yaWFsLW92ZXJsYXktdG9wIj48L2Rpdj4KPGRpdiBjbGFzcz0idHV0b3JpYWwtb3ZlcmxheS1wYXJ0IiBpZD0idHV0b3JpYWwtb3ZlcmxheS1ib3R0b20iPjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5LXBhcnQiIGlkPSJ0dXRvcmlhbC1vdmVybGF5LWxlZnQiPjwvZGl2Pgo8ZGl2IGNsYXNzPSJ0dXRvcmlhbC1vdmVybGF5LXBhcnQiIGlkPSJ0dXRvcmlhbC1vdmVybGF5LXJpZ2h0Ij48L2Rpdj4KPC9kaXY+CjxkaXYgY2xhc3M9InR1dG9yaWFsLXBvcG92ZXIiIGlkPSJ0dXRvcmlhbC1wb3BvdmVyIj4KPGRpdiBjbGFzcz0idHV0b3JpYWwtcG9wb3Zlci1oZWFkZXIiPgo8c3ZnIGZpbGw9Im5vbmUiIGhlaWdodD0iMjQiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgdmlld2JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDIyczgtNCA4LTEwVjVsLTgtMy04IDN2N2MwIDYgOCAxMCA4IDEweiI+PC9wYXRoPjwvc3ZnPgo8c3Bhbj5RdWljayBHdWlkZTwvc3Bhbj4KPC9kaXY+CjxkaXYgY2xhc3M9InR1dG9yaWFsLXBvcG92ZXItY29udGVudCIgaWQ9InR1dG9yaWFsLXBvcG92ZXItY29udGVudCI+PC9kaXY+CjxkaXYgY2xhc3M9InR1dG9yaWFsLXBvcG92ZXItbmF2Ij4KPHNwYW4gY2xhc3M9InRleHQtc20iIGlkPSJ0dXRvcmlhbC1zdGVwLWNvdW50ZXIiPjwvc3Bhbj4KPGRpdj4KPGJ1dHRvbiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiIGlkPSJ0dXRvcmlhbC1wcmV2LWJ0biI+UHJldjwvYnV0dG9uPgo8YnV0dG9uIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiIGlkPSJ0dXRvcmlhbC1uZXh0LWJ0biI+TmV4dDwvYnV0dG9uPgo8L2Rpdj4KPC9kaXY+CjwvZGl2Pgo8c2NyaXB0PgogICAgLy8gLS0tIFN0YXRlIE1hbmFnZW1lbnQgLS0tCiAgICBsZXQgaW1wb3J0ZWRQcm9kdWN0cyA9IFtdOwogICAgbGV0IHJlY2lwZUl0ZW1zID0gW107CiAgICBsZXQgc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0ID0gbnVsbDsKICAgIGxldCBzYXZlZFJlY2lwZXMgPSBbXTsKICAgIGxldCBpc0VkaXRpbmdSZWNpcGUgPSBmYWxzZTsKCiAgICAvLyAtLS0gRE9NIEVsZW1lbnRzIC0tLQogICAgY29uc3QgZXhjZWxGaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhjZWxGaWxlJyk7CiAgICBjb25zdCBmaWxlTmFtZURpc3BsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZU5hbWUnKTsKICAgIGNvbnN0IGxpYnJhcnlUYWJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpYnJhcnlUYWJzJyk7CiAgICBjb25zdCB0YWJDb250ZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YWJDb250ZW50cycpOwogICAgY29uc3QgcmVjaXBlVGFibGVCb2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3JlY2lwZVRhYmxlIHRib2R5Jyk7CiAgICBjb25zdCB0b3RhbENvc3REaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvdGFsQ29zdCcpOwogICAgY29uc3Qgc2F2ZVJlY2lwZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlUmVjaXBlQnRuJyk7CiAgICBjb25zdCBleHBvcnRBbGxCdG5IZWFkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0QWxsQnRuSGVhZGVyJyk7CiAgICBjb25zdCBleHBvcnRBbGxCdG5Gb290ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0QWxsQnRuRm9vdGVyJyk7CiAgICBjb25zdCBjbGVhckFsbEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbGVhckFsbEJ0bicpOwogICAgY29uc3QgbWVudUNhdGVnb3J5RmlsdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lbnVDYXRlZ29yeUZpbHRlcicpOwogICAgY29uc3QgbWFzdGVyUHJvZHVjdElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hc3RlclByb2R1Y3RJbnB1dCcpOwogICAgY29uc3QgbWFzdGVyUHJvZHVjdExpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFzdGVyUHJvZHVjdExpc3QnKTsKICAgIGNvbnN0IG1hc3RlclByb2R1Y3RDbGVhckJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXN0ZXJQcm9kdWN0Q2xlYXJCdG4nKTsKICAgIGNvbnN0IHNhdmVkUmVjaXBlc0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlZFJlY2lwZXNDb250YWluZXInKTsKICAgIGNvbnN0IHNhdmVkUmVjaXBlU2VhcmNoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVkUmVjaXBlU2VhcmNoJyk7CiAgICBjb25zdCBzZWxsaW5nUHJpY2VDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsbGluZ1ByaWNlQ29udGFpbmVyJyk7CiAgICBjb25zdCBtYXN0ZXJTZWxsaW5nUHJpY2VEaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hc3RlclNlbGxpbmdQcmljZScpOwogICAgY29uc3QgZ3BQZXJjZW50YWdlQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dwUGVyY2VudGFnZUNvbnRhaW5lcicpOwogICAgY29uc3QgZ3BQZXJjZW50YWdlRGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdncFBlcmNlbnRhZ2UnKTsKICAgIGNvbnN0IHlpZWxkRmllbGRzQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3lpZWxkRmllbGRzQ29udGFpbmVyJyk7CiAgICBjb25zdCB5aWVsZFF0eUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3lpZWxkUXR5SW5wdXQnKTsKICAgIGNvbnN0IHlpZWxkVW9tSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgneWllbGRVb21JbnB1dCcpOwogICAgY29uc3QgcmlnaHRQYW5lbFRhYnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmlnaHRQYW5lbFRhYnMnKTsKICAgIGNvbnN0IHlpZWxkRWRpdG9yQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3lpZWxkRWRpdG9yQ29udGFpbmVyJyk7CiAgICBjb25zdCB5aWVsZEVkaXRvclNlYXJjaCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd5aWVsZEVkaXRvclNlYXJjaCcpOwogICAgY29uc3QgZWRpdFlpZWxkQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXRZaWVsZEJ0bicpOwogICAgCiAgICAvLyAtLS0gRXZlbnQgTGlzdGVuZXJzIC0tLQogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7CiAgICAgICAgbG9hZFN0YXRlKCk7CiAgICAgICAgY29uc3QgaGFzRGF0YSA9IChpbXBvcnRlZFByb2R1Y3RzICYmIGltcG9ydGVkUHJvZHVjdHMubGVuZ3RoID4gMCkgfHwgKHNhdmVkUmVjaXBlcyAmJiBzYXZlZFJlY2lwZXMubGVuZ3RoID4gMCk7CiAgICAgICAgaWYgKCFoYXNEYXRhKSB7CiAgICAgICAgICAgIC8vIEFsd2F5cyBwcm9tcHQgdHV0b3JpYWwgd2hlbiB0aGVyZSdzIG5vIGRhdGEgKGZpcnN0IGxvYWQgLyBmcmVzaCBzdGFydCkKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXByb21wdC1tb2RhbCcpLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICAgICAgICB9CiAgICB9KTsKICAgIGV4Y2VsRmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGhhbmRsZUZpbGVVcGxvYWQpOwogICAgc2F2ZVJlY2lwZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVDdXJyZW50UmVjaXBlKTsKICAgIGV4cG9ydEFsbEJ0bkhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV4cG9ydEFsbFJlY2lwZXMpOwogICAgZXhwb3J0QWxsQnRuRm9vdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXhwb3J0QWxsUmVjaXBlcyk7CiAgICBjbGVhckFsbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IGNsZWFyQWxsRGF0YSh0cnVlKSk7CiAgICBtZW51Q2F0ZWdvcnlGaWx0ZXIuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4gewogICAgICAgIGNsZWFyTWFzdGVyUHJvZHVjdElucHV0KCk7CiAgICAgICAgcG9wdWxhdGVNYXN0ZXJQcm9kdWN0RGF0YWxpc3QoKTsKICAgIH0pOwogICAgbWFzdGVyUHJvZHVjdElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgaGFuZGxlTWFzdGVyUHJvZHVjdElucHV0KTsKICAgIG1hc3RlclByb2R1Y3RDbGVhckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsZWFyTWFzdGVyUHJvZHVjdElucHV0KTsKICAgIHNhdmVkUmVjaXBlU2VhcmNoLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgaGFuZGxlU2F2ZWRSZWNpcGVTZWFyY2gpOwogICAgeWllbGRFZGl0b3JTZWFyY2guYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoKSA9PiByZW5kZXJZaWVsZEVkaXRvcigpKTsKICAgIHJpZ2h0UGFuZWxUYWJzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICAgICAgICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLnRhYi1idXR0b24nKSkgewogICAgICAgICAgICBzd2l0Y2hSaWdodFRhYihlLnRhcmdldC5jbG9zZXN0KCcudGFiLWJ1dHRvbicpLmRhdGFzZXQudGFiKTsKICAgICAgICB9CiAgICB9KTsKICAgIGVkaXRZaWVsZEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVlpZWxkRWRpdGluZyk7CgoKICAgIC8vIC0tLSBEYXRhIFBlcnNpc3RlbmNlIC0tLQogICAgZnVuY3Rpb24gc2F2ZVN0YXRlKCkgewogICAgICAgIGNvbnN0IGFwcFN0YXRlID0gewogICAgICAgICAgICBpbXBvcnRlZFByb2R1Y3RzOiBpbXBvcnRlZFByb2R1Y3RzLAogICAgICAgICAgICBzYXZlZFJlY2lwZXM6IHNhdmVkUmVjaXBlcwogICAgICAgIH07CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3JlY2lwZUJ1aWxkZXJTdGF0ZScsIEpTT04uc3RyaW5naWZ5KGFwcFN0YXRlKSk7CiAgICB9CgogICAgZnVuY3Rpb24gbG9hZFN0YXRlKCkgewogICAgICAgIGNvbnN0IHNhdmVkU3RhdGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVjaXBlQnVpbGRlclN0YXRlJyk7CiAgICAgICAgaWYgKHNhdmVkU3RhdGUpIHsKICAgICAgICAgICAgY29uc3QgYXBwU3RhdGUgPSBKU09OLnBhcnNlKHNhdmVkU3RhdGUpOwogICAgICAgICAgICBpbXBvcnRlZFByb2R1Y3RzID0gYXBwU3RhdGUuaW1wb3J0ZWRQcm9kdWN0cyB8fCBbXTsKICAgICAgICAgICAgc2F2ZWRSZWNpcGVzID0gYXBwU3RhdGUuc2F2ZWRSZWNpcGVzIHx8IFtdOwoKICAgICAgICAgICAgaWYgKGltcG9ydGVkUHJvZHVjdHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgZmlsZU5hbWVEaXNwbGF5LnRleHRDb250ZW50ID0gJ0xvYWRlZCBmcm9tIHByZXZpb3VzIHNlc3Npb24uJzsKICAgICAgICAgICAgICAgIHNldHVwTGlicmFyeVRhYnMoKTsKICAgICAgICAgICAgICAgIHBvcHVsYXRlQ2F0ZWdvcnlGaWx0ZXIoKTsKICAgICAgICAgICAgICAgIHBvcHVsYXRlTWFzdGVyUHJvZHVjdERhdGFsaXN0KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHNhdmVkUmVjaXBlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICByZW5kZXJTYXZlZFJlY2lwZXMoKTsKICAgICAgICAgICAgICAgIHJlbmRlcllpZWxkRWRpdG9yKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZXR1cExpYnJhcnlUYWJzKCk7IC8vIFNldHVwIHRhYnMgZXZlbiBpZiBubyBkYXRhCiAgICAgICAgfQogICAgfQoKICAgIC8vIC0tLSBGaWxlIEltcG9ydCBMb2dpYyAtLS0KICAgIGZ1bmN0aW9uIGhhbmRsZUZpbGVVcGxvYWQoZXZlbnQpIHsKICAgICAgICBjb25zdCBmaWxlID0gZXZlbnQudGFyZ2V0LmZpbGVzWzBdOwogICAgICAgIGlmICghZmlsZSkgcmV0dXJuOwoKICAgICAgICBpZiAoaW1wb3J0ZWRQcm9kdWN0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGlmICghY29uZmlybSgiSW1wb3J0aW5nIGEgbmV3IGZpbGUgd2lsbCBjbGVhciBhbGwgY3VycmVudCBkYXRhLCBpbmNsdWRpbmcgc2F2ZWQgcmVjaXBlcy4gQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNvbnRpbnVlPyIpKSB7CiAgICAgICAgICAgICAgICBleGNlbEZpbGVJbnB1dC52YWx1ZSA9ICIiOyAvLyBSZXNldCBmaWxlIGlucHV0CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2xlYXJBbGxEYXRhKGZhbHNlKTsgLy8gQ2xlYXIgZXhpc3RpbmcgZGF0YSB3aXRob3V0IGFza2luZyBhZ2FpbgoKICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgIHJlYWRlci5vbmxvYWQgPSAoZSkgPT4gewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBVaW50OEFycmF5KGUudGFyZ2V0LnJlc3VsdCk7CiAgICAgICAgICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChkYXRhLCB7IHR5cGU6ICdhcnJheScgfSk7CiAgICAgICAgICAgICAgICBjb25zdCBmaXJzdFNoZWV0TmFtZSA9IHdvcmtib29rLlNoZWV0TmFtZXNbMF07CiAgICAgICAgICAgICAgICBjb25zdCB3b3Jrc2hlZXQgPSB3b3JrYm9vay5TaGVldHNbZmlyc3RTaGVldE5hbWVdOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyAtLS0gSEVBREVSIFZBTElEQVRJT04gLS0tCiAgICAgICAgICAgICAgICBjb25zdCByZXF1aXJlZEhlYWRlcnMgPSBbJ1Byb2R1Y3QgUExVJywgJ1Byb2R1Y3QgTmFtZSAmIFZhcmlhbnQnLCAnU2VsbGluZyBVT00nLCAnQ29zdCBQcmljZScsICdTZWxsaW5nIFByaWNlJywgJ0ludmVudG9yeSBDYXRlZ29yeScsICdNZW51IENhdGVnb3J5J107CiAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJSb3cgPSBYTFNYLnV0aWxzLnNoZWV0X3RvX2pzb24od29ya3NoZWV0LCB7IGhlYWRlcjogMSB9KVswXTsKICAgICAgICAgICAgICAgIGNvbnN0IG1pc3NpbmdIZWFkZXJzID0gcmVxdWlyZWRIZWFkZXJzLmZpbHRlcihoZWFkZXIgPT4gIWhlYWRlclJvdy5pbmNsdWRlcyhoZWFkZXIpKTsKCiAgICAgICAgICAgICAgICBpZiAobWlzc2luZ0hlYWRlcnMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KGBJbXBvcnQgZmFpbGVkLiBUaGUgRXhjZWwgZmlsZSBpcyBtaXNzaW5nIHRoZSBmb2xsb3dpbmcgcmVxdWlyZWQgY29sdW1uczpcblxuLSAke21pc3NpbmdIZWFkZXJzLmpvaW4oJ1xuLSAnKX1gKTsKICAgICAgICAgICAgICAgICAgICBleGNlbEZpbGVJbnB1dC52YWx1ZSA9ICIiOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIC0tLSBFTkQgVkFMSURBVElPTiAtLS0KCiAgICAgICAgICAgICAgICBjb25zdCBqc29uRGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3b3Jrc2hlZXQsIHsgZGVmdmFsOiAiIiB9KTsKICAgICAgICAgICAgICAgIGZpbGVOYW1lRGlzcGxheS50ZXh0Q29udGVudCA9IGBMb2FkZWQ6ICR7ZmlsZS5uYW1lfWA7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGltcG9ydGVkUHJvZHVjdHMgPSBqc29uRGF0YS5tYXAocm93ID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCB5aWVsZFF0eVZhbHVlID0gcGFyc2VGbG9hdChyb3dbJ01hbnVmYWN0dXJlZCBZaWVsZCddIHx8IHJvd1snWWllbGQgUXVhbnRpdHknXSkgfHwgMTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBwbHU6IHJvd1snUHJvZHVjdCBQTFUnXSwKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcm93WydQcm9kdWN0IE5hbWUgJiBWYXJpYW50J10sCiAgICAgICAgICAgICAgICAgICAgICAgIHVvbTogcm93WydTZWxsaW5nIFVPTSddLAogICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbFVvbTogcm93WydTZWxsaW5nIFVPTSddLAogICAgICAgICAgICAgICAgICAgICAgICBjb3N0OiBwYXJzZUZsb2F0KHJvd1snQ29zdCBQcmljZSddKSB8fCAwLAogICAgICAgICAgICAgICAgICAgICAgICBzZWxsaW5nUHJpY2U6IHBhcnNlRmxvYXQocm93WydTZWxsaW5nIFByaWNlJ10pIHx8IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5OiByb3dbJ0ludmVudG9yeSBDYXRlZ29yeSddIHx8ICcnLCAvLyBEZWZhdWx0IHRvIGVtcHR5IHN0cmluZywgbm90ICdVbmNhdGVnb3JpemVkJwogICAgICAgICAgICAgICAgICAgICAgICBtZW51Q2F0ZWdvcnk6IHJvd1snTWVudSBDYXRlZ29yeSddIHx8ICdVbmNhdGVnb3JpemVkJywKICAgICAgICAgICAgICAgICAgICAgICAgeWllbGRRdHk6IHlpZWxkUXR5VmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsWWllbGRRdHk6IHlpZWxkUXR5VmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkVW9tOiByb3dbJ1lpZWxkIFVPTSddIHx8ICdlYWNoJwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzZXR1cExpYnJhcnlUYWJzKCk7CiAgICAgICAgICAgICAgICBwb3B1bGF0ZUNhdGVnb3J5RmlsdGVyKCk7CiAgICAgICAgICAgICAgICBwb3B1bGF0ZU1hc3RlclByb2R1Y3REYXRhbGlzdCgpOwogICAgICAgICAgICAgICAgc2F2ZVN0YXRlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBwcm9jZXNzaW5nIGZpbGU6IiwgZXJyb3IpOwogICAgICAgICAgICAgICAgYWxlcnQoIlRoZXJlIHdhcyBhbiBlcnJvciByZWFkaW5nIHRoZSBFeGNlbCBmaWxlLiBQbGVhc2UgZW5zdXJlIGl0J3MgYSB2YWxpZCBmb3JtYXQuIik7CiAgICAgICAgICAgICAgICBleGNlbEZpbGVJbnB1dC52YWx1ZSA9ICIiOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7CiAgICB9CgogICAgLy8gLS0tIFVJIFJlbmRlcmluZyAtLS0KICAgIGZ1bmN0aW9uIHN3aXRjaFJpZ2h0VGFiKHRhYklkKSB7CiAgICAgICAgcmlnaHRQYW5lbFRhYnMucXVlcnlTZWxlY3RvckFsbCgnLnRhYi1idXR0b24nKS5mb3JFYWNoKGJ0biA9PiBidG4uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yaWdodC1wYW5lbC1ncm91cCAucGFuZWwnKS5mb3JFYWNoKHBhbmVsID0+IHBhbmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgICAKICAgICAgICBjb25zdCBhY3RpdmVCdXR0b24gPSByaWdodFBhbmVsVGFicy5xdWVyeVNlbGVjdG9yKGAudGFiLWJ1dHRvbltkYXRhLXRhYj0nJHt0YWJJZH0nXWApOwogICAgICAgIGNvbnN0IGFjdGl2ZVBhbmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFiSWQpOwoKICAgICAgICBpZihhY3RpdmVCdXR0b24pIGFjdGl2ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICBpZihhY3RpdmVQYW5lbCkgYWN0aXZlUGFuZWwuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICB9CgogICAgZnVuY3Rpb24gcG9wdWxhdGVDYXRlZ29yeUZpbHRlcigpIHsKICAgICAgICBtZW51Q2F0ZWdvcnlGaWx0ZXIuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgY29uc3Qgc2F2ZWRNYXN0ZXJQcm9kdWN0UExVcyA9IG5ldyBTZXQoc2F2ZWRSZWNpcGVzLm1hcChyID0+IHIubWFzdGVyLnBsdSkpOwogICAgICAgIGNvbnN0IGVsaWdpYmxlUHJvZHVjdHMgPSBpbXBvcnRlZFByb2R1Y3RzLmZpbHRlcihwcm9kdWN0ID0+CiAgICAgICAgICAgICFwcm9kdWN0Lm5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCcocmF3KScpICYmCiAgICAgICAgICAgICFzYXZlZE1hc3RlclByb2R1Y3RQTFVzLmhhcyhwcm9kdWN0LnBsdSkKICAgICAgICApOwogICAgICAgIAogICAgICAgIGNvbnN0IG1hblByb2R1Y3RzID0gZWxpZ2libGVQcm9kdWN0cy5maWx0ZXIocCA9PiBwLm5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCcobWFuKScpKTsKICAgICAgICBjb25zdCBvdGhlclByb2R1Y3RzID0gZWxpZ2libGVQcm9kdWN0cy5maWx0ZXIocCA9PiAhcC5uYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnKG1hbiknKSk7CgogICAgICAgIC8vIEFkZCBkZWZhdWx0ICJBbGwiIG9wdGlvbgogICAgICAgIGNvbnN0IGFsbE9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOwogICAgICAgIGFsbE9wdGlvbi52YWx1ZSA9ICdhbGwnOwogICAgICAgIGFsbE9wdGlvbi50ZXh0Q29udGVudCA9ICdBbGwgQ2F0ZWdvcmllcyc7CiAgICAgICAgbWVudUNhdGVnb3J5RmlsdGVyLmFwcGVuZENoaWxkKGFsbE9wdGlvbik7CiAgICAgICAgCiAgICAgICAgLy8gQWRkICJNYW51ZmFjdHVyZWQiIG9wdGlvbiBpZiB0aGVyZSBhcmUgYW55CiAgICAgICAgaWYgKG1hblByb2R1Y3RzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgY29uc3QgbWFuT3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7CiAgICAgICAgICAgIG1hbk9wdGlvbi52YWx1ZSA9ICdtYW51ZmFjdHVyZWQnOwogICAgICAgICAgICBtYW5PcHRpb24udGV4dENvbnRlbnQgPSAnTWFudWZhY3R1cmVkIFByb2R1Y3RzJzsKICAgICAgICAgICAgbWVudUNhdGVnb3J5RmlsdGVyLmFwcGVuZENoaWxkKG1hbk9wdGlvbik7CiAgICAgICAgfQoKICAgICAgICAvLyBBZGQgb3RoZXIgbWVudSBjYXRlZ29yaWVzCiAgICAgICAgY29uc3QgdW5pcXVlTWVudUNhdGVnb3JpZXMgPSBbLi4ubmV3IFNldChvdGhlclByb2R1Y3RzLm1hcChwID0+IHAubWVudUNhdGVnb3J5IHx8ICdVbmNhdGVnb3JpemVkJykpXS5zb3J0KCk7CiAgICAgICAgdW5pcXVlTWVudUNhdGVnb3JpZXMuZm9yRWFjaChjYXQgPT4gewogICAgICAgICAgICBjb25zdCBjYXRPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsKICAgICAgICAgICAgY2F0T3B0aW9uLnZhbHVlID0gY2F0OwogICAgICAgICAgICBjYXRPcHRpb24udGV4dENvbnRlbnQgPSBjYXQ7CiAgICAgICAgICAgIG1lbnVDYXRlZ29yeUZpbHRlci5hcHBlbmRDaGlsZChjYXRPcHRpb24pOwogICAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIHBvcHVsYXRlTWFzdGVyUHJvZHVjdERhdGFsaXN0KCkgewogICAgICAgIG1hc3RlclByb2R1Y3RMaXN0LmlubmVySFRNTCA9ICcnOwogICAgICAgIGNvbnN0IHNhdmVkTWFzdGVyUHJvZHVjdFBMVXMgPSBuZXcgU2V0KHNhdmVkUmVjaXBlcy5tYXAociA9PiByLm1hc3Rlci5wbHUpKTsKICAgICAgICAKICAgICAgICAvLyBXaGVuIGVkaXRpbmcsIHRoZSBzZWxlY3RlZCBwcm9kdWN0IGlzbid0IGluIHNhdmVkUmVjaXBlcywgYnV0IGl0IElTIHRoZSBgc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0YAogICAgICAgIGNvbnN0IGVsaWdpYmxlUHJvZHVjdHMgPSBpbXBvcnRlZFByb2R1Y3RzLmZpbHRlcihwcm9kdWN0ID0+CiAgICAgICAgICAgICFwcm9kdWN0Lm5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCcocmF3KScpICYmCiAgICAgICAgICAgICghc2F2ZWRNYXN0ZXJQcm9kdWN0UExVcy5oYXMocHJvZHVjdC5wbHUpIHx8IChpc0VkaXRpbmdSZWNpcGUgJiYgc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0ICYmIHByb2R1Y3QucGx1ID09PSBzZWxlY3RlZE1hc3RlclByb2R1Y3QucGx1KSkKICAgICAgICApOwoKICAgICAgICBjb25zdCBzZWxlY3RlZENhdGVnb3J5ID0gbWVudUNhdGVnb3J5RmlsdGVyLnZhbHVlOwogICAgICAgIGxldCBwcm9kdWN0c1RvTGlzdCA9IFtdOwoKICAgICAgICBpZiAoc2VsZWN0ZWRDYXRlZ29yeSA9PT0gJ2FsbCcpIHsKICAgICAgICAgICAgcHJvZHVjdHNUb0xpc3QgPSBlbGlnaWJsZVByb2R1Y3RzOwogICAgICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWRDYXRlZ29yeSA9PT0gJ21hbnVmYWN0dXJlZCcpIHsKICAgICAgICAgICAgcHJvZHVjdHNUb0xpc3QgPSBlbGlnaWJsZVByb2R1Y3RzLmZpbHRlcihwID0+IHAubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhtYW4pJykpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHByb2R1Y3RzVG9MaXN0ID0gZWxpZ2libGVQcm9kdWN0cy5maWx0ZXIocCA9PiAocC5tZW51Q2F0ZWdvcnkgfHwgJ1VuY2F0ZWdvcml6ZWQnKSA9PT0gc2VsZWN0ZWRDYXRlZ29yeSk7CiAgICAgICAgfQoKICAgICAgICBpZiAocHJvZHVjdHNUb0xpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIG1hc3RlclByb2R1Y3RJbnB1dC5wbGFjZWhvbGRlciA9ICItLSBObyBwcm9kdWN0cyBpbiB0aGlzIGNhdGVnb3J5IC0tIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtYXN0ZXJQcm9kdWN0SW5wdXQucGxhY2Vob2xkZXIgPSAiLS0gU3RhcnQgdHlwaW5nIHRvIHNlYXJjaCAtLSI7CiAgICAgICAgfQoKICAgICAgICBwcm9kdWN0c1RvTGlzdC5zb3J0KChhLGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpLmZvckVhY2gocHJvZHVjdCA9PiB7CiAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOwogICAgICAgICAgICBvcHRpb24udmFsdWUgPSBgJHtwcm9kdWN0Lm5hbWV9ICgke3Byb2R1Y3QucGx1fSlgOwogICAgICAgICAgICBvcHRpb24uZGF0YXNldC5wbHUgPSBwcm9kdWN0LnBsdTsKICAgICAgICAgICAgbWFzdGVyUHJvZHVjdExpc3QuYXBwZW5kQ2hpbGQob3B0aW9uKTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXR1cExpYnJhcnlUYWJzKCkgewogICAgICAgIGxpYnJhcnlUYWJzLmlubmVySFRNTCA9ICcnOwogICAgICAgIHRhYkNvbnRlbnRzLmlubmVySFRNTCA9ICcnOwoKICAgICAgICBjb25zdCBhdmFpbGFibGVJbmdyZWRpZW50cyA9IGltcG9ydGVkUHJvZHVjdHMuZmlsdGVyKHAgPT4gewogICAgICAgICAgICAvLyBUcmltIGFuZCBjb252ZXJ0IHRvIGxvd2VyIGNhc2UgZm9yIGEgY2FzZS1pbnNlbnNpdGl2ZSBjaGVjay4KICAgICAgICAgICAgY29uc3QgY2xlYW5DYXRlZ29yeSA9IChwLmNhdGVnb3J5IHx8ICcnKS50cmltKCkudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIEFuIGluZ3JlZGllbnQgaXMgYW55IHByb2R1Y3QgdGhhdCBoYXMgYW4gaW52ZW50b3J5IGNhdGVnb3J5IGNvbnRhaW5pbmcgInJhdyBtYXRlcmlhbCIgb3IgIm1hbnVmYWN0dXJlZCIuCiAgICAgICAgICAgIC8vIFVzaW5nIC5pbmNsdWRlcygpIGlzIG1vcmUgZmxleGlibGUgdGhhbiAuZW5kc1dpdGgoKQogICAgICAgICAgICByZXR1cm4gY2xlYW5DYXRlZ29yeS5pbmNsdWRlcygncmF3IG1hdGVyaWFsJykgfHwgY2xlYW5DYXRlZ29yeS5pbmNsdWRlcygnbWFudWZhY3R1cmVkJyk7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChhdmFpbGFibGVJbmdyZWRpZW50cy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgaWYgKGltcG9ydGVkUHJvZHVjdHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgbGlicmFyeVRhYnMuaW5uZXJIVE1MID0gJzxwIHN0eWxlPSJwYWRkaW5nOiAxMHB4OyBjb2xvcjogdmFyKC0teW9jby10ZXh0LXNlY29uZGFyeSk7Ij5ObyB2YWxpZCBpbmdyZWRpZW50cyBmb3VuZC48L3A+JzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm47IC8vIEV4aXQgaWYgbm8gaW5ncmVkaWVudHMgdG8gc2hvdwogICAgICAgIH0KCiAgICAgICAgLy8gLS0tIENyZWF0ZSAiQWxsIiBUYWIgLS0tCiAgICAgICAgY29uc3QgYWxsVGFiSWQgPSAndGFiLWFsbCc7CiAgICAgICAgY29uc3QgYWxsVGFiQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgYWxsVGFiQnV0dG9uLmNsYXNzTmFtZSA9ICd0YWItYnV0dG9uJzsKICAgICAgICBhbGxUYWJCdXR0b24uZGF0YXNldC50YWIgPSBhbGxUYWJJZDsKICAgICAgICBhbGxUYWJCdXR0b24udGV4dENvbnRlbnQgPSAnQWxsJzsKICAgICAgICBsaWJyYXJ5VGFicy5hcHBlbmRDaGlsZChhbGxUYWJCdXR0b24pOwoKICAgICAgICBjb25zdCBhbGxUYWJDb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgYWxsVGFiQ29udGVudC5pZCA9IGFsbFRhYklkOwogICAgICAgIGFsbFRhYkNvbnRlbnQuY2xhc3NOYW1lID0gJ3RhYi1jb250ZW50JzsKCiAgICAgICAgY29uc3QgYWxsU2VhcmNoSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwogICAgICAgIGFsbFNlYXJjaElucHV0LnR5cGUgPSAndGV4dCc7CiAgICAgICAgYWxsU2VhcmNoSW5wdXQuY2xhc3NOYW1lID0gJ3NlYXJjaC1iYXInOwogICAgICAgIGFsbFNlYXJjaElucHV0LnBsYWNlaG9sZGVyID0gJ1NlYXJjaCBhbGwgaW5ncmVkaWVudHMuLi4nOwogICAgICAgIGFsbFNlYXJjaElucHV0Lm9ua2V5dXAgPSAoZSkgPT4gZmlsdGVySW5ncmVkaWVudHMoZS50YXJnZXQudmFsdWUsIGFsbFRhYklkKTsKCiAgICAgICAgY29uc3QgYWxsTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7CiAgICAgICAgYWxsTGlzdC5jbGFzc05hbWUgPSAnaW5ncmVkaWVudC1saXN0JzsKICAgICAgICAKICAgICAgICAvLyBTb3J0IGFsbCBpbmdyZWRpZW50cyBhbHBoYWJldGljYWxseSBieSBuYW1lIGZvciB0aGUgIkFsbCIgdGFiCiAgICAgICAgYXZhaWxhYmxlSW5ncmVkaWVudHMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSkuZm9yRWFjaChwcm9kdWN0ID0+IHsKICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7CiAgICAgICAgICAgIGl0ZW0uY2xhc3NOYW1lID0gJ2luZ3JlZGllbnQtaXRlbSc7CiAgICAgICAgICAgIGl0ZW0udGl0bGUgPSAiQ2xpY2sgdG8gYWRkIHRoaXMgaXRlbSB0byB0aGUgY3VycmVudCByZWNpcGUuIjsKICAgICAgICAgICAgaXRlbS5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJuYW1lIj4ke3Byb2R1Y3QubmFtZX08L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InVvbSI+KCR7cHJvZHVjdC51b219KTwvc3Bhbj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9ImNvc3QiPlIke3Byb2R1Y3QuY29zdC50b0ZpeGVkKDIpfTwvc3Bhbj4KICAgICAgICAgICAgYDsKICAgICAgICAgICAgaXRlbS5vbmNsaWNrID0gKCkgPT4gYWRkUHJvZHVjdFRvUmVjaXBlKHByb2R1Y3QpOwogICAgICAgICAgICBhbGxMaXN0LmFwcGVuZENoaWxkKGl0ZW0pOwogICAgICAgIH0pOwoKICAgICAgICBhbGxUYWJDb250ZW50LmFwcGVuZENoaWxkKGFsbFNlYXJjaElucHV0KTsKICAgICAgICBhbGxUYWJDb250ZW50LmFwcGVuZENoaWxkKGFsbExpc3QpOwogICAgICAgIHRhYkNvbnRlbnRzLmFwcGVuZENoaWxkKGFsbFRhYkNvbnRlbnQpOwoKCiAgICAgICAgLy8gLS0tIENyZWF0ZSBDYXRlZ29yeSBUYWJzIC0tLQogICAgICAgIGNvbnN0IGFsbENhdGVnb3JpZXMgPSBbLi4ubmV3IFNldChhdmFpbGFibGVJbmdyZWRpZW50cy5tYXAocCA9PiBwLmNhdGVnb3J5KSldOwogICAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhbGxDYXRlZ29yaWVzLmZpbHRlcihjID0+IGMgJiYgYy50cmltKCkgIT09ICcnICYmIGMudHJpbSgpICE9PSAnVW5jYXRlZ29yaXplZCcpLnNvcnQoKTsKCiAgICAgICAgY2F0ZWdvcmllcy5mb3JFYWNoKGNhdGVnb3J5ID0+IHsKICAgICAgICAgICAgY29uc3QgdGFiSWQgPSBgdGFiLSR7Y2F0ZWdvcnkucmVwbGFjZSgvW15hLXpBLVowLTldL2csICctJyl9YDsgLy8gU2FuaXRpemUgSUQgZm9yIHNhZmV0eQogICAgICAgICAgICBjb25zdCB0YWJCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgdGFiQnV0dG9uLmNsYXNzTmFtZSA9ICd0YWItYnV0dG9uJzsKICAgICAgICAgICAgdGFiQnV0dG9uLmRhdGFzZXQudGFiID0gdGFiSWQ7CiAgICAgICAgICAgIHRhYkJ1dHRvbi50ZXh0Q29udGVudCA9IGNhdGVnb3J5OwogICAgICAgICAgICBsaWJyYXJ5VGFicy5hcHBlbmRDaGlsZCh0YWJCdXR0b24pOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgdGFiQ29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICB0YWJDb250ZW50LmlkID0gdGFiSWQ7CiAgICAgICAgICAgIHRhYkNvbnRlbnQuY2xhc3NOYW1lID0gJ3RhYi1jb250ZW50JzsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnN0IHNlYXJjaElucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICAgICAgc2VhcmNoSW5wdXQudHlwZSA9ICd0ZXh0JzsKICAgICAgICAgICAgc2VhcmNoSW5wdXQuY2xhc3NOYW1lID0gJ3NlYXJjaC1iYXInOwogICAgICAgICAgICBzZWFyY2hJbnB1dC5wbGFjZWhvbGRlciA9IGBTZWFyY2ggaW4gJHtjYXRlZ29yeX0uLi5gOwogICAgICAgICAgICBzZWFyY2hJbnB1dC5vbmtleXVwID0gKGUpID0+IGZpbHRlckluZ3JlZGllbnRzKGUudGFyZ2V0LnZhbHVlLCB0YWJJZCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTsKICAgICAgICAgICAgbGlzdC5jbGFzc05hbWUgPSAnaW5ncmVkaWVudC1saXN0JzsKCiAgICAgICAgICAgIGNvbnN0IGNhdGVnb3J5UHJvZHVjdHMgPSBhdmFpbGFibGVJbmdyZWRpZW50cy5maWx0ZXIocCA9PiBwLmNhdGVnb3J5ID09PSBjYXRlZ29yeSk7CiAgICAgICAgICAgIC8vIFNvcnQgcHJvZHVjdHMgd2l0aGluIGVhY2ggY2F0ZWdvcnkgYXMgd2VsbAogICAgICAgICAgICBjYXRlZ29yeVByb2R1Y3RzLnNvcnQoKGEsIGIpID0+IGEubmFtZS5sb2NhbGVDb21wYXJlKGIubmFtZSkpLmZvckVhY2gocHJvZHVjdCA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTsKICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NOYW1lID0gJ2luZ3JlZGllbnQtaXRlbSc7CiAgICAgICAgICAgICAgICBpdGVtLnRpdGxlID0gIkNsaWNrIHRvIGFkZCB0aGlzIGl0ZW0gdG8gdGhlIGN1cnJlbnQgcmVjaXBlLiI7CiAgICAgICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibmFtZSI+JHtwcm9kdWN0Lm5hbWV9PC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idW9tIj4oJHtwcm9kdWN0LnVvbX0pPC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJjb3N0Ij5SJHtwcm9kdWN0LmNvc3QudG9GaXhlZCgyKX08L3NwYW4+CiAgICAgICAgICAgICAgICBgOwogICAgICAgICAgICAgICAgaXRlbS5vbmNsaWNrID0gKCkgPT4gYWRkUHJvZHVjdFRvUmVjaXBlKHByb2R1Y3QpOwogICAgICAgICAgICAgICAgbGlzdC5hcHBlbmRDaGlsZChpdGVtKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgICAgICB0YWJDb250ZW50LmFwcGVuZENoaWxkKHNlYXJjaElucHV0KTsKICAgICAgICAgICAgdGFiQ29udGVudC5hcHBlbmRDaGlsZChsaXN0KTsKICAgICAgICAgICAgdGFiQ29udGVudHMuYXBwZW5kQ2hpbGQodGFiQ29udGVudCk7CiAgICAgICAgfSk7CgogICAgICAgIC8vIC0tLSBGaW5hbGl6ZSBUYWJzIC0tLQogICAgICAgIGxpYnJhcnlUYWJzLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWItYnV0dG9uJykuZm9yRWFjaChidG4gPT4gewogICAgICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBzd2l0Y2hUYWIoYnRuLmRhdGFzZXQudGFiKSk7CiAgICAgICAgfSk7CgogICAgICAgIC8vIEFjdGl2YXRlIHRoZSAnQWxsJyB0YWIgYnkgZGVmYXVsdAogICAgICAgIHN3aXRjaFRhYihhbGxUYWJJZCk7CiAgICB9CgoKICAgIGZ1bmN0aW9uIHN3aXRjaFRhYih0YWJJZCkgewogICAgICAgIGxpYnJhcnlUYWJzLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWItYnV0dG9uJykuZm9yRWFjaChidG4gPT4gYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgICB0YWJDb250ZW50cy5xdWVyeVNlbGVjdG9yQWxsKCcudGFiLWNvbnRlbnQnKS5mb3JFYWNoKGNvbnRlbnQgPT4gY29udGVudC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgICAgICAgCiAgICAgICAgY29uc3QgYWN0aXZlQnV0dG9uID0gbGlicmFyeVRhYnMucXVlcnlTZWxlY3RvcihgLnRhYi1idXR0b25bZGF0YS10YWI9JyR7dGFiSWR9J11gKTsKICAgICAgICBjb25zdCBhY3RpdmVDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFiSWQpOwoKICAgICAgICBpZihhY3RpdmVCdXR0b24pIGFjdGl2ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgICBpZihhY3RpdmVDb250ZW50KSBhY3RpdmVDb250ZW50LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgfQoKICAgIGZ1bmN0aW9uIGZpbHRlckluZ3JlZGllbnRzKHNlYXJjaFRlcm0sIHRhYklkKSB7CiAgICAgICAgY29uc3QgbGlzdEl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgIyR7dGFiSWR9IC5pbmdyZWRpZW50LWl0ZW1gKTsKICAgICAgICBjb25zdCBsb3dlckNhc2VTZWFyY2hUZXJtID0gc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGxpc3RJdGVtcy5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgICBjb25zdCBuYW1lID0gaXRlbS5xdWVyeVNlbGVjdG9yKCcubmFtZScpLnRleHRDb250ZW50LnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgIGl0ZW0uc3R5bGUuZGlzcGxheSA9IG5hbWUuaW5jbHVkZXMobG93ZXJDYXNlU2VhcmNoVGVybSkgPyAnZmxleCcgOiAnbm9uZSc7CiAgICAgICAgfSk7CiAgICB9CgogICAgLy8gLS0tIFJlY2lwZSBMb2dpYyAtLS0KICAgIGZ1bmN0aW9uIGhhbmRsZU1hc3RlclByb2R1Y3RJbnB1dChldmVudCkgewogICAgICAgIGNvbnN0IGlucHV0VmFsdWUgPSBldmVudC50YXJnZXQudmFsdWU7CiAgICAgICAgY29uc3Qgb3B0aW9uID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjbWFzdGVyUHJvZHVjdExpc3Qgb3B0aW9uJykpLmZpbmQob3B0ID0+IG9wdC52YWx1ZSA9PT0gaW5wdXRWYWx1ZSk7CiAgICAgICAgc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0ID0gb3B0aW9uID8gaW1wb3J0ZWRQcm9kdWN0cy5maW5kKHAgPT4gcC5wbHUudG9TdHJpbmcoKSA9PT0gb3B0aW9uLmRhdGFzZXQucGx1KSA6IG51bGw7CiAgICAgICAgCiAgICAgICAgaWYgKHNlbGVjdGVkTWFzdGVyUHJvZHVjdCAmJiBzZWxlY3RlZE1hc3RlclByb2R1Y3QubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhtYW4pJykpIHsKICAgICAgICAgICAgeWllbGRGaWVsZHNDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdncmlkJzsKICAgICAgICAgICAgeWllbGRRdHlJbnB1dC52YWx1ZSA9IHNlbGVjdGVkTWFzdGVyUHJvZHVjdC5vcmlnaW5hbFlpZWxkUXR5IHx8IDE7CiAgICAgICAgICAgIHlpZWxkVW9tSW5wdXQudmFsdWUgPSBzZWxlY3RlZE1hc3RlclByb2R1Y3Qub3JpZ2luYWxVb207CiAgICAgICAgICAgIHNldFlpZWxkRmllbGRzUmVhZE9ubHkodHJ1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgeWllbGRGaWVsZHNDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICB9CgogICAgICAgIHVwZGF0ZVN1bW1hcnkoKTsKICAgICAgICBtYXN0ZXJQcm9kdWN0Q2xlYXJCdG4uc3R5bGUuZGlzcGxheSA9IGlucHV0VmFsdWUubGVuZ3RoID4gMCA/ICdibG9jaycgOiAnbm9uZSc7CiAgICB9CgogICAgZnVuY3Rpb24gY2xlYXJNYXN0ZXJQcm9kdWN0SW5wdXQoKSB7CiAgICAgICAgbWFzdGVyUHJvZHVjdElucHV0LnZhbHVlID0gJyc7CiAgICAgICAgc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0ID0gbnVsbDsKICAgICAgICB1cGRhdGVTdW1tYXJ5KCk7CiAgICAgICAgbWFzdGVyUHJvZHVjdENsZWFyQnRuLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgeWllbGRGaWVsZHNDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICBtYXN0ZXJQcm9kdWN0SW5wdXQuZm9jdXMoKTsKICAgIH0KICAgIAogICAgZnVuY3Rpb24gYWRkUHJvZHVjdFRvUmVjaXBlKHByb2R1Y3QpIHsKICAgICAgICAvLyBDaGVjayBpZiB0aGUgcHJvZHVjdCBpcyBhIChNQU4pIGl0ZW0gdGhhdCBkb2Vzbid0IGhhdmUgYSBzYXZlZCByZWNpcGUgeWV0CiAgICAgICAgaWYgKHByb2R1Y3QubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhtYW4pJykpIHsKICAgICAgICAgICAgY29uc3QgaXNNYW5SZWNpcGVTYXZlZCA9IHNhdmVkUmVjaXBlcy5zb21lKHIgPT4gci5tYXN0ZXIucGx1LnRvU3RyaW5nKCkgPT09IHByb2R1Y3QucGx1LnRvU3RyaW5nKCkpOwogICAgICAgICAgICBpZiAoIWlzTWFuUmVjaXBlU2F2ZWQpIHsKICAgICAgICAgICAgICAgIGFsZXJ0KGBBIHJlY2lwZSBmb3IgIiR7cHJvZHVjdC5uYW1lfSIgbXVzdCBiZSBidWlsdCBhbmQgc2F2ZWQgZmlyc3QgYmVmb3JlIGl0IGNhbiBiZSB1c2VkIGFzIGFuIGluZ3JlZGllbnQuYCk7CiAgICAgICAgICAgICAgICByZXR1cm47IC8vIFN0b3AgdGhlIGZ1bmN0aW9uCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChyZWNpcGVJdGVtcy5zb21lKGl0ZW0gPT4gaXRlbS5wbHUgPT09IHByb2R1Y3QucGx1KSkgewogICAgICAgICAgICBhbGVydChgJHtwcm9kdWN0Lm5hbWV9IGlzIGFscmVhZHkgaW4gdGhlIHJlY2lwZS5gKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICByZWNpcGVJdGVtcy5wdXNoKHsgLi4ucHJvZHVjdCwgcXVhbnRpdHk6ICcnIH0pOwogICAgICAgIHJlbmRlclJlY2lwZVRhYmxlKCk7CiAgICAgICAgdXBkYXRlU3VtbWFyeSgpOwogICAgfQogICAgCiAgICBmdW5jdGlvbiB1cGRhdGVSZWNpcGVRdWFudGl0eShwbHUsIHF1YW50aXR5KSB7CiAgICAgICAgY29uc3QgaXRlbSA9IHJlY2lwZUl0ZW1zLmZpbmQoaSA9PiBpLnBsdS50b1N0cmluZygpID09PSBwbHUudG9TdHJpbmcoKSk7CiAgICAgICAgaWYgKGl0ZW0pIGl0ZW0ucXVhbnRpdHkgPSBwYXJzZUZsb2F0KHF1YW50aXR5KSB8fCAwOwogICAgICAgIHJlbmRlclJlY2lwZVRhYmxlKCk7CiAgICAgICAgdXBkYXRlU3VtbWFyeSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIHJlbW92ZVJlY2lwZUl0ZW0ocGx1KSB7CiAgICAgICAgcmVjaXBlSXRlbXMgPSByZWNpcGVJdGVtcy5maWx0ZXIoaXRlbSA9PiBpdGVtLnBsdS50b1N0cmluZygpICE9PSBwbHUudG9TdHJpbmcoKSk7CiAgICAgICAgcmVuZGVyUmVjaXBlVGFibGUoKTsKICAgICAgICB1cGRhdGVTdW1tYXJ5KCk7CiAgICB9CgogICAgZnVuY3Rpb24gcmVuZGVyUmVjaXBlVGFibGUoKSB7CiAgICAgICAgcmVjaXBlVGFibGVCb2R5LmlubmVySFRNTCA9ICcnOwogICAgICAgIHJlY2lwZUl0ZW1zLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7CiAgICAgICAgICAgIGNvbnN0IGl0ZW1Ub3RhbENvc3QgPSBpdGVtLmNvc3QgKiBpdGVtLnF1YW50aXR5OwogICAgICAgICAgICByb3cuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgPHRkPiR7aXRlbS5wbHV9PC90ZD4KICAgICAgICAgICAgICAgIDx0ZD4ke2l0ZW0ubmFtZX08L3RkPgogICAgICAgICAgICAgICAgPHRkPiR7aXRlbS51b219PC90ZD4KICAgICAgICAgICAgICAgIDx0ZD5SJHtpdGVtLmNvc3QudG9GaXhlZCgyKX08L3RkPgogICAgICAgICAgICAgICAgPHRkPjxpbnB1dCB0eXBlPSJudW1iZXIiIHZhbHVlPSIke2l0ZW0ucXVhbnRpdHl9IiBwbGFjZWhvbGRlcj0iMC4wMDAiIG1pbj0iMCIgc3RlcD0iMC4wMDEiIG9uY2hhbmdlPSJ1cGRhdGVSZWNpcGVRdWFudGl0eSgnJHtpdGVtLnBsdX0nLCB0aGlzLnZhbHVlKSI+PC90ZD4KICAgICAgICAgICAgICAgIDx0ZD5SJHtpdGVtVG90YWxDb3N0LnRvRml4ZWQoMil9PC90ZD4KICAgICAgICAgICAgICAgIDx0ZD48YnV0dG9uIGNsYXNzPSJyZW1vdmUtYnRuIiB0aXRsZT0iUmVtb3ZlIHRoaXMgaW5ncmVkaWVudCBmcm9tIHRoZSBjdXJyZW50IHJlY2lwZS4iIG9uY2xpY2s9InJlbW92ZVJlY2lwZUl0ZW0oJyR7aXRlbS5wbHV9JykiPiZ0aW1lczs8L2J1dHRvbj48L3RkPgogICAgICAgICAgICBgOwogICAgICAgICAgICByZWNpcGVUYWJsZUJvZHkuYXBwZW5kQ2hpbGQocm93KTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVTdW1tYXJ5KCkgewogICAgICAgIC8vIDEuIENhbGN1bGF0ZSBhbmQgZGlzcGxheSB0b3RhbCBjb3N0CiAgICAgICAgY29uc3QgdG90YWwgPSByZWNpcGVJdGVtcy5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKGl0ZW0uY29zdCAqIGl0ZW0ucXVhbnRpdHkpLCAwKTsKICAgICAgICB0b3RhbENvc3REaXNwbGF5LnRleHRDb250ZW50ID0gYFIke3RvdGFsLnRvRml4ZWQoMil9YDsKCiAgICAgICAgLy8gMi4gRGlzcGxheSBzZWxsaW5nIHByaWNlIGFuZCBHUCUgaWYgYSBtYXN0ZXIgcHJvZHVjdCBpcyBzZWxlY3RlZAogICAgICAgIGlmIChzZWxlY3RlZE1hc3RlclByb2R1Y3QgJiYgdHlwZW9mIHNlbGVjdGVkTWFzdGVyUHJvZHVjdC5zZWxsaW5nUHJpY2UgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICAgIGNvbnN0IHNlbGxpbmdQcmljZSA9IHNlbGVjdGVkTWFzdGVyUHJvZHVjdC5zZWxsaW5nUHJpY2U7CiAgICAgICAgICAgIG1hc3RlclNlbGxpbmdQcmljZURpc3BsYXkudGV4dENvbnRlbnQgPSBgUiR7c2VsbGluZ1ByaWNlLnRvRml4ZWQoMil9YDsKICAgICAgICAgICAgc2VsbGluZ1ByaWNlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwoKICAgICAgICAgICAgbGV0IGdwID0gMDsKICAgICAgICAgICAgaWYgKHNlbGxpbmdQcmljZSA+IDApIHsKICAgICAgICAgICAgICAgIGdwID0gKChzZWxsaW5nUHJpY2UgLSB0b3RhbCkgLyBzZWxsaW5nUHJpY2UpICogMTAwOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgIGdwID0gLTEwMDsgLy8gT3IgaGFuZGxlIGFzIHlvdSBzZWUgZml0IGlmIHNlbGxpbmcgcHJpY2UgaXMgemVybwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBncFBlcmNlbnRhZ2VEaXNwbGF5LnRleHRDb250ZW50ID0gYCR7Z3AudG9GaXhlZCgyKX0lYDsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIENvbG9yIGNvZGUgdGhlIEdQJQogICAgICAgICAgICBpZiAoZ3AgPCAzMCkgewogICAgICAgICAgICAgICAgZ3BQZXJjZW50YWdlRGlzcGxheS5zdHlsZS5jb2xvciA9ICd2YXIoLS15b2NvLXJlZCknOwogICAgICAgICAgICB9IGVsc2UgaWYgKGdwIDwgNjApIHsKICAgICAgICAgICAgICAgIGdwUGVyY2VudGFnZURpc3BsYXkuc3R5bGUuY29sb3IgPSAndmFyKC0teW9jby1vcmFuZ2UpJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGdwUGVyY2VudGFnZURpc3BsYXkuc3R5bGUuY29sb3IgPSAndmFyKC0teW9jby1ncmVlbiknOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBncFBlcmNlbnRhZ2VDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEhpZGUgaWYgbm8gbWFzdGVyIHByb2R1Y3QgaXMgc2VsZWN0ZWQKICAgICAgICAgICAgc2VsbGluZ1ByaWNlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIGdwUGVyY2VudGFnZUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIH0KICAgIH0KCgogICAgLy8gLS0tIFNhdmVkIFJlY2lwZXMgTG9naWMgLS0tCiAgICBmdW5jdGlvbiBzYXZlQ3VycmVudFJlY2lwZSgpIHsKICAgICAgICBpZiAoIXNlbGVjdGVkTWFzdGVyUHJvZHVjdCkgewogICAgICAgICAgICBhbGVydCgnUGxlYXNlIHNlbGVjdCBhIHZhbGlkIE1hc3RlciBQcm9kdWN0IGJlZm9yZSBzYXZpbmcuJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHJlY2lwZUl0ZW1zLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBhbGVydCgnQ2Fubm90IHNhdmUgYW4gZW1wdHkgcmVjaXBlLicpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNvbnN0IGl0ZW1XaXRoTm9RdWFudGl0eSA9IHJlY2lwZUl0ZW1zLmZpbmQoaXRlbSA9PiAhaXRlbS5xdWFudGl0eSB8fCBwYXJzZUZsb2F0KGl0ZW0ucXVhbnRpdHkpIDw9IDApOwogICAgICAgIGlmIChpdGVtV2l0aE5vUXVhbnRpdHkpIHsKICAgICAgICAgICAgYWxlcnQoYFBsZWFzZSBwcm92aWRlIGEgcXVhbnRpdHkgZ3JlYXRlciB0aGFuIDAgZm9yIGFsbCBpbmdyZWRpZW50cy4gVGhlIGl0ZW0gIiR7aXRlbVdpdGhOb1F1YW50aXR5Lm5hbWV9IiBuZWVkcyBhIHF1YW50aXR5LmApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCBpc01hblByb2R1Y3QgPSBzZWxlY3RlZE1hc3RlclByb2R1Y3QubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhtYW4pJyk7CiAgICAgICAgY29uc3QgeWllbGRRdHkgPSBwYXJzZUZsb2F0KHlpZWxkUXR5SW5wdXQudmFsdWUpOwogICAgICAgIAogICAgICAgIGlmIChpc01hblByb2R1Y3QgJiYgKCF5aWVsZFF0eSB8fCB5aWVsZFF0eSA8PSAwKSkgewogICAgICAgICAgICBhbGVydCgnTWFudWZhY3R1cmVkIHByb2R1Y3RzIG11c3QgaGF2ZSBhIFlpZWxkIFF1YW50aXR5IGdyZWF0ZXIgdGhhbiAwLicpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBSZW1lbWJlciB0aGUgY2F0ZWdvcnkgYmVmb3JlIHNhdmluZwogICAgICAgIGNvbnN0IGxhc3RTZWxlY3RlZENhdGVnb3J5ID0gbWVudUNhdGVnb3J5RmlsdGVyLnZhbHVlOwoKICAgICAgICBjb25zdCB0b3RhbENvc3QgPSByZWNpcGVJdGVtcy5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgKGl0ZW0uY29zdCAqIGl0ZW0ucXVhbnRpdHkpLCAwKTsKICAgICAgICAKICAgICAgICBjb25zdCBtYXN0ZXJEYXRhRm9yUmVjaXBlID0gewogICAgICAgICAgICAuLi5zZWxlY3RlZE1hc3RlclByb2R1Y3QKICAgICAgICB9OwoKICAgICAgICAvLyBJZiB0aGUgc2F2ZWQgcmVjaXBlIGlzIGZvciBhIChNQU4pIHByb2R1Y3QsIHVwZGF0ZSBpdHMgY29zdCBpbiB0aGUgbWFpbiBwcm9kdWN0IGxpc3QKICAgICAgICBpZiAoaXNNYW5Qcm9kdWN0KSB7CiAgICAgICAgICAgIGNvbnN0IHlpZWxkVW9tID0geWllbGRVb21JbnB1dC52YWx1ZS50cmltKCkgfHwgc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0LnVvbTsKICAgICAgICAgICAgY29uc3QgY29zdFBlcllpZWxkVW5pdCA9IHRvdGFsQ29zdCAvIHlpZWxkUXR5OwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQWRkIHlpZWxkIGluZm8gdG8gdGhlIHJlY2lwZSBtYXN0ZXIgZGF0YQogICAgICAgICAgICBtYXN0ZXJEYXRhRm9yUmVjaXBlLnlpZWxkUXR5ID0geWllbGRRdHk7CiAgICAgICAgICAgIG1hc3RlckRhdGFGb3JSZWNpcGUueWllbGRVb20gPSB5aWVsZFVvbTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgbWFzdGVyIHByb2R1Y3QgbGlzdCBmb3IgZnV0dXJlIHVzZSBhcyBhbiBpbmdyZWRpZW50CiAgICAgICAgICAgIGNvbnN0IHByb2R1Y3RJbmRleCA9IGltcG9ydGVkUHJvZHVjdHMuZmluZEluZGV4KHAgPT4gcC5wbHUudG9TdHJpbmcoKSA9PT0gc2VsZWN0ZWRNYXN0ZXJQcm9kdWN0LnBsdS50b1N0cmluZygpKTsKICAgICAgICAgICAgaWYgKHByb2R1Y3RJbmRleCA+IC0xKSB7CiAgICAgICAgICAgICAgICBpbXBvcnRlZFByb2R1Y3RzW3Byb2R1Y3RJbmRleF0uY29zdCA9IGNvc3RQZXJZaWVsZFVuaXQ7CiAgICAgICAgICAgICAgICBpbXBvcnRlZFByb2R1Y3RzW3Byb2R1Y3RJbmRleF0udW9tID0geWllbGRVb207CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnN0IGV4aXN0aW5nSW5kZXggPSBzYXZlZFJlY2lwZXMuZmluZEluZGV4KHIgPT4gci5tYXN0ZXIucGx1ID09PSBzZWxlY3RlZE1hc3RlclByb2R1Y3QucGx1KTsKICAgICAgICBjb25zdCByZWNpcGVUb1NhdmUgPSB7IG1hc3RlcjogbWFzdGVyRGF0YUZvclJlY2lwZSwgaXRlbXM6IFsuLi5yZWNpcGVJdGVtc10gfTsKICAgICAgICAKICAgICAgICBpZiAoZXhpc3RpbmdJbmRleCA+IC0xKSB7CiAgICAgICAgICAgIC8vIE5vIG5lZWQgdG8gY29uZmlybSB3aGVuIHVwZGF0aW5nLCBhcyBpdCdzIGFuIGV4cGxpY2l0IGFjdGlvbiBmcm9tICJFZGl0IgogICAgICAgICAgICBzYXZlZFJlY2lwZXNbZXhpc3RpbmdJbmRleF0gPSByZWNpcGVUb1NhdmU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2F2ZWRSZWNpcGVzLnB1c2gocmVjaXBlVG9TYXZlKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgY2xlYXJDdXJyZW50UmVjaXBlQnVpbGRlcigpOwogICAgICAgIHJlbmRlclNhdmVkUmVjaXBlcygpOwogICAgICAgIHJlbmRlcllpZWxkRWRpdG9yKCk7CiAgICAgICAgc2F2ZVN0YXRlKCk7CiAgICAgICAgCiAgICAgICAgLy8gUmVwb3B1bGF0ZSBtYXN0ZXIgZGF0YQogICAgICAgIHBvcHVsYXRlQ2F0ZWdvcnlGaWx0ZXIoKTsgCiAgICAgICAgc2V0dXBMaWJyYXJ5VGFicygpOyAvLyBSZS1yZW5kZXIgbGlicmFyeSB0byByZWZsZWN0IG5ldyBjb3N0cy9VT01zCiAgICAgICAgc2F2ZWRSZWNpcGVTZWFyY2gudmFsdWUgPSAnJzsKCiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGxhc3QgdXNlZCBjYXRlZ29yeSBpcyBub3cgZW1wdHkKICAgICAgICBjb25zdCBzYXZlZE1hc3RlclByb2R1Y3RQTFVzID0gbmV3IFNldChzYXZlZFJlY2lwZXMubWFwKHIgPT4gci5tYXN0ZXIucGx1KSk7CiAgICAgICAgY29uc3QgZWxpZ2libGVQcm9kdWN0cyA9IGltcG9ydGVkUHJvZHVjdHMuZmlsdGVyKHByb2R1Y3QgPT4KICAgICAgICAgICAgIXByb2R1Y3QubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhyYXcpJykgJiYKICAgICAgICAgICAgIXNhdmVkTWFzdGVyUHJvZHVjdFBMVXMuaGFzKHByb2R1Y3QucGx1KQogICAgICAgICk7CgogICAgICAgIGxldCBwcm9kdWN0c0xlZnRJbkNhdGVnb3J5ID0gW107CiAgICAgICAgaWYgKGxhc3RTZWxlY3RlZENhdGVnb3J5ID09PSAnYWxsJykgewogICAgICAgICAgICBwcm9kdWN0c0xlZnRJbkNhdGVnb3J5ID0gZWxpZ2libGVQcm9kdWN0czsKICAgICAgICB9IGVsc2UgaWYgKGxhc3RTZWxlY3RlZENhdGVnb3J5ID09PSAnbWFudWZhY3R1cmVkJykgewogICAgICAgICAgICBwcm9kdWN0c0xlZnRJbkNhdGVnb3J5ID0gZWxpZ2libGVQcm9kdWN0cy5maWx0ZXIocCA9PiBwLm5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCcobWFuKScpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwcm9kdWN0c0xlZnRJbkNhdGVnb3J5ID0gZWxpZ2libGVQcm9kdWN0cy5maWx0ZXIocCA9PiAocC5tZW51Q2F0ZWdvcnkgfHwgJ1VuY2F0ZWdvcml6ZWQnKSA9PT0gbGFzdFNlbGVjdGVkQ2F0ZWdvcnkpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHByb2R1Y3RzTGVmdEluQ2F0ZWdvcnkubGVuZ3RoID4gMCAmJiBsYXN0U2VsZWN0ZWRDYXRlZ29yeSAhPT0gJ2FsbCcpIHsKICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIHN0aWxsIHByb2R1Y3RzLCBrZWVwIHRoZSBmaWx0ZXIgb24gdGhhdCBjYXRlZ29yeQogICAgICAgICAgICBtZW51Q2F0ZWdvcnlGaWx0ZXIudmFsdWUgPSBsYXN0U2VsZWN0ZWRDYXRlZ29yeTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBJZiB0aGUgY2F0ZWdvcnkgaXMgZW1wdHkgb3Igd2FzICdhbGwnLCByZXNldCB0byAnYWxsJwogICAgICAgICAgICBtZW51Q2F0ZWdvcnlGaWx0ZXIudmFsdWUgPSAnYWxsJzsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gRmluYWxseSwgcG9wdWxhdGUgdGhlIG1hc3RlciBwcm9kdWN0IGxpc3QgYmFzZWQgb24gdGhlIChwb3RlbnRpYWxseSBzdGlja3kpIGNhdGVnb3J5CiAgICAgICAgcG9wdWxhdGVNYXN0ZXJQcm9kdWN0RGF0YWxpc3QoKTsgCiAgICB9CgogICAgZnVuY3Rpb24gY2xlYXJDdXJyZW50UmVjaXBlQnVpbGRlcigpIHsKICAgICAgICBjbGVhck1hc3RlclByb2R1Y3RJbnB1dCgpOwogICAgICAgIHJlY2lwZUl0ZW1zID0gW107CiAgICAgICAgeWllbGRRdHlJbnB1dC52YWx1ZSA9ICcnOwogICAgICAgIHlpZWxkVW9tSW5wdXQudmFsdWUgPSAnJzsKICAgICAgICB5aWVsZEZpZWxkc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIHJlbmRlclJlY2lwZVRhYmxlKCk7CiAgICAgICAgdXBkYXRlU3VtbWFyeSgpOwogICAgICAgIAogICAgICAgIC8vIFJlc2V0IGZyb20gZWRpdCBtb2RlIGlmIGFjdGl2ZQogICAgICAgIGlzRWRpdGluZ1JlY2lwZSA9IGZhbHNlOyAKICAgICAgICBzYXZlUmVjaXBlQnRuLnRleHRDb250ZW50ID0gJ1NhdmUgUmVjaXBlJzsgCiAgICAgICAgc2F2ZVJlY2lwZUJ0bi50aXRsZSA9ICJTYXZlIHRoZSBjdXJyZW50IHJlY2lwZSBpbiB0aGUgYnVpbGRlciB0byB0aGUgJ1NhdmVkIFJlY2lwZXMnIGxpc3QgYmVsb3cuIjsKICAgIH0KCiAgICBmdW5jdGlvbiByZW5kZXJTYXZlZFJlY2lwZXMocmVjaXBlc1RvUmVuZGVyID0gc2F2ZWRSZWNpcGVzKSB7CiAgICAgICAgc2F2ZWRSZWNpcGVzQ29udGFpbmVyLmlubmVySFRNTCA9ICcnOwogICAgICAgIGlmIChyZWNpcGVzVG9SZW5kZXIubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHNhdmVkUmVjaXBlc0NvbnRhaW5lci5pbm5lckhUTUwgPSBgPHAgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgdGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nLXRvcDogMjBweDsiPk5vIHNhdmVkIHJlY2lwZXMgZm91bmQuPC9wPmA7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGFibGUnKTsKICAgICAgICB0YWJsZS5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgIDx0aGVhZD4KICAgICAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICAgICAgICA8dGg+UmVjaXBlIE5hbWU8L3RoPgogICAgICAgICAgICAgICAgICAgIDx0aD5JdGVtczwvdGg+CiAgICAgICAgICAgICAgICAgICAgPHRoPllpZWxkPC90aD4KICAgICAgICAgICAgICAgICAgICA8dGg+VG90YWwgQ29zdDwvdGg+CiAgICAgICAgICAgICAgICAgICAgPHRoPkNvc3QvWWllbGQgVU9NPC90aD4KICAgICAgICAgICAgICAgICAgICA8dGg+R1AlPC90aD4KICAgICAgICAgICAgICAgICAgICA8dGggY2xhc3M9ImFjdGlvbnMtY29sIj5BY3Rpb25zPC90aD4KICAgICAgICAgICAgICAgIDwvdHI+CiAgICAgICAgICAgIDwvdGhlYWQ+CiAgICAgICAgYDsKICAgICAgICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3Rib2R5Jyk7CgogICAgICAgIHJlY2lwZXNUb1JlbmRlci5zb3J0KChhLGIpID0+IGEubWFzdGVyLm5hbWUubG9jYWxlQ29tcGFyZShiLm1hc3Rlci5uYW1lKSkuZm9yRWFjaChyZWNpcGUgPT4gewogICAgICAgICAgICBjb25zdCB0b3RhbENvc3QgPSByZWNpcGUuaXRlbXMucmVkdWNlKChzdW0sIGl0ZW0pID0+IHN1bSArIChpdGVtLmNvc3QgKiBpdGVtLnF1YW50aXR5KSwgMCk7CiAgICAgICAgICAgIGNvbnN0IHNlbGxpbmdQcmljZSA9IHJlY2lwZS5tYXN0ZXIuc2VsbGluZ1ByaWNlIHx8IDA7CiAgICAgICAgICAgIGxldCBncCA9IDA7CiAgICAgICAgICAgIGxldCBlZmZlY3RpdmVDb3N0ID0gdG90YWxDb3N0OwoKICAgICAgICAgICAgLy8gRm9yIChNQU4pIHByb2R1Y3RzLCB0aGUgR1Agc2hvdWxkIGJlIGJhc2VkIG9uIHRoZSBjb3N0IHBlciBTSU5HTEUgc2VsbGluZyB1bml0LCBub3QgdGhlIHdob2xlIGJhdGNoIGNvc3QKICAgICAgICAgICAgaWYgKHJlY2lwZS5tYXN0ZXIubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhtYW4pJykpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHByb2R1Y3RJbmZvID0gaW1wb3J0ZWRQcm9kdWN0cy5maW5kKHAgPT4gcC5wbHUgPT09IHJlY2lwZS5tYXN0ZXIucGx1KTsKICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0SW5mbykgewogICAgICAgICAgICAgICAgICAgIGVmZmVjdGl2ZUNvc3QgPSBwcm9kdWN0SW5mby5jb3N0OyAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHNlbGxpbmdQcmljZSA+IDApIHsKICAgICAgICAgICAgICAgIGdwID0gKChzZWxsaW5nUHJpY2UgLSBlZmZlY3RpdmVDb3N0KSAvIHNlbGxpbmdQcmljZSkgKiAxMDA7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBncCA9IC0xMDA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBncENvbG9yQ2xhc3MgPSAnJzsKICAgICAgICAgICAgaWYgKGdwIDwgMzApIHsKICAgICAgICAgICAgICAgIGdwQ29sb3JDbGFzcyA9ICdncC1sb3cnOwogICAgICAgICAgICB9IGVsc2UgaWYgKGdwIDwgNjApIHsKICAgICAgICAgICAgICAgIGdwQ29sb3JDbGFzcyA9ICdncC1tZWRpdW0nOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZ3BDb2xvckNsYXNzID0gJ2dwLWhpZ2gnOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCB5aWVsZERpc3BsYXkgPSAocmVjaXBlLm1hc3Rlci55aWVsZFF0eSAmJiByZWNpcGUubWFzdGVyLnlpZWxkVW9tKSA/IGAke3JlY2lwZS5tYXN0ZXIueWllbGRRdHl9ICR7cmVjaXBlLm1hc3Rlci55aWVsZFVvbX1gIDogJ04vQSc7CiAgICAgICAgICAgIGNvbnN0IGNvc3RQZXJZaWVsZFVuaXQgPSAocmVjaXBlLm1hc3Rlci55aWVsZFF0eSA+IDApID8gKHRvdGFsQ29zdCAvIHJlY2lwZS5tYXN0ZXIueWllbGRRdHkpIDogMDsKCiAgICAgICAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7CiAgICAgICAgICAgIHJvdy5pbm5lckhUTUwgPSBgCiAgICAgICAgICAgICAgICA8dGQgdGl0bGU9IiR7cmVjaXBlLm1hc3Rlci5uYW1lfSI+JHtyZWNpcGUubWFzdGVyLm5hbWV9PC90ZD4KICAgICAgICAgICAgICAgIDx0ZD4ke3JlY2lwZS5pdGVtcy5sZW5ndGh9PC90ZD4KICAgICAgICAgICAgICAgIDx0ZD4ke3lpZWxkRGlzcGxheX08L3RkPgogICAgICAgICAgICAgICAgPHRkPlIke3RvdGFsQ29zdC50b0ZpeGVkKDIpfTwvdGQ+CiAgICAgICAgICAgICAgICA8dGQ+UiR7Y29zdFBlcllpZWxkVW5pdC50b0ZpeGVkKDIpfTwvdGQ+CiAgICAgICAgICAgICAgICA8dGQgY2xhc3M9IiR7Z3BDb2xvckNsYXNzfSI+JHtncC50b0ZpeGVkKDIpfSU8L3RkPgogICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJhY3Rpb25zLWNvbCI+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJjb3B5UmVjaXBlKCcke3JlY2lwZS5tYXN0ZXIucGx1fScpIiB0aXRsZT0iQ29weSBpbmdyZWRpZW50cyBmcm9tIHRoaXMgcmVjaXBlIHRvIHRoZSBidWlsZGVyLiBZb3UgbXVzdCBzZWxlY3QgYSBuZXcgbWFzdGVyIHByb2R1Y3QgZmlyc3QuIj5Db3B5PC9idXR0b24+CiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJsb2FkUmVjaXBlKCcke3JlY2lwZS5tYXN0ZXIucGx1fScpIiB0aXRsZT0iTG9hZCB0aGlzIHJlY2lwZSBpbnRvIHRoZSBidWlsZGVyIGZvciBlZGl0aW5nLiBUaGlzIHdpbGwgcmVtb3ZlIGl0IGZyb20gdGhlIHNhdmVkIGxpc3QgdW50aWwgaXQncyBzYXZlZCBhZ2Fpbi4iPkVkaXQ8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImRlbGV0ZVJlY2lwZSgnJHtyZWNpcGUubWFzdGVyLnBsdX0nKSIgdGl0bGU9IlBlcm1hbmVudGx5IGRlbGV0ZSB0aGlzIHNhdmVkIHJlY2lwZS4iPkRlbGV0ZTwvYnV0dG9uPgogICAgICAgICAgICAgICAgPC90ZD4KICAgICAgICAgICAgYDsKICAgICAgICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQocm93KTsKICAgICAgICAgICAgLy8gUm9idXN0OiBlbnN1cmUgYWN0aW9uIGJ1dHRvbnMgd29yayBldmVuIGlmIGlubGluZSBoYW5kbGVycyBhcmUgYmxvY2tlZC9tYWxmb3JtZWQKICAgICAgICAgICAgKGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgY29uc3QgYnRucyA9IHJvdy5xdWVyeVNlbGVjdG9yQWxsKCcuYWN0aW9ucy1jb2wgYnV0dG9uJyk7CiAgICAgICAgICAgICAgaWYgKGJ0bnMgJiYgYnRucy5sZW5ndGggPj0gMykgewogICAgICAgICAgICAgICAgY29uc3QgYnRuQ29weSA9IGJ0bnNbMF07CiAgICAgICAgICAgICAgICBjb25zdCBidG5FZGl0ID0gYnRuc1sxXTsKICAgICAgICAgICAgICAgIGNvbnN0IGJ0bkRlbGV0ZSA9IGJ0bnNbMl07CiAgICAgICAgICAgICAgICB0cnkgeyBidG5FZGl0Lm9uY2xpY2sgPSBmdW5jdGlvbigpeyB0cnl7IGxvYWRSZWNpcGUoU3RyaW5nKHJlY2lwZS5tYXN0ZXIucGx1KSk7IH1jYXRjaChfZSl7fSB9OyB9IGNhdGNoKF9lKXt9CiAgICAgICAgICAgICAgICB0cnkgeyBidG5Db3B5Lm9uY2xpY2sgPSBmdW5jdGlvbigpeyB0cnl7IGNvcHlSZWNpcGUoU3RyaW5nKHJlY2lwZS5tYXN0ZXIucGx1KSk7IH1jYXRjaChfZSl7fSB9OyB9IGNhdGNoKF9lKXt9CiAgICAgICAgICAgICAgICB0cnkgeyBidG5EZWxldGUub25jbGljayA9IGZ1bmN0aW9uKCl7IHRyeXsgZGVsZXRlUmVjaXBlKFN0cmluZyhyZWNpcGUubWFzdGVyLnBsdSkpOyB9Y2F0Y2goX2Upe30gfTsgfSBjYXRjaChfZSl7fQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkoKTsKICAgICAgICB9KTsKCiAgICAgICAgdGFibGUuYXBwZW5kQ2hpbGQodGJvZHkpOwogICAgICAgIHNhdmVkUmVjaXBlc0NvbnRhaW5lci5hcHBlbmRDaGlsZCh0YWJsZSk7CiAgICB9CgogICAgZnVuY3Rpb24gaGFuZGxlU2F2ZWRSZWNpcGVTZWFyY2goZXZlbnQpIHsKICAgICAgICBjb25zdCBzZWFyY2hUZXJtID0gZXZlbnQudGFyZ2V0LnZhbHVlLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgY29uc3QgZmlsdGVyZWRSZWNpcGVzID0gc2F2ZWRSZWNpcGVzLmZpbHRlcihyZWNpcGUgPT4KICAgICAgICAgICAgcmVjaXBlLm1hc3Rlci5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybSkKICAgICAgICApOwogICAgICAgIHJlbmRlclNhdmVkUmVjaXBlcyhmaWx0ZXJlZFJlY2lwZXMpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNvcHlSZWNpcGUobWFzdGVyUGx1KSB7CiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWNpcGVCdWlsZGVyUGFuZWwnKS5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID09PSBmYWxzZSkgewogICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBzd2l0Y2ggdG8gdGhlICdSZWNpcGUgQnVpbGRlcicgdGFiIGZpcnN0LiIpOwogICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoIXNlbGVjdGVkTWFzdGVyUHJvZHVjdCkgewogICAgICAgICAgICBhbGVydCgiUGxlYXNlIHNlbGVjdCBhIG5ldyBNYXN0ZXIgUHJvZHVjdCBpbiB0aGUgUmVjaXBlIEJ1aWxkZXIgYmVmb3JlIGNvcHlpbmcgaW5ncmVkaWVudHMuIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHJlY2lwZVRvQ29weSA9IHNhdmVkUmVjaXBlcy5maW5kKHIgPT4gci5tYXN0ZXIucGx1LnRvU3RyaW5nKCkgPT09IG1hc3RlclBsdS50b1N0cmluZygpKTsKICAgICAgICBpZiAoIXJlY2lwZVRvQ29weSkgcmV0dXJuOwoKICAgICAgICBpZiAocmVjaXBlSXRlbXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBpZiAoIWNvbmZpcm0oIlRoaXMgd2lsbCByZXBsYWNlIHRoZSBjdXJyZW50IGluZ3JlZGllbnRzIGluIHRoZSBSZWNpcGUgQnVpbGRlci4gQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNvbnRpbnVlPyIpKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIENyZWF0ZSBhIGRlZXAgY29weSBvZiB0aGUgaXRlbXMgdG8gYXZvaWQgcmVmZXJlbmNlIGlzc3VlcwogICAgICAgIHJlY2lwZUl0ZW1zID0gcmVjaXBlVG9Db3B5Lml0ZW1zLm1hcChpdGVtID0+ICh7IC4uLml0ZW0gfSkpOwogICAgICAgIHJlbmRlclJlY2lwZVRhYmxlKCk7CiAgICAgICAgdXBkYXRlU3VtbWFyeSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGxvYWRSZWNpcGUobWFzdGVyUGx1KSB7CiAgICAgICAgY29uc3QgcmVjaXBlVG9Mb2FkID0gc2F2ZWRSZWNpcGVzLmZpbmQociA9PiByLm1hc3Rlci5wbHUudG9TdHJpbmcoKSA9PT0gbWFzdGVyUGx1LnRvU3RyaW5nKCkpOwogICAgICAgIGlmICghcmVjaXBlVG9Mb2FkKSByZXR1cm47CiAgICAgICAgCiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWNpcGVCdWlsZGVyUGFuZWwnKS5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID09PSBmYWxzZSkgewogICAgICAgICAgICAgaWYoIWNvbmZpcm0oIlRoaXMgd2lsbCBzd2l0Y2ggeW91IHRvIHRoZSAnUmVjaXBlIEJ1aWxkZXInIHRhYiBhbmQgZGlzY2FyZCBhbnkgdW5zYXZlZCB3b3JrIHRoZXJlLiBDb250aW51ZT8iKSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgc3dpdGNoUmlnaHRUYWIoJ3JlY2lwZUJ1aWxkZXJQYW5lbCcpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHJlY2lwZUl0ZW1zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgaWYoIWNvbmZpcm0oIkxvYWRpbmcgdGhpcyByZWNpcGUgd2lsbCBkaXNjYXJkIHRoZSBjdXJyZW50IHVuc2F2ZWQgcmVjaXBlIGluIHRoZSBidWlsZGVyLiBDb250aW51ZT8iKSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIFRlbXBvcmFyaWx5IHN0b3JlIHRoZSByZWNpcGUgZGF0YSBiZWNhdXNlIHdlJ3JlIGFib3V0IHRvIGRlbGV0ZSBpdCBmcm9tIHRoZSBzYXZlZCBsaXN0CiAgICAgICAgY29uc3QgcmVjaXBlRGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVjaXBlVG9Mb2FkKSk7CgogICAgICAgIC8vIFJlbW92ZSB0aGUgcmVjaXBlIGZyb20gdGhlIG1haW4gbGlzdC4gVGhpcyBhbHNvIHJlZnJlc2hlcyB0aGUgYXZhaWxhYmxlIG1hc3RlciBwcm9kdWN0cy4KICAgICAgICBkZWxldGVSZWNpcGUobWFzdGVyUGx1LCBmYWxzZSk7CiAgICAgICAgCiAgICAgICAgLy8gQ2xlYXIgdGhlIGN1cnJlbnQgYnVpbGRlciBVSQogICAgICAgIGNsZWFyQ3VycmVudFJlY2lwZUJ1aWxkZXIoKTsKCiAgICAgICAgLy8gU2V0IHRoZSBjYXRlZ29yeSBmaWx0ZXIgdG8gbWF0Y2ggdGhlIHByb2R1Y3QgYmVpbmcgbG9hZGVkCiAgICAgICAgY29uc3QgcHJvZHVjdENhdGVnb3J5ID0gcmVjaXBlRGF0YS5tYXN0ZXIubmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJyhtYW4pJykgPyAnbWFudWZhY3R1cmVkJyA6IHJlY2lwZURhdGEubWFzdGVyLm1lbnVDYXRlZ29yeTsKICAgICAgICBtZW51Q2F0ZWdvcnlGaWx0ZXIudmFsdWUgPSBwcm9kdWN0Q2F0ZWdvcnk7CgogICAgICAgIC8vIFJlcG9wdWxhdGUgdGhlIGRhdGFsaXN0IGZvciB0aGUgY29ycmVjdCBjYXRlZ29yeS4gTm93IHRoZSBwcm9kdWN0IHRvIGJlIGVkaXRlZCB3aWxsIGJlIGluIHRoZSBsaXN0LgogICAgICAgIHBvcHVsYXRlTWFzdGVyUHJvZHVjdERhdGFsaXN0KCk7CgogICAgICAgIC8vIFNldCB0aGUgYnVpbGRlcidzIHN0YXRlIHdpdGggdGhlIGxvYWRlZCByZWNpcGUgZGF0YQogICAgICAgIG1hc3RlclByb2R1Y3RJbnB1dC52YWx1ZSA9IGAke3JlY2lwZURhdGEubWFzdGVyLm5hbWV9ICgke3JlY2lwZURhdGEubWFzdGVyLnBsdX0pYDsKICAgICAgICBoYW5kbGVNYXN0ZXJQcm9kdWN0SW5wdXQoe3RhcmdldDogbWFzdGVyUHJvZHVjdElucHV0fSk7IC8vIFRoaXMgd2lsbCBub3cgY29ycmVjdGx5IGZpbmQgdGhlIHByb2R1Y3QgYW5kIHNldCBzZWxlY3RlZE1hc3RlclByb2R1Y3QKICAgICAgICByZWNpcGVJdGVtcyA9IFsuLi5yZWNpcGVEYXRhLml0ZW1zXTsKICAgICAgICAKICAgICAgICAvLyBUaGUgaGFuZGxlTWFzdGVyUHJvZHVjdElucHV0IGZ1bmN0aW9uIGFscmVhZHkgc2V0cyB0aGUgeWllbGQgZnJvbSB0aGUgb3JpZ2luYWwgaW1wb3J0ZWQgZGF0YS4KICAgICAgICAvLyBObyBuZWVkIHRvIG92ZXJyaWRlIGl0IHdpdGggdGhlIHNhdmVkIHJlY2lwZSdzIHlpZWxkIGRhdGEgaGVyZS4KICAgICAgICBzZXRZaWVsZEZpZWxkc1JlYWRPbmx5KHRydWUpOwoKICAgICAgICAvLyBVcGRhdGUgVUkKICAgICAgICByZW5kZXJSZWNpcGVUYWJsZSgpOwogICAgICAgIHVwZGF0ZVN1bW1hcnkoKTsKICAgICAgICAKICAgICAgICBpc0VkaXRpbmdSZWNpcGUgPSB0cnVlOwogICAgICAgIHNhdmVSZWNpcGVCdG4udGV4dENvbnRlbnQgPSAnVXBkYXRlIFJlY2lwZSc7CiAgICAgICAgc2F2ZVJlY2lwZUJ0bi50aXRsZSA9ICdVcGRhdGUgdGhlIHJlY2lwZSBmb3IgdGhpcyBwcm9kdWN0IGluIHRoZSBzYXZlZCBsaXN0Lic7CiAgICB9CgoKICAgIGZ1bmN0aW9uIGRlbGV0ZVJlY2lwZShtYXN0ZXJQbHUsIGFza0NvbmZpcm0gPSB0cnVlKSB7CiAgICAgICAgY29uc3QgcmVjaXBlVG9EZWxldGUgPSBzYXZlZFJlY2lwZXMuZmluZChyID0+IHIubWFzdGVyLnBsdS50b1N0cmluZygpID09PSBtYXN0ZXJQbHUudG9TdHJpbmcoKSk7CiAgICAgICAgaWYgKCFyZWNpcGVUb0RlbGV0ZSkgcmV0dXJuOwoKICAgICAgICBpZiAoYXNrQ29uZmlybSkgewogICAgICAgICAgICBpZiAoIWNvbmZpcm0oYEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhlIHJlY2lwZSBmb3IgIiR7cmVjaXBlVG9EZWxldGUubWFzdGVyLm5hbWV9Ij9gKSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHNhdmVkUmVjaXBlcyA9IHNhdmVkUmVjaXBlcy5maWx0ZXIociA9PiByLm1hc3Rlci5wbHUudG9TdHJpbmcoKSAhPT0gbWFzdGVyUGx1LnRvU3RyaW5nKCkpOwogICAgICAgIHJlbmRlclNhdmVkUmVjaXBlcygpOwogICAgICAgIHJlbmRlcllpZWxkRWRpdG9yKCk7CiAgICAgICAgc2F2ZVN0YXRlKCk7CgogICAgICAgIC8vIEFmdGVyIGRlbGV0aW5nLCByZWZyZXNoIHRoZSBjYXRlZ29yeSBmaWx0ZXIgYW5kIHByb2R1Y3QgbGlzdAogICAgICAgIHBvcHVsYXRlQ2F0ZWdvcnlGaWx0ZXIoKTsKICAgICAgICBwb3B1bGF0ZU1hc3RlclByb2R1Y3REYXRhbGlzdCgpOwogICAgfQogICAgCiAgICAvLyAtLS0gWWllbGQgRWRpdG9yICYgQnVpbGRlciBMb2dpYyAtLS0KICAgIGZ1bmN0aW9uIHRvZ2dsZVlpZWxkRWRpdGluZyhlKSB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGNvbnN0IGlzUmVhZE9ubHkgPSB5aWVsZFF0eUlucHV0LnJlYWRPbmx5OwogICAgICAgIHNldFlpZWxkRmllbGRzUmVhZE9ubHkoIWlzUmVhZE9ubHkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldFlpZWxkRmllbGRzUmVhZE9ubHkoaXNSZWFkT25seSkgewogICAgICAgIHlpZWxkUXR5SW5wdXQucmVhZE9ubHkgPSBpc1JlYWRPbmx5OwogICAgICAgIHlpZWxkVW9tSW5wdXQucmVhZE9ubHkgPSBpc1JlYWRPbmx5OwoKICAgICAgICBjb25zdCBlZGl0SWNvbiA9IGVkaXRZaWVsZEJ0bi5xdWVyeVNlbGVjdG9yKCcuZWRpdC1pY29uJyk7CiAgICAgICAgY29uc3Qgc2F2ZUljb24gPSBlZGl0WWllbGRCdG4ucXVlcnlTZWxlY3RvcignLnNhdmUtaWNvbicpOwoKICAgICAgICBpZiAoaXNSZWFkT25seSkgewogICAgICAgICAgICBlZGl0WWllbGRCdG4udGl0bGUgPSAiRWRpdCBZaWVsZCI7CiAgICAgICAgICAgIGVkaXRJY29uLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICBzYXZlSWNvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVkaXRZaWVsZEJ0bi50aXRsZSA9ICJTYXZlIFlpZWxkIjsKICAgICAgICAgICAgZWRpdEljb24uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgc2F2ZUljb24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgIHlpZWxkUXR5SW5wdXQuZm9jdXMoKTsKICAgICAgICB9CiAgICB9CgoKICAgIGZ1bmN0aW9uIHJlbmRlcllpZWxkRWRpdG9yKCkgewogICAgICAgIGNvbnN0IHNlYXJjaFRlcm0gPSB5aWVsZEVkaXRvclNlYXJjaC52YWx1ZS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGNvbnN0IG1hblJlY2lwZXMgPSBzYXZlZFJlY2lwZXMuZmlsdGVyKHIgPT4gCiAgICAgICAgICAgIHIubWFzdGVyLm5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCcobWFuKScpICYmCiAgICAgICAgICAgIHIubWFzdGVyLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtKQogICAgICAgICk7CgogICAgICAgIGlmIChtYW5SZWNpcGVzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICB5aWVsZEVkaXRvckNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHAgc3R5bGU9ImNvbG9yOiB2YXIoLS15b2NvLXRleHQtc2Vjb25kYXJ5KTsgdGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nLXRvcDogMjBweDsiPk5vIHNhdmVkIG1hbnVmYWN0dXJlZCBwcm9kdWN0cyBmb3VuZC48L3A+YDsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0YWJsZScpOwogICAgICAgIHRhYmxlLmlubmVySFRNTCA9IGAKICAgICAgICAgICAgPHRoZWFkPgogICAgICAgICAgICAgICAgPHRyPgogICAgICAgICAgICAgICAgICAgIDx0aD5Qcm9kdWN0IE5hbWU8L3RoPgogICAgICAgICAgICAgICAgICAgIDx0aD5DdXJyZW50IFlpZWxkPC90aD4KICAgICAgICAgICAgICAgICAgICA8dGg+TmV3IFlpZWxkIFF0eTwvdGg+CiAgICAgICAgICAgICAgICAgICAgPHRoPk5ldyBZaWVsZCBVT008L3RoPgogICAgICAgICAgICAgICAgICAgIDx0aD5BY3Rpb248L3RoPgogICAgICAgICAgICAgICAgPC90cj4KICAgICAgICAgICAgPC90aGVhZD4KICAgICAgICBgOwogICAgICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGJvZHknKTsKCiAgICAgICAgbWFuUmVjaXBlcy5zb3J0KChhLGIpID0+IGEubWFzdGVyLm5hbWUubG9jYWxlQ29tcGFyZShiLm1hc3Rlci5uYW1lKSkuZm9yRWFjaChyZWNpcGUgPT4gewogICAgICAgICAgICBjb25zdCBwbHUgPSByZWNpcGUubWFzdGVyLnBsdTsKICAgICAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTsKICAgICAgICAgICAgcm93LmlubmVySFRNTCA9IGAKICAgICAgICAgICAgICAgIDx0ZD4ke3JlY2lwZS5tYXN0ZXIubmFtZX08L3RkPgogICAgICAgICAgICAgICAgPHRkPiR7cmVjaXBlLm1hc3Rlci55aWVsZFF0eSB8fCAnTi9BJ30gJHtyZWNpcGUubWFzdGVyLnlpZWxkVW9tIHx8ICcnfTwvdGQ+CiAgICAgICAgICAgICAgICA8dGQ+PGlucHV0IHR5cGU9Im51bWJlciIgaWQ9InlpZWxkLXF0eS0ke3BsdX0iIHZhbHVlPSIke3JlY2lwZS5tYXN0ZXIueWllbGRRdHkgfHwgJyd9IiBzdGVwPSIwLjAwMSIgbWluPSIwLjAwMSI+PC90ZD4KICAgICAgICAgICAgICAgIDx0ZD48aW5wdXQgdHlwZT0idGV4dCIgaWQ9InlpZWxkLXVvbS0ke3BsdX0iIHZhbHVlPSIke3JlY2lwZS5tYXN0ZXIueWllbGRVb20gfHwgJyd9Ij48L3RkPgogICAgICAgICAgICAgICAgPHRkPjxidXR0b24gY2xhc3M9ImFjdGlvbi1idG4gdXBkYXRlLXlpZWxkLWJ0biIgb25jbGljaz0idXBkYXRlWWllbGQoJyR7cGx1fScpIj5VcGRhdGU8L2J1dHRvbj48L3RkPgogICAgICAgICAgICBgOwogICAgICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZChyb3cpOwogICAgICAgIH0pOwogICAgICAgIHRhYmxlLmFwcGVuZENoaWxkKHRib2R5KTsKICAgICAgICB5aWVsZEVkaXRvckNvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsgLy8gQ2xlYXIgcHJldmlvdXMgY29udGVudAogICAgICAgIHlpZWxkRWRpdG9yQ29udGFpbmVyLmFwcGVuZENoaWxkKHRhYmxlKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVZaWVsZChtYXN0ZXJQbHUpIHsKICAgICAgICBjb25zdCByZWNpcGVJbmRleCA9IHNhdmVkUmVjaXBlcy5maW5kSW5kZXgociA9PiByLm1hc3Rlci5wbHUudG9TdHJpbmcoKSA9PT0gbWFzdGVyUGx1LnRvU3RyaW5nKCkpOwogICAgICAgIGlmIChyZWNpcGVJbmRleCA9PT0gLTEpIHJldHVybjsKCiAgICAgICAgY29uc3QgbmV3WWllbGRRdHlJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGB5aWVsZC1xdHktJHttYXN0ZXJQbHV9YCk7CiAgICAgICAgY29uc3QgbmV3WWllbGRVb21JbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGB5aWVsZC11b20tJHttYXN0ZXJQbHV9YCk7CiAgICAgICAgCiAgICAgICAgY29uc3QgbmV3WWllbGRRdHkgPSBwYXJzZUZsb2F0KG5ld1lpZWxkUXR5SW5wdXQudmFsdWUpOwogICAgICAgIGNvbnN0IG5ld1lpZWxkVW9tID0gbmV3WWllbGRVb21JbnB1dC52YWx1ZS50cmltKCk7CgogICAgICAgIGlmICghbmV3WWllbGRRdHkgfHwgbmV3WWllbGRRdHkgPD0gMCkgewogICAgICAgICAgICBhbGVydCgnWWllbGQgUXVhbnRpdHkgbXVzdCBiZSBhIHBvc2l0aXZlIG51bWJlci4nKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmVjaXBlVG9VcGRhdGUgPSBzYXZlZFJlY2lwZXNbcmVjaXBlSW5kZXhdOwogICAgICAgIGNvbnN0IHRvdGFsUmVjaXBlQ29zdCA9IHJlY2lwZVRvVXBkYXRlLml0ZW1zLnJlZHVjZSgoc3VtLCBpdGVtKSA9PiBzdW0gKyAoaXRlbS5jb3N0ICogaXRlbS5xdWFudGl0eSksIDApOwogICAgICAgIGNvbnN0IG5ld0Nvc3RQZXJZaWVsZFVuaXQgPSB0b3RhbFJlY2lwZUNvc3QgLyBuZXdZaWVsZFF0eTsKCiAgICAgICAgLy8gMS4gVXBkYXRlIHRoZSAoTUFOKSBwcm9kdWN0J3MgbWFpbiBlbnRyeSBpbiBpbXBvcnRlZFByb2R1Y3RzCiAgICAgICAgY29uc3QgcHJvZHVjdEluZGV4ID0gaW1wb3J0ZWRQcm9kdWN0cy5maW5kSW5kZXgocCA9PiBwLnBsdS50b1N0cmluZygpID09PSBtYXN0ZXJQbHUudG9TdHJpbmcoKSk7CiAgICAgICAgaWYgKHByb2R1Y3RJbmRleCA+IC0xKSB7CiAgICAgICAgICAgIGltcG9ydGVkUHJvZHVjdHNbcHJvZHVjdEluZGV4XS5jb3N0ID0gbmV3Q29zdFBlcllpZWxkVW5pdDsKICAgICAgICAgICAgaW1wb3J0ZWRQcm9kdWN0c1twcm9kdWN0SW5kZXhdLnVvbSA9IG5ld1lpZWxkVW9tOwogICAgICAgICAgICBpbXBvcnRlZFByb2R1Y3RzW3Byb2R1Y3RJbmRleF0ueWllbGRRdHkgPSBuZXdZaWVsZFF0eTsgLy8gS2VlcCBvcmlnaW5hbCB5aWVsZCBpbmZvIGNvbnNpc3RlbnQgdG9vCiAgICAgICAgICAgIGltcG9ydGVkUHJvZHVjdHNbcHJvZHVjdEluZGV4XS55aWVsZFVvbSA9IG5ld1lpZWxkVW9tOwogICAgICAgIH0KCiAgICAgICAgLy8gMi4gVXBkYXRlIHRoZSBtYXN0ZXIgZGF0YSB3aXRoaW4gdGhlIHNhdmVkIHJlY2lwZSBpdHNlbGYKICAgICAgICByZWNpcGVUb1VwZGF0ZS5tYXN0ZXIueWllbGRRdHkgPSBuZXdZaWVsZFF0eTsKICAgICAgICByZWNpcGVUb1VwZGF0ZS5tYXN0ZXIueWllbGRVb20gPSBuZXdZaWVsZFVvbTsKCiAgICAgICAgLy8gMy4gLS0tIENBU0NBRElORyBVUERBVEUgLS0tCiAgICAgICAgLy8gRmluZCBhbnkgb3RoZXIgc2F2ZWQgcmVjaXBlcyB0aGF0IHVzZSB0aGlzIHByb2R1Y3QgYXMgYW4gaW5ncmVkaWVudCBhbmQgdXBkYXRlIHRoZWlyIGNvc3QKICAgICAgICBzYXZlZFJlY2lwZXMuZm9yRWFjaChyZWNpcGUgPT4gewogICAgICAgICAgICByZWNpcGUuaXRlbXMuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgICAgICAgIGlmIChpdGVtLnBsdS50b1N0cmluZygpID09PSBtYXN0ZXJQbHUudG9TdHJpbmcoKSkgewogICAgICAgICAgICAgICAgICAgIGl0ZW0uY29zdCA9IG5ld0Nvc3RQZXJZaWVsZFVuaXQ7CiAgICAgICAgICAgICAgICAgICAgaXRlbS51b20gPSBuZXdZaWVsZFVvbTsgLy8gQWxzbyB1cGRhdGUgVU9NIGluIGNhc2UgaXQgY2hhbmdlZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKCiAgICAgICAgLy8gNC4gU2F2ZSBzdGF0ZSBhbmQgcmUtcmVuZGVyIGFsbCByZWxldmFudCBVSSBjb21wb25lbnRzCiAgICAgICAgc2F2ZVN0YXRlKCk7CiAgICAgICAgcmVuZGVyWWllbGRFZGl0b3IoKTsKICAgICAgICByZW5kZXJTYXZlZFJlY2lwZXMoKTsKICAgICAgICBzZXR1cExpYnJhcnlUYWJzKCk7IC8vIFRoaXMgcmVmcmVzaGVzIHRoZSBpbmdyZWRpZW50IGxpYnJhcnkgd2l0aCB0aGUgbmV3IGNvc3QKCiAgICAgICAgYWxlcnQoYCIke3JlY2lwZVRvVXBkYXRlLm1hc3Rlci5uYW1lfSIgeWllbGQgdXBkYXRlZC4gQWxsIHJlbGF0ZWQgY29zdHMgaGF2ZSBiZWVuIHJlY2FsY3VsYXRlZC5gKTsKICAgIH0KCiAgICAvLyAtLS0gR2xvYmFsIEFjdGlvbnMgLS0tCiAgICBmdW5jdGlvbiBjbGVhckFsbERhdGEoYXNrQ29uZmlybSA9IHRydWUpIHsKICAgICAgICBpZiAoYXNrQ29uZmlybSkgewogICAgICAgICAgICBpZiAoIWNvbmZpcm0oIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjbGVhciBhbGwgaW1wb3J0ZWQgcHJvZHVjdHMgYW5kIHNhdmVkIHJlY2lwZXM/IFRoaXMgYWN0aW9uIGNhbm5vdCBiZSB1bmRvbmUuIikpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpbXBvcnRlZFByb2R1Y3RzID0gW107CiAgICAgICAgc2F2ZWRSZWNpcGVzID0gW107CiAgICAgICAgCiAgICAgICAgZmlsZU5hbWVEaXNwbGF5LnRleHRDb250ZW50ID0gJyc7CiAgICAgICAgZXhjZWxGaWxlSW5wdXQudmFsdWUgPSAiIjsKICAgICAgICAKICAgICAgICBjbGVhckN1cnJlbnRSZWNpcGVCdWlsZGVyKCk7CiAgICAgICAgc2V0dXBMaWJyYXJ5VGFicygpOwogICAgICAgIHJlbmRlclNhdmVkUmVjaXBlcygpOwogICAgICAgIHJlbmRlcllpZWxkRWRpdG9yKCk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3JlY2lwZUJ1aWxkZXJTdGF0ZScpOwogICAgICAgIAogICAgICAgIG1hc3RlclByb2R1Y3RMaXN0LmlubmVySFRNTCA9ICcnOwogICAgICAgIG1hc3RlclByb2R1Y3RJbnB1dC5wbGFjZWhvbGRlciA9ICItLSBJbXBvcnQgcHJvZHVjdHMgZmlyc3QgLS0iOwogICAgICAgIG1lbnVDYXRlZ29yeUZpbHRlci5pbm5lckhUTUwgPSAnJzsKICAgIH0KLy8gU2hvdyB0dXRvcmlhbCBhZ2FpbiBhZnRlciBjbGVhcmluZyBhbGwgZGF0YQp0cnkgeyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcHJvbXB0LW1vZGFsJykuY2xhc3NMaXN0LmFkZCgnc2hvdycpOyB9IGNhdGNoKGUpIHt9CgogICAgLy8gLS0tIEV4cG9ydCBMb2dpYyAtLS0KICAgIGZ1bmN0aW9uIGV4cG9ydEFsbFJlY2lwZXMoKSB7CiAgICAgICAgaWYgKHNhdmVkUmVjaXBlcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgYWxlcnQoJ1RoZXJlIGFyZSBubyBzYXZlZCByZWNpcGVzIHRvIGV4cG9ydC4nKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFjb25maXJtKCJBcmUgeW91IHN1cmUgeW91IGhhdmUgY29tcGxldGVkIGFsbCByZWNpcGVzPyBUaGlzIHdpbGwgZXhwb3J0IHRoZSBkYXRhIGFuZCBjbGVhciB0aGUgYXBwbGljYXRpb24uIikpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgbGV0IHJlY2lwZUV4cG9ydERhdGEgPSBbXTsKICAgICAgICBsZXQgeWllbGRFeHBvcnREYXRhID0gW107CgogICAgICAgIHNhdmVkUmVjaXBlcy5mb3JFYWNoKHJlY2lwZSA9PiB7CiAgICAgICAgICAgIC8vIFBvcHVsYXRlIHRoZSByZWNpcGUgZGF0YSB0YWIKICAgICAgICAgICAgY29uc3QgcmVjaXBlUm93cyA9IHJlY2lwZS5pdGVtcy5tYXAoaXRlbSA9PiAoewogICAgICAgICAgICAgICAgJ01hc3RlciBQcm9kdWN0IFBMVSc6IHJlY2lwZS5tYXN0ZXIucGx1LAogICAgICAgICAgICAgICAgJ1Byb2R1Y3QgVHlwZSc6IHJlY2lwZS5tYXN0ZXIubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCcobWFuKScpID8gJ1ByZXBhcmF0aW9uJyA6ICdDb21wb3NpdGUnLAogICAgICAgICAgICAgICAgJ01hc3RlciBQcm9kdWN0IE5hbWUnOiByZWNpcGUubWFzdGVyLm5hbWUsCiAgICAgICAgICAgICAgICAnUmVjaXBlIFByb2R1Y3QgUExVJzogaXRlbS5wbHUsCiAgICAgICAgICAgICAgICAnUmVjaXBlIFByb2R1Y3QgTmFtZSc6IGl0ZW0ubmFtZSwKICAgICAgICAgICAgICAgICdVbml0IG9mIE1lYXN1cmUnOiBpdGVtLnVvbSwKICAgICAgICAgICAgICAgICdRdWFudGl0eSc6IGl0ZW0ucXVhbnRpdHkKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICByZWNpcGVFeHBvcnREYXRhID0gcmVjaXBlRXhwb3J0RGF0YS5jb25jYXQocmVjaXBlUm93cyk7CgogICAgICAgICAgICAvLyBQb3B1bGF0ZSB0aGUgeWllbGQgZGF0YSB0YWIgaWYgaXQncyBhIG1hbnVmYWN0dXJlZCBwcm9kdWN0CiAgICAgICAgICAgIGlmIChyZWNpcGUubWFzdGVyLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnKG1hbiknKSkgewogICAgICAgICAgICAgICAgeWllbGRFeHBvcnREYXRhLnB1c2goewogICAgICAgICAgICAgICAgICAgICdNYXN0ZXIgUHJvZHVjdCBQTFUnOiByZWNpcGUubWFzdGVyLnBsdSwKICAgICAgICAgICAgICAgICAgICAnTWFzdGVyIFByb2R1Y3QgTmFtZSc6IHJlY2lwZS5tYXN0ZXIubmFtZSwKICAgICAgICAgICAgICAgICAgICAnWWllbGQgUXVhbnRpdHknOiByZWNpcGUubWFzdGVyLnlpZWxkUXR5IHx8ICcnLAogICAgICAgICAgICAgICAgICAgICdZaWVsZCBVT00nOiByZWNpcGUubWFzdGVyLnlpZWxkVW9tIHx8ICcnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBjb25zdCB3YiA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsKCiAgICAgICAgLy8gQ3JlYXRlIGFuZCBhcHBlbmQgdGhlIFJlY2lwZXMgc2hlZXQKICAgICAgICBjb25zdCByZWNpcGVfd3MgPSBYTFNYLnV0aWxzLmpzb25fdG9fc2hlZXQocmVjaXBlRXhwb3J0RGF0YSk7CiAgICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3YiwgcmVjaXBlX3dzLCAiUmVjaXBlcyIpOwoKICAgICAgICAvLyBDcmVhdGUgYW5kIGFwcGVuZCB0aGUgWWllbGRzIHNoZWV0IG9ubHkgaWYgdGhlcmUgaXMgZGF0YSBmb3IgaXQKICAgICAgICBpZiAoeWllbGRFeHBvcnREYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgY29uc3QgeWllbGRfd3MgPSBYTFNYLnV0aWxzLmpzb25fdG9fc2hlZXQoeWllbGRFeHBvcnREYXRhKTsKICAgICAgICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3YiwgeWllbGRfd3MsICJZaWVsZHMiKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgWExTWC53cml0ZUZpbGUod2IsIGBhbGxfcmVjaXBlc19leHBvcnQueGxzeGApOwogICAgICAgIAogICAgICAgIGNsZWFyQWxsRGF0YShmYWxzZSk7CiAgICB9CiAgICAKICAgIC8vIC0tLSBUVVRPUklBTCBMT0dJQyAtLS0KICAgIGNvbnN0IHR1dG9yaWFsUHJvbXB0TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtcHJvbXB0LW1vZGFsJyk7CiAgICBjb25zdCBzdGFydFR1dG9yaWFsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0LXR1dG9yaWFsLWJ0bicpOwogICAgY29uc3Qgc2tpcFR1dG9yaWFsQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NraXAtdHV0b3JpYWwtYnRuJyk7CiAgICAKICAgIHN0YXJ0VHV0b3JpYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgdHV0b3JpYWxQcm9tcHRNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3JlY2lwZUxvYWRlclR1dG9yaWFsU2hvd24nLCAndHJ1ZScpOwogICAgICAgIHN0YXJ0VHV0b3JpYWwoKTsKICAgIH0pOwoKICAgIHNraXBUdXRvcmlhbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICB0dXRvcmlhbFByb21wdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncmVjaXBlTG9hZGVyVHV0b3JpYWxTaG93bicsICd0cnVlJyk7CiAgICB9KTsKCiAgICBjb25zdCB0dXRvcmlhbFN0ZXBzID0gWwogICAgewogICAgICAgIGVsZW1lbnQ6ICcjdHV0b3JpYWwtaG93LXRvLWd1aWRlJywKICAgICAgICBjb250ZW50OiAnPGI+V2VsY29tZSE8L2I+IE5lZWQgbW9yZSBkZXRhaWw/IENsaWNrIHRoaXMgZG9jdW1lbnQgaWNvbiBhbnl0aW1lIHRvIG9wZW4gdGhlIGZ1bGwgPGI+SG934oCRVG8gR3VpZGU8L2I+IGluIGEgbmV3IHRhYi4nLAogICAgICAgIHBvc2l0aW9uOiAncmlnaHQnCiAgICB9LAogICAgewogICAgICAgIGVsZW1lbnQ6ICcjdHV0b3JpYWwtaW1wb3J0JywKICAgICAgICBjb250ZW50OiAnU3RhcnQgaGVyZTogY2xpY2sgPGI+4oCcQ2hvb3NlIEZpbGXigJ08L2I+IGFuZCB1cGxvYWQgeW91ciA8Yj5Qcm9kdWN0IEV4Y2VsPC9iPiBzaGVldC4gVGhpcyBsb2FkcyB5b3VyIHByb2R1Y3QgbGlzdCBhbmQgdW5sb2NrcyB5b3VyIGluZ3JlZGllbnQgbGlicmFyeS4nLAogICAgICAgIHBvc2l0aW9uOiAnYm90dG9tJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3R1dG9yaWFsLWxpYnJhcnknLAogICAgICAgIGNvbnRlbnQ6ICdCcm93c2UgeW91ciA8Yj5JbmdyZWRpZW50IExpYnJhcnk8L2I+LiBDbGljayBhbiBpbmdyZWRpZW50IHRvIGFkZCBpdCB0byB5b3VyIGN1cnJlbnQgcmVjaXBlLiBVc2UgdGhlIHNlYXJjaCBiYXIgYW5kIHRhYnMgdG8gZmluZCBpdGVtcyBmYXN0LicsCiAgICAgICAgcG9zaXRpb246ICdyaWdodCcKICAgIH0sCiAgICB7CiAgICAgICAgZWxlbWVudDogJyN0dXRvcmlhbC1tYXN0ZXItcHJvZHVjdCcsCiAgICAgICAgY29udGVudDogJ1NlbGVjdCB0aGUgPGI+TWFzdGVyIFByb2R1Y3Q8L2I+IHlvdSBhcmUgYnVpbGRpbmcgYSByZWNpcGUgZm9yLiBJZiBpdOKAmXMgYSA8Yj4oTUFOKTwvYj4gcHJvZHVjdCwgeW91IGNhbiBzZXQgaXRzIDxiPllpZWxkIFF1YW50aXR5PC9iPiBhbmQgPGI+VU9NPC9iPi4nLAogICAgICAgIHBvc2l0aW9uOiAnYm90dG9tJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3R1dG9yaWFsLXJlY2lwZS10YWJsZScsCiAgICAgICAgY29udGVudDogJ1lvdXIgc2VsZWN0ZWQgaW5ncmVkaWVudHMgYXBwZWFyIGhlcmUuIEVudGVyIGEgPGI+UXVhbnRpdHk8L2I+IGZvciBlYWNoLiBXZeKAmWxsIGNhbGN1bGF0ZSB0aGUgPGI+VG90YWwgQ29zdDwvYj4gYXV0b21hdGljYWxseS4nLAogICAgICAgIHBvc2l0aW9uOiAndG9wJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3NhdmVSZWNpcGVCdG4nLAogICAgICAgIGNvbnRlbnQ6ICdBbGwgc2V0PyBDbGljayA8Yj5TYXZlIFJlY2lwZTwvYj4uIElmIGEgPGI+KE1BTik8L2I+IHByb2R1Y3QgaXMgc2F2ZWQsIGl0cyBjb3N0IHBlciB5aWVsZCB1bml0IHVwZGF0ZXMgZXZlcnl3aGVyZSBpdOKAmXMgdXNlZC4nLAogICAgICAgIHBvc2l0aW9uOiAndG9wJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3R1dG9yaWFsLXNhdmVkLXJlY2lwZXMnLAogICAgICAgIGNvbnRlbnQ6ICdGaW5kIHlvdXIgPGI+U2F2ZWQgUmVjaXBlczwvYj4gaGVyZS4gWW91IGNhbiA8Yj5FZGl0PC9iPiwgPGI+Q29weTwvYj4sIG9yIDxiPkRlbGV0ZTwvYj4uIFVzZSB0aGUgc2VhcmNoIGJhciB0byBmaWx0ZXIgcXVpY2tseS4nLAogICAgICAgIHBvc2l0aW9uOiAndG9wJwogICAgfSwKICAgIHsKICAgICAgICBlbGVtZW50OiAnI3R1dG9yaWFsLWFjdGlvbnMnLAogICAgICAgIGNvbnRlbnQ6ICdSZWFkeSB0byBoYW5kIG9mZj8gPGI+RXhwb3J0IEFsbCBSZWNpcGVzPC9iPiB0byBFeGNlbCAodGhlbiB0aGUgYXBwIGNsZWFycyksIG9yIDxiPkNsZWFyIEFsbCBEYXRhPC9iPiB0byBzdGFydCBmcmVzaC4nLAogICAgICAgIHBvc2l0aW9uOiAnbGVmdCcKICAgIH0KXTsKCiAgICBsZXQgY3VycmVudFR1dG9yaWFsU3RlcCA9IDA7CiAgICBjb25zdCB0dXRvcmlhbE92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheScpOwogICAgY29uc3QgdHV0b3JpYWxQb3BvdmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXBvcG92ZXInKTsKICAgIGNvbnN0IHBvcG92ZXJDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXBvcG92ZXItY29udGVudCcpOwogICAgY29uc3Qgc3RlcENvdW50ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtc3RlcC1jb3VudGVyJyk7CiAgICBjb25zdCBwcmV2QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLXByZXYtYnRuJyk7CiAgICBjb25zdCBuZXh0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW5leHQtYnRuJyk7CiAgICBsZXQgaGlnaGxpZ2h0ZWRFbGVtZW50ID0gbnVsbDsKCiAgICBmdW5jdGlvbiBzdGFydFR1dG9yaWFsKCkgewogICAgICAgIGN1cnJlbnRUdXRvcmlhbFN0ZXAgPSAwOwogICAgICAgIHR1dG9yaWFsT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICBzaG93VHV0b3JpYWxTdGVwKGN1cnJlbnRUdXRvcmlhbFN0ZXApOwogICAgfQoKICAgIGZ1bmN0aW9uIGVuZFR1dG9yaWFsKCkgewogICAgICAgIHR1dG9yaWFsT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50dXRvcmlhbC1vdmVybGF5LXBhcnQnKS5mb3JFYWNoKHBhcnQgPT4gewogICAgICAgICAgICBwYXJ0LnN0eWxlLndpZHRoID0gJzAnOwogICAgICAgICAgICBwYXJ0LnN0eWxlLmhlaWdodCA9ICcwJzsKICAgICAgICB9KTsKICAgICAgICB0dXRvcmlhbFBvcG92ZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICBpZiAoaGlnaGxpZ2h0ZWRFbGVtZW50KSB7CiAgICAgICAgICAgIGhpZ2hsaWdodGVkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQtZWxlbWVudCcpOwogICAgICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQgPSBudWxsOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzaG93VHV0b3JpYWxTdGVwKGluZGV4KSB7CiAgICAgICAgaWYgKGhpZ2hsaWdodGVkRWxlbWVudCkgewogICAgICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnaGlnaGxpZ2h0LWVsZW1lbnQnKTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHN0ZXAgPSB0dXRvcmlhbFN0ZXBzW2luZGV4XTsKICAgICAgICBjb25zdCB0YXJnZXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzdGVwLmVsZW1lbnQpOwoKICAgICAgICBpZiAoIXRhcmdldEVsZW1lbnQpIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKCdUdXRvcmlhbCBlbGVtZW50IG5vdCBmb3VuZDonLCBzdGVwLmVsZW1lbnQpOwogICAgICAgICAgICBpZiAoaW5kZXggPCB0dXRvcmlhbFN0ZXBzLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgICAgIHNob3dUdXRvcmlhbFN0ZXAoaW5kZXggKyAxKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGVuZFR1dG9yaWFsKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0dXRvcmlhbFBvcG92ZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgaGlnaGxpZ2h0ZWRFbGVtZW50ID0gdGFyZ2V0RWxlbWVudDsKICAgICAgICBoaWdobGlnaHRlZEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0LWVsZW1lbnQnKTsKICAgICAgICAKICAgICAgICB0YXJnZXRFbGVtZW50LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ2NlbnRlcicsIGlubGluZTogJ2NlbnRlcicgfSk7CgogICAgICAgIHBvcG92ZXJDb250ZW50LmlubmVySFRNTCA9IHN0ZXAuY29udGVudDsKICAgICAgICBzdGVwQ291bnRlci50ZXh0Q29udGVudCA9IGBTdGVwICR7aW5kZXggKyAxfSBvZiAke3R1dG9yaWFsU3RlcHMubGVuZ3RofWA7CiAgICAgICAgCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHBvc2l0aW9uUG9wb3Zlcih0YXJnZXRFbGVtZW50LCBzdGVwLnBvc2l0aW9uKTsKICAgICAgICAgICAgcG9zaXRpb25TcG90bGlnaHQodGFyZ2V0RWxlbWVudCk7CiAgICAgICAgfSwgMzAwKTsKCiAgICAgICAgcHJldkJ0bi5kaXNhYmxlZCA9IGluZGV4ID09PSAwOwogICAgICAgIG5leHRCdG4udGV4dENvbnRlbnQgPSBpbmRleCA9PT0gdHV0b3JpYWxTdGVwcy5sZW5ndGggLSAxID8gJ0ZpbmlzaCcgOiAnTmV4dCc7CiAgICB9CgogICAgZnVuY3Rpb24gcG9zaXRpb25TcG90bGlnaHQodGFyZ2V0KSB7CiAgICAgICAgY29uc3QgdGFyZ2V0UmVjdCA9IHRhcmdldC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS10b3AnKS5zdHlsZS5oZWlnaHQgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktdG9wJykuc3R5bGUud2lkdGggPSAnMTAwdncnOwogICAgICAgIAogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWJvdHRvbScpLnN0eWxlLnRvcCA9IGAke3RhcmdldFJlY3QuYm90dG9tfXB4YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1ib3R0b20nKS5zdHlsZS5oZWlnaHQgPSBgY2FsYygxMDB2aCAtICR7dGFyZ2V0UmVjdC5ib3R0b219cHgpYDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1ib3R0b20nKS5zdHlsZS53aWR0aCA9ICcxMDB2dyc7CgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbC1vdmVybGF5LWxlZnQnKS5zdHlsZS50b3AgPSBgJHt0YXJnZXRSZWN0LnRvcH1weGA7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1dG9yaWFsLW92ZXJsYXktbGVmdCcpLnN0eWxlLmhlaWdodCA9IGAke3RhcmdldFJlY3QuaGVpZ2h0fXB4YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1sZWZ0Jykuc3R5bGUud2lkdGggPSBgJHt0YXJnZXRSZWN0LmxlZnR9cHhgOwoKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1yaWdodCcpLnN0eWxlLnRvcCA9IGAke3RhcmdldFJlY3QudG9wfXB4YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1yaWdodCcpLnN0eWxlLmhlaWdodCA9IGAke3RhcmdldFJlY3QuaGVpZ2h0fXB4YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1yaWdodCcpLnN0eWxlLmxlZnQgPSBgJHt0YXJnZXRSZWN0LnJpZ2h0fXB4YDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHV0b3JpYWwtb3ZlcmxheS1yaWdodCcpLnN0eWxlLndpZHRoID0gYGNhbGMoMTAwdncgLSAke3RhcmdldFJlY3QucmlnaHR9cHgpYDsKICAgIH0KCiAgICBmdW5jdGlvbiBwb3NpdGlvblBvcG92ZXIodGFyZ2V0LCBwb3NpdGlvbikgewogICAgICAgIGNvbnN0IHRhcmdldFJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgY29uc3QgcG9wb3Zlck5vZGUgPSB0dXRvcmlhbFBvcG92ZXI7CiAgICAgICAgCiAgICAgICAgcG9wb3Zlck5vZGUuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nOwogICAgICAgIGNvbnN0IHBvcG92ZXJSZWN0ID0gcG9wb3Zlck5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgcG9wb3Zlck5vZGUuc3R5bGUudmlzaWJpbGl0eSA9ICcnOwoKICAgICAgICBjb25zdCBzcGFjaW5nID0gMTU7CiAgICAgICAgcG9wb3Zlck5vZGUuY2xhc3NOYW1lID0gJ3R1dG9yaWFsLXBvcG92ZXInOyAvLyBSZXNldCBjbGFzc2VzCiAgICAgICAgbGV0IHRvcCwgbGVmdDsKCiAgICAgICAgc3dpdGNoIChwb3NpdGlvbikgewogICAgICAgICAgICBjYXNlICd0b3AnOgogICAgICAgICAgICAgICAgdG9wID0gdGFyZ2V0UmVjdC50b3AgLSBwb3BvdmVyUmVjdC5oZWlnaHQgLSBzcGFjaW5nOwogICAgICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QubGVmdCArICh0YXJnZXRSZWN0LndpZHRoIC8gMikgLSAocG9wb3ZlclJlY3Qud2lkdGggLyAyKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdib3R0b20nOgogICAgICAgICAgICAgICAgdG9wID0gdGFyZ2V0UmVjdC5ib3R0b20gKyBzcGFjaW5nOwogICAgICAgICAgICAgICAgbGVmdCA9IHRhcmdldFJlY3QubGVmdCArICh0YXJnZXRSZWN0LndpZHRoIC8gMikgLSAocG9wb3ZlclJlY3Qud2lkdGggLyAyKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdsZWZ0JzoKICAgICAgICAgICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LmxlZnQgLSBwb3BvdmVyUmVjdC53aWR0aCAtIHNwYWNpbmc7CiAgICAgICAgICAgICAgICB0b3AgPSB0YXJnZXRSZWN0LnRvcCArICh0YXJnZXRSZWN0LmhlaWdodCAvIDIpIC0gKHBvcG92ZXJSZWN0LmhlaWdodCAvIDIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzoKICAgICAgICAgICAgICAgIGxlZnQgPSB0YXJnZXRSZWN0LnJpZ2h0ICsgc3BhY2luZzsKICAgICAgICAgICAgICAgIHRvcCA9IHRhcmdldFJlY3QudG9wICsgKHRhcmdldFJlY3QuaGVpZ2h0IC8gMikgLSAocG9wb3ZlclJlY3QuaGVpZ2h0IC8gMik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKGxlZnQgPCBzcGFjaW5nKSBsZWZ0ID0gc3BhY2luZzsKICAgICAgICBpZiAoKGxlZnQgKyBwb3BvdmVyUmVjdC53aWR0aCkgPiB3aW5kb3cuaW5uZXJXaWR0aCAtIHNwYWNpbmcpIGxlZnQgPSB3aW5kb3cuaW5uZXJXaWR0aCAtIHBvcG92ZXJSZWN0LndpZHRoIC0gc3BhY2luZzsKICAgICAgICBpZiAodG9wIDwgc3BhY2luZykgdG9wID0gc3BhY2luZzsKICAgICAgICBpZiAoKHRvcCArIHBvcG92ZXJSZWN0LmhlaWdodCkgPiB3aW5kb3cuaW5uZXJIZWlnaHQgLSBzcGFjaW5nKSB0b3AgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBwb3BvdmVyUmVjdC5oZWlnaHQgLSBzcGFjaW5nOwoKICAgICAgICBwb3BvdmVyTm9kZS5zdHlsZS50b3AgPSBgJHt0b3B9cHhgOwogICAgICAgIHBvcG92ZXJOb2RlLnN0eWxlLmxlZnQgPSBgJHtsZWZ0fXB4YDsKICAgICAgICBwb3BvdmVyTm9kZS5jbGFzc0xpc3QuYWRkKGBhcnJvdy0ke3Bvc2l0aW9ufWApOwogICAgfQoKICAgIHByZXZCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgaWYgKGN1cnJlbnRUdXRvcmlhbFN0ZXAgPiAwKSB7CiAgICAgICAgICAgIGN1cnJlbnRUdXRvcmlhbFN0ZXAtLTsKICAgICAgICAgICAgc2hvd1R1dG9yaWFsU3RlcChjdXJyZW50VHV0b3JpYWxTdGVwKTsKICAgICAgICB9CiAgICB9KTsKCiAgICBuZXh0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGlmIChjdXJyZW50VHV0b3JpYWxTdGVwIDwgdHV0b3JpYWxTdGVwcy5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgIGN1cnJlbnRUdXRvcmlhbFN0ZXArKzsKICAgICAgICAgICAgc2hvd1R1dG9yaWFsU3RlcChjdXJyZW50VHV0b3JpYWxTdGVwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlbmRUdXRvcmlhbCgpOwogICAgICAgIH0KICAgIH0pOwoKPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPg==</script>
<!-- === Yoco: Session Defaults helper (non-destructive) === -->
</body>
</html>
